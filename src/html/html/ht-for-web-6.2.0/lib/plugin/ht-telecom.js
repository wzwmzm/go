!function(i,A){"use strict";var B=ht.AlarmSeverity=function(w,R,k,N,o){this.value=w,this.name=R,this.nickName=k,this.color=N,this.displayName=o};ht.Default.def("ht.AlarmSeverity",A,{toString:function(){return this.displayName||this.name}}),function(){B.severities=new ht.List,B._vm={},B._nm={},B._cp=function(U,g){if(U&&g){var Z=U.value-g.value;return Z>0?1:0>Z?-1:0}return U&&!g?1:!U&&g?-1:0},B.each=function(z,G){B.severities.each(z,G)},B.getSortFunction=function(){return B._cp},B.setSortFunction=function(S){B._cp=S,B.severities.sort(S)},B.add=function(Y,m,f,o,G){var N=new B(Y,m,f,o,G);return B._vm[Y]=N,B._nm[m]=N,B.severities.add(N),B.severities.sort(B._cp),N},B.remove=function(Z){var M=B._nm[Z];return M&&(delete B._nm[Z],delete B._vm[M.value],B.severities.remove(M)),M},B.CRITICAL=B.add(500,"Critical","C","#FF0000"),B.MAJOR=B.add(400,"Major","M","#FFA000"),B.MINOR=B.add(300,"Minor","m","#FFFF00"),B.WARNING=B.add(200,"Warning","W","#00FFFF"),B.INDETERMINATE=B.add(100,"Indeterminate","N","#C800FF"),B.CLEARED=B.add(0,"Cleared","R","#00FF00"),B.isClearedAlarmSeverity=function(U){return U?0===U.value:!1},B.getByName=function(h){return B._nm[h]},B.getByValue=function(H){return B._vm[H]},B.clear=function(){B.severities.clear(),B._vm={},B._nm={}},B.compare=function(b,n){return B._cp(b,n)}}();var F=ht.AlarmState=function(N){this._d=N,this._nm={},this._am={},this._ps=null,this._haa=null,this._hna=null,this._hoa=null,this._hta=null,this._hls=!1,this._aac=0,this._nac=0};ht.Default.def("ht.AlarmState",A,{_ep:!0,_f:function(){this._c1(),this._c2(),this._c3(),this._c4(),this._c5(),this._c6(),this._c7(),this._d.fp("alarmState",null,this)},getHighestAcknowledgedAlarmSeverity:function(){return this._haa},getHighestNewAlarmSeverity:function(){return this._hna},getHighestOverallAlarmSeverity:function(){return this._hoa},getHighestNativeAlarmSeverity:function(){return this._hta},hasLessSevereNewAlarms:function(){return this._hls},_c1:function(){var H=null;for(var l in this._am)l=B.getByName(l),B.isClearedAlarmSeverity(l)||0!==this.getAcknowledgedAlarmCount(l)&&(H=H?B.compare(H,l)>0?H:l:l);this._haa=H},_c2:function(){var P=null;for(var e in this._nm)e=B.getByName(e),B.isClearedAlarmSeverity(e)||0!==this.getNewAlarmCount(e)&&(P=P?B.compare(P,e)>0?P:e:e);this._hna=P},_c3:function(){if(!this._hna)return this._hls=!1,void 0;for(var Y in this._nm)if(Y=B.getByName(Y),!B.isClearedAlarmSeverity(Y)&&0!==this.getNewAlarmCount(Y)&&B.compare(this._hna,Y)>0)return this._hls=!0,void 0;this._hls=!1},_c4:function(){var K=this._haa,b=this._hna,G=this._ps;this._hoa=K,B.compare(b,this._hoa)>0&&(this._hoa=b),B.compare(G,this._hoa)>0&&(this._hoa=G)},_c5:function(){var O=this._haa,g=this._hna;this._hta=O,B.compare(g,this._hta)>0&&(this._hta=g)},increaseAcknowledgedAlarm:function(j,F){if(0!==F){F=F||1;var M=this._am[j.name]||0;M+=F,this._am[j.name]=M,this._f()}},increaseNewAlarm:function(g,B){if(0!==B){B=B||1;var e=this._nm[g.name]||0;e+=B,this._nm[g.name]=e,this._f()}},decreaseAcknowledgedAlarm:function(U,Z){if(0!==Z){Z||(Z=1);var r=this._am[U.name]||0;if(r-=Z,0>r)throw"Alarm count can not be negative";this._am[U.name]=r,this._f()}},decreaseNewAlarm:function(s,A){if(0!==A){A||(A=1);var B=this._nm[s.name]||0;if(B-=A,0>B)throw"Alarm count can not be negative";this._nm[s.name]=B,this._f()}},acknowledgeAlarm:function(N){this.decreaseNewAlarm(N,1),this.increaseAcknowledgedAlarm(N,1)},acknowledgeAllAlarms:function(z){if(z){var S=this.getNewAlarmCount(z);this.decreaseNewAlarm(z,S),this.increaseAcknowledgedAlarm(z,S)}else for(var c in this._nm)this.acknowledgeAllAlarms(B.getByName(c))},_c6:function(){this._aac=0;for(var Z in this._am)Z=B.getByName(Z),this._aac+=this.getAcknowledgedAlarmCount(Z)},getAcknowledgedAlarmCount:function($){return $?this._am[$.name]||0:this._aac},getAlarmCount:function(v){return this.getAcknowledgedAlarmCount(v)+this.getNewAlarmCount(v)},_c7:function(){this._nac=0;for(var $ in this._nm)this._nac+=this.getNewAlarmCount(B.getByName($))},getNewAlarmCount:function(G){return G?this._nm[G.name]||0:this._nac},setNewAlarmCount:function(k,r){this._nm[k.name]=r,this._f()},removeAllNewAlarms:function(r){r?delete this._nm[r]:this._nm={},this._f()},setAcknowledgedAlarmCount:function(c,x){this._am[c.name]=x,this._f()},removeAllAcknowledgedAlarms:function(x){x?delete this._am[x.name]:this._am={},this._f()},isEmpty:function(){return!this._hoa},clear:function(){this._am={},this._nm={},this._f()},getPropagateSeverity:function(){return this._ps},setPropagateSeverity:function(e){if(this._ep||(e=null),this._ps!==e){var D=this._ps;this._ps=e,this._f(),this._d.fp("propagateSeverity",D,e)}},isEnablePropagation:function(){return this._ep},setEnablePropagation:function(c){var e=this._ep;this._ep=c,this._d.fp("enablePropagation",e,c)&&(c||this.setPropagateSeverity(null))}});var f=ht.AlarmStatePropagator=function(d){this._dataModel=d,this._enable=!1,this._isPropagating=!1};ht.Default.def("ht.AlarmStatePropagator",A,{getDataModel:function(){return this._dataModel},isEnable:function(){return this._enable},setEnable:function($){this._enable!==$&&(this._enable=$,this._enable?(this._dataModel.mm(this.handleDataModelChange,this),this._dataModel.md(this.handleDataPropertyChange,this),this._dataModel.each(function(b){this.propagate(b)},this)):(this._dataModel.umm(this.handleDataModelChange,this),this._dataModel.umd(this.handleDataPropertyChange,this)))},handleDataModelChange:function(_){_.data&&this.propagate(_.data)},handleDataPropertyChange:function(J){if("alarmState"===J.property||"enablePropagation"===J.property)this.propagate(J.data);else if("parent"===J.property){var k=J.oldValue;k&&this.propagate(k),this.propagate(J.data)}},propagate:function(p){p&&!this._isPropagating&&(this._isPropagating=!0,this.propagateToTop(p),this._isPropagating=!1)},propagateToTop:function(D){for(this.propagateToParent(null,D);D&&D.getParent();)this.propagateToParent(D,D.getParent()),D=D.getParent()},propagateToParent:function(E,c){var Q=null;c.getChildren().each(function(t){var M=t.getAlarmState().getHighestOverallAlarmSeverity();B.compare(M,Q)>0&&(Q=M)}),c.getAlarmState().setPropagateSeverity(Q)}}),ht.AlarmStateStatistics=function(s){this.sumNew=0,this.sumAcked=0,this.sumTotal=0,this.severtiyMap={},this.dataMap={},this.setDataModel(s)},ht.Default.def("ht.AlarmStateStatistics",A,{ms_fire:1,getDataModel:function(){return this._dataModel},setDataModel:function(Y){var $=this._dataModel;$!==Y&&($&&($.umd(this.handleDataPropertyChange,this),$.umm(this.handleDataModelChange,this),this.severtiyMap={},this.dataMap={}),this._dataModel=Y,this.reset(),Y.md(this.handleDataPropertyChange,this),Y.mm(this.handleDataModelChange,this),this.fp("dataModel",$,Y))},dispose:function(){this._dataModel.umd(this.handleDataPropertyChange,this),this._dataModel.umm(this.handleDataModelChange,this),delete this._dataModel},handleDataPropertyChange:function(f){"alarmState"===f.property&&(this.increase(f.data),this.fireAlarmStateChange())},handleDataModelChange:function(C){"add"===C.kind?(this.increase(C.data),this.fireAlarmStateChange()):"remove"===C.kind?(this.decrease(C.data),this.fireAlarmStateChange()):"clear"===C.kind&&(this.severtiyMap={},this.dataMap={},this.fireAlarmStateChange())},fireAlarmStateChange:function(){this.sumAcked=0,this.sumNew=0,this.sumTotal=0,B.each(function(d){var v=this.getSumInfo(d);this.sumAcked+=v.ackedCount,this.sumNew+=v.newCount,this.sumTotal+=v.totalCount},this),this.fp("alarmState",!1,!0)},getNewAlarmCount:function(a){if(!a)return this.sumNew;var j=this.getSumInfo(a);return j.newCount},getAcknowledgedAlarmCount:function(r){if(!r)return this.sumAcked;var c=this.getSumInfo(r);return c.ackedCount},getTotalAlarmCount:function(B){if(!B)return this.sumTotal;var L=this.getSumInfo(B);return L.totalCount},getSumInfo:function(S){var q=this.severtiyMap[S.name];return q||(q={},q.newCount=0,q.ackedCount=0,q.totalCount=0,this.severtiyMap[S.name]=q),q},decrease:function(w){var h=this.dataMap[w.getId()];h&&(delete this.dataMap[w.getId()],B.each(function(O){var m=h[O.name],w=this.getSumInfo(O);w.newCount=w.newCount-m.newCount,w.ackedCount=w.ackedCount-m.ackedCount,w.totalCount=w.totalCount-m.totalCount},this))},increase:function(I){if(this.decrease(I),!this._filterFunc||this._filterFunc(I)){var o={},Z=I.getAlarmState();this.dataMap[I.getId()]=o,B.each(function(P){var b={};b.newCount=Z.getNewAlarmCount(P),b.ackedCount=Z.getAcknowledgedAlarmCount(P),b.totalCount=Z.getAlarmCount(P),o[P.name]=b;var I=this.getSumInfo(P);I.newCount=I.newCount+b.newCount,I.ackedCount=I.ackedCount+b.ackedCount,I.totalCount=I.totalCount+b.totalCount},this)}},reset:function(){this.severtiyMap={},this.dataMap={},this._dataModel.each(this.increase,this),this.fireAlarmStateChange()},setFilterFunc:function(G){var y=this._filterFunc;this._filterFunc=G,this.reset(),this.fp("filterFunc",y,G)},getFilterFunc:function(){return this._filterFunc}});var P=ht.Data.prototype;P.getAlarmState=function(){return this._alarmState||(this._alarmState=new F(this))},P=ht.DataModel.prototype,P.isEnableAlarmStatePropagator=function(){return!!this._alarmStatePropagator&&this._alarmStatePropagator.isEnable()},P.setEnableAlarmStatePropagator=function(p){p!=this.isEnableAlarmStatePropagator()&&(p?(this._alarmStatePropagator=new f(this)).setEnable(!0):this._alarmStatePropagator.setEnable(!1))},P=ht.graph.GraphView.prototype,P.getNote2=function(A){var X=A.getAlarmState().getHighestNewAlarmSeverity();if(X){var c=A.getAlarmState().getNewAlarmCount(X)+X.nickName;return A.getAlarmState().hasLessSevereNewAlarms()&&(c+="+"),c}return A.s("note2")},P.getNote2Background=function(u){var i=u.getAlarmState().getHighestNewAlarmSeverity();return i?i.color:u.s("note2.background")},P.getBodyColor=function(_){var s=_.getAlarmState().getHighestNativeAlarmSeverity();return s?s.color:_.s("body.color")},P.getBorderColor=function(F){var C=F.getAlarmState().getPropagateSeverity();return C?C.color:F.s("border.color")},P=ht.widget.TreeView.prototype,P.getBorderColor=function(T){var u=T.getAlarmState().getPropagateSeverity();return u?u.color:T.s("border.color")},P.getIcon=function(u){return u.getIcon()?"__alarmIcon__":null},P=ht.widget.TreeTableView.prototype,P.getBorderColor=function(o){var p=o.getAlarmState().getPropagateSeverity();return p?p.color:o.s("border.color")},P.getIcon=function(n){return n.getIcon()?"__alarmIcon__":null},ht.Default.setImage("__alarmIcon__",{width:16,height:16,comps:[{type:"image",name:{func:function(d){return d.getIcon()}},color:{func:function(r){var I=r.getAlarmState().getHighestNativeAlarmSeverity();return I?I.color:r.s("body.color")}},rect:[0,0,16,16]}]});var b=ht.Style;b["note2.expanded"]=!0,b["note2.color"]="#000"}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:(0,eval)("this"),Object);