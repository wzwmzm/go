!function(p){"use strict";var Q="ht",L=p[Q],G=function(){return document},O=function(){return G().body},z=function(i,$,p){i.style.setProperty($,p,null)},e=function(u){return G().createElement(u)},T=function(){return e("div")},F=function(){var Y=e("canvas");return Y},X=function(M,J){z(M,"-webkit-transform",J),z(M,"-ms-transform",J),z(M,"transform",J)},K=function(Y,L){z(Y,"-webkit-transform-origin",L),z(Y,"-ms-transform-origin",L),z(Y,"transform-origin",L)},w=function(I,G){I.appendChild(G)},d=function(P,H){P.removeChild(H)},I=p.parseInt,S=L.Default,l=S.getInternal(),W=Math.PI,C="white-space",N="visibility",f="left",r="top",H="width",n="height",D="position",k="display",j="z-index",q="px",B="0 0",R="absolute",y="visible",v="hidden",o="none",Z="block",i="nowrap",m="rgba(0, 0, 0, 0.005)";S.setImage("node_dragger","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAN9JREFUeNrsV9sNhDAMKyzQVdgARmGzrMJNUFZhAh6nfkVcG9PQgHSR8lEksJs6pnGuLCimSRzAa0yyBK9O4gy8GokU+O0kJOAwiQYg0LP1xNYDW3+0CfBYNb7VOuN4LAGpiOaYUhFDas9F2NPHDELNENJqaHgBgSQJ3ufakfQJqckERcOiK+Ae1FGWBNKGh9oX5WPpLpdNYfffijbsxTHh7VKP7388n1g1h7OKUoUuyGpJakQEuhwkZAKcDXVOdWcrOrL/feBVBHI/q8fcjE1nA9PpyHQ+NJ2Qi8A3AQYAOtS27fCoRY0AAAAASUVORK5CYII=");var P=L.graph.GraphView.prototype,M=P._42;P.adjustHtmlNodeIndex=!0,P._42=function(w,Y){if(M.call(this,w,Y),this.adjustHtmlNodeIndex)for(var C=this.getDataModel()._datas._as,$=C.length,A=1,n=0;$>n;n++){var l=C[n];if(l instanceof u){var J=this.getDataUI(l);z(J.$2f,j,A+""),z(J.$3f,j,A+1+""),A+=2}}};var E=L.HtmlNodeUI=function(G,b){var L=this;E.superClass.constructor.call(L,G,b);var H=L.$2f=T(),c=L.$3f=F();z(H,D,R),z(H,N,v),z(H,C,i),c.draggable=!1,z(c,D,R),z(c,k,o),K(c,B),H.addEventListener("change",function(Z){var E=Z.target,r=E.bind||E.getAttribute("bind"),I=E.type&&"checkbox"===E.type?E.checked:E.value,i=b.getContext();r&&i&&(i[r]=I,L.$4f=JSON.stringify(i))}),["mousedown","touchstart","keydown","mousewheel","DOMMouseScroll"].forEach(function(g){H.addEventListener(g,this.$9f.bind(this))},L)};S.def(E,l.ui().NodeUI,{_visible:!0,$11f:function(){var c=this,b=c.$3f,I=c._data,L=I.getDraggerImageWidth(),B=I.getDraggerImageHeight(),E=I.getDraggerImage(),p=l.initContext(b);p.beginPath(),l.setCanvas(b,L,B),l.translateAndScale(p,0,0,1),p.clearRect(0,0,L,B),S.drawImage(p,S.getImage(E),0,0,L,B),p.restore()},_80o:function(U){E.superClass._80o.call(this,U);var P=this,Q=P._data,G=Q._padding,J=2*G,B=P.$2f,d=P.$3f,M=P.gv,K=M.getZoom(),O=M.getTranslateX(),F=M.getTranslateY(),l=M.getView(),L=P._83o,p=Q._width,t=Q._height,Y=L.position,V=L.rotation,b=(p-J)/Q.$5f*K,h=(t-J)/Q.$6f*K,S=P._html,s=Q._html,g=Q.getHtmlType();if("html"===g){var u=Q.getContext()||{},x=P.$4f,e=Q.$10f,i=JSON.stringify(u);S&&x&&S===s&&x===i||(P.$4f=i,P._html=s,B.innerHTML=e?e(u):s)}else if(null!=g){var a=Q.getHtml();"ht"===g&&(a=a.getView()),S&&S===a&&B.contains(S)||(P._html=a,B.innerHTML="",w(B,a))}if(!B.parentNode){var $=M.$1f;if(!$){var C=T();z(C,D,R),z(C,j,"0"),$=M.$1f=C;var c=M._canvas.nextSibling;c?l.insertBefore(C,c):w(l,C)}w($,B),w($,d),Q.onContentInitialized&&Q.onContentInitialized(B)}if(Q._scalable){var _=Q.$5f,A=Q.$6f;X(B,"rotate("+180*(V/W)+"deg) scale("+b+","+h+")"),z(B,H,""),z(B,n,""),z(B,f,(Y.x-_/K/2)*K+O+q),z(B,r,(Y.y-A/K/2)*K+F+q)}else{var Wr=I(B.style.width),um=I(B.style.height),bm=I((p-J)*K),tl=I((t-J)*K),Nk="100%",cp=B.children[0];z(cp,H,Nk),z(cp,n,Nk),(Wr!==bm||um!==tl)&&(z(B,H,bm+q),z(B,n,tl+q),"ht"===g&&s.invalidate()),X(B,"rotate("+180*(V/W)+"deg)"),z(B,f,(Y.x-bm/K/2)*K+O+q),z(B,r,(Y.y-tl/K/2)*K+F+q)}var Zq=P.dragRect;M.isMovable(Q)&&M.isSelected(Q)&&Zq?(U.save(),U.fillStyle=m,U.fillRect(Zq.x,Zq.y,Zq.width,Zq.height),U.restore(),z(d,f,Zq.x*K+O+q),z(d,r,Zq.y*K+F+q),X(d,"scale("+K+","+K+")"),z(d,k,Z),P.$11f()):z(d,k,o),z(B,N,this._visible?y:v)},dispose:function(){var F=this.gv.$1f;this.$2f.parentNode===F&&F.removeChild(this.$2f),this.$3f.parentNode===F&&F.removeChild(this.$3f)},_84o:function(q){this._visible=q,z(this.$2f,N,q?y:v),z(this.$3f,k,q?Z:o)},_3O:function(){var K=this,V=K.gv,c=K._data;E.superClass._3O.call(K);var n=c.getRect();V.isEditable(c)&&(K.dragRect={x:n.x+n.width+c._padding,y:n.y+10,width:c.getDraggerImageWidth(),height:c.getDraggerImageHeight()},K._68o(K.dragRect))},rectIntersects:function(J){var T=this._79o();return L.Default.intersection(T,J)?!0:void 0},$9f:function(B){var e=this.gv,P=this._data;e.sm().contains(P)&&B.stopPropagation()}});var u=L.HtmlNode=function(){u.superClass.constructor.call(this)};L.Default.def(u,L.Node,{ms_ac:["html","context","scalable","padding","draggerImage","draggerImageWidth","draggerImageHeight"],_padding:L.Default.isTouchable?12:6,_image:null,_scalable:!0,_draggerImage:"node_dragger",_draggerImageWidth:20,_draggerImageHeight:20,setHtml:function(S){var s=this,q=s._html;s._html=S,"html"===s.getHtmlType()&&"Handlebars"in p&&(s.$10f=Handlebars.compile(S)),s.$13f(),s.fp("html",q,S)},setContext:function(V){var o=this,I=o._context;o._context=V,o.fp("context",I,V),o.$13f()},setScalable:function(g){var W=this,e=W._scalable;W._scalable=g,W.fp("scalable",e,g),W.$13f()},getHtmlType:function(){var H=this._html;return H?"string"==typeof H?"html":H.getView?"ht":"dom":null},$13f:function(){var j=this,I=j._html,W=j.$10f;if(I){var u=T(),y=!1,B=j.getHtmlType();if(z(u,D,R),z(u,C,i),z(u,N,v),"html"===B?(u.innerHTML=W?W(j.getContext()||{}):I,y=!0):"ht"===B?(w(u,I.getView()),y=!0):"dom"===B&&(w(u,I),y=!0),y){var A=2*j._padding;w(O(),u),j.$5f=u.scrollWidth,j.$6f=u.scrollHeight,j._width=j.$5f+A,j._height=j.$6f+A,j._originWidth=j._width,j._originHeight=j._height,d(O(),u)}}},getUIClass:function(){return L.HtmlNodeUI}})}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:(0,eval)("this"),Object);