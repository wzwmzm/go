!function(d,h,O){"use strict";var w="ht",u=d[w],q=u.Default,D=u.graph,H=q.getInternal(),s=H.ui(),P=s.NodeUI.prototype,M=s.ShapeUI.prototype,K=D.GraphView,$=K.prototype,k=s.EdgeUI.prototype,v=u.Node,F=u.Shape,X=u.Edge,N=u.Group,Q=q.isTouchable,J=q.preventDefault,T=d.setTimeout,B=q.grow,R=q.isDragging,U=q.getDistance,g=null,t=u.List,W="undefined"!=typeof Float32Array?Float32Array:Array,S=Math,o=S.PI,E="Crossing",m="No Crossing",x=o/2,Y=2*o,b=S.atan2,a=S.sqrt,f=S.pow,l=S.sin,G=S.cos,A=S.min,y=S.max,I=S.abs,V=S.ceil,L=S.round,i=q.unionPoint,_=q.unionRect,p=q.containsPoint,C=q.clone,j="rgb(52, 152, 219)",r="red",n={northwest:0,north:1,northeast:2,west:7,east:3,southwest:6,south:5,southeast:4},z={width:400,height:100,comps:[{type:"shape",points:{func:function(){for(var W=[10,8,162,36,314,37,269,2,398,49,268,98,314,58,161,60,9,91,103,49,10,8],F=0;F<W.length;F++){var Y=W[F];Y=0===F%2?Y/400*z.width:Y/100*z.height,W[F]=Y}return z.width>120&&(W[4]=z.width-26,W[6]=z.width-40,W[10]=z.width-40,W[12]=z.width-26,W[18]=33),W}},segments:[1,3,2,2,2,2,3,2,2],background:"white",gradient:"linear.east",gradientColor:"red"}]},Z={width:300,height:300,comps:[{type:"circle",rect:[20,0,120,120],background:j,rotation:.61},{type:"circle",rect:[200,120,70,70],background:j,rotation:.61},{type:"circle",rect:[200,220,70,70],background:j,rotation:.61},{type:"shape",points:[80,60,80,155,200,155],borderWidth:20,borderColor:j},{type:"shape",points:[80,60,80,255,200,255],borderWidth:20,borderColor:j}]},c={width:300,height:300,comps:[{type:"shape",points:[114,239,115,106,112,73,149,73,149,73,175,73,177,105,179,261,178,302,147,307,98,308,83,307,72,276,73,260,72,81,74,29,115,21,191,21,221,22,224,53,223,238],segments:[1,2,3,2,3,2,3,2,4,2,3,2,3,2],borderWidth:20,borderColor:r,rotation:.61}]},e={width:300,height:300,comps:[{type:"circle",rect:[210,0,90,90],background:j},{type:"circle",rect:[0,210,90,90],background:j},{type:"shape",points:[255,45,45,255],borderWidth:20,borderColor:j}]},qh={width:300,height:300,comps:[{type:"shape",points:[20,20,280,280],borderWidth:30,borderColor:r},{type:"shape",points:[280,20,20,280],borderWidth:30,borderColor:r}]},ss={width:300,height:300,comps:[{type:"shape",points:[270,30,30,150,270,270],borderWidth:40,borderColor:j}]},Ye={width:300,height:300,comps:[{type:"shape",points:[30,30,270,150,30,270],borderWidth:40,borderColor:r}]},Pi={width:300,height:300,comps:[{type:"rect",rect:[125.58,52.76,40,231.96],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"rect",rect:[27.87,61.06,150,30],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000",rotation:5.5},{type:"rect",rect:[113.36,61,150,30],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000",rotation:.79}]},aq={width:300,height:300,author:"",note:"",comps:[{type:"rect",rect:[135.15,38.76,28.63,82.84],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"triangle",rect:[94.69,2.35,110,44.77],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"rect",rect:[31.71,115.72,240,15],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"rect",rect:[31.71,167.62,240,15],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"rect",rect:[135.15,177.33,28.63,82.84],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"triangle",rect:[94.69,251.39,110,44.77],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000",rotation:3.14}]},ed=function(q){var b=q.touches[0];return b?b:q.changedTouches[0]},sm=function(F,l,I,w){return b(w-l,I-F)},Rn=function(j,n){return{x:j.x*n,y:j.y*n}},lk=function(p,I){p.each(function(b){return p.isSelected(b)?I(b):void 0})},Zi=function(W,p){W.reverseEach(function(H){return W.isSelected(H)?p(H):void 0})},_j=function(r,Q,b){var Y,h,H,U,p,D=this,K=Q,W=D.gv;if(r instanceof F){H=r.getSegments();var M=W.getDataUI(r);p=M._55O.$15l,H&&H.size()||(H=Sf(p)),r.isClosePath()&&H.indexOf(5)<0&&(H=new t(H._as),H.add(5)),Y=rm(r,M,K),h=p[Y]}else{var e=W.getDataUI(r);p=lh(e,r.s("edge.points")),H=r.s("edge.segments"),H&&H.size()||(H=Sf(p)),p=p._as,Y=rm(r,e,K),h=p[Y]}if(H&&(U=H.get(K)),2===U||1===U||5===U){var m=p[Y+1];5===U&&(m=p[0]);var z=th(h,b,m);return z}return b},Tb=function(V,W,N,G){var S=W/2,U=N/2,A=pd(V,-S,-U,G),C=pd(V,S,-U,G),i=pd(V,-S,U,G),L=pd(V,S,U,G),c=pd(V,0,-U,G),q=pd(V,S,0,G),D=pd(V,0,U,G),l=pd(V,-S,0,G);return[A,C,i,L,c,q,D,l]},th=function(v,J,U){var p={x:J.x-v.x,y:J.y-v.y},C={x:U.x-v.x,y:U.y-v.y},y=a(f(U.x-v.x,2)+f(U.y-v.y,2)),P={x:C.x/y,y:C.y/y},L=p.x*P.x+p.y*P.y,B={x:P.x*L,y:P.y*L};return{x:v.x+B.x,y:v.y+B.y}},pd=function(w,k,F,T){var e=G(T)*k-l(T)*F,n=l(T)*k+G(T)*F;return w?{x:w.x+e,y:w.y+n}:{x:e,y:n}},co=function(G,M){return M>2*G?G:M/2},Cd=function(b,Y,N,Z){var M=U(b,Y);return N=Z?A(N,M):co(N,M),M?N/=M:N=0,{x:b.x+(Y.x-b.x)*N,y:b.y+(Y.y-b.y)*N}},zq=function(h,N){var K,B,e=h.gv,I=h._data,d=I._40I,f=I._41I,L=I.s("edge.offset"),G=I.s("edge.source.position"),C=I.s("edge.target.position"),A=I.s("edge.source.offset.x"),g=I.s("edge.source.offset.y"),U=I.s("edge.target.offset.x"),c=I.s("edge.target.offset.y"),$=I.s("edge.source.anchor.x"),V=I.s("edge.source.anchor.y"),Z=I.s("edge.target.anchor.x"),J=I.s("edge.target.anchor.y");if(N?(K=H.getEdgeAgentPosition(e,d,G,A,g,$,V),B=H.getEdgeAgentPosition(e,f,C,U,c,Z,J)):(K=H.getEdgeAgentPosition(e,d,G,0,0,$,V),B=H.getEdgeAgentPosition(e,f,C,0,0,Z,J)),"points"===I.s("edge.type")&&L&&!I.s("edge.center")&&K){var W=I.s("edge.points")||new t,k=W.size(),j=Cd(K,k?W.get(0):B,L,k),p=Cd(B,k?W.get(k-1):K,L,k);K=j,B=p}return[K,B]},lh=function(n,A,y){var Y=n._78o,c=n._data,u=c.s("edge.type"),O=[Y.sourcePoint,Y.targetPoint];return"points"===u?y&&(O=zq(n)):O=Y.center?u?y?zq(n):zq(n,!0):y?zq(n):[Y.c1,Y.c2]:y?zq(n):zq(n,!0),A=new t(A?A._as:g),A.add(O[0],0),A.add(O[1]),A},Qc=function(K){return K=new t(K._as),K.removeAt(0),K.removeAt(K.size()-1),K},Sf=function(F){F._as||(F=new t(F));var b=new t;b.add(1);for(var d=1;d<F.size();d++)b.add(2);return b},tp=function(B,J){return{x:(B.x+J.x)/2,y:(B.y+J.y)/2}},Gd=function(c,a){return{x:c.x+1*(a.x-c.x)/4,y:c.y+1*(a.y-c.y)/4}},fl=function(L,a){return{x:L.x+3*(a.x-L.x)/4,y:L.y+3*(a.y-L.y)/4}},Eq=function(Q,y,D,E){var v=y.x+y.width/2,t=y.y+y.height/2,Z=a(v*v+t*t),L=b(t,v)+D;return{x:E.x+Z*G(L),y:E.y+Z*l(L)}},rg=$.validateImpl,td=$.isRectEditable,xi=$.isPointEditable,Ml=$._42,Xp=M._79o,Rb=k._79o,rd=M._48O,Vi=M._47O,ho=P._48O,Bb=P._80o,js=M._80o,qb=P.getSelectWidth,Vn=P._47O,rs=k._47O,ul=$.isEditable,Cl=["northwest","north","northeast","east","southeast","south","southwest","west"],xm=function(t,E,V,M,Q,y,j,N,v,r){var n=t.x,l=t.y,J=t.width,$=t.height,a={x:n+J/2,y:l+$/2};M=M||0,E=pd(a,E.x-a.x,E.y-a.y,-M),j&&!N&&(E.x+=v,E.y+=r);var L=.01;if("northwest"===V?(E.x+Q>n+J-L&&(E.x=n+J-Q-L),E.y+Q>l+$-L&&(E.y=l+$-Q-L),t=i(E,{x:n+J,y:l+$})):"north"===V?(E.y+Q>l+$-L&&(E.y=l+$-Q-L),t=i({x:n,y:E.y},{x:n+J,y:l+$})):"northeast"===V?(E.x<n+Q+L&&(E.x=n+Q+L),E.y+Q>l+$-L&&(E.y=l+$-Q-L),t=i({x:n,y:E.y},{x:E.x,y:l+$})):"west"===V?(E.x+Q>n+J-L&&(E.x=n+J-Q-L),t=i({x:E.x,y:l},{x:n+J,y:l+$})):"east"===V?(E.x<n+Q+L&&(E.x=n+Q+L),t=i({x:n,y:l},{x:E.x,y:l+$})):"southwest"===V?(E.x+Q>n+J-L&&(E.x=n+J-Q-L),E.y<l+Q+L&&(E.y=l+Q+L),t=i({x:E.x,y:l},{x:n+J,y:E.y})):"south"===V?(E.y<l+Q+L&&(E.y=l+Q+L),t=i({x:n,y:l},{x:n+J,y:E.y})):"southeast"===V&&(E.x<n+Q+L&&(E.x=n+Q+L),E.y<l+Q+L&&(E.y=l+Q+L),t=i({x:n,y:l},E)),"keepRatio"===y&&(!j&&N||j&&!N)&&("northeast"===V||"southeast"===V||"northwest"===V||"southwest"===V)){var H=t.width,q=t.height,d=H/J,F=q/$,S=A(d,F);t.width=J*S,t.height=$*S,"northeast"===V?t.y=l+($-t.height):"northwest"===V?(t.y=l+($-t.height),t.x=n+(J-t.width)):"southwest"===V&&(t.x=n+(J-t.width))}t.x-=a.x,t.y-=a.y;var s=Eq(g,t,M,a);return t.x=s.x-t.width/2,t.y=s.y-t.height/2,t},hc=function(x,v,G,y){var k=x.getRotation(),o=v,p=o.x,b=o.y,q=o.width,C=o.height,w={x:p+o.width/2,y:b+o.height/2};y=pd(w,y.x-w.x,y.y-w.y,-k),"northwest"===G?o=i(y,{x:p+q,y:b+C}):"north"===G?o=i({x:p,y:y.y},{x:p+q,y:b+C}):"northeast"===G?o=i({x:p,y:y.y},{x:y.x,y:b+C}):"west"===G?o=i({x:y.x,y:b},{x:p+q,y:b+C}):"east"===G?o=i({x:p,y:b},{x:y.x,y:b+C}):"southwest"===G?o=i({x:y.x,y:b},{x:p+q,y:y.y}):"south"===G?o=i({x:p,y:b},{x:p+q,y:y.y}):"southeast"===G&&(o=i({x:p,y:b},y)),x.setRect(o),o.x-=w.x,o.y-=w.y;var O=Eq(x,o,k,w);x.p(O.x,O.y)},qm=function($,o,w,O,e,k,A,N){var j=g;k?(j=pd(g,e.x-o.x,e.y-o.y,-w),j.x-=A.x,j.y-=A.y):j=pd(g,e.x-o.x,e.y-o.y,0);var M={x:o.x+j.x,y:o.y+j.y};N&&(M=N(M.x,M.y)),M.e=$.getPoints().get(O).e,$.setPoint(O,M);var Q=$.getWidth(),I=$.getHeight(),f=$.p().x-Q/2,C=$.p().y-I/2;f-=o.x,C-=o.y;var x=Eq($,{x:f,y:C,width:Q,height:I},w,o);$.p(x.x,x.y)},rm=function(J,g,E){var f,$;if(J instanceof F?(f=J.getPoints(),$=J.getSegments()):J instanceof X&&"points"===J.s("edge.type")&&(f=J.s("edge.points"),$=J.s("edge.segments"),f=lh(g,f)),$&&$.size()||($=Sf(f)),J instanceof F&&J.isClosePath()&&$.indexOf(5)<0&&($=new t($._as),$.add(5)),$)for(var h=-1,W=0;W<$.size();W++){if(W===E)return h;var y=$.get(W);1===y?h+=1:2===y?h+=1:3===y?h+=2:4===y&&(h+=3)}},Nn=function(R,w,o){var y,M;if(R instanceof F?(y=R.getPoints(),M=R.getSegments()):R instanceof X&&"points"===R.s("edge.type")&&(y=R.s("edge.points"),M=R.s("edge.segments"),y=lh(w,y)),M&&M.size()||(M=Sf(y)),M)for(var Q=-1,Z=0;Z<M.size();Z++){var u=M.get(Z);if(1===u?Q+=1:2===u?Q+=1:3===u?Q+=2:4===u&&(Q+=3),Q===o)return Z}},ar=function(W,s){var i=[W[0]-s[0],W[1]-s[1],W[2]-s[2]];return i},vr=function(){var n=new W(16);return n[0]=1,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=1,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=1,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n},Ph=function(H,T){var t=H[0],N=H[1],n=H[2];return H[0]=T[0]*t+T[4]*N+T[8]*n+T[12],H[1]=T[1]*t+T[5]*N+T[9]*n+T[13],H[2]=T[2]*t+T[6]*N+T[10]*n+T[14],H},Yk=function(E,R){if(R){var $=l(R),r=G(R),p=E[0],H=E[1],i=E[2],k=E[3],s=E[8],f=E[9],v=E[10],y=E[11];E[0]=p*r-s*$,E[1]=H*r-f*$,E[2]=i*r-v*$,E[3]=k*r-y*$,E[8]=p*$+s*r,E[9]=H*$+f*r,E[10]=i*$+v*r,E[11]=k*$+y*r}},bq=function(l,d){for(var R=l.s("grid.row.count"),Q=l.s("grid.column.count"),m=0;R>m;m++)for(var t=0;Q>t;t++){var q=l.getCellRect(m,t);if(p(q,d))return{rowIndex:m,columnIndex:t,rect:q,grid:l}}return null},Go=function(g,t,b,i,j,N){var w={},f=b-g,U=i-t,X=S.sqrt(f*f+U*U),c=f/X,W=U/X,D=(-g+j)*c+(-t+N)*W;return 0>=D?(w.x=g,w.y=t):D>=X?(w.x=b,w.y=i):(w.x=g+D*c,w.y=t+D*W),f=j-w.x,U=N-w.y,w.z=S.sqrt(f*f+U*U),w},Pq=function(z,H){var h,p,C,J,Y,r,R,G,m=z.getPoints(),x=z.getSegments(),o=z.p(),P=z.getRotation();if(!x||!(x.indexOf(3)>0||x.indexOf(4)>0)){for(G=0;G<=m.size()-1;G++)if(G===m.size()-1?(Y=m.get(0),J=m.get(G)):(J=m.get(G),Y=m.get(G+1)),J=pd(o,J.x-o.x,J.y-o.y,P),Y=pd(o,Y.x-o.x,Y.y-o.y,P),r=Go(J.x,J.y,Y.x,Y.y,H.x,H.y),R=r.z,R<(z.s("shape.border.width")||10)){p=J,C=Y,h=G;break}if(h!=g){var b=Go(p.x,p.y,C.x,C.y,H.x,H.y),k=U(p,b);return{attachIndex:h,attachOffset:k}}}},Ke=function(J){for(var o=J._data,z=o.p(),T=o.getRotation(),B=o.getPoints(),k=g,I=[],i=0;i<B.size();i++)k=B.get(i),I.push(pd(z,k.x-z.x,k.y-z.y,T));J._55O.$15l=I};q.setImage("xeditinteractor_parentIcon",Z),q.setImage("xeditinteractor_hostIcon",c),q.setImage("xeditinteractor_edgeIcon",e),q.setImage("xeditinteractor_removeIcon",qh),q.setImage("xeditinteractor_sourceIcon",ss),q.setImage("xeditinteractor_targetIcon",Ye),q.setImage("xeditinteractor_elevationIcon",Pi),q.setImage("xeditinteractor_tallIcon",aq),$._editPointSize=Q?24:9,$._edgeHelpers=["parent","remove","source","target"],$._leftTopHelpers=["parent"],$._rightTopHelpers=["host"],$._leftBottomHelpers=["edge"],$._rightBottomHelpers=["remove"],Cl=Cl.concat(Cl).concat(Cl),k._79o=function(){var f=this,x=f.gv,K=x.getZoom(),y=x._editInteractor,l=Rb.call(f);if(!l)return null;var E=zq(f,!0),I=E[0],c=E[1],m={x:l.x,y:l.y,width:l.width,height:l.height},Y=i(I,c);if(y instanceof D.XEditInteractor){m=_(m,Y);var u=f._55O,A=x.getEditPointSize()/K+2,F=0;u&&u._43O&&(F+=A/2,B(m,F))}return m},k._47O=function(S){var u=this,l=u.gv,r=l._editInteractor;r instanceof D.XEditInteractor||rs.call(u,S)},k.rectIntersects=function(K){var y=this,k=y._data,O=y.gv,A=O.getZoom(),W=y._55O,v=O._editInteractor;if(v instanceof D.XEditInteractor&&O.isEditable(k)&&W&&W._43O&&"points"===k.s("edge.type")){var a=k.s("edge.points"),B=k.s("edge.segments");a=lh(y,a),B&&B.size()||(B=Sf(a)),a=a._as;var F=!1,u=Q?5:1,d=K.x+u,n=K.y+u,R={x:d,y:n};if(v._edge===k&&v._hoverSegmentIndex>=0){var f=O._editInteractor._hoverSegmentIndex,s=B.get(f),X=rm(k,y,f),Y=g;if(X!=g&&X>=0){var Z=a[X],G=O.getSegmentHoverWidth()/A;if(2===s||1===s){var r=a[X+1];Y=Cp(new xo(Z.x,Z.y),new xo(r.x,r.y),new xo(R.x-G,R.y-G),new xo(R.x+2*G,R.y+2*G)),Y.$62l===E&&(F=!0)}else if(3===s){var w=a[X+1],r=a[X+2];Y=Uj(new xo(Z.x,Z.y),new xo(w.x,w.y),new xo(r.x,r.y),new xo(R.x-G,R.y-G),new xo(R.x+2*G,R.y+2*G)),Y.$62l===E&&(F=!0)}else if(4===s){var b=a[X+1],V=a[X+2];r=a[X+3],Y=bs(new xo(Z.x,Z.y),new xo(b.x,b.y),new xo(V.x,V.y),new xo(r.x,r.y),new xo(R.x-G,R.y-G),new xo(R.x+2*G,R.y+2*G)),Y.$62l===E&&(F=!0)}}}if(F)return!0}return g},M._47O=function(s){var Z=this,L=Z.gv,k=L._editInteractor;k instanceof D.XEditInteractor||Vi.call(Z,s)},M.rectIntersects=function(V){var z=this,q=z._data,J=z.gv,U=J.getZoom(),n=z._55O,K=J._editInteractor;if(K instanceof D.XEditInteractor&&J.isEditable(q)&&n&&n._43O){var F=n.$15l,X=!1,y=Q?5:1,r=V.x+y,A=V.y+y,l={x:r,y:A};if(F&&F.length===q.getPoints().size()||(Ke(z),F=n.$15l),K._shape===q&&K._hoverSegmentIndex>=0){var $=q.getSegments();$&&$.size()||($=Sf(F));var o=J._editInteractor._hoverSegmentIndex,i=$.get(o),b=rm(q,z,o),T=g;if(b!=g&&b>=0){var m=F[b],S=J.getSegmentHoverWidth()/U;if(2===i||1===i){var x=F[b+1];T=Cp(new xo(m.x,m.y),new xo(x.x,x.y),new xo(l.x-S,l.y-S),new xo(l.x+2*S,l.y+2*S)),T.$62l===E&&(X=!0)}else if(3===i){var h=F[b+1],x=F[b+2];T=Uj(new xo(m.x,m.y),new xo(h.x,h.y),new xo(x.x,x.y),new xo(l.x-S,l.y-S),new xo(l.x+2*S,l.y+2*S)),T.$62l===E&&(X=!0)}else if(4===i){var f=F[b+1],p=F[b+2];x=F[b+3],T=bs(new xo(m.x,m.y),new xo(f.x,f.y),new xo(p.x,p.y),new xo(x.x,x.y),new xo(l.x-S,l.y-S),new xo(l.x+2*S,l.y+2*S)),T.$62l===E&&(X=!0)}}}if(X)return!0}return g},M._48O=function(){var Q=this,r=Q.gv,M=r._editInteractor;M instanceof D.XEditInteractor?(P._48O.call(Q),Q._55O._43O&&Ke(Q)):rd.call(Q)},M._79o=function(){var o=this,P=o.gv,h=P.getZoom(),e=P._editInteractor,S=Xp.call(o);if(S){var w={x:S.x,y:S.y,width:S.width,height:S.height};if(e instanceof D.XEditInteractor){var X=o._55O,Y=P.getEditPointSize()/h+2,d=0;X&&X._43O&&(d+=Y/2,B(w,d))}return w}},P._47O=function(N){var J=this,U=J.gv,X=U._editInteractor;if(X instanceof D.XEditInteractor);else{var f=J._55O;f&&f._98o&&Vn.call(J,N)}},P.getSelectWidth=function(){var p=this,W=p.gv,c=W._editInteractor,f=p._data;return W.isEditable(f)&&c instanceof D.XEditInteractor?0:qb.call(p)},P._80o=function(c){var P=this,j=P.gv._editInteractor;if(Bb.call(P,c),j&&j._debug){c.save(),c.beginPath(),c.lineWidth=1,c.strokeStyle="green";var y=P._79o();y&&(c.rect(y.x,y.y,y.width,y.height),c.stroke()),c.restore()}},M._80o=function(U){var s=this,X=s.gv._editInteractor;if(js.call(s,U),X&&X._debug){U.save(),U.beginPath(),U.lineWidth=1,U.strokeStyle="green";var l=s._79o();U.rect(l.x,l.y,l.width,l.height),U.stroke(),U.restore()}},P._48O=function(){var Q=this,U=Q.gv,O=Q._data,Z=U._editInteractor,S=Q._55O,L=O.p(),w=O.getRotation();if(Z instanceof D.XEditInteractor){if(S._42O){var F=Tb(L,O.getWidth(),O.getHeight(),w),X=F[0],B=F[1],y=F[2],G=F[3],j=F[4],e=F[5],P=F[6],q=F[7];S.$45l=[X,j,B,e,G,P,y,q]}}else ho.call(Q)},$.getResizeMode=function(){return this.$25l||"normal"},$.setResizeMode=function(A){var g=this.$25l;this.$25l=A,this.fp("resizeMode",g,A)},$.getSnapAngle=function(){return this.$26l||Math.PI/36},$.setSnapAngle=function(G){var B=this.$26l;this.$26l=G,this.fp("snapAngle",B,G)},$.getSnapSpacing=function(){return this.$27l},$.setSnapSpacing=function(z){var I=this.$27l;this.$27l=z,this.fp("snapSpacing",I,z)},$.getPointSnapSpacing=function(){return this._pointSnapSpacing},$.setPointSnapSpacing=function(s){var J=this._pointSnapSpacing;this._pointSnapSpacing=s,this.fp("pointSnapSpacing",J,s)},$.setHelperEditableFunc=function(o){var J=this._helperEditableFunc;this._helperEditableFunc=o,this.fp("helperEditableFunc",J,o)},$.getHelperEditableFunc=function(){return this._helperEditableFunc},$.setLeftTopHelpers=function(c){var a=this._leftTopHelpers;this._leftTopHelpers=c,this.fp("leftTopHelpers",a,c)},$.getLeftTopHelpers=function(){return this._leftTopHelpers},$.setLeftTopHelpersAlign=function(c){var J=this._leftTopHelpersAlign;this._leftTopHelpersAlign=c,this.fp("leftTopHelpersAlign",J,c)},$.getLeftTopHelpersAlign=function(){return this._leftTopHelpersAlign},$.setRightTopHelpers=function(L){var H=this._rightTopHelpers;this._rightTopHelpers=L,this.fp("rightTopHelpers",H,L)},$.getRightTopHelpers=function(){return this._rightTopHelpers},$.setRightTopHelpersAlign=function(Y){var L=this._rightTopHelpersAlign;this._rightTopHelpersAlign=Y,this.fp("rightTopHelpersAlign",L,Y)},$.getRightTopHelpersAlign=function(){return this._rightTopHelpersAlign},$.setLeftBottomHelpers=function(S){var h=this._leftBottomHelpers;this._leftBottomHelpers=S,this.fp("leftBottomHelpers",h,S)},$.getLeftBottomHelpers=function(){return this._leftBottomHelpers},$.setLeftBottomHelpersAlign=function(u){var B=this._leftBottomHelpersAlign;this._leftBottomHelpersAlign=u,this.fp("leftBottomHelpersAlign",B,u)},$.getLeftBottomHelpersAlign=function(){return this._leftBottomHelpersAlign},$.setRightBottomHelpers=function(i){var $=this._rightBottomHelpers;this._rightBottomHelpers=i,this.fp("rightBottomHelpers",$,i)},$.getRightBottomHelpers=function(){return this._rightBottomHelpers},$.setRightBottomHelpersAlign=function(u){var q=this._rightBottomHelpersAlign;this._rightBottomHelpersAlign=u,this.fp("rightBottomHelpersAlign",q,u)},$.getRightBottomHelpersAlign=function(){return this._rightBottomHelpersAlign},$.setEdgeHelpers=function(H){var m=this._edgeHelpers;this._edgeHelpers=H,this.fp("edgeHelpers",m,H)},$.getEdgeHelpers=function(){return this._edgeHelpers},$.isHelperEditable=function(q,l){return q instanceof X&&("host"===l||"edge"===l||"elevation"===l||"tall"===l)?!1:q instanceof v&&("source"===l||"target"===l)?!1:"pointElevation"===l?this._helperEditableFunc?this._helperEditableFunc(q,l):!1:this._helperEditableFunc?this._helperEditableFunc(q,l):!0},$.getEditHelperSize=function(){return this._editHelperSize||(Q?28:16)},$.setEditHelperSize=function(P){var Y=this._editHelperSize;this._editHelperSize=P,this.fp("editHelperSize",Y,P)},$.getEditRectBorderColor=function(){return this.$28l||"rgb(0, 168, 255)"},$.setEditRectBorderColor=function(q){var C=this.$28l;this.$28l=q,this.fp("editRectBorderColor",C,q)},$.getNodeBorderColor=function(){return this.$29l||"#1ABC9C"},$.setNodeBorderColor=function(d){var X=this.$29l;this.$29l=d,this.fp("nodeBorderColor",X,d)},$.getEditRectBorderStyle=function(){return this.$30l||"dashed"},$.setEditRectBorderStyle=function(D){var I=this.$30l;this.$30l=D,this.fp("editRectBorderStyle",I,D)},$.getControlPointBackground=function(){return this.$31l||"#ff0"},$.setControlPointBackground=function(W){var g=this.$31l;this.$31l=W,this.fp("controlPointBackground",g,W)},$.getControlPointBorderColor=function(){return this.$32l||this._editPointBorderColor},$.setControlPointBorderColor=function(X){var e=this.$32l;this.$32l=X,this.fp("controlPointBorderColor",e,X)},$.getJoinPointBackground=function(){return this.$33l||this._editPointBackground},$.setJoinPointBackground=function(R){var O=this.$33l;this.$33l=R,this.fp("joinPointBackground",O,R)},$.getJoinPointBorderColor=function(){return this.$34l||this._editPointBorderColor},$.setJoinPointBorderColor=function(u){var E=this.$34l;this.$34l=u,this.fp("joinPointBorderColor",E,u)},$.getDirectionLineColor=function(){return this.$35l||"#888"},$.setDirectionLineColor=function(P){var p=this.$35l;this.$35l=P,this.fp("directionLineColor",p,P)},$.getSegmentHoverColor=function(){return this.$36l||"rgba(255, 0, 0, 0.3)"},$.setSegmentHoverColor=function(U){var O=this.$36l;this.$36l=U,this.fp("segmentHoverColor",O,U)},$.getSegmentHoverWidth=function(){return this.$22l||(Q?16:8)},$.setSegmentHoverWidth=function(v){var p=this.$22l;this.$22l=v,this.fp("segmentHoverWidth",p,v)},$.getSnapPointBorderColor=function(){return this.$38l||"#f00"},$.setSnapPointBorderColor=function(P){var A=this.$38l;this.$38l=P,this.fp("snapPointBorderColor",A,P)},$.getEditRectPadding=function(){return this.$39l!=g?this.$39l:6},$.setEditRectPadding=function(W){var x=this.$39l;this.$39l=W,this.fp("editRectPading",x,W)},$.isRectEditable=function(A){var w=this,L=w._editInteractor;return L instanceof D.XEditInteractor?w._rectEditableFunc?w._rectEditableFunc(A):!0:td.call(w,A)},$.isPointEditable=function(v){var x=this,M=x._editInteractor;return M instanceof D.XEditInteractor?x._pointEditableFunc?x._pointEditableFunc(v):!0:xi.call(x,v)},$.validateImpl=function(){var K=this,O=K.$14l,Y=K._editInteractor;if(O){var l=K.getWidth(),s=K.getHeight();(l!==O.clientWidth||s!==O.clientHeight)&&(Y&&(Y._68I=1),H.setCanvas(O,l,s),K._32I=1)}rg.call(this)},$.isEditable=function($){var S=ul.call(this,$),H=this._editInteractor;if(H instanceof D.XEditInteractor&&$ instanceof X){if(!$.s("2d.editable"))return!1;var r=this.getEditableFunc();S=r?r($):!0}return S},$._42=function(A,L){var Q=this,Z=Q._editInteractor;Ml.call(Q,A,L),Z instanceof D.XEditInteractor&&Z._68I&&Z._42()},$.isSnapPoint=function(){return!0};var bn=function(C){arguments.length>0&&this.$58l(C)},Vq=bn.prototype;Vq.$58l=function(v){this.$62l=v,this.points=new Array},Vq.$56l=function(j){this.points.push(j)},Vq.$57l=function(Y){this.points=this.points.concat(Y)};var xo=function(v,J){arguments.length>0&&this.$58l(v,J)},oq=xo.prototype;oq.$58l=function(k,T){this.x=k,this.y=T},oq.add=function(f){return new xo(this.x+f.x,this.y+f.y)},oq.addEquals=function(o){return this.x+=o.x,this.y+=o.y,this},oq.$55l=function(g){return new xo(this.x*g,this.y*g)},oq.eq=function(b){return this.x==b.x&&this.y==b.y},oq.lt=function(C){return this.x<C.x&&this.y<C.y},oq.lte=function(v){return this.x<=v.x&&this.y<=v.y},oq.gt=function(B){return this.x>B.x&&this.y>B.y},oq.gte=function(F){return this.x>=F.x&&this.y>=F.y},oq.lerp=function(X,f){return new xo(this.x+(X.x-this.x)*f,this.y+(X.y-this.y)*f)},oq.distanceFrom=function(V){var c=this.x-V.x,h=this.y-V.y;return a(c*c+h*h)},oq.min=function(G){return new xo(A(this.x,G.x),A(this.y,G.y))},oq.max=function(U){return new xo(y(this.x,U.x),y(this.y,U.y))},oq.toString=function(){return this.x+","+this.y};var Lp=function(){this.$58l(arguments)},Ig=Lp.prototype;Lp.TO=1e-6,Lp.AC=6,Ig.$58l=function(b){this.co=new Array;for(var h=b.length-1;h>=0;h--)this.co.push(b[h])},Ig.$55l=function(d){for(var F=new Lp,Q=0;Q<=this.$50l()+d.$50l();Q++)F.co.push(0);for(var Q=0;Q<=this.$50l();Q++)for(var p=0;p<=d.$50l();p++)F.co[Q+p]+=this.co[Q]*d.co[p];return F},Ig.$59l=function(){for(var y=this.$50l();y>=0&&I(this.co[y])<=Lp.TO;y--)this.co.pop()},Ig.$50l=function(){return this.co.length-1},Ig.$51l=function(){var B;switch(this.$59l(),this.$50l()){case 0:B=new Array;break;case 1:B=this.$52l();break;case 2:B=this.$53l();break;case 3:B=this.$54l();break;case 4:B=this.$63l();break;default:B=new Array}return B},Ig.$52l=function(){var W=new Array,i=this.co[1];return 0!=i&&W.push(-this.co[0]/i),W},Ig.$53l=function(){var R=new Array;if(2==this.$50l()){var N=this.co[2],M=this.co[1]/N,m=this.co[0]/N,l=M*M-4*m;if(l>0){var G=a(l);R.push(.5*(-M+G)),R.push(.5*(-M-G))}else 0==l&&R.push(.5*-M)}return R},Ig.$63l=function(){var w=new Array;if(4==this.$50l()){var K=this.co[4],c=this.co[3]/K,L=this.co[2]/K,S=this.co[1]/K,e=this.co[0]/K,F=new Lp(1,-L,c*S-4*e,-c*c*e+4*L*e-S*S).$54l(),t=F[0],d=c*c/4-L+t;if(I(d)<=Lp.TO&&(d=0),d>0){var o=a(d),R=3*c*c/4-o*o-2*L,X=(4*c*L-8*S-c*c*c)/(4*o),E=R+X,Q=R-X;if(I(E)<=Lp.TO&&(E=0),I(Q)<=Lp.TO&&(Q=0),E>=0){var O=a(E);w.push(-c/4+(o+O)/2),w.push(-c/4+(o-O)/2)}if(Q>=0){var O=a(Q);w.push(-c/4+(O-o)/2),w.push(-c/4-(O+o)/2)}}else if(0>d);else{var X=t*t-4*e;if(X>=-Lp.TO){if(0>X&&(X=0),X=2*a(X),R=3*c*c/4-2*L,R+X>=Lp.TO){var b=a(R+X);w.push(-c/4+b/2),w.push(-c/4-b/2)}if(R-X>=Lp.TO){var b=a(R-X);w.push(-c/4+b/2),w.push(-c/4-b/2)}}}}return w},Ig.$54l=function(){var J=new Array;if(3==this.$50l()){var P=this.co[3],g=this.co[2]/P,E=this.co[1]/P,c=this.co[0]/P,p=(3*E-g*g)/3,q=(2*g*g*g-9*E*g+27*c)/27,B=g/3,A=q*q/4+p*p*p/27,u=q/2;if(I(A)<=Lp.TO&&(A=0),A>0){var O,K,L=a(A);O=-u+L,K=O>=0?f(O,1/3):-f(-O,1/3),O=-u-L,O>=0?K+=f(O,1/3):K-=f(-O,1/3),J.push(K-B)}else if(0>A){var C=a(-p/3),n=b(a(-A),-u)/3,i=G(n),T=l(n),h=a(3);J.push(2*C*i-B),J.push(-C*(i+h*T)-B),J.push(-C*(i-h*T)-B)}else{var O;O=u>=0?-f(u,1/3):f(-u,1/3),J.push(2*O-B),J.push(-O-B)}}return J};var fh=function(Y,S){arguments.length>0&&this.$58l(Y,S)},cs=fh.prototype;cs.$58l=function(k,D){this.x=k,this.y=D},cs.length=function(){return a(this.x*this.x+this.y*this.y)},cs.$60l=function(b){return this.x*b.x+this.y*b.y};var Zc=function(w,p,J,M){var C,f=(M.x-J.x)*(w.y-J.y)-(M.y-J.y)*(w.x-J.x),U=(p.x-w.x)*(w.y-J.y)-(p.y-w.y)*(w.x-J.x),B=(M.y-J.y)*(p.x-w.x)-(M.x-J.x)*(p.y-w.y);if(0!=B){var j=f/B,q=U/B;j>=0&&1>=j&&q>=0&&1>=q?(C=new bn(E),C.points.push(new xo(w.x+j*(p.x-w.x),w.y+j*(p.y-w.y)))):C=new bn(m)}else C=0==f||0==U?new bn("C"):new bn("P");return C},sq=function(z,r,_,H,Y){var T,t,Q,U,x,q,d,p=H.min(Y),Z=H.max(Y),G=new bn(m);T=r.$55l(-2),Q=z.add(T.add(_)),T=z.$55l(-2),t=r.$55l(2),U=T.add(t),x=new xo(z.x,z.y),d=new fh(H.y-Y.y,Y.x-H.x),q=H.x*Y.y-Y.x*H.y;for(var W=new Lp(d.$60l(Q),d.$60l(U),d.$60l(x)+q).$51l(),u=0;u<W.length;u++){var g=W[u];if(g>=0&&1>=g){var D=z.lerp(r,g),C=r.lerp(_,g),b=D.lerp(C,g);H.x==Y.x?p.y<=b.y&&b.y<=Z.y&&(G.$62l=E,G.$56l(b)):H.y==Y.y?p.x<=b.x&&b.x<=Z.x&&(G.$62l=E,G.$56l(b)):b.gte(p)&&b.lte(Z)&&(G.$62l=E,G.$56l(b))}}return G},Uj=function(Q,A,i,M,_){var C=M.min(_),l=M.max(_),h=new xo(l.x,C.y),G=new xo(C.x,l.y),I=sq(Q,A,i,C,h),V=sq(Q,A,i,h,l),g=sq(Q,A,i,l,G),x=sq(Q,A,i,G,C),j=new bn(m);return j.$57l(I.points),j.$57l(V.points),j.$57l(g.points),j.$57l(x.points),j.points.length>0&&(j.$62l=E),j},Qd=function(z,V,a,n,$,Y){var _,J,N,G,w,M,I,q,B,R,g=$.min(Y),v=$.max(Y),D=new bn(m);_=z.$55l(-1),J=V.$55l(3),N=a.$55l(-3),G=_.add(J.add(N.add(n))),w=new fh(G.x,G.y),_=z.$55l(3),J=V.$55l(-6),N=a.$55l(3),G=_.add(J.add(N)),M=new fh(G.x,G.y),_=z.$55l(-3),J=V.$55l(3),N=_.add(J),I=new fh(N.x,N.y),q=new fh(z.x,z.y),R=new fh($.y-Y.y,Y.x-$.x),B=$.x*Y.y-Y.x*$.y;for(var d=new Lp(R.$60l(w),R.$60l(M),R.$60l(I),R.$60l(q)+B).$51l(),S=0;S<d.length;S++){var Q=d[S];if(Q>=0&&1>=Q){var f=z.lerp(V,Q),X=V.lerp(a,Q),u=a.lerp(n,Q),k=f.lerp(X,Q),F=X.lerp(u,Q),p=k.lerp(F,Q);$.x==Y.x?g.y<=p.y&&p.y<=v.y&&(D.$62l=E,D.$56l(p)):$.y==Y.y?g.x<=p.x&&p.x<=v.x&&(D.$62l=E,D.$56l(p)):p.gte(g)&&p.lte(v)&&(D.$62l=E,D.$56l(p))}}return D},bs=function(x,F,s,K,g,B){var d=g.min(B),f=g.max(B),G=new xo(f.x,d.y),p=new xo(d.x,f.y),k=Qd(x,F,s,K,d,G),w=Qd(x,F,s,K,G,f),r=Qd(x,F,s,K,f,p),M=Qd(x,F,s,K,p,d),N=new bn(m);return N.$57l(k.points),N.$57l(w.points),N.$57l(r.points),N.$57l(M.points),N.points.length>0&&(N.$62l=E),N},Cp=function(O,F,U,L){var P=U.min(L),W=U.max(L),f=new xo(W.x,P.y),w=new xo(P.x,W.y),A=Zc(P,f,O,F),i=Zc(f,W,O,F),a=Zc(W,w,O,F),y=Zc(w,P,O,F),D=new bn(m);return D.$57l(A.points),D.$57l(i.points),D.$57l(a.points),D.$57l(y.points),D.points.length>0&&(D.$62l=E),D},qr=D.XEditInteractor=function(B){var L=this,_=L._view=document.createElement("canvas");_.className="editCanvas",_.style.position="absolute",qr.superClass.constructor.call(L,B)};q.def(qr,D.Interactor,{ms_edit:1,setUp:function(){var P=this,o=P.gv,W=o.getView(),e=P._view;qr.superClass.setUp.call(P),o.setEditInteractor(P),o.$14l=e,o._79O?W.insertBefore(e,o._79O):W.appendChild(e);var E=P.$49l=P.$11l.bind(P);o.dm().md(E),o.sm().ms(E),o.mp(E)},tearDown:function(){var $=this,N=$.gv,b=N.getView(),W=$.$49l;qr.superClass.tearDown.call($),N.setEditInteractor(g),N.$14l=g,b.removeChild($._view),N.dm().umd(W),N.sm().ums(W),N.ump(W)},clear:function(){var C=this,i=C.gv;delete C._hoverSegmentIndex,delete C._edge,delete C._shape,delete i._editing,delete C.$10l,delete C.$13l,delete C.$9l,delete C._removePointIndex,delete C._lp,C.$12l="",delete C.$40l,delete C.$67l,delete C.$72l,delete C.$73l,delete C.$75l,delete C.$1l,delete C.$3l,delete C.$2l,delete C.$92l,delete C.$93l,delete C.$94l,C.clearDragging()},handle_keydown:function(s){this.$48l!==s.shiftKey&&(this.$48l=s.shiftKey,this.handle_mousemove(s,O,!0))},handle_keyup:function(k){this.$48l!==k.shiftKey&&(this.$48l=k.shiftKey,this.handle_mousemove(k,O,!0))},handle_touchstart:function(N){this.handle_mousemove(N),this.handle_mousedown(N)},handle_mousedown:function(o){J(o);var Q=this,G=Q.$13l,F=Q.gv,m=F.dm(),k=F.sm(),y=F.getZoom(),g=F.lp(o),A=q.isDoubleClick(o),d=q.isLeftButton(o),b=Q.$7l,$=Q._shape,M=Q._hoverSegmentIndex,O=Q._edge,W=Q.$87l,I=Q.$88l,P=function(){Q._68I||W===Q.$87l&&I===Q.$88l||Q.$43l()};if(7!==Q.$67l&&(delete Q.$87l,delete Q.$88l),d&&($||O)&&M>=0&&A&&($&&k.contains($)||O&&k.contains(O))){var s=_j.call(Q,$||O,M,g);return Q.addShapePoint($||O,M,s),T(function(){Q.handle_mousemove(o)},40),void 0}if(d&&($||O)&&Q._removePointIndex>=0&&A)return Q.removeShapePoint(),Q.$5l=1,T(function(){Q.handle_mousemove(o)},40),void 0;if(!d||!F._editing)return P(),void 0;if($&&G>=0){var x=$.getPoints().get(G),K=$.p(),S=pd(K,x.x-K.x,x.y-K.y,-b+$.getRotation());p=pd(K,g.x-K.x,g.y-K.y,-b),Q.$24l={x:p.x-S.x,y:p.y-S.y},Q.startDragging(o),m.beginTransaction(),Q.fi({kind:"beginEditPoint",event:o,data:$,index:G}),Q.$88l=G,Q.$87l=$}else if(Q.$10l){var w=F.sm().getSelection(),V=Q.$6l,E=Q.$1l={},h=Q.$3l={},D=Q.$16l[n[Q.$10l]],e={x:V.x,y:V.y},r={x:V.x+V.width/2,y:V.y+V.height/2};Q.$24l={x:g.x-D.x/y,y:g.y-D.y/y},Q.$2l=C(Q.$8l),Q.$4l=C(V),w.each(function(T){if(T instanceof v){var s=T.p(),D=T.getWidth(),F=T.getHeight(),u=pd(r,s.x-r.x,s.y-r.y,-b);E[T.getId()]={x:s.x-D/2,y:s.y-F/2,width:D,height:F},h[T.getId()]={x:(u.x-e.x)/V.width,y:(u.y-e.y)/V.height}}}),Q.startDragging(o),m.beginTransaction(),Q.fi({kind:"beginEditRect",event:o,direction:Q.$10l})}else if(O&&G>=0){var X=lh(F.getDataUI(O),O.s("edge.points")),x=X.get(G);Q.$24l={x:g.x-x.x,y:g.y-x.y},Q.startDragging(o),m.beginTransaction(),Q.fi({kind:"beginEditPoint",event:o,data:O,index:G}),Q.$88l=G,Q.$87l=O}else if(Q.$40l){var V=Q.$6l,r={x:V.x+V.width/2,y:V.y+V.height/2},H=C(Q.$23l);H.x/=y,H.y/=y;var j=pd(r,H.x-r.x,H.y-r.y,-b),p=pd(r,g.x-r.x,g.y-r.y,-b);Q.$24l={x:p.x-j.x,y:p.y-j.y},Q.startDragging(o),m.beginTransaction(),Q.fi({kind:"beginEditRotation",event:o,data:Q._rotationNode})}else if([1,2,3,5,6,7,8,9].indexOf(Q.$67l)>=0){var Z=Q.$67l;(7===Z||8===Z||9===Z)&&m.beginTransaction(),Q.startDragging(o)}else if(Q.$71l&&A&&Q.$79l(Q.$71l,g)){var L=k.toSelection();m.beginTransaction(),L.each(function(x){m.remove(x)}),m.endTransaction()}P()},$11l:function(){var C=this,A=C.gv;A._editing&&(C.$13l==g||C._shape==g&&C._edge==g)&&(C.$73l==g||1!==C.$67l&&5!==C.$67l&&6!==C.$67l)||(C.$5l=1),C._68I=1},$46l:function(v){var h=this,i=h.gv,t=i.lp(v),O=[];return Zi(i,function(e){var r=i.getDataUI(e);if(r){var d=r._79o();p(d,t)&&O.push(e)}}),O},$47l:function(U){var d=this,l=d.$13l,r=d.gv.dm();d.$10l?(d.fi({kind:"endEditRect",event:U,direction:d.$10l}),r.endTransaction()):d._shape&&l>=0?(d.fi({kind:"endEditPoint",event:U,data:d._shape,index:l}),r.endTransaction()):d._edge&&l>=0?(d.fi({kind:"endEditPoint",event:U,data:d._edge,index:l}),r.endTransaction()):d.$23l&&d.$40l&&(d.fi({kind:"endEditRotation",event:U}),r.endTransaction())},handleWindowTouchEnd:function(q){this.handleWindowMouseUp(q)},handleWindowMouseUp:function(z){var q=this,w=q.gv,F=w.dm(),d=q._shape,m=q._edge,M=q.$13l,n=q.$40l,J=q.$9l,B=q.$10l,I=q.$67l;if((d||m)&&M>=0&&J>=0){var k,K;if(d){var a=d.p(),H=d.getRotation();k=d.getPoints(),K=k.get(J),qm(d,a,H,M,K,!1)}else if(k=lh(w.getDataUI(m),m.s("edge.points"),!0),K=k.get(J),0===M){var U=k.get(0);m.s("edge.source.offset.x",K.x-U.x),m.s("edge.source.offset.y",K.y-U.y)}else if(M===k.size()-1){var T=k.get(k.size()-1);m.s("edge.target.offset.x",K.x-T.x),m.s("edge.target.offset.y",K.y-T.y)}else"points"===m.s("edge.type")&&(k.set(M,K),m.s("edge.points",Qc(k)))}q.$47l(z);var W=q.$73l;1===I?(F.beginTransaction(),W?w.sm().each(function(M){if(M.setHost&&w.isHelperEditable(M,"host")){M.setHost(W);
var I=q.$75l,R=q.$74l;I&&(M.s("attach.row.index",I.rowIndex),M.s("attach.column.index",I.columnIndex)),R&&(M.s("attach.index",R.attachIndex),M.s("attach.offset",R.attachOffset),M.s("attach.offset.relative",!1),M.s("attach.offset.opposite",!1))}}):w.sm().each(function(S){S.setHost&&w.isHelperEditable(S,"host")&&(S.setHost(g),S.s("attach.row.index",O),S.s("attach.column.index",O),S.s("attach.index",O),S.s("attach.offset",O),S.s("attach.offset.relative",!1),S.s("attach.offset.opposite",!1))}),F.endTransaction()):2===I?(F.beginTransaction(),W?w.sm().each(function(B){B.setParent&&w.isHelperEditable(B,"parent")&&B.setParent(W)}):w.sm().each(function(Y){Y.setParent&&w.isHelperEditable(Y,"parent")&&Y.setParent(g)}),F.endTransaction()):3===I?W&&(F.beginTransaction(),w.sm().each(function(S){if(w.isHelperEditable(S,"edge")&&S instanceof v&&W instanceof v){var d=new u.Edge;F.add(d),d.setSource(S),d.setTarget(W),q.onEdgeCreated&&q.onEdgeCreated(z,d)}}),F.endTransaction()):5===I||6===I?W&&(F.beginTransaction(),w.sm().each(function(x){x instanceof X&&W instanceof v&&(5===I&&w.isHelperEditable(x,"source")?x.setSource(W):6===I&&w.isHelperEditable(x,"source")&&x.setTarget(W))}),F.endTransaction()):(7===I||8===I||9===I)&&F.endTransaction(),(B||n)&&q.$43l(!0),Q?(q.clear(),delete q.$64l,q._68I||q.$43l()):(q.handle_mousemove(z,!0),I&&!q._68I&&q.$43l())},handleWindowTouchMove:function(Z){this.handleWindowMouseMove(Z)},handleWindowMouseMove:function(j){this._78I(j)},handle_mousemove:function(e,y,O){if(!this._pause){if(!O){var l=Q?ed(e):e;this.$61l={clientX:l.clientX,clientY:l.clientY}}if(y===!0||!R()){var U=this,W=U.gv,d=!1,s=g;U.clear(),W.sm().size()>0&&(s=W.lp(O?U.$61l:e),d=U._79I(e,s)),d&&(W._editing=1),U.$12l!==U.$65l&&(U.$65l=U.$12l,U.setCursor(U.$12l)),U.$40l!==U.$64l&&(U.$64l=U.$40l,U._68I||U.$43l()),U._hoverSegmentIndex!==U.$66l&&(U.$66l=U._hoverSegmentIndex,U._68I||U.$43l())}}},_78I:function(V){this.autoScroll(V);var n=this,y=n.gv,E=y.lp(V),W=y.getZoom(),Z=n.$13l;if((n._shape||n._edge)&&Z>=0){var Q,k,u,t=n._shape,P=n._edge,A=n.$24l,S=y.getPointSnapSpacing(),w=function(F,T){return S==g||isNaN(S)?{x:F,y:T}:{x:L(F/S)*S,y:L(T/S)*S}};if(t){Q=t.getPoints();var J=t.p(),l=t.getRotation(),M=0;k=pd(J,E.x-J.x,E.y-J.y,-l),qm(t,J,l,Z,E,!0,A,w),n.fi({kind:"betweenEditPoint",event:V,data:t,index:Z})}else if(P){Q=lh(y.getDataUI(P),P.s("edge.points"),!0),E.x-=A.x,E.y-=A.y,k=E;var r,B,R=P.s("edge.offset"),O=Q.size(),s=O>2;if(0===Z){var C=Q.get(0);R&&(C=Cd(C,Q.get(1),-R,s),E=Cd(E,Q.get(1),-R,s)),r=E.x-C.x,B=E.y-C.y,u=w(r,B),P.s("edge.source.offset.x",u.x),P.s("edge.source.offset.y",u.y)}else if(Z===O-1){var c=Q.get(O-1);R&&(c=Cd(c,Q.get(O-2),-R,s),E=Cd(E,Q.get(O-2),-R,s)),r=E.x-c.x,B=E.y-c.y,u=w(r,B),P.s("edge.target.offset.x",u.x),P.s("edge.target.offset.y",u.y)}else"points"===P.s("edge.type")&&(u=w(E.x,E.y),u.e=Q.get(Z).e,Q.set(Z,u),P.s("edge.points",Qc(Q)));n.fi({kind:"betweenEditPoint",event:V,data:P,index:Z})}if(delete n.$9l,y.isSnapPoint(t)||y.isSnapPoint(P))for(M=0;M<Q.size();M++)if(M!==Z){var H=Q.get(M);if(U(H,k)<y.getEditPointSize()/W){n.$9l=M;break}}}else if(n.$10l){var A=n.$24l;E.x-=A.x,E.y-=A.y;var j=y.sm().getSelection(),D=n.$1l,m=n.$7l,$=n.$10l,e=n.$4l,i=n.$2l,d=y.getEditRectPadding()/W,N=2*d,h=y.getSnapSpacing(),K=h!=g&&!isNaN(h),f=xm(i,E,$,m,2*d,y.getResizeMode(),K,!0),G=n.$6l;if(K){var _=f.width-N,p=f.height-N,z=L(_/h)*h,dm=L(p/h)*h,Gj=z-_,Yj=dm-p;("west"===$||"northwest"===$||"southwest"===$)&&(Gj=-Gj),("north"===$||"northwest"===$||"northeast"===$)&&(Yj=-Yj),f=xm(i,E,$,m,2*d,y.getResizeMode(),K,!1,Gj,Yj)}n.$8l=f,G.x=f.x+d,G.y=f.y+d,G.width=f.width-N,G.height=f.height-N;var Km=f.x+f.width/2,Vf=f.y+f.height/2,Bo=G.x,of=G.y,Pi=G.width/e.width,Sh=G.height/e.height;j.each(function(F){if(F instanceof v&&y.isEditable(F)&&y.isRectEditable(F)){var R=D[F.getId()],A=n.$3l[F.getId()],M={x:R.x+R.width/2,y:R.y+R.height/2},r=0,C=0,f=$,Z=180*I(m-F.getRotation())/o;"northeast"===$?Z>=315||45>Z?(r=R.width*Pi+R.x,C=R.height*(1-Sh)+R.y,f="northeast"):Z>=45&&135>Z?(r=R.width*(1-Sh)+R.x,C=R.height*(1-Pi)+R.y,f="northwest"):Z>=135&&225>Z?(r=R.width*(1-Pi)+R.x,C=R.height*Sh+R.y,f="southwest"):(r=R.width*Sh+R.x,C=R.height*Pi+R.y,f="southeast"):"north"===$?Z>=315||45>Z?(C=R.height*(1-Sh)+R.y,f="north"):Z>=45&&135>Z?(r=R.width*(1-Sh)+R.x,f="west"):Z>=135&&225>Z?(C=R.height*Sh+R.y,f="south"):(r=R.width*Sh+R.x,f="east"):"northwest"===$?Z>=315||45>Z?(r=R.width*(1-Pi)+R.x,C=R.height*(1-Sh)+R.y,f="northwest"):Z>=45&&135>Z?(r=R.width*(1-Sh)+R.x,C=R.height*Pi+R.y,f="southwest"):Z>=135&&225>Z?(r=R.width*Pi+R.x,C=R.height*Sh+R.y,f="southeast"):(r=R.width*Sh+R.x,C=R.height*(1-Pi)+R.y,f="northeast"):"west"===$?Z>=315||45>Z?(r=R.width*(1-Pi)+R.x,f="west"):Z>=45&&135>Z?(C=R.height*Pi+R.y,f="south"):Z>=135&&225>Z?(r=R.width*Pi+R.x,f="east"):(C=R.height*(1-Pi)+R.y,f="north"):"southwest"===$?Z>=315||45>Z?(r=R.width*(1-Pi)+R.x,C=R.height*Sh+R.y,f="southwest"):Z>=45&&135>Z?(r=R.width*Sh+R.x,C=R.height*Pi+R.y,f="southeast"):Z>=135&&225>Z?(r=R.width*Pi+R.x,C=R.height*(1-Sh)+R.y,f="northeast"):(r=R.width*(1-Sh)+R.x,C=R.height*(1-Pi)+R.y,f="northwest"):"east"===$?Z>=315||45>Z?(r=R.width*Pi+R.x,f="east"):Z>=45&&135>Z?(C=R.height*(1-Pi)+R.y,f="north"):Z>=135&&225>Z?(r=R.width*(1-Pi)+R.x,f="west"):(C=R.height*Pi+R.y,f="south"):"south"===$?Z>=315||45>Z?(C=R.height*Sh+R.y,f="south"):Z>=45&&135>Z?(r=R.width*Sh+R.x,f="east"):Z>=135&&225>Z?(C=R.height*(1-Sh)+R.y,f="north"):(r=R.width*(1-Sh)+R.x,f="west"):"southeast"===$&&(Z>=315||45>Z?(r=R.width*Pi+R.x,C=R.height*Sh+R.y,f="southeast"):Z>=45&&135>Z?(r=R.width*Sh+R.x,C=R.height*(1-Pi)+R.y,f="northeast"):Z>=135&&225>Z?(r=R.width*(1-Pi)+R.x,C=R.height*(1-Sh)+R.y,f="northwest"):(r=R.width*(1-Sh)+R.x,C=R.height*Pi+R.y,f="southwest"));var Y=pd(M,r-M.x,C-M.y,F.getRotation());hc(F,R,f,{x:Y.x,y:Y.y});var q=Bo+G.width*A.x,j=of+G.height*A.y,P={x:q,y:j};P=pd({x:Km,y:Vf},P.x-Km,P.y-Vf,m),F.p(P.x,P.y)}}),n.fi({kind:"betweenEditRect",event:V,direction:$})}else if(n.$23l&&n.$40l){var Xg=n.$8l,$i=Xg.width,ds=Xg.height,J={x:Xg.x+$i/2,y:Xg.y+ds/2},A=n.$24l,ff=n.$23l,vn=ff.x/W-J.x,On=ff.y/W-J.y,Jl=a(vn*vn+On*On),fi=Math.asin(A.x/Jl),Nd=y.sm().getSelection(),Ae=x+b(E.y-J.y,E.x-J.x)-fi,dh=y.getSnapAngle(),Ae=L(Ae/dh)*dh;0>Ae&&(Ae+=Y);var jq=Ae-n.$7l,af=[J.x,0,J.y];Nd.each(function($){if(y.isEditable($)&&y.isRotationEditable($)&&y.isVisible($)){var B=ar($.p3(),af),F=vr();Yk(F,-jq),$.setRotation($.getRotation()+jq),Ph(B,F),$.p3(af[0]+B[0],af[1]+B[1],af[2]+B[2])}}),n.$7l=Ae,n.fi({kind:"betweenEditRotation",event:V})}else if([1,2,3,5,6].indexOf(n.$67l)>=0)n.$72l=V,n.$78l||(n.$78l=1,T(function(){q.isDragging()&&n.$43l(),delete n.$78l},12));else if(7===n.$67l){if(n.$87l instanceof F){var t=n.$87l,$k=n.$88l,gq=q.clone(t.getPoints().get($k)),qh=E.y-gq.y;gq.e||(gq.e=0),n.$92l||(n.$92l=gq.e),gq.e=n.$92l-qh,t.setPoint($k,gq)}else if(n.$87l instanceof X){var P=n.$87l,$k=n.$88l,Q=lh(y.getDataUI(P),P.s("edge.points")),gq=Q.get($k),qh=E.y-gq.y;gq.e||(gq.e=0),n.$92l||(n.$92l=gq.e),gq.e=n.$92l-qh,Q.set($k,gq),P.s("edge.points",Qc(Q))}}else if(8===n.$67l){var Nd=y.sm().getSelection(),yh=n.$93l;yh||(yh=n.$93l={}),Nd.each(function(J){if(J.p3){var b=J.p3(),B=yh[J.getId()];B==g&&(B=yh[J.getId()]=b[1]),J.p3([b[0],B-(E.y-n.$90l.y/W),b[2]])}})}else if(9===n.$67l){var Nd=y.sm().getSelection(),so=n.$94l;so||(so=n.$94l={}),Nd.each(function(U){if(U.s3){var i=U.s3(),P=so[U.getId()];P==g&&(P=so[U.getId()]=i[1]);var u=P-(E.y-n.$91l.y/W);0>u&&(u=.01),U.s3([i[0],u,i[2]])}})}},$79l:function(i,X){var K=this,f=K.gv,I=f.getZoom(),D=f.getEditHelperSize(),r=i.x/I,U=i.y/I,R=D/I,q=R/2;return p({x:r-q,y:U-q,width:R,height:R},X)?!0:void 0},getHelperCursor:function(){return"crosshair"},_79I:function(x,S){for(var c=this,n=c.gv,I=n.getZoom(),Y=n.getEditPointSize(),B=Y/I,C=B/2,D=c.$46l(x),f=0;f<D.length;f++){var i,h,W=D[f],r=n.getDataUI(W);if(r&&r._55O){var L=r._55O;if(L._43O&&W instanceof X){if(i=W.s("edge.points"),i=lh(r,i),h=W.s("edge.segments"),h&&h.size()||(h=Sf(i)),c.$42l(W,S,i._as,h,"edge"))return!0;if("points"===W.s("edge.type"))return c.$41l(W,S,i._as,h,"edge"),void 0}if(L._43O&&W instanceof F&&L.$15l&&L.$15l.length===W.getPoints().size()){if(i=L.$15l,h=W.getSegments(),h&&h.size()||(h=Sf(i)),c.$42l(W,S,i,h,"shape"))return!0;if(c.$41l(W,S,i,h,"shape"))return}}}if(c.$16l){var i,O=c.$16l,E=O[3].x-O[7].x,_=O[3].y-O[7].y,Z=a(E*E+_*_),d=O[1].x-O[5].x,u=O[1].y-O[5].y,Q=a(d*d+u*u),e={x:S.x*I,y:S.y*I};if(c._80I(e,0,O[0],"northwest",Z,Q)||c._80I(e,1,O[1],"north",Z,Q)||c._80I(e,2,O[2],"northeast",Z,Q)||c._80I(e,7,O[7],"west",Z,Q)||c._80I(e,3,O[3],"east",Z,Q)||c._80I(e,6,O[6],"southwest",Z,Q)||c._80I(e,5,O[5],"south",Z,Q)||c._80I(e,4,O[4],"southeast",Z,Q))return!0}if(c.$23l){var U=c.$23l,G=U.x/I,w=U.y/I;if(p({x:G-C,y:w-C,width:B,height:B},S))return c.$40l=1,c.$12l=c.getHelperCursor("rotation")||"crosshair",!0}return c.$68l&&c.$79l(c.$68l,S)?(c.$67l=1,c.$12l=c.getHelperCursor("host")||"crosshair",!0):c.$69l&&c.$79l(c.$69l,S)?(c.$67l=2,c.$12l=c.getHelperCursor("parent")||"crosshair",!0):c.$70l&&c.$79l(c.$70l,S)?(c.$67l=3,c.$12l=c.getHelperCursor("edge")||"crosshair",!0):c.$71l&&c.$79l(c.$71l,S)?(c.$67l=4,c.$12l=c.getHelperCursor("remove")||"crosshair",!0):c.$82l&&c.$79l(c.$82l,S)?(c.$67l=5,c.$12l=c.getHelperCursor("source")||"crosshair",!0):c.$83l&&c.$79l(c.$83l,S)?(c.$67l=6,c.$12l=c.getHelperCursor("target")||"crosshair",!0):c._pointElevationHelperPoint&&c.$79l(c._pointElevationHelperPoint,S)?(c.$67l=7,c.$12l=c.getHelperCursor("pointElevation")||"crosshair",!0):c.$90l&&c.$79l(c.$90l,S)?(c.$67l=8,c.$12l=c.getHelperCursor("elevation")||"crosshair",!0):c.$91l&&c.$79l(c.$91l,S)?(c.$67l=9,c.$12l=c.getHelperCursor("tall")||"crosshair",!0):!1},_80I:function(F,t,l,H,R,Q){var g=this,N=g.gv,A=N.getEditPointSize(),C=A/2,$=N.sm(),u=N.isDirectionEditable;if(u&&1===$.size()){var n=$.ld();if(u=u.bind(N),n instanceof v){if(!u(n,H))return!1;if("east"===H){if(u(n,"northeast")&&u(n,"southeast")&&2*A>=Q)return!1}else if("west"===H){if(u(n,"northwest")&&u(n,"southwest")&&2*A>=Q)return!1}else if("north"===H){if(u(n,"northwest")&&u(n,"northeast")&&2*A>=R)return!1}else if("south"===H&&u(n,"southwest")&&u(n,"southeast")&&2*A>=R)return!1}}else{if(2*A>=R&&("north"===H||"south"===H))return!1;if(2*A>=Q&&("east"===H||"west"===H))return!1}if(p({x:l.x-C,y:l.y-C,width:A,height:A},F)){if(g.$10l!==H){var w=180*g.$7l/o,e="";w>=337.5||22.5>w?e="north":w>=22.5&&67.5>w?e="northeast":w>=67.5&&112.5>w?e="east":w>=112.5&&157.5>w?e="southeast":w>=157.5&&202.5>w?e="south":w>=202.5&&247.5>w?e="southwest":w>=247.5&&292.5>w?e="west":w>=292.5&&337.5>w&&(e="northwest");var s=Cl.indexOf(e),e=Cl[t-(1-s)+8];switch(e){case"northwest":g.$12l="nwse-resize";break;case"northeast":g.$12l="nesw-resize";break;case"southwest":g.$12l="nesw-resize";break;case"southeast":g.$12l="nwse-resize";break;case"north":g.$12l="ns-resize";break;case"east":g.$12l="ew-resize";break;case"south":g.$12l="ns-resize";break;case"west":g.$12l="ew-resize"}g.$10l=H}return!0}return!1},$42l:function(S,g,K,F,D){var u,x=this,W=x.gv,k=W.getEditPointSize(),_=k/W.getZoom(),q=-1,n={x:g.x,y:g.y,width:0,height:0},h=function(E){"shape"===D?x._shape=S:x._edge=S,x._removePointIndex=E},c=function(F){"shape"===D?x._shape=S:x._edge=S,x.$13l=F,x.$12l="crosshair"};for(B(n,_/2),q=K.length-1,u=F.size()-1;u>=0;u--){var I=F.get(u);if(1===I||2===I)q-=1;else if(3===I){var m=K[q-1];if(p(n,m))return c(q-1),!0;q-=2}else if(4===I){var $=K[q-1],r=K[q-2];if(p(n,$))return c(q-1),!0;if(p(n,r))return c(q-2),!0;q-=3}}for(q=K.length-1,u=F.size()-1;u>=0;u--){var I=F.get(u),o=K[q];if(p(n,o))return h(q),c(q),!0;1===I||2===I?q-=1:3===I?q-=2:4===I&&(q-=3)}return!1},$41l:function(V,b,j,_,x){var w=this,o=w.gv,P=-1,W=0,e={x:b.x,y:b.y,width:0,height:0},M=function(J,I){w._hoverSegmentIndex=I,w._lp=b,"shape"===x?w._shape=V:w._edge=V};for(B(e,o.getSegmentHoverWidth()/2/o.getZoom()),V instanceof F&&V.isClosePath()&&_.indexOf(5)<0&&(_=new t(_._as),_.add(5));W<_.size();W++){var O=_.get(W);if(1===O){var q=j[P],N=j[P+1];if(q){var H=Cp(new xo(q.x,q.y),new xo(N.x,N.y),new xo(e.x,e.y),new xo(e.x+e.width,e.y+e.height));if(H.$62l===E&&H.points.length>0)return M(H,W),!0}P+=1}else if(2===O){var q=j[P],N=j[P+1],H=Cp(new xo(q.x,q.y),new xo(N.x,N.y),new xo(e.x,e.y),new xo(e.x+e.width,e.y+e.height));if(H.$62l===E&&H.points.length>0)return M(H,W),!0;P+=1}else if(3===O){var q=j[P],X=j[P+1],d=j[P+2],H=Uj(new xo(q.x,q.y),new xo(X.x,X.y),new xo(d.x,d.y),new xo(e.x,e.y),new xo(e.x+e.width,e.y+e.height));if(H.$62l===E)return M(H,W),!0;P+=2}else if(4===O){var q=j[P],T=j[P+1],J=j[P+2],d=j[P+3],H=bs(new xo(q.x,q.y),new xo(T.x,T.y),new xo(J.x,J.y),new xo(d.x,d.y),new xo(e.x,e.y),new xo(e.x+e.width,e.y+e.height));if(H.$62l===E)return M(H,W),!0;P+=3}else if(5===O){var q=j[P],N=j[0];if(q){var H=Cp(new xo(q.x,q.y),new xo(N.x,N.y),new xo(e.x,e.y),new xo(e.x+e.width,e.y+e.height));if(H.$62l===E&&H.points.length>0)return M(H,W),!0}}}return!1},addShapePoint:function(K,x,D){var r=this,V=r.gv,H=V.dm();if(H.beginTransaction(),0===arguments.length&&(K=r._shape||r._edge,x=r._hoverSegmentIndex,D=r._lp),K instanceof F||K instanceof X){var h=rm(K,V.getDataUI(K),x);if(!isNaN(x)&&D&&!isNaN(h)){var q=D;if(K instanceof F){var y=K.p(),I=K.getRotation(),e=K.toSegments();e&&e.size()||(e=Sf(K.getPoints())),K.isClosePath()&&e.indexOf(5)<0&&(e=new t(e._as),e.add(5));var L=e.get(x),C="addPoint",E="removePointAt";if(2===L||1===L){var z={x:q.x,y:q.y};e.add(L,x),z=pd(y,z.x-y.x,z.y-y.y,-I),K[C](z,h+1)}else if(3===L){var B=K.getPoints(),k=B.get(h),d=B.get(h+2),z={x:q.x,y:q.y};z=pd(y,z.x-y.x,z.y-y.y,-I);var c=tp(k,z),j=tp(z,d);e.removeAt(x),e.add(3,x),e.add(3,x),K.setPoint(h+1,z),K[C](j,h+2),K[C](c,h+1)}else if(4===L){var B=K.getPoints(),k=B.get(h),d=B.get(h+3),z={x:q.x,y:q.y};z=pd(y,z.x-y.x,z.y-y.y,-I);var c=Gd(k,z),j=fl(k,z),T=Gd(z,d),J=fl(z,d);e.removeAt(x),e.add(4,x),e.add(4,x),K[E](h+1),K[E](h+1),K[C](z,h+1),K[C](J,h+2),K[C](T,h+2),K[C](j,h+1),K[C](c,h+1)}else if(5===L){var z={x:q.x,y:q.y};e.add(2,x),z=pd(y,z.x-y.x,z.y-y.y,-I),K[C](z,h+1)}K.isClosePath()&&e.remove(5),K.setSegments(e);var O=K.getWidth(),m=K.getHeight(),u=K.p().x-O/2,W=K.p().y-m/2;u-=y.x,W-=y.y;var o=Eq(K,{x:u,y:W,width:O,height:m},I,y);K.p(o.x,o.y)}else if(K instanceof X){if("points"!==K.s("edge.type"))return H.endTransaction(),void 0;var B=K.s("edge.points");e=K.s("edge.segments"),B=lh(V.getDataUI(K),B),e&&e.size()||(e=Sf(B)),e=new t(e._as.slice(0)),B=new t(B._as.slice(0));var L=e.get(x);if(2===L||1===L){var z={x:q.x,y:q.y};e.add(L,x),B.add(z,h+1)}else if(3===L){var k=B.get(h),d=B.get(h+2),z={x:q.x,y:q.y},c=tp(k,z),j=tp(z,d);e.removeAt(x),e.add(3,x),e.add(3,x),B.set(h+1,z),B.add(j,h+2),B.add(c,h+1)}else if(4===L){var k=B.get(h),d=B.get(h+3),z={x:q.x,y:q.y},c=Gd(k,z),j=fl(k,z),T=Gd(z,d),J=fl(z,d);e.removeAt(x),e.add(4,x),e.add(4,x),B.removeAt(h+1),B.removeAt(h+1),B.add(z,h+1),B.add(J,h+2),B.add(T,h+2),B.add(j,h+1),B.add(c,h+1)}K.s("edge.points",Qc(B)),K.s("edge.segments",e)}}}H.endTransaction()},removeShapePoint:function(W,j){var p=this,x="removeAt",i=p.gv,n=i.dm();if(n.beginTransaction(),0===arguments.length&&(W=p._shape||p._edge,j=p._removePointIndex),j>=0&&(W instanceof F||W instanceof X)){var O=Nn(W,p.gv.getDataUI(W),j),$=j;if(W instanceof F){var z=W.p(),q=W.toSegments();q&&q.size()||(q=Sf(W.getPoints()));var Q=q.get(O),L="removePointAt";if(1===Q&&0===$)if(W.getPoints().size()>1){var w=q.get(O+1);q[x](O+1),3===w?W[L]($+1):4===w&&(W[L]($+2),W[L]($+1)),W[L]($)}else W.dm().remove(W);else 2===Q||1===Q?(q[x](O),W[L]($)):3===Q?(q[x](O),W[L]($),W[L]($-1)):4===Q&&(q[x](O),W[L]($),W[L]($-1),W[L]($-2));W.setSegments(q);var b=W.getWidth(),K=W.getHeight(),a=W.p().x-b/2,D=W.p().y-K/2;a-=z.x,D-=z.y;var y=Eq(W,{x:a,y:D,width:b,height:K},W.getRotation(),z);W.p(y.x,y.y)}else if(W instanceof X){if("points"!==W.s("edge.type"))return n.endTransaction(),void 0;var k=W.s("edge.points");if(q=W.s("edge.segments"),k&&(k=lh(p.gv.getDataUI(W),k),q&&q.size()||(q=Sf(k))),0===j||j===k.size()-1)return n.endTransaction(),void 0;q=new t(q._as.slice(0)),k=new t(k._as.slice(0));var Q=q.get(O);2===Q||1===Q?(q[x](O),k[x]($)):3===Q?(q[x](O),k[x]($),k[x]($-1)):4===Q&&(q[x](O),k[x]($),k[x]($-1),k[x]($-2)),W.s("edge.segments",q),W.s("edge.points",Qc(k))}}n.endTransaction()},changeShapeSegment:function(h,V,U){var Z=this,o=Z.gv,c=o.dm();if(c.beginTransaction(),1!==arguments.length||isNaN(h)||(U=h,h=Z._shape||Z._edge,V=Z._hoverSegmentIndex),h instanceof F||h instanceof X){var g=rm(h,Z.gv.getDataUI(h),V);if(!isNaN(V)&&!isNaN(g))if(h instanceof F){var f=h.p(),S=h.toSegments();S&&S.size()||(S=Sf(h.getPoints()));var R=S.get(V),N=h.toPoints();if(1===U||2===U)1===R||2===R?S.set(V,U):3===R?(S.set(V,U),N.removeAt(g+1)):4===R&&(S.set(V,U),N.removeAt(g+1),N.removeAt(g+1));else if(3===U){var q=function(){var w=N.get(g),O=N.get(g+1),r=tp(w,O);S.set(V,3),N.add(r,g+1)};2===R||1===R?q():4===R&&(N.removeAt(g+1),N.removeAt(g+1),q())}else if(4===U){var l=function(){var Y=N.get(g),r=N.get(g+1),M=Gd(Y,r),b=fl(Y,r);S.set(V,4),N.add(M,g+1),N.add(b,g+2)};2===R||1===R?l():3===R&&(N.removeAt(g+1),l())}h.setSegments(S),h.setPoints(N);var M=h.getWidth(),k=h.getHeight(),w=h.p().x-M/2,e=h.p().y-k/2;w-=f.x,e-=f.y;var y=new Eq(h,{x:w,y:e,width:M,height:k},h.getRotation(),f);h.p(y.x,y.y)}else if(h instanceof X){if("points"!==h.s("edge.type"))return c.endTransaction(),void 0;var N=h.s("edge.points");S=h.s("edge.segments"),N&&(N=lh(Z.gv.getDataUI(h),N),S&&S.size()||(S=Sf(N))),S=new t(S._as.slice(0)),N=new t(N._as.slice(0));var R=S.get(V);if(1===U||2===U)1===R||2===R?S.set(V,U):3===R?(S.set(V,U),N.removeAt(g+1)):4===R&&(S.set(V,U),N.removeAt(g+1),N.removeAt(g+1));else if(3===U){var q=function(){var v=N.get(g),M=N.get(g+1),R=tp(v,M);S.set(V,3),N.add(R,g+1)};2===R||1===R?q():4===R&&(N.removeAt(g+1),N.removeAt(g+1),q())}else if(4===U){var l=function(){var l=N.get(g),A=N.get(g+1),t=Gd(l,A),s=fl(l,A);S.set(V,4),N.add(t,g+1),N.add(s,g+2)};2===R||1===R?l():3===R&&(N.removeAt(g+1),l())}h.s("edge.points",Qc(N)),h.s("edge.segments",S)}}c.endTransaction()},getDefaultSegments:function(D){var k=this.gv,S=k.getDataUI(D);if(D instanceof X){var B=D.s("edge.points");return B=lh(S,B),Sf(B)}if(D instanceof F){var B=D.getPoints(),U=D.getSegments();return U&&U.size()>0?U:Sf(B)}},$43l:function(v){var N=this;v&&(N.$5l=1),N._68I=1,N._42()},_42:function(){var A=this;if(A._68I){delete A._68I;var b=A.gv,Q=A.$5l,o=b.getZoom(),x=b.getEditPointSize(),h=x/2,T=new t,O=A._view,L=A._edge,W=A._shape,M=O.getContext("2d"),E=b.tx(),I=b.ty(),J=g,l=b.getEditPointBackground(),w=b.getControlPointBackground(),Z=b.getControlPointBorderColor(),s=b.getEditPointBorderColor(),k=b.getEditRectBorderColor(),p=b.getDirectionLineColor(),d=b.getSegmentHoverColor(),$=b.getSnapPointBorderColor(),S=b.getJoinPointBackground(),c=b.getJoinPointBorderColor(),U=b.getSegmentHoverWidth(),y=[5,5],G=b.getEditRectBorderStyle();lk(b,function(i){b.isSelected(i)&&b.isVisible(i)&&T.add(i)}),M.clearRect(0,0,V(O.width),V(O.height)),M.save(),H.translateAndScale(M,E,I,1);var f=g,m={x:0,y:0,width:0,height:0},K=0,D=0,n=0,P=0,e=0,R=0,Ee=0,js=0,gs=0,Wk=0,ln=[];if(Q?(delete A.$6l,delete A.$8l,delete A.$7l,delete A.$16l,delete A.$23l):(f=A.$6l,J=A.$7l),delete A.$68l,delete A.$69l,delete A.$71l,delete A.$70l,delete A.$82l,delete A.$83l,delete A._pointElevationHelperPoint,delete A.$90l,delete A.$91l,delete A.$75l,delete A.$74l,T.each(function(Y){var V=b.getDataUI(Y);if(V){var r=V._55O;if(b.isEditable(Y))r._56O&&Y instanceof v&&D++,ln.push(Y),r._42O&&Y instanceof v&&K++,b.isHelperEditable(Y,"host")&&P++,b.isHelperEditable(Y,"parent")&&n++,b.isHelperEditable(Y,"remove")&&e++,b.isHelperEditable(Y,"edge")&&R++,b.isHelperEditable(Y,"source")&&Ee++,b.isHelperEditable(Y,"target")&&js++,b.isHelperEditable(Y,"elevation")&&gs++,b.isHelperEditable(Y,"tall")&&Wk++;else if(Y instanceof N&&Y.isExpanded()){var s=!0,C=b.getEditableFunc();C&&(s=C(Y)),s&&(b.isHelperEditable(Y,"host")&&P++,b.isHelperEditable(Y,"parent")&&n++,b.isHelperEditable(Y,"remove")&&e++,b.isHelperEditable(Y,"edge")&&R++,b.isHelperEditable(Y,"source")&&Ee++,b.isHelperEditable(Y,"target")&&js++,b.isHelperEditable(Y,"elevation")&&gs++,b.isHelperEditable(Y,"tall")&&Wk++,ln.push(Y))}}}),M.beginPath(),M.lineWidth=1,M.strokeStyle=b.getNodeBorderColor(),ln.forEach(function(q){var t=b.getDataUI(q),z=t._55O;if(Q)if(J==g&&(J=q instanceof X?0:q instanceof N&&q.isExpanded()?0:q.getRotation(),A.$7l=J),f==g){var l,d,G;if(q instanceof N&&q.isExpanded()||q instanceof X){var Z=b.getDataUIBounds(q);d=Z.width,G=Z.height,l={x:Z.x+d/2,y:Z.y+G/2}}else l=q.p(),d=q.getWidth(),G=q.getHeight();f={x:l.x,y:l.y,width:0,height:0},m.x=l.x-d/2,m.y=l.y-G/2,m.width=d,m.height=G,f=_(f,m)}else{var l,d,G,W,y=f.x+f.width/2,E=f.y+f.height/2,c={x:y,y:E};if(q instanceof N&&q.isExpanded()||q instanceof X){W=0;var Z=b.getDataUIBounds(q);d=Z.width,G=Z.height,l={x:Z.x+d/2,y:Z.y+G/2}}else l=q.p(),d=q.getWidth(),G=q.getHeight(),W=q.getRotation();var h={x:l.x-d/2,y:l.y-G/2,width:d,height:G},a={x:h.x,y:h.y},P={x:h.x+h.width,y:h.y},e={x:h.x,y:h.y+h.height},F={x:h.x+h.width,y:h.y+h.height},a=pd(l,a.x-l.x,a.y-l.y,W),e=pd(l,e.x-l.x,e.y-l.y,W),F=pd(l,F.x-l.x,F.y-l.y,W),P=pd(l,P.x-l.x,P.y-l.y,W),$=-J,u=pd(c,a.x-c.x,a.y-c.y,$),j=pd(c,P.x-c.x,P.y-c.y,$),V=pd(c,e.x-c.x,e.y-c.y,$),U=pd(c,F.x-c.x,F.y-c.y,$),C=i([u,j,V,U]);f=_(f,C),f.x-=y,f.y-=E;var L=Eq(g,f,J,c);f.x=L.x-f.width/2,f.y=L.y-f.height/2}if(K>1&&b.isEditable(q)&&b.isRectEditable(q)&&q instanceof v){var k=q.getRect(),B=z.$45l,r=Rn(B[0],o),w=Rn(B[2],o),Y=Rn(B[4],o),O=Rn(B[6],o);q.getRotation()?(M.moveTo(r.x,r.y),M.lineTo(w.x,w.y),M.lineTo(Y.x,Y.y),M.lineTo(O.x,O.y),M.lineTo(r.x,r.y)):M.rect(k.x*o,k.y*o,k.width*o,k.height*o)}}),M.stroke(),f){A.$6l=C(f),B(f,b.getEditRectPadding()/o);var ie={x:f.x+f.width/2,y:f.y+f.height/2},hd=Tb(ie,f.width,f.height,J),Oo=hd[0],Br=hd[1],ib=hd[2],Df=hd[3],Pd=hd[4],uk=hd[5],mp=hd[6],Kf=hd[7];if(Oo=Rn(hd[0],o),Br=Rn(hd[1],o),ib=Rn(hd[2],o),Df=Rn(hd[3],o),Pd=Rn(hd[4],o),uk=Rn(hd[5],o),mp=Rn(hd[6],o),Kf=Rn(hd[7],o),A.$8l=f,K>0&&(A.$16l=[Oo,Pd,Br,uk,Df,mp,ib,Kf],M.beginPath(),M.lineWidth=1,M.strokeStyle=k,"dashed"===G&&M.setLineDash&&M.setLineDash(y),M.moveTo(Oo.x,Oo.y),M.lineTo(Br.x,Br.y),M.lineTo(Df.x,Df.y),M.lineTo(ib.x,ib.y),M.lineTo(Oo.x,Oo.y),M.stroke(),"dashed"===G&&M.setLineDash&&M.setLineDash([])),M.beginPath(),M.lineWidth=1,M.fillStyle=l,M.strokeStyle=s,K>0){var Bf=uk.x-Kf.x,oo=uk.y-Kf.y,ym=a(Bf*Bf+oo*oo),Wb=Pd.x-mp.x,Nf=Pd.y-mp.y,Ob=a(Wb*Wb+Nf*Nf),Cr=2*x;if(b.isDirectionEditable&&1===ln.length){var qk=ln[0],qb=b.getDataUI(qk),me=qb._55O,Sk=b.isDirectionEditable.bind(b);if(me._42O){var Xl,uh,rf,sr;Sk(qk,"northwest")&&(Xl=!0,M.rect(Oo.x-h,Oo.y-h,x,x)),Sk(qk,"northeast")&&(uh=!0,M.rect(Br.x-h,Br.y-h,x,x)),Sk(qk,"southwest")&&(rf=!0,M.rect(ib.x-h,ib.y-h,x,x)),Sk(qk,"southeast")&&(sr=!0,M.rect(Df.x-h,Df.y-h,x,x)),Sk(qk,"north")&&(Xl&&uh?ym>Cr&&M.rect(Pd.x-h,Pd.y-h,x,x):M.rect(Pd.x-h,Pd.y-h,x,x)),Sk(qk,"south")&&(sr&&rf?ym>Cr&&M.rect(mp.x-h,mp.y-h,x,x):M.rect(mp.x-h,mp.y-h,x,x)),Sk(qk,"west")&&(rf&&Xl?Ob>Cr&&M.rect(Kf.x-h,Kf.y-h,x,x):M.rect(Kf.x-h,Kf.y-h,x,x)),Sk(qk,"east")&&(sr&&uh?Ob>Cr&&M.rect(uk.x-h,uk.y-h,x,x):M.rect(uk.x-h,uk.y-h,x,x))}}else ym>Cr&&(M.rect(Pd.x-h,Pd.y-h,x,x),M.rect(mp.x-h,mp.y-h,x,x)),Ob>Cr&&(M.rect(uk.x-h,uk.y-h,x,x),M.rect(Kf.x-h,Kf.y-h,x,x)),M.rect(Oo.x-h,Oo.y-h,x,x),M.rect(Br.x-h,Br.y-h,x,x),M.rect(ib.x-h,ib.y-h,x,x),M.rect(Df.x-h,Df.y-h,x,x)}if(D>0){var ij=A.$23l=pd(Pd,0,2*-x,J);M.moveTo(ij.x+h,ij.y),M.arc(ij.x,ij.y,h,0,Y,!1)}M.fill(),M.stroke(),A.$40l&&A.$44l(M,f,J);var Dc,Ho,Jj=b.getLeftTopHelpers(),om=b.getRightTopHelpers(),Zh=b.getLeftBottomHelpers(),Wm=b.getRightBottomHelpers(),Ye=b.getEdgeHelpers(),ae=b.getEditHelperSize(),To=ae/2,Pm=function(E,D,t,S){"leftTop"===D?(Dc=f.x*o-ae-h-("h"===S?t*(ae+h):0)-1,Ho=f.y*o-ae-h-("v"===S?t*(ae+h):0)-1):"rightTop"===D?(Dc=(f.x+f.width)*o+h+("h"===S?t*(ae+h):0)+1,Ho=f.y*o-ae-h-("v"===S?t*(ae+h):0)-1):"leftBottom"===D?(Dc=f.x*o-ae-h-("h"===S?t*(ae+h):0)-1,Ho=(f.y+f.height)*o+h+("v"===S?t*(ae+h):0)+1):"rightBottom"===D&&(Dc=(f.x+f.width)*o+h+("h"===S?t*(ae+h):0)+1,Ho=(f.y+f.height)*o+h+("v"===S?t*(ae+h):0)+1);var Q=Dc+To,V=Ho+To,T=(f.x+f.width/2)*o,z=(f.y+f.height/2)*o,G=pd({x:T,y:z},Q-T,V-z,J);if("host"===E){if(P>0)return A.$77l(M,J,G),!0}else if("edge"===E){if(R>0)return A.$80l(M,J,G),!0}else if("remove"===E){if(e>0)return ln&&1===ln.length&&ln[0]instanceof X?A.$81l(M,J,{x:T+ae/2+5,y:z}):A.$81l(M,J,G),!0}else if("parent"===E){if(n>0)return ln&&1===ln.length&&ln[0]instanceof X?A.$76l(M,J,{x:T-ae/2-5,y:z}):A.$76l(M,J,G),!0}else if("elevation"===E){if(gs>0)return A.$85l(M,J,G),!0}else if("tall"===E){if(Wk>0)return A.$86l(M,J,G),!0}else if("source"===E||"target"===E){var N=ln[0],u=b.getDataUI(N),I=zq(u,!0),H=I[0],O=I[1];if(Ee&&"source"===E)return A.$84l(M,f,H,!0,N.isLooped(),D,t,S),!0;if(js&&"target"===E)return A.$84l(M,f,O,!1,N.isLooped(),D,t,S),!0}};if(Jj&&Jj.length>0){var rq=0;Jj.forEach(function(d){Pm(d,"leftTop",rq,b.getLeftTopHelpersAlign()||"h")&&rq++})}if(om&&om.length>0){var rq=0;om.forEach(function(H){Pm(H,"rightTop",rq,b.getRightTopHelpersAlign()||"h")&&rq++})}if(Zh&&Zh.length>0){var rq=0;Zh.forEach(function(V){Pm(V,"leftBottom",rq,b.getLeftBottomHelpersAlign()||"h")&&rq++})}if(Wm&&Wm.length>0){var rq=0;Wm.forEach(function(K){Pm(K,"rightBottom",rq,b.getRightBottomHelpersAlign()||"h")&&rq++})}if(Ye&&Ye.length>0&&((Ee||js)&&ln&&1===ln.length&&ln[0]instanceof X?!0:!1)){var rq=0;Ye.forEach(function($){Pm($,"edge",rq,"h")&&rq++})}if(A.$72l){var xn,yl=A.$67l,fe=A.$68l,Zk=A.$69l,Uc=(A.$71l,A.$70l),pq=A.$82l,bs=A.$83l;if(1===yl?xn=fe:2===yl?xn=Zk:3===yl?xn=Uc:5===yl?xn=pq:6===yl&&(xn=bs),xn){var Uk=b.lp(A.$72l),Yp=b.getDataAt(A.$72l);if(Yp&&Yp instanceof v){var jk,sp,Xo;if(A.$73l=Yp,1===yl)if(Yp instanceof u.Grid)jk=A.$75l=bq(Yp,Uk);else if(Yp instanceof u.Shape){Xo=A.$74l=Pq(Yp,Uk);var Jn=Yp.getPoints();if(Xo){var Rk=Xo.attachIndex,vq=rm(Yp,b.getDataUI(Yp),Rk)+1,On=vq+1>=Jn.size()?0:vq+1,Sl=Jn.get(vq),gq=Jn.get(On),un=Yp.p(),Uq=Yp.getRotation();Sl=pd(un,Sl.x-un.x,Sl.y-un.y,Uq),gq=pd(un,gq.x-un.x,gq.y-un.y,Uq),M.beginPath(),M.strokeStyle=d,M.lineWidth=U,M.moveTo(Sl.x*o,Sl.y*o),M.lineTo(gq.x*o,gq.y*o),M.stroke()}}jk?sp=jk.rect:(sp=q.clone(b.getDataUIBounds(Yp)),q.grow(sp,2)),M.beginPath(),M.rect(sp.x*o,sp.y*o,sp.width*o,sp.height*o),M.strokeStyle=1===yl||4===yl||6===yl?r:j,M.lineWidth=2,M.setLineDash&&M.setLineDash([8,8]),M.stroke()}else delete A.$73l;Uk.x=Uk.x*o,Uk.y=Uk.y*o;var _l=sm(xn.x,xn.y,Uk.x,Uk.y),Tq=pd(xn,Uk.x-xn.x,Uk.y-xn.y,-_l),fp=Tq.x-xn.x;M.translate(xn.x,xn.y),M.rotate(_l),z.width=fp,z.height=40;var Ec=j;(1===yl||4===yl||6===yl)&&(Ec=r),z.comps[0].gradientColor=Ec,q.drawImage(M,z,0,-20,fp,40)}}}if(T.each(function(l){var q=b.getDataUI(l);if(q){var a,G,H=q._55O,E=q._78o;if(H&&H._43O&&l instanceof F?(a=H.$15l,G=l.getSegments(),G&&G.size()||(G=Sf(a)),l.isClosePath()&&G.indexOf(5)<0&&(G=new t(G._as),G.add(5))):H&&E&&H._43O&&(a=l.s("edge.points"),G=l.s("edge.segments"),a=lh(q,a),G&&G.size()||(G=Sf(a)),a&&(a=a._as)),a&&G){var X=0,m=G.size(),N=A._hoverSegmentIndex;a=a.slice(0);for(var y=0;y<a.length;y++)a[y]=Rn(a[y],o);M.beginPath(),M.strokeStyle=p,M.lineWidth=1,X=0;for(var y=0;m>y;y++){var P=G.get(y);if(1===P||2===P)X++;else if(3===P){var _=a[X-1],J=a[X],i=a[X+1];M.moveTo(_.x,_.y),M.lineTo(J.x,J.y),M.lineTo(i.x,i.y),X+=2}else if(4===P){var _=a[X-1],x=a[X],V=a[X+1],i=a[X+2];M.moveTo(_.x,_.y),M.lineTo(x.x,x.y),M.moveTo(V.x,V.y),M.lineTo(i.x,i.y),X+=3}}if(M.stroke(),W===l||L===l&&"points"===L.s("edge.type")){M.beginPath(),X=0,M.strokeStyle=d,M.lineWidth=U;for(var y=0;m>y;y++){var P=G.get(y);if(1===P||2===P){if(N===y){var _=a[X-1],i=a[X];M.moveTo(_.x,_.y),M.lineTo(i.x,i.y);break}X++}else if(3===P){if(N===y){var _=a[X-1],J=a[X],i=a[X+1];M.moveTo(_.x,_.y),M.quadraticCurveTo(J.x,J.y,i.x,i.y);break}X+=2}else if(4===P){if(N===y){var _=a[X-1],x=a[X],V=a[X+1],i=a[X+2];M.moveTo(_.x,_.y),M.bezierCurveTo(x.x,x.y,V.x,V.y,i.x,i.y);break}X+=3}else if(5===P&&N===y){var _=a[X-1],i=a[0];M.moveTo(_.x,_.y),M.lineTo(i.x,i.y);break}}M.stroke()}M.beginPath(),X=0,M.strokeStyle=c,M.lineWidth=1,M.fillStyle=S;for(var y=0;m>y;y++){var P=G.get(y);if(1===P||2===P){var i=a[X];M.moveTo(i.x+h,i.y),M.arc(i.x,i.y,h,0,Y,!0),X++}else if(3===P){var i=a[X+1];M.moveTo(i.x+h,i.y),M.arc(i.x,i.y,h,0,Y,!0),X+=2}else if(4===P){var i=a[X+2];M.moveTo(i.x+h,i.y),M.arc(i.x,i.y,h,0,Y,!0),X+=3}}M.fill(),M.stroke(),M.beginPath(),X=0,M.strokeStyle=Z,M.lineWidth=1,M.fillStyle=w;for(var y=0;m>y;y++){var P=G.get(y);if(1===P||2===P)X++;else if(3===P){var J=a[X];M.moveTo(J.x+h,J.y),M.arc(J.x,J.y,h,0,Y,!0),X+=2}else if(4===P){var x=a[X],V=a[X+1];M.moveTo(x.x+h,x.y),M.arc(x.x,x.y,h,0,Y,!0),M.moveTo(V.x+h,V.y),M.arc(V.x,V.y,h,0,Y,!0),X+=3}}if(M.fill(),M.stroke(),M.beginPath(),X=0,M.strokeStyle=$,M.lineWidth=2,(W===l||L===l)&&A.$9l!=g){var i=a[A.$9l];M.moveTo(i.x+h,i.y),M.arc(i.x,i.y,h,0,Y,!0),M.stroke()}}}}),A.$87l&&b.sm().contains(A.$87l)){var Ml,Qk=A.$87l,$k=A.$88l,ae=b.getEditHelperSize(),To=ae/2;if(b.isHelperEditable(Qk,"pointElevation"))if(Qk instanceof F){var Xn=Qk.getPosition();Ml=q.clone(Qk.getPoints().get($k)),Ml=pd({x:Xn.x,y:Xn.y},Ml.x-Xn.x,Ml.y-Xn.y,Qk.getRotation()),Ml.x*=o,Ml.y*=o,M.translate(Ml.x,Ml.y),q.drawImage(M,q.getImage("xeditinteractor_elevationIcon"),To,-To,ae,ae),M.translate(-Ml.x,-Ml.y),A._pointElevationHelperPoint={x:Ml.x+ae,y:Ml.y}}else if(Qk instanceof X){var ui=lh(b.getDataUI(Qk),Qk.s("edge.points")),Ml=q.clone(ui.get($k));Ml.x*=o,Ml.y*=o,M.translate(Ml.x,Ml.y),q.drawImage(M,q.getImage("xeditinteractor_elevationIcon"),To,-To,ae,ae),M.translate(-Ml.x,-Ml.y),A._pointElevationHelperPoint={x:Ml.x+ae,y:Ml.y}}}M.restore(),A.$5l=0}},$89l:function(z,h,G,H){z.save();var W=this,$=W.gv,Q=$.getEditHelperSize(),x=Q/2;z.beginPath(),z.translate(G.x,G.y),z.rotate(h),q.drawImage(z,H,-x,-x,Q,Q),z.restore()},$85l:function(P,F,O){var Z=this;Z.$90l=O,Z.$89l(P,F,O,q.getImage("xeditinteractor_elevationIcon"))},$86l:function(k,H,M){var w=this;w.$91l=M,w.$89l(k,H,M,q.getImage("xeditinteractor_tallIcon"))},$77l:function(T,d,N){var f=this;f.$68l=N,f.$89l(T,d,N,q.getImage("xeditinteractor_hostIcon"))},$80l:function(O,W,D){var m=this;m.$70l=D,m.$89l(O,W,D,q.getImage("xeditinteractor_edgeIcon"))},$81l:function(J,G,C){var I=this;I.$71l=C,I.$89l(J,G,C,q.getImage("xeditinteractor_removeIcon"))},$76l:function(P,U,W){var f=this;f.$69l=W,f.$89l(P,U,W,q.getImage("xeditinteractor_parentIcon"))},$84l:function(i,Y,T,x,z){var G,Z=this,o=Z.gv,I=o.getZoom(),$=o.getEditHelperSize(),p=$/2;T.x*=I,T.y*=I,z&&(x?T.x-=p+5:T.x+=p+5),T.y-=$-2,x?(Z.$82l=T,G=q.getImage("xeditinteractor_sourceIcon")):(Z.$83l=T,G=q.getImage("xeditinteractor_targetIcon")),i.beginPath(),i.translate(T.x,T.y),q.drawImage(i,G,-p,-p,$,$),i.translate(-T.x,-T.y)},$44l:function(S,g,i){S.save();var H=this.gv.getZoom(),c=a(f(g.width,2)+f(g.height,2))/2*H+10,W=c,s=W+8,U=W+18,w=i,T=g.x+g.width/2,R=g.y+g.height/2;S.translate(T*H,R*H),S.beginPath(),S.strokeStyle="rgb(150, 150, 150)";for(var q=0,I=0,M=0,Q=0,r=0,b=0;360>b;b++)q=b*o/180,0===b%5&&(I=G(q)*W,M=l(q)*W,Q=G(q)*s,r=l(q)*s,S.moveTo(I,M),S.lineTo(Q,r)),0===b%45&&(I=G(q)*W,M=l(q)*W,Q=G(q)*U,r=l(q)*U,S.moveTo(I,M),S.lineTo(Q,r));S.stroke(),S.beginPath(),S.rotate(-x),S.beginPath(),S.fillStyle="rgba(255, 0, 0, 0.1)",S.strokeStyle="rgb(157, 157, 157)",S.moveTo(0,0),S.arc(0,0,U,0,i,!1),S.fill(),S.beginPath(),S.moveTo(0+U,0),S.arc(0,0,U,0,i,!1),S.stroke(),S.rotate(x),S.font="bold 12px Verdana, Arial";var _=20*l(w),A=20*G(w),d=L(180*w/o)+"°";S.textAlign="center",S.textBaseline="middle",S.beginPath();var O=S.measureText("365.°").width;S.fillStyle="white",S.rect(_-O/2,-A-10,O,20),S.fill(),S.beginPath(),S.fillStyle="rgb(79,79,79)",S.fillText(d,_,-A),S.restore()}})}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:(0,eval)("this"),Object);