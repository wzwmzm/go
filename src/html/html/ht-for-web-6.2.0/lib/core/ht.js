!function(C,h,R){"use strict";var l="ht";if(!C[l]){!function(){Date.now&&Date.prototype.getTime||(Date.now=function(){return(new Date).getTime()}),C.performance&&C.performance.now||function(){var Q=Date.now();C.performance||(C.performance={}),C.performance.now=function(){return Date.now()-Q}}();for(var N=Date.now(),z=16,n=["ms","moz","webkit","o"],t=0;t<n.length&&!C.requestAnimationFrame;++t)C.requestAnimationFrame=C[n[t]+"RequestAnimationFrame"],C.cancelAnimationFrame=C[n[t]+"CancelAnimationFrame"]||C[n[t]+"CancelRequestAnimationFrame"];C.requestAnimationFrame||(C.requestAnimationFrame=function(f){var V=Date.now(),b=z+N-V;return 0>b&&(b=0),N=V,C.setTimeout(function(){N=Date.now(),f(performance.now())},b)}),C.cancelAnimationFrame||(C.cancelAnimationFrame=function(t){return C.clearTimeout(t)})}();var P,$,F,G,i=C.document,p=null,D=C[l]={},e=C[l+"config"],U=D.Default=e&&e.Default||{},q=D.Style=e&&e.Style||{},T=D.Attr=e&&e.Attr||{},v=D.Color=e&&e.Color||{},K=D.IsGetter=e&&e.IsGetter||{},r=Math,o=r.round,Z=r.floor,E=r.ceil,M=r.sqrt,Q=r.max,j=r.min,B=r.abs,X=r.cos,Y=r.acos,S=r.sin,k=r.pow,O=r.asin,V=r.PI,x=2*V,u=V/2,t=r.tan,z=r.atan2,b=r.random,L=function(v,z,_){return Math.max(z,Math.min(_,v))},W=!1,d=!1,f=C.parseInt||global.parseInt,g="2018-03-25",c=C.navigator?C.navigator.platform.indexOf("Win")>-1:!1,m=function(W){return W*W},A=C.setTimeout,J=C.clearTimeout,H=C.location,w=C.navigator?C.navigator.userAgent.toLowerCase():"",n=function(G){return G.test(w)},I=n(/msie/)||n(/trident/),N=n(/msie 10/),s=n(/edge/),a=n(/firefox/),y=n(/mac/),_=U.isTouchable===R?c?!1:i?"ontouchend"in i:!1:U.isTouchable,Wb="default",Mr="single",jn="multiple",Ap="front",Kq="back",Aj="left",ig="right",ko="top",eg="bottom",Qc="center",An="eye",hn="middle",br="east",fc="west",uf="north",nl="none",Vj="px",Vc="absolute",yi="border",Rr="triangle",li="rect",On="circle",dd="cylinder",jp="shape",dh="items",of="normal",Hi="remove",Zi="clear",Mh="width",ye="height",ys="ingroup",_h="check",bn="uncheck",qo="radio",as="radioOn",mh="radioOff",oi="points",Em="values",$r="series",qr="body",Ql="label",Mn="label2",Ir="note",kb="note2",tc="icons",$q="labelFont",Sl="labelColor",Tc="labelSelectColor",Hj="note.expanded",kg="note2.expanded",Qr="edge.expanded",ds="edge.points",Bq="edge.type",wr="rotation",xh="getRotation",kp="setRotation",yd="hidden",ks="visible",Tg="tuv",zh="no",Lg="draw",mp="select",hq="currentSubGraph",ri="selectBackground",Jf="autoMakeVisible",Zd="autoHideScrollBar",Dg="scrollBarColor",Se="scrollBarSize",qe="indent",Fj="rowHeight",Bs="columnLineColor",Df="rowLineColor",Zj="columnLineVisible",Vl="rowLineVisible",lr="visibleFunc",_l="expandIcon",Nn="collapseIcon",Pk="checkMode",Cc="sortFunc",vp="editable",Eo="batchEditable",Aq="tristate",Ug="asc",qi="desc",tk="position",Br="elevation",bi="children",Gj="translateX",Cn="translateY",Il="dataModel",am="maxSize",hg="shape3d",ai="shape3d.resolution",In="shape3d.visible",yr="shape3d.from.visible",Nh="shape3d.to.visible",ro="shape3d.top.visible",rm="shape3d.bottom.visible",Oo="repeat.uv.length",dn="serializeValue",Ac="deserializeValue",As="centerUniform",Lk="rgba(255,255,255,0)",Ce="style",be="attr",Im="field",pn="string",Um="boolean",ym="color",ui="int",oe="number",Ie="ew-resize",dg="ns-resize",Kn="pointer",fl="auto",Fh="mousedown",Zm="mousemove",Wc="mouseup",ij="mouseout",yh="touchstart",Ke="touchmove",Lj="touchend",Zn="keydown",Ym="keyup",Qd=a?"DOMMouseScroll":"mousewheel",jj=_?[yh,Ke,Lj,Zn,Ym,"keypress","input","contextmenu"]:[Zn,Ym,"keypress","input",Fh,Zm,Wc,ij,Qd,"wheel","contextmenu","mouseenter","mouseleave","mouseover"],wn=p,_b=p,gs=p,Hk=Wc.length,Fr=function(){gs&&(J(gs.timeout),gs=p)},cq=function(){gs&&ih(gs.e,gs.info)};C.addEventListener&&(_||(C.addEventListener(ij,function(){Fr()},!1),C.addEventListener(Qd,function(){mk()},!1)),C.addEventListener(Ym,function(A){91===A.keyCode?qg={}:delete qg[A.keyCode]},!0),C.addEventListener(Zn,function(E){qg[E.keyCode]=!0},!0));var Bb,mc,Rq,vg=0,wi=p,Vf=function(s,t){var B=A(function(){delete wi[B],es(wi)&&(wi=p),s()},t);return B},ie=p,ps={},zb={},pe={},Xp={},mj={},qg={},Be={},Om={},Ei={},cb={},gr=/.json$/,Tn=/^data:image\/svg\+xml/,Cq={},gl=[],Vh={},_o=p,Jk=p,Fp=function(){},ff=function(){throw"Oops!"},nn=[0,0,0],Vd=[0,0,0,0],Am={x:0,y:0,width:0,height:0},Gf=p,or=p,hr=p,Qp=function(u){or&&!u._72O&&(hr||(hr={}),hr[u._72O=Zq()]=u),Bb!=p?Np()<.05&&G&&!mc&&(Co=Fr):Co=sq},ql=function($,v,D,o){or||(or={});var t=or[$];if(t){if(t.url===v)return;t.image?(t.image.onload=Fp,t.image.onerror=Fp):t.request&&(t.request.onload=Fp,t.request.onerror=Fp)}if(gr.test(v)){var u=new XMLHttpRequest;if(or[$]={request:u,url:v},u.overrideMimeType&&u.overrideMimeType("text/plain"),v=U.beforeLoadURL(v),v.data){var m=U.parse(v.data);Vq($,m),U.handleImageLoaded($,m)}else u.open("GET",encodeURI(v),!0),u.onload=function(e){if(200===this.status||0===this.status){var d=U.parse(e.target.response||e.target.responseText);Vq($,d),U.handleImageLoaded($,d)}else Vq($,U.handleUnfoundImage($,v)||p)},u.onerror=function(){Vq($,U.handleUnfoundImage($,v)||p)},u.send(null)}else{var m=new Image;or[$]={image:m,url:v},I&&(v.toLowerCase().indexOf(".svg")>0||Tn.test(v))?(i.body.appendChild(m),m.style.visibility="hidden",m.onload=function(){A(function(){if(D&&(m.width=D),o&&(m.height=o),!m.width||!m.height){var E=m.width||m.clientWidth,n=m.height||m.clientHeight;m.width=E,m.height=n}U.handleImageLoaded($,m),Vq($,m),i.body.removeChild(m),m.style.visibility=""},180)},m.onerror=function(){Vq($,U.handleUnfoundImage($,v)||p),i.body.removeChild(m),m.style.visibility=""}):(m.onload=function(){D&&(m.width=D),o&&(m.height=o),U.handleImageLoaded($,m),Vq($,m)},m.onerror=function(){Vq($,U.handleUnfoundImage($,v)||p)}),/^data:image/.test(v)||(v=U.beforeLoadURL(v),/^data:image/.test(v)||(v=U.appendTimeStamp(v),v=encodeURI(v))),m.src=v}},Vq=function(Y,s){if(zb[Y]=s,delete or[Y],es(or)&&(or=p,hr)){for(var O in hr){var N=hr[O];N._2O&&(N._2O={}),N.invalidateAll&&N.invalidateAll(R,"imageLoaded",Y),N.redraw&&N.redraw(),N.iv(),delete N._72O}hr=p}if(s&&hr)for(var O in hr){var N=hr[O];N.invalidateAll&&N.invalidateAll(R,"imageLoading",Y),N.redraw&&N.redraw(),N.iv()}},Io=function(){return C.performance&&C.performance.now?C.performance.now():Date.now()},bq=function(s,L){L?J(s):C.cancelAnimationFrame(s)},on=function(e,m,D){return{width:e,height:m,comps:vi(D)?D:[D]}},Bh=function(s,G){return{type:On,rect:[s,G,1.6,1.6],borderWidth:1,borderColor:Er,gradient:hl,gradientColor:Ji,background:Er}},Ll=function(l,j){return on(16,16,{type:Rr,rect:[4,4,10,8],background:l,rotation:j?1.57:3.14})},dp=function(B,S){return on(16,16,{type:Rr,rect:[4,4,8,7],background:B,rotation:S?3.14:0})},ld=function(v){var R=v._orientation;return"horizontal"===R||"h"===R},Wi=function(q){var h=p||4,P=p||1,j=p||1;0>h?h=0:h>.25&&(h=.25);var n,J,A,R,u,t,z,Q=.5,H=[],i=[],U=[],F=x/j,I=x/P,C=Q-h;for(J=0;P>=J;J++)for(R=-V+J*I,t=X(R),u=S(R),n=0;j>=n;n++)A=n*F,z=C+h*t,H.push(X(A)*z,u*h,-S(A)*z),($=q)&&i.push(n/j,1-J/P);for(J=0;P>J;J++){var d=J*(j+1),Y=(J+1)*(j+1);for(n=0;j>n;n++)U.push(d+n,Y+n+1,Y+n,d+n,d+n+1,Y+n+1),Ej.z=xn.z=q}},Th=function(Y){var i=2,Z=0;for(var m in Y)m.length===i&&f(m,32)===rs&&(_o=Jk=Y[m]),Z++;return Z},Wo=function(J,l,h,B){return h||(h=_?5:3,h/=B||1),{x:J-h,y:l-h,width:2*h,height:2*h}},hf=function(y,I,O,r){var E=this;I||(I=_?5:3,O=20,r=20);var s={x:y,y:I,width:O,height:r};if(O)for(var Y=0;O>Y;Y++)if(3===O)r=20;else for(var F=0;r>F;F++)E=C?C:O;var x={x:V,y:2*V};if($f(s,x)){var e=ye[0]+ko[0]+Zi[1];Hd[An]=E[e],E[e]=Jl[An]}},xr=function(q){return(/ble$/.test(q)||/ed$/.test(q)||K[q]?"is":"get")+q.charAt(0).toUpperCase()+q.slice(1)},Jl=function(s){return"set"+s.charAt(0).toUpperCase()+s.slice(1)},Op=function(Y){return typeof Y===pn||Y instanceof String},Tq=function(L){return typeof L===oe},sq=function(o){return typeof o===Um},Dh=function(C){return C&&"object"==typeof C},vk=function(g){return"function"==typeof g},vi=function(M){return M instanceof Array},nk=function(J){return J instanceof uh},Mq=function(z){return vi(z)?new uh(z):z},Bf=function(L){return L instanceof Dl},Yr=function(T){return T instanceof qf},xk=function($){return $ instanceof ak},eb=function(x,T){if(!(x instanceof D.Group))return!1;if(!T)return x.isExpanded();var c=T.getDataUI(x);return c&&c._88I?!0:!1},_d=function(x){return x instanceof Zl},Bg=function(K){return K&&"IFRAME"===K.tagName},kn=function(k){return k==p||U.numberDigits==p?k:parseFloat(k.toFixed(U.numberDigits))},xg=function(g,t,i){var a,y=t.length;if(i)for(var L=0;i>L;L++)if(3===y)g.push(t[0]),g.push(t[1]),g.push(t[2]);else for(a=0;y>a;a++)g.push(t[a]);else if(3===y)g.push(t[0]),g.push(t[1]),g.push(t[2]);else for(a=0;y>a;a++)g.push(t[a])},Cd=function(n){return n?Dh(n)?n:{}:!1},Gp=function(C,l,j){var g,o=Dh(C)?C:C.prototype;for(g in l)j&&o[g]!==R||(o[g]=l[g]);return C},th=function(Q){return String.fromCharCode(Q)},Uh=function(K){for(var p,m=0,P="";m<K.length;m++)p=K[K.length-1-m],"%"===p?p="'":"a"===p?p='"':"]"===p&&(p="\\"),P+=th(p.charCodeAt(0)-1);return P},td=function(N,Z,Y){N.superClass.constructor.apply(Z,Y)},es=function(J){for(var X in J)return!1;return!0},wf=function(h){return h?0===h.length:!0},Kl=function(k,n){return k===n?!0:k.x===n.x&&k.y===n.y&&k.width===n.width&&k.height===n.height},uj=function(c,H,p){return H>c?H:c>p?p:c},nm=function(y){return 0>y?-1:y>0?1:0},Np=function(){var f=1e4*S(Hk++);return f-Z(f)},sp=function(N,Y,j){return Uj(N.x,N.y,Y.x,Y.y,j.x,j.y,j.x+j.width,j.y,!0)||Uj(N.x,N.y,Y.x,Y.y,j.x+j.width,j.y,j.x+j.width,j.y+j.height,!0)||Uj(N.x,N.y,Y.x,Y.y,j.x+j.width,j.y+j.height,j.x,j.y+j.height,!0)||Uj(N.x,N.y,Y.x,Y.y,j.x,j.y+j.height,j.x,j.y,!0)},Uj=function(h,W,y,s,D,M,d,c,g){var i=(d-D)*(W-M)-(c-M)*(h-D),F=(c-M)*(y-h)-(d-D)*(s-W);if(0!==F){var C=i/F,$=h+C*(y-h),f=W+C*(s-W);return g&&($+Sd<j(h,y)||$-Sd>Q(h,y)||$+Sd<j(D,d)||$-Sd>Q(D,d)||f+Sd<j(W,s)||f-Sd>Q(W,s)||f+Sd<j(M,c)||f-Sd>Q(M,c))?p:[$,f]}return p},Kg=function(t,Y,w){if(t&&w)if(Y){if(Y===Ce)return t.getStyle(w);if(Y===be)return t.getAttr(w);if(Y===Im)return t[w]}else if(w=xr(w),t[w])return t[w]();return R},re=function(s,X,r,$){if(s&&r)if(X){if(X===Ce)s.s(r,$);else if(X===be)s.a(r,$);else if(X===Im){var n=s[r];s[r]=$,s.fp("f:"+r,n,$)}}else r=Jl(r),s[r]&&s[r]($)},ph=function(F,X,q){return X&&"top"!==X?"bottom"===X?{x:F.x,y:F.y,width:F.width,height:F.height*q}:"right"===X?{x:F.x,y:F.y,width:F.width*q,height:F.height}:"left"===X?{x:F.x+F.width*(1-q),y:F.y,width:F.width*q,height:F.height}:void 0:{x:F.x,y:F.y+F.height*(1-q),width:F.width,height:F.height*q}},ve=function(z,Y,A,x,r){Y&&le(z,A,x,1,r,Y)},Ad=function(Z,D,Q,L){var u=1-Z;return u*u*D+2*Z*u*Q+Z*Z*L},Ej=function(g,Z,j,P,X){var K=1-g;return K*K*K*Z+3*K*K*g*j+3*K*g*g*P+g*g*g*X},rd=function(A){var l,r,$,W,k=0;return A.forEach(function(y){if(l=y.length,l>0)for(r=y[0],W=1;l>W;W++)$=y[W],k+=ti(r,$),r=$}),k},he=function(w,U,R){var s="__"+w,A=function(H){R.disabled||R["handle_"+w](H)};R[s]||(R[s]=A,U.addEventListener(w,A,!1))},Jd=function(N,D,P){var g="__"+N,m=P[g];m&&(D.removeEventListener(N,m,!1),delete P[g])},Vk=function(Y,B){var c="_"+B;Y[xr(B)]=function(){return this[c]},Y[Jl(B)]=function(Q){var Z=this[c];this[c]=Q,this.fp(B,Z,Q)}},Nm=function(E){return h.create(E)},jm=function(t){if(!t.element){var P,p;(P=t.textField)?p=Wg(Tp.TextField,P):(P=t.textArea)?p=Wg(Tp.TextArea,P):(P=t.button)?p=Wg(Tp.Button,P):(P=t.comboBox)?p=Wg(Tp.ComboBox,P):(P=t.checkBox)?p=Wg(Tp.CheckBox,P):(P=t.radioButton)?p=Wg(Tp.RadioButton,P):(P=t.slider)?p=Wg(Tp.Slider,P):(P=t.colorPicker)?p=Wg(Tp.ColorPicker,P):(P=t.image)&&(p=Wg(Tp.Image,P)),p&&(t.element=p)}},Yf=function(l,t){var Y=yb(l);return Y._ht=t,Y},yb=function(I,U){var W=i.createElement("div"),v=W.style;return W.tabIndex=-1,W.onkeydown=gj,v.msTouchAction=nl,xl(W,p,0),_&&v.setProperty("-webkit-tap-highlight-color","rgba(0, 0, 0, 0)",p),I&&(v.overflow=yd),U&&rj(U,W),W},Ne=function(c,x){var d=i.createElement("canvas"),z=d.style;return z.msTouchAction=nl,x||(z.pointerEvents=nl),xl(d,p,0),c&&rj(c,d),d},xl=function(W,H,K){var i=W.style;i.border=H?H+" solid 1px":0,i.outline=0,i.padding=K?"0 "+K+Vj:0,Pf(W)},Pf=function(Q){var M=Q.style;M.position=Vc,M.margin=0,M.setProperty("box-sizing","border-box",p),M.setProperty("-moz-box-sizing","border-box",p)},Yc=function(E,M,r,T){T||(T=eq),M!=p&&(E.width=M*T,E.style.width=M+Vj),r!=p&&(E.height=r*T,E.style.height=r+Vj)},rj=function(q,A,V){q.appendChild(A),V&&(A.style.position=Vc)},bk=function(w,$){$.split||($+="");for(var O,E=$.split("\n"),b=0,B=E.length,Y=0;B>Y;Y++){var P=sk(w.font,E[Y]);P.width>b&&(b=P.width),O||(O=P.height)}return w.ss=E,{width:b,height:O*B}},Cb=function(R,A,M,G,k,B){var b=A.length;if(1===b)Bm(R,A[0],M,G,k);else for(var p=M.height/b,D={x:M.x,y:M.y,width:M.width,height:p},V=0;V<A.length;V++)B?Sn(R,A[V],G,k,D.x,D.y,D.width,D.height,B):Bm(R,A[V],D,G,k),D.y+=p},Bm=function(S,Y,W,n,X){S.font=n?n:cc,S.fillStyle=X?X:Bd,S.textAlign=Qc,S.textBaseline=hn;var V,j;W?W.width===R?(V=W.x,j=W.y):(V=W.x+W.width/2,j=W.y+W.height/2):(V=0,j=0),S.fillText(Y,o(V),o(j))},Rd=function(E){E.getView&&(E=E.getView());var P=E.offsetWidth||E.scrollWidth;return!P&&E.style.width&&(P=f(E.style.width)),P},Hh=function(s){s.getView&&(s=s.getView());var X=s.offsetHeight||s.scrollHeight;return!X&&s.style.height&&(X=f(s.style.height)),X},ss=function(){var t=function(C){gj(C),C.stopPropagation()},c=_?[yh]:[Zn,Fh];return function(p){var E=yb(),V=E.style;return V.backgroundColor=U.disabledBackground,p&&(V.backgroundImage="url("+p+")",V.backgroundPosition="50% 50%",V.backgroundRepeat="no-repeat no-repeat"),c.forEach(function($){E.addEventListener($,t)}),E}}(),Xh=function(E){var w=E.getContext("2d");return w.save(),w.lineCap=mi,w.lineJoin=Fd,w},Co=function(N,v,b,m){Up(N,v*eq,b*eq),m*=eq,1!==m&&N.scale(m,m)},Up=function(g,z,o){g.translate(z,o)},nd=function(w,t){t&&w.rotate(t)},tb=function(_,D,w){D===R&&(D=1),w===R&&(w=1),(1!==D||1!==w)&&_.scale(D,w)},rn=!1,rb=function(J){var r=i.activeElement;if(i.activeElement!==J){r&&r.forceOnblur&&r.forceOnblur();for(var y=[],k=J.parentNode;k;)y.push([k,k.scrollLeft,k.scrollTop]),k=k.parentNode;if(!rn){var c=[];try{for(var h=C.parent,b=C;h!==b;)c.push([h,h.scrollX,h.scrollY]),b=h,h=C.parent}catch(v){rn=!0}}if(_)J.focus();else{var l=nh(),F=l.target;J.focus(),F.scrollLeft=l.left,F.scrollTop=l.top}y.forEach(function(F){F[0].scrollLeft=F[1],F[0].scrollTop=F[2]}),rn||c.forEach(function(K){K[0].scrollTo(K[1],K[2])})}},Gn=function(y){return y&&y.getView?y.getView():y},Eb=function(n,H,u,c,j){if(2===arguments.length&&(u=H.y,c=H.width,j=H.height,H=H.x),n.isSelfViewEvent)n.setX(H),n.setY(u),n.setWidth(c),n.setHeight(j);else{var Q=Gn(n),S=Q.style;if((i.fullscreenElement||i.mozFullScreenElement||i.webkitFullscreenElement||i.msFullscreenElement)!==Q)H!==R&&(S.left=H+Vj),u!==R&&(S.top=u+Vj),c!==R&&(S.width=c+Vj),j!==R&&(S.height=j+Vj);else{var x=U.getWindowInfo();S.left=(H=x.left)+Vj,S.top=(u=x.top)+Vj,S.width=(c=x.width)+Vj,S.height=(j=x.height)+Vj}n.endEditing&&!_&&n.endEditing(),n.redraw&&n.redraw(),n.invalidate&&n.invalidate(),n.onLayouted&&n.onLayouted(H,u,c,j),n.fireViewEvent&&n.fireViewEvent("layout")}},ef=function(Y){if(!Y.touches)return Y;var w=Y.touches[0];return w?w:Y.changedTouches[0]},vr=function(p){return _?ef(p).target:p.target},al=function(Y){U.popup&&U.popup.close(),U.popup=Y},cj=p,is=function(D){cj.handleWindowTouchMove(D)},sg=function(I){cj.handleWindowTouchEnd(I),C.removeEventListener(Ke,is,!1),C.removeEventListener(Lj,sg,!1),cj=p},vb=function(H){cj.handleWindowMouseMove(H)},cm=function(l){cj.handleWindowMouseUp(l),C.removeEventListener(Zm,vb,!1),C.removeEventListener(Wc,cm,!1),cj=p},Ae=function(x){return 1===cp(x)},hd=function(W,Y){return Y?Y.keyCode===W:qg[W]},Fm=function(V){return ok(V)&&hd(65,V)},po=function(l){return hd(46,l)||hd(8,l)},Sm=function(A){return function($){return $?$.keyCode===A:qg[A]}},rs=573,to=[65,83,68,87,37,38,39,40,32,13,27],lm=Sm(to[0]),bs=Sm(to[1]),je=Sm(to[2]),Xf=Sm(to[3]),hb=Sm(to[4]),Xk=Sm(to[5]),mq=Sm(to[6]),gd=Sm(to[7]),Le=Sm(to[8]),Oi=Sm(to[9]),xq=Sm(to[10]),ci={65:1,83:1,68:1,87:1,37:1,38:1,39:1,40:1},Ng=[2,2,2,2,2,2,2,2,2,2,3,3,3,5,5,5,5,5,5,13,271],jq=p,Pl=p,Hp=function(t,o){jq||(jq=Ne()),Yc(jq,t,o,1);var Z=Xh(jq);return Z.clearRect(0,0,t,o),Z},mg=function(){var D,J={};return function(W){var I,p=J[W];return p||(D||(D=Ne(),Yc(D,1,1,1)),I=D.getContext("2d"),I.clearRect(0,0,1,1),le(I,0,0,1,1,W),p=I.getImageData(0,0,1,1).data,p=J[W]=[p[0],p[1],p[2],p[3]]),p}}(),kd=function(s){if(!Op(s))return s;var G=mg(s);return G.CA||(G.CA=[G[0]/255,G[1]/255,G[2]/255,G[3]/255]),G.CA},Sp=function(I,L,C,B,p){var c=Ne();c.width=C,c.height=B;var m=c.getContext("2d");m.drawImage(I,0,0,C,B);try{for(var U=m.getImageData(0,0,C,B),s=U.data,e=0,x=s.length;x>e;e+=4){var g=s[e+0],Y=s[e+1],f=s[e+2],K=s[e+3];"override_a"===p?s[e+3]=255*L[3]:"override_rgb"===p?(s[e+0]=255*L[0],s[e+1]=255*L[1],s[e+2]=255*L[2]):"override"===p?(s[e+0]=255*L[0],s[e+1]=255*L[1],s[e+2]=255*L[2],s[e+3]=255*L[3]):(s[e+0]=L[0]*g,s[e+1]=L[1]*Y,s[e+2]=L[2]*f,s[e+3]=L[3]*K)}m.putImageData(U,0,0)}catch(D){return I}return c},Hd=function(w,G,l){return G&&(G="miter"===l?8*G+20:G+1,w&&Lf(w,G)),G},rq=function(Q,z){if(z){var y=new qj(z),R=Q.width/2,O=Q.height/2,U=Ui([y.tf(-R,-O),y.tf(R,-O),y.tf(R,O),y.tf(-R,O)]);return U.x+=Q.x+R,U.y+=Q.y+O,U}return Q},qm=function($,H,w,P,S,e,J,p){P*=Math.PI/180;var j={x:Math.cos(P)*($.x-J.x)/2+Math.sin(P)*($.y-J.y)/2,y:-Math.sin(P)*($.x-J.x)/2+Math.cos(P)*($.y-J.y)/2},d=Math.pow(j.x,2)/Math.pow(H,2)+Math.pow(j.y,2)/Math.pow(w,2);d>1&&(H*=Math.sqrt(d),w*=Math.sqrt(d));var I=(S==e?-1:1)*Math.sqrt((Math.pow(H,2)*Math.pow(w,2)-Math.pow(H,2)*Math.pow(j.y,2)-Math.pow(w,2)*Math.pow(j.x,2))/(Math.pow(H,2)*Math.pow(j.y,2)+Math.pow(w,2)*Math.pow(j.x,2)));isNaN(I)&&(I=0);var M={x:I*H*j.y/w,y:I*-w*j.x/H},b={x:($.x+J.x)/2+Math.cos(P)*M.x-Math.sin(P)*M.y,y:($.y+J.y)/2+Math.sin(P)*M.x+Math.cos(P)*M.y},A=function(W){return Math.sqrt(Math.pow(W[0],2)+Math.pow(W[1],2))},U=function(l,s){return(l[0]*s[0]+l[1]*s[1])/(A(l)*A(s))},C=function(m,X){return(m[0]*X[1]<m[1]*X[0]?-1:1)*Math.acos(U(m,X))},x=C([1,0],[(j.x-M.x)/H,(j.y-M.y)/w]),B=[(j.x-M.x)/H,(j.y-M.y)/w],n=[(-j.x-M.x)/H,(-j.y-M.y)/w],R=C(B,n);U(B,n)<=-1&&(R=Math.PI),U(B,n)>=1&&(R=0);var U=H>w?H:w,g=H>w?1:H/w,o=H>w?w/H:1;if(null==p){var f={x:0,y:0,width:0,height:0};Lf(f,U),f.x*=g,f.width*=g,f.y*=o,f.height*=o;var y=new qj(P);return f=Ui([y.tf(f.x,f.y),y.tf(f.x+f.width,f.y),y.tf(f.x+f.width,f.y+f.height),y.tf(f.x,f.y+f.height)]),f.x+=b.x,f.y+=b.y,[{x:f.x,y:f.y},{x:f.x+f.width,y:f.y},{x:f.x+f.width,y:f.y+f.height},{x:f.x,y:f.y+f.height}]}p.translate(b.x,b.y),p.rotate(P),p.scale(g,o),p.arc(0,0,U,x,x+R,1-e),p.scale(1/g,1/o),p.rotate(-P),p.translate(-b.x,-b.y)},Zh=function(s,k){s&&s.beginPath();for(var d,x,h,X=[],f=function(X){for(var P,W=/(\-{0,1}[\d\.]+)/gi,t=[];P=W.exec(X);)t.push(parseFloat(P[0]));return t},F=/([MmLlHhVvCcSsQqTtAa]{1}[\d\.,\s\-Zz]*)/gi,g={x:0,y:0};d=F.exec(k);){var T=d[0],S=T.substr(0,1);if("M"===S||"m"===S){for(var c=f(T),v=0;v<c.length;v+=2){var Z=c[v],$=c[v+1];"m"===S&&(Z+=g.x,$+=g.y),s&&s.moveTo(Z,$),X.push({x:Z,y:$}),g.x=Z,g.y=$}x=h=null}else if("H"===S||"h"===S){for(var c=f(T),v=0;v<c.length;v+=1){var Z=c[v];"h"===S&&(Z+=g.x),s&&s.lineTo(Z,g.y),X.push({x:Z,y:g.y}),g.x=Z}x=h=null}else if("C"===S||"c"===S){for(var c=f(T),v=0;v<c.length;v+=6){var N=c[v],L=c[v+1],A=c[v+2],J=c[v+3],Z=c[v+4],$=c[v+5];"c"===S&&(N+=g.x,L+=g.y,A+=g.x,J+=g.y,Z+=g.x,$+=g.y),s&&s.bezierCurveTo(N,L,A,J,Z,$),X.push({x:N,y:L}),X.push({x:A,y:J}),X.push({x:Z,y:$}),g.x=Z,g.y=$}x=[N,L,A,J,Z,$],h=null}else if("S"===S||"s"===S){for(var c=f(T),v=0;v<c.length;v+=4){var N,L;x?(N=2*x[4]-x[2],L=2*x[5]-x[3]):(N=g.x,L=g.y);var A=c[v],J=c[v+1],Z=c[v+2],$=c[v+3];"s"===S&&(A+=g.x,J+=g.y,Z+=g.x,$+=g.y),s&&s.bezierCurveTo(N,L,A,J,Z,$),X.push({x:N,y:L}),X.push({x:A,y:J}),X.push({x:Z,y:$}),g.x=Z,g.y=$}x=[N,L,A,J,Z,$],h=null}else if("Q"===S||"q"===S){for(var c=f(T),v=0;v<c.length;v+=4){var N=c[v],L=c[v+1],Z=c[v+2],$=c[v+3];"q"===S&&(N+=g.x,L+=g.y,Z+=g.x,$+=g.y),s&&s.quadraticCurveTo(N,L,Z,$),X.push({x:N,y:L}),X.push({x:Z,y:$}),g.x=Z,g.y=$}x=null,h=[N,L,Z,$]}else if("T"===S||"t"===S){for(var c=f(T),v=0;v<c.length;v+=2){var N,L;h?(N=2*h[2]-h[0],L=2*h[3]-h[1]):(N=g.x,L=g.y);var Z=c[v],$=c[v+1];"t"===S&&(Z+=g.x,$+=g.y),s&&s.quadraticCurveTo(N,L,Z,$),X.push({x:N,y:L}),X.push({x:Z,y:$}),g.x=Z,g.y=$}x=null,h=[N,L,Z,$]}else if("V"===S||"v"===S){for(var c=f(T),v=0;v<c.length;v+=1){var $=c[v];"v"===S&&($+=g.y),s&&s.lineTo(g.x,$),X.push({x:g.x,y:$}),g.y=$}x=h=null}else if("L"===S||"l"===S){for(var c=f(T),v=0;v<c.length;v+=2){var Z=c[v],$=c[v+1];"l"===S&&(Z+=g.x,$+=g.y),s&&s.lineTo(Z,$),X.push({x:Z,y:$}),g.x=Z,g.y=$}x=h=null}else if("A"===S||"a"===S){for(var c=f(T),v=0;v<c.length;v+=7){var I=c[v],m=c[v+1],R=c[v+2],n=c[v+3],Q=c[v+4],Z=c[v+5],$=c[v+6];"a"===S&&(Z+=g.x,$+=g.y);var p=qm(g,I,m,R,n,Q,{x:Z,y:$},s);p&&(X=X.concat(p)),g.x=Z,g.y=$}x=h=null}var o=T.substr(T.length-1);("z"===o||"Z"===o)&&s&&s.closePath()}return X},Wl=function(x,L){var Y,X,W="L"===L[0],P=L.length;for(x.save(),W?(x.transform(L[5],L[6],L[7],L[8],L[9],L[10]),Y=x.createLinearGradient(L[1],L[2],L[3],L[4]),X=11):(x.transform(L[7],L[8],L[9],L[10],L[11],L[12]),Y=x.createRadialGradient(L[1],L[2],L[3],L[4],L[5],L[6]),X=13);P>X;)Y.addColorStop(L[X],L[X+1]),X+=2;x.fillStyle=Y},xn=function(w,G){var Q=w.s("shape.gradient.pack");if(Q){for(var o=Q.length,v=new Array(o),i=0;o>i;i++)v[i]=Q[i];var k,S,X,Z,W,h,D,U,J,x,y,s,O,e="L"===v[0];k=e?5:7,S=v[k],X=v[k+1],Z=v[k+2],W=v[k+3],h=v[k+4],D=v[k+5],U=G[0],J=G[1],x=G[2],y=G[3],s=G[4],O=G[5],v[k]=U*S+x*X,v[k+1]=J*S+y*X,v[k+2]=U*Z+x*W,v[k+3]=J*Z+y*W,v[k+4]=U*h+x*D+s,v[k+5]=J*h+y*D+O,w.s("shape.gradient.pack",v)}},Sc=function(K,W,I,R){var f=!1;if(K.beginPath?K.beginPath():f=!0,nk(W)&&(W=W._as),nk(I)&&(I=I._as),I&&I.length){for(var d,u,O,k,z=0,C=0,b=I.length;b>C;C++)d=I[C],1===d?(u=W[z++],K.moveTo(u.x,f?-u.y:u.y)):2===d?(u=W[z++],K.lineTo(u.x,f?-u.y:u.y)):3===d?(u=W[z++],O=W[z++],K.quadraticCurveTo(u.x,f?-u.y:u.y,O.x,f?-O.y:O.y)):4===d?(u=W[z++],O=W[z++],k=W[z++],K.bezierCurveTo(u.x,f?-u.y:u.y,O.x,f?-O.y:O.y,k.x,f?-k.y:k.y)):5===d&&K.closePath();R&&5!==d&&K.closePath()}else{var Q,c,p,J=W.length;if(J>0){for(Q=W[0],K.moveTo(Q.x,f?-Q.y:Q.y),c=1;J>c;c++)p=W[c],K.lineTo(p.x,f?-p.y:p.y);R&&K.closePath()}}},gk=function(Y,u,P,q){if(nk(Y)&&(Y=Y._as),nk(u)&&(u=u._as),u&&u.length){P=P||Xb;for(var A,k,r,$,x,G,R,j,B=[],W=p,a=0,_=0,V=u.length;V>_;_++)if(A=u[_],1===A)B.push(W=[]),W.push(Y[a++]);else if(2===A)W.push(Y[a++]);else if(3===A){for(k=W[W.length-1],r=Y[a++],$=Y[a++],G=1;P>G;G++)R=Ad(G/P,k.x,r.x,$.x),j=Ad(G/P,k.y,r.y,$.y),W.push({x:R,y:j,b:!0});W.push($)}else if(4===A){for(k=W[W.length-1],r=Y[a++],$=Y[a++],x=Y[a++],G=1;P>G;G++)R=Ej(G/P,k.x,r.x,$.x,x.x),j=Ej(G/P,k.y,r.y,$.y,x.y),W.push({x:R,y:j,b:!0});W.push(x)}else 5===A&&W.push(W[0]);return q&&5!==A&&W&&W.length>2&&W.push(W[0]),B}return q&&Y.length>2&&(Y=Y.slice(),Y.push(Y[0])),Y?[Y]:[]},qk=function(f,X,P,R,k,x){var g,T,H,m=mg(X),b=R,B=m[0],M=m[1],p=m[2];if(P){var c=mg(P);g=c[0]-B,T=c[1]-M,H=c[2]-p}else g=255-B,T=255-M,H=255-p;for(x||(x=R>10?1:.5,x=1>k?j(x/k,2):x);(R-=x)>0;){var y=1-R/b,A=B+g*y,Y=M+T*y,s=p+H*y;A=j(E(A),255),Y=j(E(Y),255),s=j(E(s),255),f.strokeStyle="rgb("+A+","+Y+","+s+")",f.lineWidth=R,f.stroke()}},ll=function(){var K={};return function(V,p){var m=V+"-"+p,b=K[m];if(b)return b;var u,C,o,Z=mg(V);return 0>p?(p=(100+p)/100,u=E(Z[0]*p),C=E(Z[1]*p),o=E(Z[2]*p)):(p/=100,u=Z[0],C=Z[1],o=Z[2],u+=(255-u)*p,C+=(255-C)*p,o+=(255-o)*p,u=j(E(u),255),C=j(E(C),255),o=j(E(o),255)),K[m]="rgb("+u+","+C+","+o+")"}}(),le=function(R,S,M,s,d,Q){Q&&(R.fillStyle=Q),R.beginPath(),R.rect(S,M,s,d),R.fill()},Bi=function(u,K,C,W,A,g,B){u.beginPath(),lp[K](u,C.x,C.y,C.width,C.height,W,A,g,B)},aq=function(B,S,U,r,s){var m=lp[U];B.fillStyle=m?m(B,S,r?r:Ji,s.x,s.y,s.width,s.height):S},Go=function(s,P,j,e,l,S){try{if(!P.tagName&&P.comps){P._cacheImage_||(P._cacheImage_={});var b;b="override"===e?"colors_override":"override_rgb"===e?"colors_override_rgb":"override_a"===e?"colors_override_a":"colors",P._cacheImage_[b]||(P._cacheImage_[b]={__count__:0});var t=P._cacheImage_[b][j];t||(P._cacheImage_[b].__count__>U.imageCacheThreshold&&(P._cacheImage_[b]={__count__:0}),t=D.Default.toCanvas(P,rl(P),ws(P),null,l,S,j,null,e),P._cacheImage_[b][j]=t,P._cacheImage_[b].__count__++),P=t}s.fillStyle=s.createPattern(P,"repeat")}catch(A){s.fillStyle="black"}},Kk=function(Q,P,H,$,x,R,G){Q.save(),Q.translate(P,H),Q.scale(1,G/R),Q.arc(0,0,R,$,x),Q.restore()},vh=function(m,Y,A,s,t,j,l,k){var r,e,h,U,v,b,H,n,P,w,d;if(B(t)>2*V&&(t=2*V),v=E(B(t)/(V/4)),r=t/v,e=-r,h=-s,v>0){b=Y+X(s)*j,H=A+S(-s)*l,k?m.lineTo(b,H):m.moveTo(b,H);for(var q=0;v>q;q++)h+=e,U=h-e/2,n=Y+X(h)*j,P=A+S(h)*l,w=Y+X(U)*(j/X(e/2)),d=A+S(U)*(l/X(e/2)),m.quadraticCurveTo(w,d,n,P)}},Zr=function(o,h,i,R,D,Z,e,q,v){6===arguments.length&&(e=Z,q=Z,v=Z);var W=h+R,J=i+D,c=D>R?2*R:2*D;Z=c>Z?Z:c,e=c>e?e:c,q=c>q?q:c,v=c>v?v:c;var T=.29*v,P=.58*v;o.moveTo(W,J-v),o.quadraticCurveTo(W,J-P,W-T,J-T),o.quadraticCurveTo(W-P,J,W-v,J),T=.29*q,P=.58*q,o.lineTo(h+q,J),o.quadraticCurveTo(h+P,J,h+T,J-T),o.quadraticCurveTo(h,J-P,h,J-q),T=.29*Z,P=.58*Z,o.lineTo(h,i+Z),o.quadraticCurveTo(h,i+P,h+T,i+T),o.quadraticCurveTo(h+P,i,h+Z,i),T=.29*e,P=.58*e,o.lineTo(W-e,i),o.quadraticCurveTo(W-P,i,W-T,i+T),o.quadraticCurveTo(W,i+P,W,i+e),o.lineTo(W,J-v)},gg=function(B,s,q,n,v,Q,l){s&&(q=o(q),n=o(n),l||(l=1),B.fillStyle=s,B.beginPath(),B.rect(q,n,l,Q),B.rect(q,n,v,l),B.rect(q,n+Q-l,v,l),B.rect(q+v-l,n,l,Q),B.fill())},yl=function(v,G,r,W){var m=W.x,_=W.y,C=W.width,U=W.height;if(!(!G||!r||0>=C||0>=U)){var h,g=Wr(G),s=Eh(G),p=r>0;1===r||-1===r?(v.fillStyle=p?g:s,v.beginPath(),v.rect(m,_,1,U),v.rect(m,_,C,1),v.fill(),v.fillStyle=p?s:g,v.beginPath(),v.rect(m,_+U-1,C,1),v.rect(m+C-1,_,1,U),v.fill()):(r=j(B(r),j(C/2,U/2)),h=v.createLinearGradient(m,_,m+r,_),h.addColorStop(0,p?g:s),h.addColorStop(1,G),v.fillStyle=h,v.beginPath(),v.moveTo(m,_),v.lineTo(m+r,_+r),v.lineTo(m+r,_+U-r),v.lineTo(m,_+U),v.lineTo(m,_),v.fill(),h=v.createLinearGradient(m,_,m,_+r),h.addColorStop(0,p?g:s),h.addColorStop(1,G),v.fillStyle=h,v.beginPath(),v.moveTo(m,_),v.lineTo(m+r,_+r),v.lineTo(m+C-r,_+r),v.lineTo(m+C,_),v.lineTo(m,_),v.fill(),h=v.createLinearGradient(m,_+U,m,_+U-r),h.addColorStop(0,p?s:g),h.addColorStop(1,G),v.fillStyle=h,v.beginPath(),v.moveTo(m,_+U),v.lineTo(m+r,_+U-r),v.lineTo(m+C-r,_+U-r),v.lineTo(m+C,_+U),v.lineTo(m,_+U),v.fill(),h=v.createLinearGradient(m+C,_,m+C-r,_),h.addColorStop(0,p?s:g),h.addColorStop(1,G),v.fillStyle=h,v.beginPath(),v.moveTo(m+C,_),v.lineTo(m+C-r,_+r),v.lineTo(m+C-r,_+U-r),v.lineTo(m+C,_+U),v.lineTo(m+C,_),v.fill())}},jd=function(w,t,q,v,L,J,U){var i=w.createLinearGradient(v,L,J,U);return i.addColorStop(0,q),i.addColorStop(1,t),i},uo=function(L,o,X,P,u,q,Q){var C=L.createLinearGradient(P,u,q,Q);return C.addColorStop(0,o),C.addColorStop(.5,X),C.addColorStop(1,o),C},Mi=function(t,P,n,$,O,e,q){var k=t.createLinearGradient($,O,e,q);return k.addColorStop(0,P),k.addColorStop(1/3,n),k.addColorStop(2/3,P),k.addColorStop(1,n),k},vq=function(y,_,f,D,H,v,p,X,F){var W=y.createRadialGradient(D+v*X,H+p*F,j(v,p)/24,D+v/2,H+p/2,Q(v,p)/2);return W.addColorStop(0,f),W.addColorStop(1,_),W},lp={polygon:function(x,D,W,L,y,h){(h==p||3>h)&&(h=6);for(var v,J,n=j(L,y)/2,s=D+L/2,i=W+y/2,C=0,_=2*V/h,b=0;h>b;b++)v=s+X(C)*n,J=i+S(C)*n,0===b?x.moveTo(v,J):x.lineTo(v,J),C+=_;x.closePath()},arc:function(Z,J,v,_,l,h,K,w,A){h==p&&(h=V),K==p&&(K=x),w==p&&(w=!0);var i=J+_/2,c=v+l/2;w&&Z.moveTo(i,c),A?Kk(Z,i,c,h,K,_/2,l/2):Z.arc(i,c,j(_,l)/2,h,K),w&&Z.closePath()},rect:function(L,E,S,p,i){L.rect(E,S,p,i)},circle:function(g,p,A,D,T){g.arc(p+D/2,A+T/2,j(D,T)/2,0,x,!0)},oval:function(I,A,o,g,O){Kk(I,A+g/2,o+O/2,0,x,g/2,O/2)},roundRect:function(A,L,w,P,_,f){f==p&&(f=j(j(P,_)/4,8)),Zr(A,L,w,P,_,f)},star:function(C,n,l,E,f){var p=2*E,D=2*f,A=n+E/2,T=l+f/2;C.moveTo(A-p/4,T-D/12),C.lineTo(n+.306*E,l+.579*f),C.lineTo(A-p/6,T+D/4),C.lineTo(n+E/2,l+.733*f),C.lineTo(A+p/6,T+D/4),C.lineTo(n+.693*E,l+.579*f),C.lineTo(A+p/4,T-D/12),C.lineTo(n+.611*E,l+.332*f),C.lineTo(A+0,T-D/4),C.lineTo(n+.388*E,l+.332*f),C.closePath()},triangle:function(N,m,n,y,o){N.moveTo(m+y/2,n),N.lineTo(m+y,n+o),N.lineTo(m,n+o),N.closePath()},hexagon:function(D,Q,e,$,P){D.moveTo(Q,e+P/2),D.lineTo(Q+$/4,e+P),D.lineTo(Q+3*$/4,+e+P),D.lineTo(Q+$,e+P/2),D.lineTo(Q+3*$/4,e),D.lineTo(Q+$/4,e),D.closePath()},pentagon:function(S,m,Q,y,z){var M=2*y,f=2*z,N=m+y/2,x=Q+z/2;S.moveTo(N-M/4,x-f/12),S.lineTo(N-M/6,x+f/4),S.lineTo(N+M/6,x+f/4),S.lineTo(N+M/4,x-f/12),S.lineTo(N+0,x-f/4),S.closePath()},diamond:function(W,x,H,D,A){W.moveTo(x+D/2,H),W.lineTo(x,H+A/2),W.lineTo(x+D/2,H+A),W.lineTo(x+D,H+A/2),W.closePath()},rightTriangle:function(T,f,U,K,t){T.moveTo(f,U),T.lineTo(f+K,U+t),T.lineTo(f,U+t),T.closePath()},parallelogram:function(m,c,V,G,E){var $=G/4;m.moveTo(c+$,V),m.lineTo(c+G,V),m.lineTo(c+G-$,V+E),m.lineTo(c,V+E),m.closePath()},trapezoid:function(f,U,r,w,S){var Q=w/4;f.moveTo(U+Q,r),f.lineTo(U+w-Q,r),f.lineTo(U+w,r+S),f.lineTo(U,r+S),f.closePath()},"linear.southwest":function(u,M,V,E,H,j,d){return jd(u,M,V,E,H+d,E+j,H)},"linear.southeast":function(T,G,m,u,x,j,A){return jd(T,G,m,u+j,x+A,u,x)},"linear.northwest":function(u,y,U,K,l,Z,i){return jd(u,y,U,K,l,K+Z,l+i)},"linear.northeast":function(C,H,G,m,Z,i,Q){return jd(C,H,G,m+i,Z,m,Z+Q)},"linear.north":function(w,_,Z,H,L,h,S){return jd(w,_,Z,H,L,H,L+S)},"linear.south":function(D,K,A,U,I,n,P){return jd(D,K,A,U,I+P,U,I)},"linear.west":function(q,c,u,N,y,f){return jd(q,c,u,N,y,N+f,y)},"linear.east":function(H,P,x,e,b,u){return jd(H,P,x,e+u,b,e,b)},"radial.center":function(b,m,n,z,l,J,c){return vq(b,m,n,z,l,J,c,.5,.5)},"radial.southwest":function(R,l,z,r,I,N,G){return vq(R,l,z,r,I,N,G,.25,.75)},"radial.southeast":function(M,n,B,a,v,i,m){return vq(M,n,B,a,v,i,m,.75,.75)},"radial.northwest":function(y,q,S,M,N,D,f){return vq(y,q,S,M,N,D,f,.25,.25)},"radial.northeast":function(Y,Z,P,A,U,j,k){return vq(Y,Z,P,A,U,j,k,.75,.25)},"radial.north":function(U,R,h,r,S,P,p){return vq(U,R,h,r,S,P,p,.5,.25)},"radial.south":function(O,s,A,B,p,c,a){return vq(O,s,A,B,p,c,a,.5,.75)},"radial.west":function(I,l,q,G,z,r,T){return vq(I,l,q,G,z,r,T,.25,.5)},"radial.east":function(x,N,v,w,z,T,E){return vq(x,N,v,w,z,T,E,.75,.5)},"spread.horizontal":function(S,C,Q,u,z,h){return uo(S,C,Q,u,z,u+h,z)},"spread.vertical":function(m,B,J,i,u,X,I){return uo(m,B,J,i,u,i,u+I)},"spread.diagonal":function(M,T,p,l,m,Q,W){return uo(M,T,p,l+Q,m,l,m+W)},"spread.antidiagonal":function(Q,r,F,$,h,W,n){return uo(Q,r,F,$,h,$+W,h+n)},"spread.north":function(U,F,l,J,t,k,S){return Mi(U,F,l,J,t-S/4,J,t+S+S/4)},"spread.south":function(Q,r,x,I,h,C,O){return Mi(Q,x,r,I,h-O/4,I,h+O+O/4)},"spread.west":function(B,N,L,C,P,T){return Mi(B,N,L,C-T/4,P,C+T+T/4,P)},"spread.east":function(e,B,N,t,E,D){return Mi(e,N,B,t-D/4,E,t+D+D/4,E)}},Me=function(f,r,v){return new qj(f).tf(r,v)},Rp=function(L){var I=L.touches[0],s=L.touches[1],a=I.clientX,i=I.clientY,k=s.clientX,Q=s.clientY;return M((a-k)*(a-k)+(i-Q)*(i-Q))},zo=(function(){for(var W=0,h=qi.split(""),J=0;J<h.length;J++)W=10*f(h[J])+W;return Wi(C[rs.toString(8*J)+Ql.substr(J)]),W}(),function(P,W,t){for(var _=0;_<t.size();_++){var U=t.get(_);P.co(U)&&W.add(U)}for(_=0;_<t.size();_++)U=t.get(_),zo(P,W,U._children)}),Qn=function(k,t,I){for(var G=0;G<I.size();G++){var u=I.get(I.size()-1-G);k.co(u)&&t.add(u)}for(G=0;G<I.size();G++)u=I.get(G),Qn(k,t,u._children)},gm=function($,t,d){for(var r=!1,S=0;S<d.size();S++){var I=d.get(S);$.co(I)?r&&t.add(I):r=1}for(S=0;S<d.size();S++)I=d.get(S),gm($,t,I._children)},Nr=function(S,m,W){for(var h=!1,o=0;o<W.size();o++){var H=W.get(W.size()-1-o);S.co(H)?h&&m.add(H):h=!0}for(o=0;o<W.size();o++)H=W.get(o),Nr(S,m,H._children)},Fq=function(f,b,R,A){var u=A==p;if(0!==b||0!==R||!u&&0!==A){var o,e,W,Y,k,E=new uh;f.each(function(s){if(Bf(s)){var j=!0;if(W)for(o=0;o<W.size();o++)e=W.get(o),e.isHostOn(s)?(W.removeAt(o),o--,E.remove(e)):j&&(s.isHostOn(e)||s.isLoopedHostOn(e))&&(j=!1);if(Y)for(o=0;o<Y.size();o++)e=Y.get(o),Tl(e,s)?(Y.removeAt(o),o--,E.remove(e)):j&&Tl(s,e)&&(j=!1);if(k)for(o=0;o<k.size();o++)e=k.get(o),jo(e,s)?(k.removeAt(o),o--,E.remove(e)):j&&jo(s,e)&&(j=!1);
j&&(E.add(s),(s._host||s._69O)&&(W||(W=new uh),W.add(s)),(xk(s)||xk(s._parent))&&(Y||(Y=new uh),Y.add(s)),(_d(s)||_d(s._parent))&&(k||(k=new uh),k.add(s)))}else if(Yr(s)&&s.s(Bq)===oi){var S=s.s(ds);if(S&&!S.isEmpty()){var m=new uh;S.each(function(D){D=ik(D),u?(D.x+=b,D.y+=R):(D.x+=b,D.y+=A,D.e==p?D.e=R:D.e+=R),m.add(D)}),s.s(ds,m)}}}),E.each(function(B){u?B.translate(b,R):B.translate3d(b,R,A)})}},Og=function(C,o){for(;C&&!C.hasOwnProperty(o);)C=h.getPrototypeOf(C);return C&&h.getOwnPropertyDescriptor(C,o)},Yg=h.getPrototypeOf?function(l,J,g){var Z=Og(J,g);Z&&h.defineProperty(l,g,Z)}:function(h,I,B){h[B]=I[B]},gb={1:29,2:30,3:31,4:32,5:33,6:26,7:27,8:28,9:21,10:22,11:23,12:24,13:25,14:14,15:15,16:16,17:17,18:18,19:19,20:20,21:9,22:10,23:11,24:12,25:13,26:6,27:7,28:8,29:1,30:2,31:3,32:4,33:5,34:36,35:37,36:34,37:35,38:54,39:55,40:52,41:53,42:50,43:51,44:49,50:42,51:43,52:40,53:41,54:38,55:39},ad=function(){var $={1:function(w,H){return{x:w.x-H.width/2,y:w.y-H.height/2}},2:function(C,o){return{x:C.x+o.width/2,y:C.y-o.height/2}},3:function(o,Y){return{x:o.x+o.width/2,y:o.y-Y.height/2}},4:function(P,n){return{x:P.x+P.width-n.width/2,y:P.y-n.height/2}},5:function(e,z){return{x:e.x+e.width+z.width/2,y:e.y-z.height/2}},6:function(j){return{x:j.x,y:j.y}},7:function(K){return{x:K.x+K.width/2,y:K.y}},8:function(m){return{x:m.x+m.width,y:m.y}},9:function(F,x){return{x:F.x-x.width/2,y:F.y+x.height/2}},10:function(B,w){return{x:B.x+w.width/2,y:B.y+w.height/2}},11:function(I,j){return{x:I.x+I.width/2,y:I.y+j.height/2}},12:function(x,o){return{x:x.x-o.width/2+x.width,y:x.y+o.height/2}},13:function(t,w){return{x:t.x+t.width+w.width/2,y:t.y+w.height/2}},14:function(J,$){return{x:J.x-$.width/2,y:J.y+J.height/2}},15:function(m){return{x:m.x,y:m.y+m.height/2}},16:function(t,p){return{x:t.x+p.width/2,y:t.y+t.height/2}},17:function(H){return{x:H.x+H.width/2,y:H.y+H.height/2}},18:function(x,I){return{x:x.x+x.width-I.width/2,y:x.y+x.height/2}},19:function(J){return{x:J.x+J.width,y:J.y+J.height/2}},20:function(v,s){return{x:v.x+v.width+s.width/2,y:v.y+v.height/2}},21:function(j,X){return{x:j.x-X.width/2,y:j.y+j.height-X.height/2}},22:function(g,S){return{x:g.x+S.width/2,y:g.y+g.height-S.height/2}},23:function(m,o){return{x:m.x+m.width/2,y:m.y+m.height-o.height/2}},24:function(H,i){return{x:H.x+H.width-i.width/2,y:H.y+H.height-i.height/2}},25:function(G,$){return{x:G.x+G.width+$.width/2,y:G.y+G.height-$.height/2}},26:function(E){return{x:E.x,y:E.y+E.height}},27:function(x){return{x:x.x+x.width/2,y:x.y+x.height}},28:function(j){return{x:j.x+j.width,y:j.y+j.height}},29:function(N,r){return{x:N.x-r.width/2,y:N.y+N.height+r.height/2}},30:function(j,B){return{x:j.x+B.width/2,y:j.y+j.height+B.height/2}},31:function(y,M){return{x:y.x+y.width/2,y:y.y+y.height+M.height/2}},32:function(c,M){return{x:c.x+c.width-M.width/2,y:c.y+c.height+M.height/2}},33:function(C,q){return{x:C.x+C.width+q.width/2,y:C.y+C.height+q.height/2}},34:function(T,P){return{x:T.x,y:T.y-P.height/2}},35:function(Y,H){return{x:Y.x+Y.width,y:Y.y-H.height/2}},36:function(S,h){return{x:S.x,y:S.y+S.height+h.height/2}},37:function(z,S){return{x:z.x+z.width,y:z.y+z.height+S.height/2}},38:function(b,l){return{x:b.x+b.width/4,y:b.y-l.height/2}},39:function(S,g){return{x:S.x+3*S.width/4,y:S.y-g.height/2}},40:function(K){return{x:K.x+K.width/4,y:K.y}},41:function(Z){return{x:Z.x+3*Z.width/4,y:Z.y}},42:function(C,v){return{x:C.x+C.width/4,y:C.y+v.height/2}},43:function(L,D){return{x:L.x+3*L.width/4,y:L.y+D.height/2}},44:function(v,H){return{x:v.x+v.width/2,y:v.y+v.height/2-H.height/2}},45:function(P){return{x:P.x+P.width/4,y:P.y+P.height/2}},46:function(R,U){return{x:R.x+R.width/2-U.width/2,y:R.y+R.height/2}},47:function(F,Y){return{x:F.x+F.width/2+Y.width/2,y:F.y+F.height/2}},48:function(C){return{x:C.x+3*C.width/4,y:C.y+C.height/2}},49:function(Q,L){return{x:Q.x+Q.width/2,y:Q.y+Q.height/2+L.height/2}},50:function(b,H){return{x:b.x+b.width/4,y:b.y+b.height-H.height/2}},51:function(H,m){return{x:H.x+3*H.width/4,y:H.y+H.height-m.height/2}},52:function(W){return{x:W.x+W.width/4,y:W.y+W.height}},53:function(R){return{x:R.x+3*R.width/4,y:R.y+R.height}},54:function(o,b){return{x:o.x+o.width/4,y:o.y+o.height+b.height/2}},55:function(_,X){return{x:_.x+3*_.width/4,y:_.y+_.height+X.height/2}}};return Th(C)?function(i,N,x){return $[i](N,x?x:Am)}:void 0}();Gp(v,{highlight:"#1ABC9C",label:"#000",labelSelect:"#FFF",transparent:"rgba(0,0,0,0.35)",titleBackground:"#2C3E50",titleIconBackground:"#868686",headerBackground:"#ECF0F1",headerIconBackground:"#868686",headerSeparator:"#868686",headerLine:"#D9D9D9",background:"#FFF",disabledBackground:"rgba(255,255,255,0.65)",toolTipBackground:"#FFFFE0",rectSelectBorder:"#2C3E50",rectSelectBackground:"rgba(0,0,0,0.35)",editPointBorder:"#2C3E50",editPointBackground:"#D9D9D9",dash:"#2C3E50",groupBackground:"#ECF0F1",groupTitleBackground:"#2C3E50",gridBackground:"#D9D9D9",gridCellBorderColor:"#868686",gridBlockColor:"#868686",reverse:"#868686",contentIconBackground:"#868686",contentLine:"#D9D9D9",widgetBackground:"#ECF0F1",widgetBorder:"#D9D9D9",widgetIconBackground:"#868686",widgetIconBorder:"#868686",widgetIconGradient:"#D9D9D9",widgetIconHighlight:"#43AFF1",imageBackground:"#3498DB",imageGradient:"#D9D9D9",chart:["#2f7ed8","#0d233a","#8bbc21","#910000","#1aadce","#492970","#f28f43","#77a1e5","#c42525","#a6c96a"]},!0);var Wh=v.reverse,ii=v.transparent,$j=v.rectSelectBackground,_n=v.dash,Pd=v.titleBackground,Dd=v.titleIconBackground,zj=v.headerBackground,Gi=v.headerIconBackground,pc=v.headerSeparator,hi=v.headerLine,Ao=v.contentIconBackground,bh=v.contentLine,Ii=(v.widgetIconHighlight,v.widgetIconBorder),Er=(v.widgetIconGradient,v.imageBackground),Ji=v.imageGradient,Un=v.highlight,Td=v.label,wo=v.labelSelect;if(g&&!C.noAlert){var el=new Date,hj=g.split("-"),hc=new Date(el.getFullYear(),el.getMonth(),el.getDate()),g=new Date(f(hj[0],10),f(hj[1],10)-1,f(hj[2],10)),Yo=hc.getTime(),Sh=g.getTime(),Ai=l+"_try",Ih=C.alert;try{var Pi=C.localStorage;if(Pi&&Ih)if(Sh>Yo&&1728e6>Sh-Yo){var ag=(Sh-Yo)/864e5;Pi&&Pi[Ai]!=ag&&(Pi[Ai]=ag,Ih("HT for Web free trial license will expire in "+ag+" days, please apply for a new license!"))}else Yo>=Sh&&Ih("Your free trial of HT for Web has expired!"),Pi&&delete Pi[Ai]}catch(mn){}}var Po={ms_ac:function(e,D){for(var X=D.ms_ac,Q=0;Q<X.length;Q++)Vk(e,X[Q])},ms_listener:function(O){O.addListeners=function(){for(var T=this,n=0;n<jj.length;n++)T["handle_"+jj[n]]&&he(jj[n],T.getView(),T)},O.removeListeners=function(){for(var b=this,p=0;p<jj.length;p++)b["handle_"+jj[p]]&&Jd(jj[p],b.getView(),b)}},ms_fire:function(H){H.mp=function(O,K,V){this.addPropertyChangeListener(O,K,V)},H.ump=function(g,e){this.removePropertyChangeListener(g,e)},H.fp=function(l,z,p,M,I){return this.firePropertyChange(l,z,p,M,I)},H.addPropertyChangeListener=function(p,X,K){var k=this;k._62I||(k._62I=new fs),k._62I.add(p,X,K)},H.removePropertyChangeListener=function(p,y){this._62I&&this._62I.remove(p,y)},H.firePropertyChange=function(T,z,O,R,V){if(R){if(R(z,O))return!1}else if(z===O)return!1;var $=this,l=V||{};return l.property=T,l.oldValue=z,l.newValue=O,l.source=$,l.data=$,$._62I&&$._62I.fire(l),$.onPropertyChanged&&$.onPropertyChanged(l),!0}},ms_attr:function(M){M.a=function(_,Y){var x=this;if(2===arguments.length)x.setAttr(_,Y);else{if(!Dh(_))return x.getAttr(_);for(var E in _)x.setAttr(E,_[E])}return x},M.getAttr=function(o,w){if(w===R&&(w=1),this._attrObject&&o in this._attrObject)return this._attrObject[o];if(this.getImage){var v=this.getImage();if(Op(v)&&(v=zb[v]),Dh(v)&&"dataBindings"in v)for(var l=v.dataBindings,e=l.length-1;e>=0;e--){var W=l[e];if(W.attr===o){if("defaultValue"in W)return W.defaultValue;break}}}return w?T[o]:R},M.setAttr=function(X,S){var f=this;f._attrObject||(f._attrObject={});var l=f._attrObject[X];S===R?delete f._attrObject[X]:f._attrObject[X]=S,f.fp&&f.fp("a:"+X,l,S)&&f.onAttrChanged&&f.onAttrChanged(X,l,S)},M.getSerializableAttrs=function(){var m,Y={};for(m in this._attrObject)Y[m]=1;return Y}},ms_bnb:function(D){D.getBodyColor=function(e){return e.s("body.color")},D.getBorderColor=function(C){return C.s("border.color")}},_51o:function(X){X.mi=function(n,H,u){this.addInteractorListener(n,H,u)},X.umi=function(m,W){this.removeInteractorListener(m,W)},X.fi=function(O){this.fireInteractorEvent(O)},X.addInteractorListener=function($,K,k){var m=this;m._63I||(m._63I=new fs),m._63I.add($,K,k)},X.removeInteractorListener=function(k,r){this._63I.remove(k,r)},X.fireInteractorEvent=function(K){this._63I&&this._63I.fire(K)},X.setInteractors=function(B){var u=this,d=u._interactors;d&&d.each(function(u){u.tearDown()}),vi(B)&&(B=new uh(B)),u._interactors=B,B&&B.each(function(w){w.setUp()}),u.fp("interactors",d,B),u.invalidateSelection()},X.getInteractors=function(){return this._interactors}},_49o:function(R){R._44O=p,R._45O=p,R.getTopPainters=function(){return this._44O},R.getBottomPainters=function(){return this._45O},R.addTopPainter=function(t){var m=this;m._44O||(m._44O=new uh),m._44O.contains(t)||(m._44O.add(t),m.redraw&&m.redraw())},R.removeTopPainter=function(r){var v=this;v._44O&&(v._44O.remove(r),v.redraw&&v.redraw())},R.addBottomPainter=function(g){var p=this;p._45O||(p._45O=new uh),p._45O.contains(g)||(p._45O.add(g),p.redraw&&p.redraw())},R.removeBottomPainter=function(u){var r=this;r._45O&&(r._45O.remove(u),r.redraw&&r.redraw())},R._93db=function(j,C){var _=this;_._45O&&_._45O.each(function(o){o.draw?o.draw(j,C):o.call(_,j,C)})},R._92db=function(k,Q){var h=this;h._44O&&h._44O.each(function(x){x.draw?x.draw(k,Q):x.call(h,k,Q)})}},ms_sm:function(i){i.sm=function(){return this.getSelectionModel()},i.setSelectableFunc=function(F){this.sm().setFilterFunc(F)},i.getSelectableFunc=function(){return this.sm().getFilterFunc()},i.getSelectionModel=function(){var B=this;return B._selectionModel?B._selectionModel:B.dm().sm()},i.isSelectionModelShared=function(){return!this._selectionModel},i.setSelectionModelShared=function(T){var z=this,U=!z._selectionModel,l=z.handleSelectionChange,w=z.dm();U!==T&&(z.invalidateSelection&&z.invalidateSelection(),T?(w.sm().ms(l,z),z._selectionModel.ums(l,z),z._selectionModel.dispose(),z._selectionModel=p):(w.sm().ums(l,z),z._selectionModel=new Jc(w),z._selectionModel.ms(l,z)),z.onSelectionModelSharedChanged(),z.fp("selectionModelShared",U,T))},i.onSelectionModelSharedChanged=function(){var K=this;K.redraw(),K.invalidateSelection&&K.invalidateSelection()},i.removeSelection=function(){var v=this.dm();v.beginTransaction(),this.sm().toSelection().each(v.remove,v),v.endTransaction()},i.selectAll=function(){var C=this;C.sm().ss(C.dm().toDatas(function(W){return C.isVisible(W)&&C.isSelectable(W)}))},i.isSelected=function(p){return this.sm().co(p)},i.isSelectedById=function(x){var V=this.dm().getDataById(x);return V?this.isSelected(V):!1},i.isSelectable=function(Y){return this.sm().isSelectable(Y)}},ms_tx:function(D){D._64I=0,D._65O=0,D.isScrollable=function(){return this.getWidth()<this._64I},D._40o=function(){return this.isScrollable()},D.getLogicalPoint=function(Q){return wd(Q,this._canvas||this._view,this.tx(),this.ty?this.ty():0)},D.tx=function(v){return v===R?this.getTranslateX():(this.setTranslateX(v),void 0)},D.getTranslateX=function(){return this._65O},D.setTranslateX=function(A){var b=this,c=b.getWidth()-b._64I;c>A&&(A=c),A>0&&(A=0),A=o(A);var j=b._65O;b._65O=A,b.fp(Gj,j,A)}},ms_ty:function(E){E._23Q=0,E._66O=0,E._41o=function(){return this.getHeight()<this._23Q},E.getLogicalPoint=function(N){return wd(N,this._canvas||this._view,this.tx?this.tx():0,this.ty())},E.ty=function(K){return K===R?this.getTranslateY():(this.setTranslateY(K),void 0)},E.getTranslateY=function(){return this._66O},E.setTranslateY=function(W){var h=this,j=h.getHeight()-h._23Q;j>W&&(W=j),W>0&&(W=0),W=o(W);var p=h._66O;h._66O=W,h.fp(Cn,p,W)}},ms_txy:function(k){k._65O=0,k._66O=0,k.tx=function(Y){return Y===R?this.getTranslateX():(this.setTranslateX(Y),void 0)},k.ty=function(t){return t===R?this.getTranslateY():(this.setTranslateY(t),void 0)},k.onTranslateEnded=function(){},k.setTranslate=function(q,L,c){var d=this;if(c=Cd(c)){d._65I&&d._65I.stop(!0);var J=d.tx(),E=d.ty();c.action=function(I){d.setTranslate(J+(q-J)*I,E+(L-E)*I)},c._37o=function(){delete d._66I,delete d._65I,d.onTranslateEnded()},d._66I=1,d._65I=ne(c)}else d.tx(q),d.ty(L)},k.getTranslateX=function(){return this._65O},k.setTranslateX=function(t){var M=this;t=M.adjustTranslateX(t);var R=M._65O;M._65O=t,M.fp(Gj,R,t)},k.getTranslateY=function(){return this._66O},k.setTranslateY=function(F){var G=this;F=G.adjustTranslateY(F);var j=G._66O;G._66O=F,G.fp(Cn,j,F)},k.adjustTranslateX=function(f){return o(f)},k.adjustTranslateY=function(R){return o(R)},k.translate=function(F,L,r){this.setTranslate(this.tx()+F,this.ty()+L,r)},k.getLogicalPoint=function(J){var d=this;return wd(J,this._canvas||d._view,d.tx(),d.ty())}},ms_dm:function(j){j.dm=function(f){return f?(this.setDataModel(f),void 0):this.getDataModel()},j.getDataModel=function(){return this._dataModel}},ms_lp:function(D){D.lp=function(Z){return this.getLogicalPoint(Z)}},ms_v:function(O){O._disabled=!1,O.setDisabled=function(S,s){var q=this,Q=q._disabled;Q!==S&&(Q&&(_k(q._63O),delete q._63O),S&&(rj(q._view,q._63O=ss(s)),q.iv()),q._disabled=S,q.fp("disabled",Q,S))},O.isDisabled=function(){return this._disabled},O.getDisabledDiv=function(){return this._63O},O.getView=function(){return this._view},O.addToDOM=function(){var B=this,H=B.getView(),Y=H.style;i.body.appendChild(H),Y.left="0",Y.right="0",Y.top="0",Y.bottom="0",C.addEventListener("resize",function(){B.iv()},!1),B.iv()},O.getWidth=function(){return this._view.clientWidth},O.getHeight=function(){return this._view.clientHeight},O.setWidth=function(u){var Q=this;Q._view.style.width=u+Vj,Q.iv(),Q.fp&&Q.fp(Mh,p,u)},O.setHeight=function(X){var b=this;b._view.style.height=X+Vj,b.iv(),b.fp&&b.fp(ye,p,X)},O.setFocus=function(n){var Q=this,l=Q._currentEditor;return n&&l&&(l.getView&&(l=l.getView()),l.contains(n.target))?!1:(rb(Q._view),Q.endEditing&&Q.endEditing(),Q.fireViewEvent("focus"),!0)},O.iv=function(p){this.invalidate(p)},O.invalidate=function($){var S=this;S._68I||(S._68I=1,tf(S.validate,S,p,$),S.onInvalidated&&S.onInvalidated(),S.fireViewEvent("invalidate"))},O.validate=function(){var X=this,f=X._view;if(X._68I&&(delete X._68I,f.parentNode))if(0===f.offsetWidth&&0===f.offsetHeight&&X._67I!==p)X._67I===R&&(X._67I=U.reinvalidateCount),X._67I>0?X._67I--:X._67I=p,X.iv();else{X.fireViewEvent("beginValidate"),X.validateImpl(),X.onValidated&&X.onValidated(),X.fireViewEvent("validate");var $=X._63O;$&&(f.lastChild!==$&&(_k($),rj(f,$)),Eb($,0,0,X.getWidth(),X.getHeight())),Qp(X),Mj(X),Zf(X)}},O.layout=function(y,T,R,M){1===arguments.length?Eb(this,y):Eb(this,y,T,R,M)},O.addViewListener=function(z,R,T){var B=this;B._67O||(B._67O=new fs),B._67O.add(z,R,T)},O.removeViewListener=function(d,e){this._67O.remove(d,e)},O.fireViewEvent=function(y){var I=this;I._67O&&(Op(y)&&(y={kind:y}),I._67O.fire(y)),U.viewListener&&U.viewListener(I,y)}},ms_tip:function(W){W.setToolTipEnabled=function(K){var N=this;K?_||N._13o||(N.enableToolTip(),N.fp("toolTipEnabled",!1,!0)):N._13o&&(N.disableToolTip(),N.fp("toolTipEnabled",!0,!1))},W.isToolTipEnabled=function(){return!!this._13o},W.enableToolTip=function(){var O=this;_||O._13o||(O._13o=function(B){var d=O.getToolTip(B);d!=p?U.toolTipContinual&&U.isToolTipShowing()?ih(B,d):(mk(),gs={timeout:A(cq,zq),e:B,info:d}):mk()},O.getView().addEventListener(Zm,O._13o,!1),O.getView().addEventListener("mouseleave",U.hideToolTip,!1))},W.disableToolTip=function(){var W=this;W._13o&&(W.getView().removeEventListener(Zm,W._13o,!1),W.getView().removeEventListener("mouseleave",U.hideToolTip,!1),delete W._13o)},W.getToolTip=function(Z){var v=this;if(v.getDataAt){var A=v.getDataAt(Z);return A?A.getToolTip():p}return v.getValue?v.getValue():void 0}},_52o:function(N){N._zoom=1,N._29I=Am,N.zoomIn=function(B,I){this.setZoom(this._zoom*Ro,B,I)},N.zoomOut=function(q,v){this.setZoom(this._zoom/Ro,q,v)},N.zoomReset=function(x,K){this.setZoom(1,x,K)},N.scrollZoomIn=function(F){this.setZoom(this._zoom*di,p,F)},N.scrollZoomOut=function(u){this.setZoom(this._zoom/di,p,u)},N.pinchZoomIn=function(P){this.setZoom(this._zoom*Lm,p,P)},N.pinchZoomOut=function(i){this.setZoom(this._zoom/Lm,p,i)},N.adjustZoom=function(e){return si>e?si:e>sl?sl:e},N.getZoom=function(){return this._zoom},N.setZoom=function(J,T,l){var Y=this;if(T=Cd(T)){Y._14o&&Y._14o.stop(!0);var B=Y._zoom;T.action=function(I){Y._96O(B+(J-B)*I,l)},T._37o=function(){delete Y._zooming,delete Y._14o,Y.onZoomEnded()},Y._zooming=1,Y._14o=ne(T)}else Y._96O(J,l)},N._96O=function(e,R){var p=this;if(e=p.adjustZoom(e),e!==p._zoom){p.validate();var z=p._29I,S=p._zoom;0!==z.width&&0!==z.height&&(R=R?R:{x:z.x+z.width/2,y:z.y+z.height/2},p.tx((R.x-z.x)*S-R.x*e),p.ty((R.y-z.y)*S-R.y*e)),p._zoom=e,p.fp("zoom",S,e)}}}};Gp(U,{numberDigits:5,baseZIndex:R,isTouchable:_,devicePixelRatio:C.devicePixelRatio?C.devicePixelRatio:1,reinvalidateCount:3,hitMaxArea:3e3,imageCacheThreshold:20,autoMakeVisible:!0,autoHideScrollBar:!0,disabledOpacity:.4,disabledBackground:v.disabledBackground,forceHierarchicalSerialization:!0,hoverDelay:600,toolTipDelay:800,toolTipContinual:!1,getDragger:function(){return cj},lineCap:"butt",lineJoin:"round",imageGradient:"linear.northeast",dashPattern:[16,16],animDuration:200,animEasing:function(d){return d*d},labelColor:Td,labelSelectColor:wo,labelFont:(_?"15":"12")+"px arial, sans-serif",widgetIndent:_?30:20,widgetRowHeight:_?30:20,widgetHeaderHeight:_?32:22,widgetTitleHeight:_?34:24,scrollBarColor:ii,scrollBarSize:7,scrollBarTimeout:1e3,scrollBarMinLength:20,scrollBarInteractiveSize:_?32:16,zoomIncrement:1.3,scrollZoomIncrement:1.05,pinchZoomIncrement:1.08,zoomMax:20,zoomMin:.01,segmentResolution:12,shapeResolution:24,shapeSide:24,intersectionLineRect:sp,intersectionLineLine:Uj,isEnter:Oi,isEsc:xq,isDelete:po,isSpace:Le,isLeft:hb,isUp:Xk,isRight:mq,isDown:gd,getTarget:vr,isString:Op,isNumber:Tq,isBoolean:sq,isArray:vi,isSelectAll:Fm,isFunction:vk,isObject:Dh,getPropertyValue:Kg,setPropertyValue:re,addMethod:Gp,getVersion:function(){return"6.2.0"},appendToScreen:function(z){z=z.getView?z.getView():z,(i.fullscreenElement||i.mozFullScreenElement||i.webkitFullscreenElement||i.msFullscreenElement||i.body).appendChild(z)},toggleFullscreen:function(P){var w=P.getView();if(!(i.fullscreenElement||i.mozFullScreenElement||i.webkitFullscreenElement||i.msFullscreenElement)){var x=!0;if(P.isSelfViewEvent){var K=P.getX(),H=P.getY(),j=P.getWidth(),Q=P.getHeight(),X=w.style.background;X||(w.style.background="white"),w.requestFullscreen?w.requestFullscreen():w.msRequestFullscreen?w.msRequestFullscreen():w.mozRequestFullScreen?w.mozRequestFullScreen():w.webkitRequestFullscreen&&w.webkitRequestFullscreen();var Y=setInterval(function(){if(w!==(i.fullscreenElement||i.mozFullScreenElement||i.webkitFullscreenElement||i.msFullscreenElement))clearInterval(Y),P.setX(K),P.setY(H),P.setWidth(j),P.setHeight(Q),P._fullscreen=!1,w.style.background=X,P.iv();else{var M=D.Default.getWindowInfo();(x||M.width!==P.getWidth()||M.height!==P.getHeight())&&(P.setX(M.left),P.setY(M.top),P.setWidth(M.width),P.setHeight(M.height),P._fullscreen=!0,P.iv(),x=!1)}},500)}else{var V=w.style.left,u=w.style.top,j=w.style.width,Q=w.style.height,X=w.style.background;X||(w.style.background="white"),w.requestFullscreen?w.requestFullscreen():w.msRequestFullscreen?w.msRequestFullscreen():w.mozRequestFullScreen?w.mozRequestFullScreen():w.webkitRequestFullscreen&&w.webkitRequestFullscreen();var Y=setInterval(function(){if(w!==(i.fullscreenElement||i.mozFullScreenElement||i.webkitFullscreenElement||i.msFullscreenElement))clearInterval(Y),w.style.left=V,w.style.top=u,w.style.width=j,w.style.height=Q,w.style.background=X,P.iv();else{var f=D.Default.getWindowInfo();(x||f.width!==P.getWidth()||f.height!==P.getHeight())&&(Eb(P),x=!1)}},500)}}},appendTimeStamp:function(Y){return Y},setCompType:function(l,e){vk(e)||Dh(e)?Be[l]=e:ng(l)},getCompType:function(q){var P=Be[q];return P===R&&gr.test(q)&&ng(q),P},getCompTypeMap:function(){return Be},drawCompType:function(U,X,a,v,P,F){U(X,a,v,P,F)},numberListener:function(){var W={46:1,8:1,9:1,27:1,13:1,109:1,110:1,189:1,190:1};return function(E){var p=E.keyCode;W[p]||65===p&&U.isCtrlDown(E)||86===p&&U.isCtrlDown(E)||67===p&&U.isCtrlDown(E)||88===p&&U.isCtrlDown(E)||p>=35&&40>=p||(E.shiftKey||48>p||p>57)&&(96>p||p>105)&&E.preventDefault()}}(),ignoreKeyCodes:[122,123],preventDefault:function(p){var _=p.target.tagName;("DIV"===_||"CANVAS"===_)&&!(U.ignoreKeyCodes.indexOf(p.keyCode)>=0)&&("keydown"!==p.type||hb(p)||mq(p)||Xk(p)||gd(p)||po(p)||65===p.keyCode&&(p.metaKey||p.ctrlKey))&&(p.preventDefault(),p.preventManipulation&&p.preventManipulation())},getWindowInfo:function(){var H=i.documentElement,J=H&&(H.scrollLeft||H.scrollTop)?H:i.body;return{target:J,left:J.scrollLeft,top:J.scrollTop,width:C.innerWidth||J.clientWidth,height:C.innerHeight||J.clientHeight}},isDragging:function(){return!!cj},isLeftButton:function(O){return _?!0:0===O.button},isInput:function(T){if(!T)return!1;var R=T.tagName;return"INPUT"===R||"TEXTAREA"===R||"SELECT"===R},getTouchCount:function(v){return _?v.touches.length:1},isDoubleClick:function(){function b($){$.details=0,$.timeout=null,$.lastPoint=null}var O={};return function(e){var Q=e.button==p?"":e.button,M=e.type+Q,E=M+"_isDoubleClick",L=O[M];if(L||(L=O[M]={details:0,timeout:null,lastPoint:null}),e[E]===R){e[E]=!0;var h=kq(e);L.timeout&&(J(L.timeout),L.timeout=null),L.lastPoint&&ti(L.lastPoint,h)>(_?20:1)&&b(L),L.lastPoint=h,L.details++,L.timeout=A(function(){b(this)}.bind(L),500)}return 2===L.details}}(),isShiftDown:function(i){return i?i.shiftKey:qg["16"]},isCtrlDown:function(v){return v?y?v.metaKey:v.ctrlKey:y?qg["91"]:qg["17"]},getClientPoint:function(f){return _&&(f=ef(f)),{x:f.clientX,y:f.clientY}},isMouseEvent:function(V){return V instanceof MouseEvent||0===V.type.indexOf("mouse")},getTargetElement:function(B){if(U.isMouseEvent(B)||!i.elementFromPoint)return B.target;var e=Jb(B);return i.elementFromPoint(e.x,e.y)},getPagePoint:function(Z){return _&&(Z=ef(Z)),{x:Z.pageX,y:Z.pageY}},createObject:function(M,m){var c=new M;for(var D in m)if(0===D.indexOf("s:"))c.s(D.substr(2),m[D]);else if(0===D.indexOf("a:"))c.a(D.substr(2),m[D]);else{var H=Jl(D),P=m[D];c[H]?(c[H](P),"setToolTip"===H&&c.enableToolTip&&c.enableToolTip()):c[D]=P}return c},setImage:function(E,l,F,w){var B=arguments.length;4===B?ql(E,w,l,F):2===B?Op(l)?ql(E,l):zb[E]=l:1===B&&ql(E,E)},getImage:function(r,n,S){var i;if(r==p)return p;if(Dh(r)?i=r:(i=zb[r],r&&i===R&&(or&&or[r]||ql(r,r))),n&&i&&i.tagName){var E;E="override"===S?"colors_override":"override_rgb"===S?"colors_override_rgb":"override_a"===S?"colors_override_a":"colors",i[E]||(i[E]={__count__:0});var y=i[E][n];return y||(i[E].__count__>U.imageCacheThreshold&&(i[E]={__count__:0}),y=Sp(i,kd(n),i.width,i.height,S),i[E][n]=y,i[E].__count__++),y}return i},isImageComplete:function(m,v,i){var n=Dh(m)?m:zb[m];if(!n)return!1;if(n.tagName)return n.complete;for(var P,m,Q=n.comps,T=!0,A=0,E=Q.length;E>A;A++)if(P=Q[A],"image"===P.type){m=P.name,m&&m.func&&(m=$n(m,v));var _=bo(m,v,i);if(!_){T=!1;break}}return T},getId:function(){var $=1;return function(){return++$}}(),callLater:function(K,c,N,R){var D=function(){K.apply(c,N)};return R?A(D,R):C.requestAnimationFrame(D)},clone:function(E){if(null==E||"object"!=typeof E)return E;if(E instanceof Date){var W=new Date;return W.setTime(E.getTime()),W}if(E instanceof Array){for(var W=[],Z=0,F=E.length;F>Z;Z++)W[Z]=ik(E[Z]);return W}if(E instanceof uh){for(var W=new uh,Z=0,F=E.length;F>Z;Z++)W.set(Z,ik(E.get(Z)));return W}if(E instanceof Mo)return E;if(E instanceof h){var W={};for(var M in E)E.hasOwnProperty(M)&&(W[M]=ik(E[M]));return W}return E},callWhenLoaded:function($,b){b=b||100;var w=Vf($,b);wi||(wi={}),wi[w]={tick:w,cb:$,delay:b}},beforeLoadURL:function(N){if(wi){var f={};for(var l in wi){var z=wi[l];J(z.tick);var I=Vf(z.cb,z.delay);f[I]={tick:I,delay:z.delay,cb:z.cb}}wi=f}return U.convertURL?U.convertURL(N):N},convertURL:function(v){return v},handleRefGraphLoaded:function(){},handleCompTypeLoaded:function(){},handleImageLoaded:function(){},handleUnfoundImage:function(){},sortFunc:function(N,h){if(N===h)return 0;if(N==p&&h!=p)return 1;if(N!=p&&h==p)return-1;if(N==p&&h==p)return 0;var j,B=typeof N,S=typeof h;return B===pn&&S===pn?j=N.localeCompare(h):B===oe&&S===oe&&(j=N-h),j===R&&(j=(""+N).localeCompare(""+h)),j>0?1:0>j?-1:0},getClassMap:function(){return ps},getClass:function(h){if(Op(h)){var q,l=ps[h];if(!l){q=h.split("."),l=C;for(var n=0;n<q.length;n++)l=l[q[n]];ps[h]=l}return l}return h},def:function(h,F,K){var n,s,D,B=function(){};if(B.prototype=F.prototype,n=new B,Op(h)){if(ps[h])throw"'"+h+"' already defined";D=og(h),n.getClassName=function(){return h}}else D=h;if(n.constructor=D,n.getClass=function(){return D},n.getSuperClass=function(){return F},K)for(s in K)Po[s]&&Po.hasOwnProperty(s)?Po[s](n,K):Yg(n,K,s);D.prototype=n,D.superClass=F.prototype},startAnim:function(){var Q=function(u){u.duration&&(u.startTime=Io()),u.timeId=tf(u.tick,p,p,u.interval)};return function(x){return x=ik(x),x.easing=x.easing||U.animEasing,x.duration||x.frames||(x.duration=U.animDuration),x.t=0,x.duration?x.interval=0:(x.frame=0,x.interval=x.interval||10),x.tick=function(){if(x.duration){var u=(Io()-x.startTime)/x.duration;u>1&&(u=1),x.t=u,x.action(x.easing(u),u),1===u?x.stop():x._isPaused||(x.timeId=tf(x.tick))}else x.frame++,u=x.t=x.frame/x.frames,x.action(x.easing(u),u),x.frame<x.frames?x._isPaused||(x.timeId=tf(x.tick,p,p,x.interval)):x.stop()},x.resume=function(){x._isPaused&&(delete x._isPaused,x.duration?x.t<1&&(x.startTime=Io()-x.duration*x.t,x.timeId=tf(x.tick)):x.frame<x.frames&&(x.timeId=tf(x.tick,p,p,x.interval)))},x.pause=function(){x._isPaused=!0},x.stop=function(m){x.isRunning()&&(x.duration?x.t<1&&m&&(x.t=1,x.action(x.easing(1),1)):x.frame<x.frames&&m&&(x.frame=x.frames,x.action(x.easing(1),1)),x._37o&&x._37o(),x.finishFunc&&x.finishFunc(),bq(x.timeId,!x.duration),delete x.timeId)},x.isRunning=function(){return x.timeId!=p},x.delay?tf(Q,p,[x],x.delay):Q(x),x}}(),getTextSize:function(){var A={},O=i?Ne().getContext("2d"):p;return function(J,t){O.font=J?J:cc;var l=A[O.font];return l||(l=2*O.measureText("e").width+4,A[O.font]=l),{width:O.measureText(t).width+4,height:l}}}(),drawText:function(z,y,b,s,Z,A,G,Q,K,f){if(y!=p){var S=sk(b,y),M={};M.y=f&&f!==hn?f===ko?A+S.height/2:A+Q-S.height/2:A+Q/2,M.x=K&&K!==Aj?K===ig?Z+G-S.width/2:Z+G/2:Z+S.width/2,Bm(z,y,M,b,s)}},getDistance:function(P,Z){var Q=P.length;return Z?3===Q?M(m(P[0]-Z[0])+m(P[1]-Z[1])+m(P[2]-Z[2])):2===Q?M(m(P[0]-Z[0])+m(P[1]-Z[1])):P.z===R?M(m(Z.x-P.x)+m(Z.y-P.y)):M(m(Z.x-P.x)+m(Z.y-P.y)+m(Z.z-P.z)):3===Q?M(m(P[0])+m(P[1])+m(P[2])):2===Q?M(m(P[0])+m(P[1])):void 0},brighter:function(A,a){return 0>a&&(a=-a),ll(A,a?a:40)},darker:function(h,W){return W>0&&(W=-W),ll(h,W?W:-40)},unionPoint:function(J,W){if(!J)return p;if(2===arguments.length)return J&&W?{x:j(J.x,W.x),y:j(J.y,W.y),width:B(J.x-W.x),height:B(J.y-W.y)}:p;var c=J;if(c._as&&(c=c._as),c.length===R)return p;var C=c.length;if(0>=C)return p;for(var D=1,w=c[0],v={x:w.x,y:w.y,width:0,height:0};C>D;D++){w=c[D];var $=j(v.x,w.x),U=Q(v.x+v.width,w.x),z=j(v.y,w.y),M=Q(v.y+v.height,w.y);v.x=$,v.y=z,v.width=U-$,v.height=M-z}return v},unionRect:function(A,o){if(A&&!o)return ik(A);if(!A&&o)return ik(o);if(A&&o){var b={x:j(A.x,o.x),y:j(A.y,o.y)};return b.width=Q(A.x+A.width,o.x+o.width)-b.x,b.height=Q(A.y+A.height,o.y+o.height)-b.y,b}return p},containsPoint:function(e,E,d,B){if(B!=p&&1!==B){var s=e.x+e.width/2,G=e.y+e.height/2;e={x:s-e.width/2*B,y:G-e.height/2*B,width:e.width*B,height:e.height*B}}if(d){var R=e.width/2,$=e.height/2,z=S(-d),v=X(-d),U=E.x-e.x-R,l=E.y-e.y-$;return E={x:v*U-z*l,y:z*U+v*l},$f({x:-R,y:-$,width:e.width,height:e.height},E)}return!(!e||E.x<e.x||E.y<e.y||E.x>e.x+e.width||E.y>e.y+e.height)},containsRect:function(S,B){if(!S||!B)return!1;var W=B.x,M=B.y,g=B.width,L=B.height,N=S.width,h=S.height;if(0>(N|h|g|L))return!1;var d=S.x,s=S.y;if(d>W||s>M)return!1;if(N+=d,g+=W,W>=g){if(N>=d||g>N)return!1}else if(N>=d&&g>N)return!1;if(h+=s,L+=M,M>=L){if(h>=s||L>h)return!1}else if(h>=s&&L>h)return!1;return!0},intersectsRect:function(g,b){if(!g||!b)return!1;var v=b.width,z=b.height,C=g.width,f=g.height;if(0>=C||0>=f||0>=v||0>=z)return!1;var S=b.x,h=b.y,c=g.x,P=g.y;return C+=c,f+=P,v+=S,z+=h,C>S&&f>h&&v>c&&z>P},intersection:function(L,u){if(!L||!u)return p;var j=u.x,$=u.y,o=L.x,H=L.y,k=j,z=$,R=o,E=H;return k+=u.width,z+=u.height,R+=L.width,E+=L.height,o>j&&(j=o),H>$&&($=H),k>R&&(k=R),z>E&&(z=E),k-=j,z-=$,0>=k||0>=z?p:{x:j,y:$,width:k,height:z}},grow:function($,b,c){c===R&&(c=b),$.x-=b,$.y-=c,$.width=$.width+2*b,$.height=$.height+2*c},getLogicalPoint:function(v,r,o,C,B,Z){var j,x,p=r.getBoundingClientRect();return v.target?(ok(v)?y?qg["91"]=!0:qg["17"]=!0:y?qg["91"]=!1:qg["17"]=!1,qg["16"]=Ar(v)?!0:!1,v=_?ef(v):v,j=v.clientX,x=v.clientY):(j=v.x,x=v.y),{x:(j-p.left+r.scrollLeft-(o||0))/(B||1),y:(x-p.top+r.scrollTop-(C||0))/(Z||1)}},removeHTML:function(){var o;return function(y){return y&&y.parentNode?o===y?!0:(o=y,y.parentNode.removeChild(y),o=p,!0):!1}}(),getToolTipDiv:function(){if(!wn){wn=yb(),_b=yb();var o=wn.style;U.baseZIndex!=p&&(o.zIndex=f(U.baseZIndex)+3+""),o.whiteSpace="nowrap",o.color=U.toolTipLabelColor,o.background=U.toolTipBackground,o.font=U.toolTipLabelFont,o.padding="5px",o.boxShadow="0px 0px 3px "+U.toolTipShadowColor}return wn},isToolTipShowing:function(){return wn&&wn.parentNode?!0:_b&&_b.parentNode?!0:!1},hideToolTip:function(){_k(wn),_k(_b),Fr()},showToolTip:function(K,F){if(!K||F==p)return mk(),void 0;U.getToolTipDiv();var a,S;if(F.html?(F=F.html,a=_b,_k(wn)):(a=wn,_k(_b)),S=a.style,a.innerHTML=F,a.parentNode||D.Default.appendToScreen(a),K.target){K=Jb(K);var n=nh(),C=K.x,y=K.y,c=_?60:12;if(_){var X=a.getBoundingClientRect();S.left=C-X.width/2+Vj,S.top=y-X.height-c<n.top?y+c+Vj:y-X.height-c+Vj}else{S.left=C+c+Vj,S.top=y+c+Vj;var X=a.getBoundingClientRect();X.left+X.width>n.width&&(S.left=C-c-X.width+Vj),X.top+X.height>n.height&&(S.top=y-c-X.height+Vj),X.left<0&&(S.left=C+c+Vj),X.top<0&&(S.top=y+c+Vj)}}else S.left=K.x+Vj,S.top=K.y+Vj;Fr()},startDragging:function(E,v){E!==cj&&(cj?_?cj.handleWindowTouchEnd(v):cj.handleWindowMouseUp(v):_?(C.addEventListener(Ke,is,!1),C.addEventListener(Lj,sg,!1)):(C.addEventListener(Zm,vb,!1),C.addEventListener(Wc,cm,!1)),cj=E)},getImageMap:function(){return zb},toBoundaries:function(W,p,K,Y){var k=[];return gk(W,p,K,Y).forEach(function(l){var G=[];l.forEach(function(Z){G.push(Z.x,Z.y)}),k.push(G)}),k},getCurrentKeyCodeMap:function(){return qg},drawCenterImage:function(y,i,x,c,N,Q,w,z){var R=rl(i,N,Q),I=ws(i,N,Q);yf(y,i,o(x-R/2),o(c-I/2),R,I,N,Q,w,z)},drawStretchImage:function(v,_,y,Q,h,a,q,H,x,K,G,Y){var X,t=rl(_,H,x,a),i=ws(_,H,x,q);"uniform"===y?(X=j(a/t,q/i),t*=X,i*=X,Q+=o((a-t)/2),h+=o((q-i)/2),a=t,q=i):"centerUniform"===y&&((t>a||i>q)&&(X=j(a/t,q/i),t*=X,i*=X),Q+=o((a-t)/2),h+=o((q-i)/2),a=t,q=i);var $=v.interactiveInfo;if($){var l;l="center"===y?{x:Q+a/2-t/2,y:h+q/2-i/2,width:t,height:i}:{x:Q,y:h,width:a,height:q},$.rect?($.compInfos[$.compInfos.length-1].rect=l,l.image=_):$.rect=l}if("center"===y){var k=G!==!1&&(t>a||i>q);k&&(v.save(),v.beginPath(),v.rect(Q,h,a,q),v.clip()),yf(v,_,Q+a/2-t/2,h+q/2-i/2,t,i,H,x,K,Y),k&&v.restore()}else yf(v,_,Q,h,a,q,H,x,K,Y)},toCanvas:function(e,J,N,d,V,p,B,O,g){e=Tm(e,B),J=J||rl(e,V),N=N||ws(e,V);var r=Ne(),$=Xh(r);return O?(Yc(r,J,N,O),$.scale(O,O)):Yc(r,J,N,1),Xl($,e,d,0,0,J,N,V,p,B,g),e&&e.clampToEdge&&(r.clampToEdge=e.clampToEdge),$.restore(),r},createGradientImage:function(K,L,Z,k){for(var s=["L",0,0,K,0,1,0,0,1,0,0],P=0,i=Math.min(L.length,Z.length);i>P;P++)s.push(Z[P],L[P]);var F=D.Default.toCanvas({width:K,height:K,clampToEdge:!0,comps:[{type:"shape",rotation:k||0,points:[0,0,K,0,K,K,0,K],background:"#ffffff",gradientPack:s}]});return F},createElement:function(T,w,D,G){var s=i.createElement(T);
return xl(s,w||v.widgetBorder,2),s.style.font=D?D:cc,G!=p&&(s.value=G),U.onElementCreated&&U.onElementCreated(s),s},containedInView:function(w,J){var K=Gn(J).getBoundingClientRect();return $f({x:K.left,y:K.top,width:K.width,height:K.height},kq(w))},isIsolating:function(){return vg>0},setIsolating:function(J){J?vg++:vg--},getMSMap:function(){return Po},stringify:function(_,r){var N=Date.prototype.toJSON;Date.prototype.toJSON=function(){return"__ht__date"+this.getTime()};var k=JSON.stringify(_,function(Z,_){return"function"==typeof _?"__ht__"+(_.__ht__||_.toString()):Tq(_)?kn(_):_},r==p?2:r);return Date.prototype.toJSON=N,k},parse:function(A){return Op(A)?JSON.parse(A,function(T,C){if(Op(C)){if("__ht__function"==C.substr(0,14)){var y=C.indexOf("{")+1,m=C.lastIndexOf("}"),e=C.indexOf("(")+1,W=C.indexOf(")");if(y&&m&&e&&W){var R=new Function(C.substring(e,W),C.substring(y,m));return R.__ht__=C.substr(6),R}}if("__ht__date"==C.substr(0,10))return new Date(f(C.substr(10)))}return C}):A},loadJS:function(y,W){W&&y.push(W);var t=y.shift();if(vi(t))y=t.contact(y),U.loadJS(y);else if(vk(t))t(),U.loadJS(y);else if(Op(t)){var P=i.createElement("script");P.onload=function(){U.loadJS(y)},P.setAttribute("src",t),i.getElementsByTagName("head")[0].appendChild(P)}else y.length&&U.loadJS(y)},toRoundedCorner:function(K,f){var G=K.size();if(0>=f)return{points:K};var v,s=new uh,r=new uh,p=K.get(0);s.add(p),r.add(1);for(var H=1;G>H;H++)if(G>H+1){var T=K.get(H),n=K.get(H+1),V=p.x,w=p.y,t=T.x,$=T.y,O=$-w,x=t-V,l=z(O,x);v=j(.99*ti(p,T),f),s.add({x:t-v*X(l),y:$-v*S(l)}),s.add(T),V=T.x,w=T.y,t=n.x,$=n.y,O=$-w,x=t-V,l=z(O,x),v=j(.99*ti(T,n),f),p={x:V+v*X(l),y:w+v*S(l)},s.add(p),r.addAll([2,3])}else s.add(K.get(H)),r.add(2);return{points:s,segments:r}},toColorData:mg,setCanvas:Yc,createDiv:yb,createDisabledDiv:ss,createView:Yf,createCanvas:Ne,appendChild:rj,initContext:Xh,checkLoadingImage:Qp,translateAndScale:Co,layout:Eb,getPosition:ad,drawPoints:Sc,drawRoundRect:Zr,drawBorder:gg,setFocus:rb,getter:xr,setter:Jl,isEmptyObject:es},!0),Gp(K,{autoAdjustIndex:1,hierarchicalRendering:1,adjustChildrenToTop:1,autoHideScrollBar:1,autoUpdate:1,firstPersonMode:1,ortho:1,strict:1,stickToRight:1,instant:1,closePath:1,hierarchical:1,doubleClickToToggle:1,continuousLayout:1,syncSize:1},!0);var cn=U.disabledOpacity,zq=U.toolTipDelay,eq=U.devicePixelRatio,tl=U.autoMakeVisible,Eg=U.autoHideScrollBar,hl=U.imageGradient,ih=U.showToolTip,mk=U.hideToolTip,Qg=U.dashPattern,mi=U.lineCap,Fd=U.lineJoin,Bd=U.labelColor,nj=U.labelSelectColor,cc=U.labelFont,_f=U.widgetIndent,El=U.widgetRowHeight,Hm=U.widgetHeaderHeight,Ze=U.widgetTitleHeight,Hb=U.scrollBarColor,Db=U.scrollBarSize,uq=U.scrollBarTimeout,zf=U.scrollBarMinLength,zr=U.scrollBarInteractiveSize,Ro=U.zoomIncrement,di=U.scrollZoomIncrement,Lm=U.pinchZoomIncrement,sl=U.zoomMax,si=U.zoomMin,Wg=U.createObject,gj=U.preventDefault,kc=U.setImage,Tm=U.getImage,bo=U.isImageComplete,Pq=U.drawCenterImage,Xl=U.drawStretchImage,Zq=U.getId,tf=U.callLater,Md=U.sortFunc,ik=U.clone,og=U.getClass,ne=U.startAnim,Wr=U.brighter,Eh=U.darker,Sn=U.drawText,sk=U.getTextSize,xm=U.isLeftButton,cp=U.getTouchCount,dl=U.isDoubleClick,Ar=U.isShiftDown,ok=U.isCtrlDown,kq=U.getClientPoint,Jb=U.getPagePoint,ti=U.getDistance,Ui=U.unionPoint,Ij=U.unionRect,$f=U.containsPoint,jc=U.containsRect,Lr=U.intersectsRect,Sg=U.intersection,nh=U.getWindowInfo,Lf=U.grow,wd=U.getLogicalPoint,Kc=U.startDragging,_k=U.removeHTML,Vb=U.createElement,Xb=U.segmentResolution,$i=U.shapeResolution,ao=U.shapeSide,bd=U.def,fe=function(P,u,t){bd(l+"."+P,u,t)},md=function(s,H){s.childNodes.forEach(function(A){H(A),md(A,H)})};Gp(U,{toolTipLabelColor:Bd,toolTipLabelFont:cc,toolTipBackground:v.toolTipBackground,toolTipShadowColor:ii,drawBreakableText:Cb,setDevicePixelRatio:function(l){eq=U.devicePixelRatio="number"==typeof l?l:C.devicePixelRatio,md(i.body,function(F){var t=F._ht;t&&t._canvas&&(Yc(t._canvas,t.getWidth(),t.getHeight()),t.redraw?t.redraw():t.iv())})}},!0);var Sd=1e-6,dm="undefined"!=typeof Uint16Array?Uint16Array:Array,Oe="undefined"!=typeof Float32Array?Float32Array:Array,fg=function(y,h,j){var a=[y[0]-h[0],y[1]-h[1],y[2]-h[2]];if(j){var N=ti(a);N>0&&(a[0]/=N,a[1]/=N,a[2]/=N)}return a},pi=function(K){return[-K[0],-K[1],-K[2]]},xb=function(M,q){return 3===M.length?M[0]*q[0]+M[1]*q[1]+M[2]*q[2]:M[0]*q[0]+M[1]*q[1]},Cm=function(){var v=new Oe(16);return v[0]=1,v[1]=0,v[2]=0,v[3]=0,v[4]=0,v[5]=1,v[6]=0,v[7]=0,v[8]=0,v[9]=0,v[10]=1,v[11]=0,v[12]=0,v[13]=0,v[14]=0,v[15]=1,v},Ak=Cm(),Ch=function(C){var Z=new Oe(16);return Z[0]=C[0],Z[1]=C[1],Z[2]=C[2],Z[3]=C[3],Z[4]=C[4],Z[5]=C[5],Z[6]=C[6],Z[7]=C[7],Z[8]=C[8],Z[9]=C[9],Z[10]=C[10],Z[11]=C[11],Z[12]=C[12],Z[13]=C[13],Z[14]=C[14],Z[15]=C[15],Z},Ef=function(e,o){return e[0]=o[0],e[1]=o[1],e[2]=o[2],e[3]=o[3],e[4]=o[4],e[5]=o[5],e[6]=o[6],e[7]=o[7],e[8]=o[8],e[9]=o[9],e[10]=o[10],e[11]=o[11],e[12]=o[12],e[13]=o[13],e[14]=o[14],e[15]=o[15],e},vl=function(Q){return Q[0]=1,Q[1]=0,Q[2]=0,Q[3]=0,Q[4]=0,Q[5]=1,Q[6]=0,Q[7]=0,Q[8]=0,Q[9]=0,Q[10]=1,Q[11]=0,Q[12]=0,Q[13]=0,Q[14]=0,Q[15]=1,Q},pk=function(u,c){var C=u[0],S=u[1],f=u[2];return u[0]=c[0]*C+c[4]*S+c[8]*f+c[12],u[1]=c[1]*C+c[5]*S+c[9]*f+c[13],u[2]=c[2]*C+c[6]*S+c[10]*f+c[14],u},en=function(T,p){var B=T[0],U=T[1],k=T[2],Q=T[3];return T[0]=p[0]*B+p[4]*U+p[8]*k+p[12]*Q,T[1]=p[1]*B+p[5]*U+p[9]*k+p[13]*Q,T[2]=p[2]*B+p[6]*U+p[10]*k+p[14]*Q,T[3]=p[3]*B+p[7]*U+p[11]*k+p[15]*Q,T},Lp=function(){var F,H,h,V,p=th(to[1]+to[7]),A=th(to[0]+to[3]-to[10]),m=th(to[8]+2),g=function(){return H=h.charAt(F),F+=1,H},z=function(){var L="";if(H===m)for(;g();){if(H===m)return g(),L;L+=H}else g()},n=function(){for(;H&&" ">=H;)g()},T=function(){var B,s={};if(H===p){if(g(),n(),H===A)return g(),s;for(;H;){if(B=z(),n(),g(),s[B]=V(),n(),H===A)return g(),s;g(),n()}}};return V=function(){switch(n(),H){case p:return T();default:return z()}},function(I){if(G={},I){var O;if(h=I,F=0,H=" ",O=V(),n(),!H)return O}}}(),Pc=function(s,G){if(G){var Q=S(G),B=X(G),v=s[4],d=s[5],e=s[6],f=s[7],_=s[8],m=s[9],K=s[10],U=s[11];s[4]=v*B+_*Q,s[5]=d*B+m*Q,s[6]=e*B+K*Q,s[7]=f*B+U*Q,s[8]=_*B-v*Q,s[9]=m*B-d*Q,s[10]=K*B-e*Q,s[11]=U*B-f*Q}},zl=function(o,f){if(f){var N=S(f),i=X(f),F=o[0],q=o[1],u=o[2],Q=o[3],G=o[8],R=o[9],k=o[10],D=o[11];o[0]=F*i-G*N,o[1]=q*i-R*N,o[2]=u*i-k*N,o[3]=Q*i-D*N,o[8]=F*N+G*i,o[9]=q*N+R*i,o[10]=u*N+k*i,o[11]=Q*N+D*i}},go=function(t,o){if(o){var n=S(o),c=X(o),s=t[0],b=t[1],G=t[2],m=t[3],K=t[4],A=t[5],k=t[6],V=t[7];t[0]=s*c+K*n,t[1]=b*c+A*n,t[2]=G*c+k*n,t[3]=m*c+V*n,t[4]=K*c-s*n,t[5]=A*c-b*n,t[6]=k*c-G*n,t[7]=V*c-m*n}},Rb=function(R,b,O){return dj(p,O===!1?p:R.getFinalScale3d(),R.r3(),R.getRotationMode(),R.p3(),p,b)},dj=function(w,l,c,M,y,$,A){return $||($=Cm()),y&&xc($,y),Oj($,c,M),A&&jg($,$,A),l&&bf($,l),w&&jg($,$,w),$},Rf=function(G,S,u){S=f(S),u=f(u);var e=this;e.g=G,e._84O=S,e._85O=u,e._70I=!0,e.F=0,e._83O=S+u,e.pen={x:0,y:0}},Fb="lineDashOffset",me="setLineDash",Uc=function(g){for(var S in g)1===S.length&&(Fb=g[S]);return S?1:0},Yk=function(G,e,v){return wf(e)?G:G[me]?(G[me](e),v&&(G.lineDashOffset=v),G):new Rf(G,e[0],e.length>1?e[1]:e[0])},Pp=function(i,F){!wf(F)&&i[me]&&(i[me](gl),i.lineDashOffset=0)};if(bd(Rf,h,{_69I:6,moveTo:function(x,_){var i=this,r=i.pen;r.x=x,r.y=_,i.g.moveTo(x,_),i.start||(i.start={x:x,y:_})},lineTo:function(w,x){var C=this,K=C.pen,D=w-K.x,$=x-K.y,I=z($,D),g=X(I),V=S(I),R=C._23O(K.x,K.y,w,x),r=C._85O,n=C._84O,O=C._83O;if(C.F){if(C.F>R)return C._70I?C._72I(w,x):C.moveTo(w,x),C.F-=R,void 0;if(C._70I?C._72I(K.x+g*C.F,K.y+V*C.F):C.moveTo(K.x+g*C.F,K.y+V*C.F),R-=C.F,C.F=0,C._70I=!C._70I,!R)return}var m=Z(R/O);if(m){for(var l=g*n,s=V*n,f=g*r,i=V*r,h=0;m>h;h++)C._70I?(C._72I(K.x+l,K.y+s),C.moveTo(K.x+f,K.y+i)):(C.moveTo(K.x+f,K.y+i),C._72I(K.x+l,K.y+s));R-=O*m}C._70I?R>n?(C._72I(K.x+g*n,K.y+V*n),C.moveTo(w,x),C.F=r-(R-n),C._70I=!1):(C._72I(w,x),R===n?(C.F=0,C._70I=!C._70I):(C.F=n-R,C.moveTo(w,x))):R>r?(C.moveTo(K.x+g*r,K.y+V*r),C._72I(w,x),C.F=n-(R-r),C._70I=!0):(C.moveTo(w,x),R===r?(C.F=0,C._70I=!C._70I):C.F=r-R)},quadraticCurveTo:function(e,A,b,g){var H,j=this,V=j.pen,d=V.x,R=V.y,u=j._22O(d,R,e,A,b,g),Y=0,l=0,p=j._85O,f=j._84O;if(j.F){if(j.F>u)return j._70I?j._71I(e,A,b,g):j.moveTo(b,g),j.F-=u,void 0;if(Y=j.F/u,H=j._20O(d,R,e,A,b,g,Y),j._70I?j._71I(H[2],H[3],H[4],H[5]):j.moveTo(H[4],H[5]),j.F=0,j._70I=!j._70I,!u)return}var X=u-u*Y,n=Z(X/j._83O),P=f/u,O=p/u;if(n)for(var W=0;n>W;W++)j._70I?(l=Y+P,H=j._21O(d,R,e,A,b,g,Y,l),j._71I(H[2],H[3],H[4],H[5]),Y=l,l=Y+O,H=j._21O(d,R,e,A,b,g,Y,l),j.moveTo(H[4],H[5])):(l=Y+O,H=j._21O(d,R,e,A,b,g,Y,l),j.moveTo(H[4],H[5]),Y=l,l=Y+P,H=j._21O(d,R,e,A,b,g,Y,l),j._71I(H[2],H[3],H[4],H[5])),Y=l;X=u-u*Y,j._70I?X>f?(l=Y+P,H=j._21O(d,R,e,A,b,g,Y,l),j._71I(H[2],H[3],H[4],H[5]),j.moveTo(b,g),j.F=p-(X-f),j._70I=!1):(H=j._19O(d,R,e,A,b,g,Y),j._71I(H[2],H[3],H[4],H[5]),u===f?(j.F=0,j._70I=!j._70I):(j.F=f-X,j.moveTo(b,g))):X>p?(l=Y+O,H=j._21O(d,R,e,A,b,g,Y,l),j.moveTo(H[4],H[5]),H=j._19O(d,R,e,A,b,g,l),j._71I(H[2],H[3],H[4],H[5]),j.F=f-(X-p),j._70I=!0):(j.moveTo(b,g),X===p?(j.F=0,j._70I=!j._70I):j.F=p-X)},bezierCurveTo:function(){var f=arguments;this.pen={x:f[4],y:f[5]},this.g.bezierCurveTo(f[0],f[1],f[2],f[3],f[4],f[5])},arc:function(W,H,P,D,U,f){f||(D=-D,U=-U),vh(this,W,H,D,U-D,P,P,!1)},rect:function(w,_,R,K){var U=this;U.pen={x:w,y:_},U.moveTo(w,_),U.lineTo(w,_+K),U.lineTo(w+R,_+K),U.lineTo(w+R,_),U.lineTo(w,_)},beginPath:function(){this.g.beginPath()},closePath:function(){this.lineTo(this.start.x,this.start.y)},_23O:function(l,V,P,n){var C=P-l,F=n-V;return M(C*C+F*F)},_22O:function(M,H,j,d,r,g,R){for(var q,s,Y,m,W,n,T,b=0,V=M,u=H,Z=R>0?R:this._69I,v=1;Z>=v;v++)Y=v/Z,m=1-Y,W=m*m,n=2*Y*m,T=Y*Y,q=W*M+n*j+T*r,s=W*H+n*d+T*g,b+=this._23O(V,u,q,s),V=q,u=s;return b},_21O:function(O,u,l,S,T,Q,q,D){var o=this;if(0===q)return o._20O(O,u,l,S,T,Q,D);if(1===D)return o._19O(O,u,l,S,T,Q,q);var d=o._20O(O,u,l,S,T,Q,D);return d.push(q/D),o._19O.apply(o,d)},_20O:function(F,d,f,T,o,K,M){if(1!==M){var Z=f+(o-f)*M,E=T+(K-T)*M;f=F+(f-F)*M,T=d+(T-d)*M,o=f+(Z-f)*M,K=T+(E-T)*M}return[F,d,f,T,o,K]},_19O:function(X,m,b,F,D,y,A){if(1!==A){var W=X+(b-X)*A,v=m+(F-m)*A;b+=(D-b)*A,F+=(y-F)*A,X=W+(b-W)*A,m=v+(F-v)*A}return[X,m,b,F,D,y]},_72I:function(y,M){var D=this.pen;(y!==D.x||M!==D.y)&&(D.x=y,D.y=M,this.g.lineTo(y,M))},_71I:function(j,T,n,$){var e=this.pen;(j!==n||T!==$||n!==e.x||$!==e.y)&&(e.x=n,e.y=$,this.g.quadraticCurveTo(j,T,n,$))}}),W&&H){var rk=H.toString();d=rk.indexOf(yd.substr(0,2))>0&&rk.indexOf(ko+ko.substr(1,1))>1?!0:!1}var Pm=p,De=p,Mj=function(J){Pm&&!J._72O&&(De||(De={}),De[J._72O=Zq()]=J)},ng=function(r,Q){if(Q||(Q=r),Q&&(Pm||(Pm={}),!Pm[r])){var L=new XMLHttpRequest;if(Pm[Q]={request:L,url:Q},L.overrideMimeType&&L.overrideMimeType("text/plain"),Q=U.beforeLoadURL(Q),Q.data){var t=U.parse(Q.data);Qi(r,t),U.handleCompTypeLoaded(r,t)}else L.open("GET",encodeURI(Q),!0),L.onload=function(L){if(200===this.status||0===this.status){var j=U.parse(L.target.response||L.target.responseText);Qi(r,j),U.handleCompTypeLoaded(r,j)}else Qi(r,p)},L.onerror=function(){Qi(r,p)},L.send(null)}},Qi=function(q,o){if(Be[q]=o,delete Pm[q],es(Pm)&&(Pm=p,De)){for(var B in De){var h=De[B];h.invalidateAll&&h.invalidateAll(R,"compTypeLoaded",q),h.redraw&&h.redraw(),h.iv(),delete h._72O}De=p}if(o&&De)for(var B in De){var h=De[B];h.invalidateAll&&h.invalidateAll(R,"compTypeLoading",q),h.redraw&&h.redraw(),h.iv()}},ep=v.chart,Uk=U.compStack=[],ei=/^style@/,rp=/^attr@/,Ed=/^field@/,dr={x:.5,y:.5},rl=function(V,W,g,K){if(!V)return 0;if($n(V.fitSize,W,g)&&K)return K;var G=$n(V.width,W,g);return null==G?20:G},ws=function(O,j,P,I){if(!O)return 0;if($n(O.fitSize,j,P)&&I)return I;var R=$n(O.height,j,P);return null==R?20:R},$n=function(O,g,N){if(!O||!O.func)return O;var l,e=O.func,T=O.value;return l=vk(e)?N&&N.vectorDataBindingDisabled&&!O.isSafeFunc?T:e(g,N):g instanceof Mo?rp.test(e)?g.a(e.slice(5)):ei.test(e)?g.s(e.slice(6)):Ed.test(e)?g[e.slice(6)]:g[e]?g[e](N):T:T,T!==R&&l==p?T:l},yf=U.drawImage=function(){var g,s,H,L,t,J,W=function(o,H){o.getValue&&o.getValue.compType===H||(o.getValue=function(j){var b=l(o,j);if(b===R&&H.properties){var f=H.properties[j];f&&(b=f.defaultValue)}return b},o.getValue.compType=H)},l=function(M,b,F){var l=M[b];return l&&l.func?(l=$n(l,s,H),F&&(l=F(l))):F&&(l=M[b]=F(l)),l},e=function(Y,T){var c;if(c=T?l(Y,T):Y,t&&c){if("override"===J)return t;if("override_rgb"===J){var O=kd(t);return c=mg(c),"rgba("+Z(255*O[0])+","+Z(255*O[1])+","+Z(255*O[2])+","+c[3]/255+")"}if("override_a"===J){var O=kd(t);return c=mg(c),"rgba("+c[0]+","+c[1]+","+c[2]+","+O[3]+")"}var O=kd(t);return c=mg(c),"rgba("+Z(c[0]*O[0])+","+Z(c[1]*O[1])+","+Z(c[2]*O[2])+","+c[3]/255*O[3]+")"}return c},v=function(K){if(vi(K)){for(var j=new uh,A=K.length,G=0;A>G;G+=2)j.add({x:K[G],y:K[G+1]});K=j}return K},b=function(T){var b=l(T,"anchorX"),D=l(T,"anchorY");if(b!==R||D!==R)return{x:b===R?dr.x:b,y:D===R?dr.y:D};var S=l(T,"type"),E=l(T,"name");if("image"!==S||!E)return dr;var o=Tm(E);return o&&o.anchorX&&o.anchorY?{x:o.anchorX,y:o.anchorY}:dr},o=function(_,i){var Q=l(_,li),S=b(_);if(vi(Q)){var E=Q.length,x=l(_,"relative"),M=i.width,L=i.height;if(4===E)Q={x:Q[0],y:Q[1],width:Q[2],height:Q[3]},x?(Q.x*=M,Q.y*=L,Q.width*=M,Q.height*=L):i.fitSize&&(Q.x*=i.widthScale,Q.width*=i.widthScale,Q.y*=i.heightScale,Q.height*=i.heightScale);else if(3===E){var s=Q[0];Q={width:Q[1],height:Q[2]},x?(Q.width*=M,Q.height*=L):i.fitSize&&(Q.width*=i.widthScale,Q.height*=i.heightScale),"object"==typeof s?s.length&&(s={x:s[0],y:s[1]}):s=ad(s,i,Q),Q.x=s.x-Q.width*S.x,Q.y=s.y-Q.height*S.y}var r=l(_,"offsetX");r&&(i.fitSize&&(r*=i.widthScale),Q.x+=r),r=l(_,"offsetY"),r&&(i.fitSize&&(r*=i.heightScale),Q.y+=r)}return Q},a=function(f){return vi(f)?new uh(f):f},w=function(f,K,T,O,i,e,Q){var X=g.interactiveInfo;i===R&&(i=1),e===R&&(e=1);var j=l(f,"clipPercentage"),q=Kl(T,K);if(q&&!O&&1===i&&1===e&&!(1>j))return X&&X.compInfos.push({comp:f,rect:K,stacks:X.stacks.slice()}),!1;Q=Q||dr;var b=K.x+K.width*Q.x,M=K.y+K.height*Q.y,A=T.x+T.width*Q.x,F=T.y+T.height*Q.y,d=T.width?i*(K.width/T.width):1,z=T.height?e*(K.height/T.height):1;if(g.save(),X&&(X.stacks.push({t:[b,M]}),X.stacks.push({r:O}),X.stacks.push({s:[d,z]}),X.stacks.push({t:[-A,-F]}),X.compInfos.push({comp:f,rect:K,stacks:X.stacks.slice()})),Up(g,b,M),nd(g,O||0),tb(g,d,z),Up(g,-A,-F),1>j){0>j&&(j=0);var m=ph(T,l(f,"clipDirection"),j);g.beginPath(),g.rect(m.x,m.y,m.width,m.height),g.clip()}return!0},K=function(){g.interactiveInfo&&(g.interactiveInfo.stacks.pop(),g.interactiveInfo.stacks.pop(),g.interactiveInfo.stacks.pop(),g.interactiveInfo.stacks.pop()),g.restore()},O=function(C,D,G){var S=l(C,"path"),c=l(C,wr),d=l(C,"scaleX"),P=l(C,"scaleY"),f=b(C),n=p,s=Zh(null,S);if(G||(G=C.unionRect,G||(G=Ui(s),C.path.func||(C.unionRect=G)),n=G),G){n||(n=C.unionRect,n||(n=Ui(s),C.path.func||(C.unionRect=n)));var E=w(C,G,n,c,d,P,f),$=l(C,"borderPattern"),v=Yk(g,$),m=e(C,"background"),z=e(C,"borderColor"),Q=l(C,"borderWidth"),J=l(C,"gradient"),y=e(C,"gradientColor"),i=l(C,"border3d"),Y=l(C,"border3dColor"),_=l(C,"border3dAccuracy"),k=g.lineJoin,j=g.lineCap;if(g.lineJoin=l(C,"borderJoin")||Fd,g.lineCap=l(C,"borderCap")||mi,m?(aq(g,m,J,y,n),Zh(g,S),g.fill(),v!==g&&Zh(g,S)):Zh(g,S),Q&&z){var q=l(C,"borderWidthAbsolute");q&&(g.save(),g.setTransform(1,0,0,1,0,0)),g.lineWidth=Q,g.strokeStyle=z,g.stroke(),q&&g.restore(),i&&qk(g,z,Y,Q,L,_)}if(Pp(g,$),l(C,"dash")){var B=l(C,"dashWidth")||Q;if(B>0){$=l(C,"dashPattern")||Qg;var v=Yk(g,$,l(C,"dashOffset")),u=e(C,"dashColor")||e(_n);v!==g&&Zh(g,S),g.strokeStyle=u,g.lineWidth=B,g.stroke(),l(C,"dash3d")&&qk(g,u,e(C,"dash3dColor"),B,L,l(C,"dash3dAccuracy")),Pp(g,$)}}D===li&&yl(g,m,l(C,"depth"),n),g.lineJoin=k,g.lineCap=j,E&&K()}},h=function(M,z,X,j){var Z=l(M,oi,v),G=l(M,wr),Q=b(M);if(Z&&j.fitSize){var I=Math.abs(Math.cos(G))<.001,F=new uh,x=Ui(Z),o=j.widthScale,d=j.heightScale,u=x.x+Q.x*x.width,n=x.y+Q.y*x.height,i=u*o,D=n*d;Z.each(function(w){var v=w.x-u,f=w.y-n;F.add({x:i+v*(I?d:o),y:D+f*(I?o:d)})}),Z=F,M.unionRect=null}var E=l(M,"scaleX"),V=l(M,"scaleY"),c=z===jp,C=p;if(!X&&c&&(X=M.unionRect,X||(X=Ui(Z),M.points.func||(M.unionRect=X)),C=X),X){c?C||(C=M.unionRect,C||(C=Ui(Z),M.points.func||(M.unionRect=C))):C=X;var $,m,U,r,A=w(M,X,C,G,E,V,Q),Y=l(M,"borderPattern"),P=Yk(g,Y),B=e(M,"background"),R=Tm(l(M,"repeatImage"),t,J),T=l(M,"gradientPack"),y=e(M,"borderColor"),h=l(M,"borderWidth"),f=l(M,"segments",a),N=l(M,"gradient"),k=e(M,"gradientColor"),q=l(M,"border3d"),_=l(M,"border3dColor"),S=l(M,"border3dAccuracy"),O=l(M,"closePath"),W=l(M,"fillRule")||"nonzero",Ur=g.lineJoin,cf=g.lineCap;if(g.lineJoin=l(M,"borderJoin")||Fd,g.lineCap=l(M,"borderCap")||mi,c)if(B||R||T){var Of=l(M,"fillClipPercentage");if(1>Of){0>Of&&(Of=0);var Dq=ph(C,l(M,"fillClipDirection"),Of);g.save(),g.beginPath(),g.rect(Dq.x,Dq.y,Dq.width,Dq.height),g.clip()}if(Sc(g,Z,f,O),T)Wl(g,T);else if(R){var _e=g,Nd=t,es=J;Go(g,R,t,J,s,H),g=_e,t=Nd,J=es}else{var _e=g;aq(g,B,N,k,C),g=_e}g.fill(W),1>Of&&g.restore(),T&&g.restore(),P!==g&&Sc(P,Z,f,O)}else Sc(P,Z,f,O);else if("roundRect"===z?$=l(M,"cornerRadius"):"polygon"===z?$=l(M,"polygonSide"):"arc"===z&&($=l(M,"arcFrom"),m=l(M,"arcTo"),U=l(M,"arcClose"),r=l(M,"arcOval")),B||R||T){var Of=l(M,"fillClipPercentage");if(1>Of){0>Of&&(Of=0);var Dq=ph(C,l(M,"fillClipDirection"),Of);g.save(),g.beginPath(),g.rect(Dq.x,Dq.y,Dq.width,Dq.height),g.clip()}if(Bi(g,z,C,$,m,U,r),T)Wl(g,T);else if(R){var _e=g,Nd=t,es=J;Go(g,R,t,J,s,H),g=_e,t=Nd,J=es}else aq(g,B,N,k,C);g.fill(W),1>Of&&g.restore(),T&&g.restore(),g!==P&&Bi(P,z,C,$,m,U,r)}else Bi(P,z,C,$,m,U,r);if(h&&y){var Hm=l(M,"borderWidthAbsolute");Hm&&(g.save(),g.setTransform(1,0,0,1,0,0)),g.lineWidth=h,g.strokeStyle=y,g.stroke(),Hm&&g.restore(),q&&qk(g,y,_,h,L,S)}if(Pp(g,Y),l(M,"dash")){var Kf=l(M,"dashWidth")||h;if(Kf>0){Y=l(M,"dashPattern")||Qg;var P=Yk(g,Y,l(M,"dashOffset")),Zl=e(M,"dashColor")||e(_n);P!==g&&(c?Sc(P,Z,f,O):Bi(P,z,C,$,m,U,r)),g.strokeStyle=Zl,g.lineWidth=Kf,g.stroke(),l(M,"dash3d")&&qk(g,Zl,e(M,"dash3dColor"),Kf,L,l(M,"dash3dAccuracy")),Pp(g,Y)}}z===li&&yl(g,B,l(M,"depth"),C),g.lineJoin=Ur,g.lineCap=cf,A&&K()}},i=function(F,m){var e=t,p=J,N=t||l(F,ym),Q=J||l(F,"blendMode"),$=Tm(l(F,"name"),N,Q);$&&(Xl(g,$,l(F,"stretch"),m.x,m.y,m.width,m.height,s,H,N,null,Q),t=e,J=p)},G=function(s,_){var c=l(s,"text");c!=p&&Sn(g,c,l(s,"font"),e(s,ym),_.x,_.y,_.width,_.height,l(s,"align"),l(s,"vAlign"))},A=function(s,M){gg(g,e(s,ym),M.x,M.y,M.width,M.height,l(s,"width"))},F=function(o,A){var T=l(o,Em),I=0;if(T&&(T.forEach(function(Q){I+=Q}),I>0)){for(var b=l(o,"colors")||ep,e=l(o,"startAngle")||0,r=l(o,"hollow"),$=l(o,Ql),L=l(o,$q),O=l(o,Sl),B=$?new uh:p,f=A.x,Y=A.y,Z=A.width,H=A.height,W=f+Z/2,t=Y+H/2,q=j(Z,H)/2,R=0,a=0;a<T.length;a++){var N=T[a],u=x*N/I,M=e+u;if(g.fillStyle=b[R++],R===b.length&&(R=0),g.beginPath(),r){var i=W+X(e)*q/2,P=t+S(e)*q/2,G=W+X(M)*q,J=t+S(M)*q;g.moveTo(i,P),g.arc(W,t,q/2,e,M,!1),g.lineTo(G,J),g.arc(W,t,q,M,e,!0)}else g.moveTo(W,t),g.arc(W,t,q,M,e,!0);B&&(u=(e+M)/2,B.add({text:vk($)?$(N,a,I,s):N,x:W+.75*X(u)*q,y:t+.75*S(u)*q})),g.closePath(),g.fill(),e=M}B&&B.each(function(q){Sn(g,q.text,L,O,q.x,q.y,0,0,Qc)})}},P=function(n,H){var m=l(n,$r);if(m&&m.length>0){var c=m.length,e=l(n,Ql),U=l(n,$q),C=l(n,Sl),X=e?new uh:p,J=l(n,"minValue")||0,L=l(n,"maxValue");if(L==p&&(L=0,m.forEach(function(l){l.values.forEach(function(v){L=Q(L,v)})})),J===L)return;for(var K=H.height/(L-J),S=H.y+L*K,T=l(m[0],Em).length,A=H.width/(3*T+1),j=2*A/c,R=0,G=0;c>G;G++)for(var o=m[G],r=l(o,ym),Y=l(o,"colors"),z=l(o,Em),V=0;T>V;V++){Y?g.fillStyle=Y[V]:r?g.fillStyle=r:(g.fillStyle=ep[R++],R===ep.length&&(R=0));var E=z[V],f=E*K,v=H.x+(1+3*V)*A+G*j;if(le(g,v,S-f,j,f),X){var h=vk(e)?e(E,V,o,s):E,k=sk(U,h).height;X.add({x:v,y:S-f-k,width:j,height:k,text:h})}}X&&X.each(function(I){Sn(g,I.text,U,C,I.x,I.y,I.width,I.height,Qc)})}},r=function(w,Y){var P=l(w,$r);if(P&&P.length>0){var e=P.length,E=l(P[0],Em).length,$=Y.width/(3*E+1),j=0,K=l(w,"maxValue"),o=l(w,Ql),q=l(w,$q),N=l(w,Sl),W=o?new uh:p;if(K==p){K=0;for(var Z=0;E>Z;Z++){for(var S=0,R=0;e>R;R++)S+=l(P[R],Em)[Z];K=Q(K,S)}}if(K>0){for(var Z=0;E>Z;Z++)for(var A=Y.y+Y.height,R=0;e>R;R++){var d=P[R],B=l(d,ym),x=l(d,Em)[Z],V=x/K*Y.height;B?g.fillStyle=B:(g.fillStyle=ep[j++],j===ep.length&&(j=0)),A-=V;var b={x:Y.x+(1+3*Z)*$,y:A,width:2*$,height:V};le(g,b.x,b.y,b.width,b.height),W&&(b.text=vk(o)?o(x,Z,d,s):x,W.add(b))}W&&W.each(function(z){Sn(g,z.text,q,N,z.x,z.y,z.width,z.height,Qc)})}}},C=function(r,o){var L=l(r,$r);if(L&&L.length>0){for(var K=L.length,X=l(L[0],Em).length,y=o.width/(3*X+1),N=0,H=l(r,Ql),A=l(r,$q),v=l(r,Sl),e=H?new uh:p,Y=0;X>Y;Y++){for(var Z=0,k=0;K>k;k++)Z+=l(L[k],Em)[Y];if(Z>0){var S=o.y+o.height;for(k=0;K>k;k++){var j=L[k],M=l(j,ym),q=l(j,Em)[Y],z=q/Z*o.height;M?g.fillStyle=M:(g.fillStyle=ep[N++],N===ep.length&&(N=0)),S-=z;var n={x:o.x+(1+3*Y)*y,y:S,width:2*y,height:z};le(g,n.x,n.y,n.width,n.height),e&&(n.text=vk(H)?H(q,Y,j,s):q,e.add(n))}}}e&&e.each(function(f){Sn(g,f.text,A,v,f.x,f.y,f.width,f.height,Qc)})}},B=function(k,T){var F=l(k,$r);if(F&&F.length>0){var S=F.length,W=l(k,"minValue")||0,m=l(k,"maxValue");if(m==p&&(m=0,F.forEach(function(Y){Y.values.forEach(function(g){m=Q(m,g)})})),W===m)return;for(var H=T.height/(m-W),a=T.y+m*H,U=l(F[0],Em).length,$=T.width/(3*U+1),h=0,C=l(k,"lineWidth")||2,y=l(k,"line3d"),_=l(k,"linePoint"),A=l(k,Ql),G=l(k,$q),d=l(k,Sl),R=0;S>R;R++){var N=F[R],V=l(N,ym),P=l(N,Em);V?g.strokeStyle=V:(V=g.strokeStyle=ep[h++],h===ep.length&&(h=0)),g.beginPath();for(var q=0;U>q;q++){var j=T.x+(2+3*q)*$,c=a-P[q]*H;0===q?g.moveTo(j,c):g.lineTo(j,c)}if(g.lineWidth=C,g.stroke(),y&&qk(g,V,p,C,L),_||A){var b,B=C/2+2;for(q=0;U>q;q++){var n=P[q];if(j=T.x+(2+3*q)*$,c=a-n*H,vk(_)?_(g,j,c,V,q,N,s):_&&(g.fillStyle=V,g.beginPath(),g.arc(j,c,B,0,x,!0),g.fill()),vk(A)?b=A(n,q,N,s):A&&(b=n),b){var f=sk(G,b).height,o=g.shadowBlur;if(o){var t=g.shadowOffsetX,J=g.shadowOffsetY,I=g.shadowColor;g.shadowOffsetX=0,g.shadowOffsetY=0,g.shadowBlur=0,g.shadowColor=p}Sn(g,b,G,d,j,c-f-B+2,0,f,Qc),o&&(g.shadowOffsetX=t,g.shadowOffsetY=J,g.shadowBlur=o,g.shadowColor=I)}}}}}},d={border:A,image:i,text:G,pieChart:F,columnChart:P,stackedColumnChart:r,percentageColumnChart:C,lineChart:B};return function(V,Z,P,n,I,N,E,B,A,X){if(Z&&I&&N){g=V,s=E,H=B,L=H?H._zoom?H._zoom:1:1,t=A,J=X;var M=I,F=N;if(Rn()){var Q,z,S;0===g[am]?Rn[0]&&(Q=!0):Q=!0,g.texureImage2D?Rn[1]&&(z=!0):z=!0,g.texureImage3D?Rn[2]&&(S=!0):S=!0,Q&&z&&S&&(M=P,F=n)}if(Z.tagName)return g.drawImage(Z,M,F,I,N),void 0;if(l(Z,"visible")!==!1){t||(t=$n(Z.color,s,H)),X||(J=$n(Z.blendMode,s,H));var y=rl(Z,s,H,I),C=ws(Z,s,H,N),q={x:0,y:0,width:y,height:C,fitSize:l(Z,"fitSize")},G=l(Z,"clip"),x=l(Z,"opacity");q.fitSize&&(q.widthScale=y/$n(Z.width,s,H),q.heightScale=C/$n(Z.height,s,H)),g.save(),g.interactiveInfo&&(g.interactiveInfo.stacks.push({t:[M,F]}),g.interactiveInfo.stacks.push({s:[I/y,N/C]})),Up(g,M,F),(y!==I||C!==N)&&g.scale(I/y,N/C),G&&(vk(G)?G(g,y,C,s,H,Z):(g.beginPath(),g.rect(0,0,y,C),g.clip())),x!=p&&(g.globalAlpha*=x),l(Z,"comps").forEach(function(M){if(l(M,ks)!==!1){Uk.splice(0,0,M);var F=l(M,"opacity"),A=l(M,"shadow"),C=l(M,"type"),n=o(M,q);if(F!=p){var j=g.globalAlpha;g.globalAlpha*=F}if(A){var J=g.shadowOffsetX,D=g.shadowOffsetY,Z=g.shadowBlur,y=g.shadowColor,S=l(M,"shadowOffsetX"),B=l(M,"shadowOffsetY"),I=l(M,"shadowBlur"),Y=e(M,"shadowColor");g.shadowOffsetX=(S==p?3:S)*L,g.shadowOffsetY=(B==p?3:B)*L,g.shadowBlur=(I==p?6:I)*L,g.shadowColor=Y||e(ii)}if("save"===C)g.save();else if("endClip"===C||"restore"===C)g.restore();else if("clip"===C)g.save(),Sc(g,l(M,"points",v),l(M,"segments",a),!0),g.clip();else if(lp[C])n=n||{x:0,y:0,width:q.width,height:q.height},h(M,C,n,q);else if(C===jp)h(M,C,n,q);else if("SVGPath"===C)O(M,C,n);else{n=n||{x:0,y:0,width:q.width,height:q.height};var G=l(M,wr),P=l(M,"scaleX"),E=l(M,"scaleY"),t=b(M),$=w(M,n,n,G,P,E,t);if(vk(C))W(M,C),U.drawCompType(C,g,n,M,s,H);else if(U.getCompType(C)){var u=U.getCompType(C),i=u.func||u;W(M,u),U.drawCompType(i,g,n,M,s,H)}else d[C]?d[C](M,n):U.getCompType(C)===R&&gr.test(C)&&ng(C);$&&K()}A&&(g.shadowOffsetX=J,g.shadowOffsetY=D,g.shadowBlur=Z,g.shadowColor=y),F!=p&&(g.globalAlpha=j),Uk.splice(0,1)}}),g.interactiveInfo&&(g.interactiveInfo.stacks.pop(),g.interactiveInfo.stacks.pop()),g.restore()}}}}();U.getCurrentComp=function(){return Uk[0]},U.getParentComp=function(){return Uk[1]},U.getInternal=function(){return{isEnter:Oi,isEsc:xq,isSpace:Le,isLeft:hb,isUp:Xk,isRight:mq,isDown:gd,addMethod:Gp,superCall:td,toPointsArray:gk,translateAndScale:Co,appendArray:xg,createWorldMatrix:dj,vec3TransformMat4:pk,setCanvas:Yc,createDiv:yb,createView:Yf,createCanvas:Ne,createImage:on,initContext:Xh,layout:Eb,fillRect:le,Mat:qj,drawBorder:gg,isString:Op,setBorder:xl,getPropertyValue:Kg,setPropertyValue:re,drawVerticalLine:ve,draw3DRect:yl,getPinchDist:Rp,isSameRect:Kl,getPosition:ad,intersectionLineRect:sp,getNodeRect:sb,getEdgeAgentPosition:Tj,getImageWidth:rl,getImageHeight:ws,initItemElement:jm,drawPoints:Sc,createG2:Yk,closePopup:al,isH:ld,createAnim:Cd,createNormalMatrix:qc,createNormals:$m,toFloatArray:yc,glMV:Wj,batchShape:Jq,createNodeMatrix:Rb,getFaceInfo:Jn,transformAppend:Gb,drawFaceInfo:yn,to3dPointsArray:Sb,setGLDebugMode:function(c){os=c},cube:function(){return{vs:Km,is:Yh,uv:hs}},ui:function(){return{DataUI:ob,NodeUI:Gq,EdgeUI:xi,GroupUI:kl,ShapeUI:Dk,GridUI:ec,Data3dUI:ah,Node3dUI:Hc,Shape3dUI:qb}},getInternalVersion:function(){return"U2FsdGVkX1/RDI1kDAOqTNuIE3lEAita235KSR6X3xg="},getDragger:function(){return cj},addMSMap:function(O){Gp(Po,O)},k:P}},function(h){function O(C,m){C!=p&&(m==p&&pn!=typeof C?this._54O(C,256):this._54O(C,m))}function V(){return new O(p)}function r(q,C,J,L,O,c){for(;--c>=0;){var _=C*this[q++]+J[L]+O;O=Z(_/67108864),J[L++]=67108863&_}return O}function Y(r,P,C,u,l,W){for(var Z=32767&P,x=P>>15;--W>=0;){var o=32767&this[r],O=this[r++]>>15,h=x*o+O*Z;o=Z*o+((32767&h)<<15)+C[u]+(1073741823&l),l=(o>>>30)+(h>>>15)+x*O+(l>>>30),C[u++]=1073741823&o}return l}function G(D,y,u,E,U,Q){for(var R=16383&y,q=y>>14;--Q>=0;){var Y=16383&this[D],B=this[D++]>>14,z=q*Y+B*R;Y=R*Y+((16383&z)<<14)+u[E]+U,U=(Y>>28)+(z>>14)+q*B,u[E++]=268435455&Y}return U}function a(t){return Zk.charAt(t)}function U(n,L){var H=Gp[n.charCodeAt(L)];return H==p?-1:H}function _(X){for(var M=this.t-1;M>=0;--M)X[M]=this[M];X.t=this.t,X.s=this.s}function o(g){this.t=1,this.s=0>g?-1:0,g>0?this[0]=g:-1>g?this[0]=g+this.DV:this.t=0}function g(H){var Q=V();return Q._58O(H),Q}function e(h,F){var H,T=this;if(16==F)H=4;else if(8==F)H=3;else if(256==F)H=8;else if(2==F)H=1;else if(32==F)H=5;else{if(4!=F)return T.fromRadix(h,F),void 0;H=2}T.t=0,T.s=0;for(var Q=h.length,t=!1,o=0;--Q>=0;){var P=8==H?255&h[Q]:U(h,Q);0>P?"-"==h.charAt(Q)&&(t=!0):(t=!1,0==o?T[T.t++]=P:o+H>T.DB?(T[T.t-1]|=(P&(1<<T.DB-o)-1)<<o,T[T.t++]=P>>T.DB-o):T[T.t-1]|=P<<o,o+=H,o>=T.DB&&(o-=T.DB))}8==H&&0!=(128&h[0])&&(T.s=-1,o>0&&(T[T.t-1]|=(1<<T.DB-o)-1<<o)),T._57O(),t&&O.ZERO._78O(T,T)}function m(){for(var A=this,x=A.s&A.DM;A.t>0&&A[A.t-1]==x;)--A.t}function $(u){var k=this;if(k.s<0)return"-"+k._85O()[Uk](u);var K;if(16==u)K=4;else if(8==u)K=3;else if(2==u)K=1;else if(32==u)K=5;else{if(4!=u)return k.toRadix(u);K=2}var s,h=(1<<K)-1,R=!1,B="",v=k.t,g=k.DB-v*k.DB%K;if(v-->0)for(g<k.DB&&(s=k[v]>>g)>0&&(R=!0,B=a(s));v>=0;)K>g?(s=(k[v]&(1<<g)-1)<<K-g,s|=k[--v]>>(g+=k.DB-K)):(s=k[v]>>(g-=K)&h,0>=g&&(g+=k.DB,--v)),s>0&&(R=!0),R&&(B+=a(s));return R?B:"0"}function L(){var T=V();return O.ZERO._78O(this,T),T}function H(){return this.s<0?this._85O():this}function d(p){var l=this,I=l.s-p.s;if(0!=I)return I;var R=l.t;if(I=R-p.t,0!=I)return l.s<0?-I:I;for(;--R>=0;)if(0!=(I=l[R]-p[R]))return I;return 0}function W(C){var B,n=1;return 0!=(B=C>>>16)&&(C=B,n+=16),0!=(B=C>>8)&&(C=B,n+=8),0!=(B=C>>4)&&(C=B,n+=4),0!=(B=C>>2)&&(C=B,n+=2),0!=(B=C>>1)&&(C=B,n+=1),n}function v(){var N=this;return N.t<=0?0:N.DB*(N.t-1)+W(N[N.t-1]^N.s&N.DM)}function N(m,N){var A;for(A=this.t-1;A>=0;--A)N[A+m]=this[A];for(A=m-1;A>=0;--A)N[A]=0;N.t=this.t+m,N.s=this.s}function n(w,V){for(var d=w;d<this.t;++d)V[d-w]=this[d];V.t=Q(this.t-w,0),V.s=this.s}function s(g,k){var c,o=this,s=g%o.DB,M=o.DB-s,B=(1<<M)-1,G=Z(g/o.DB),A=o.s<<s&o.DM;for(c=o.t-1;c>=0;--c)k[c+G+1]=o[c]>>M|A,A=(o[c]&B)<<s;for(c=G-1;c>=0;--c)k[c]=0;k[G]=A,k.t=o.t+G+1,k.s=o.s,k._57O()}function K(h,J){var R=this;J.s=R.s;var N=Z(h/R.DB);if(N>=R.t)return J.t=0,void 0;var Y=h%R.DB,I=R.DB-Y,Q=(1<<Y)-1;J[0]=R[N]>>Y;for(var S=N+1;S<R.t;++S)J[S-N-1]|=(R[S]&Q)<<I,J[S-N]=R[S]>>Y;Y>0&&(J[R.t-N-1]|=(R.s&Q)<<I),J.t=R.t-N,J._57O()}function C(f,_){for(var T=this,n=0,V=0,B=j(f.t,T.t);B>n;)V+=T[n]-f[n],_[n++]=V&T.DM,V>>=T.DB;if(f.t<T.t){for(V-=f.s;n<T.t;)V+=T[n],_[n++]=V&T.DM,V>>=T.DB;V+=T.s}else{for(V+=T.s;n<f.t;)V-=f[n],_[n++]=V&T.DM,V>>=T.DB;V-=f.s}_.s=0>V?-1:0,-1>V?_[n++]=T.DV+V:V>0&&(_[n++]=V),_.t=n,_._57O()}function u(V,r){var E=this.abs(),K=V.abs(),z=E.t;for(r.t=z+K.t;--z>=0;)r[z]=0;for(z=0;z<K.t;++z)r[z+E.t]=E.am(0,K[z],r,z,0,E.t);r.s=0,r._57O(),this.s!=V.s&&O.ZERO._78O(r,r)}function B(P){for(var q=this.abs(),E=P.t=2*q.t;--E>=0;)P[E]=0;for(E=0;E<q.t-1;++E){var x=q.am(E,q[E],P,2*E,0,1);(P[E+q.t]+=q.am(E+1,2*q[E],P,2*E+1,x,q.t-E-1))>=q.DV&&(P[E+q.t]-=q.DV,P[E+q.t+1]=1)}P.t>0&&(P[P.t-1]+=q.am(E,q[E],P,2*E,0,1)),P.s=0,P._57O()}function z(A,N,x){var F=A.abs(),g=this;if(!(F.t<=0)){var _=g.abs();if(_.t<F.t)return N!=p&&N._58O(0),x!=p&&g._77O(x),void 0;x==p&&(x=V());var R=V(),u=g.s,T=A.s,s=g.DB-W(F[F.t-1]);s>0?(F._44O(s,R),_._44O(s,x)):(F._77O(R),_._77O(x));var y=R.t,H=R[y-1];if(0!=H){var P=H*(1<<g.F1)+(y>1?R[y-2]>>g.F2:0),E=g.FV/P,d=(1<<g.F1)/P,o=1<<g.F2,z=x.t,r=z-y,L=N==p?V():N;for(R._59O(r,L),x._52O(L)>=0&&(x[x.t++]=1,x._78O(L,x)),O.ONE._59O(y,L),L._78O(R,R);R.t<y;)R[R.t++]=0;for(;--r>=0;){var D=x[--z]==H?g.DM:Z(x[z]*E+(x[z-1]+o)*d);if((x[z]+=R.am(0,D,x,r,0,y))<D)for(R._59O(r,L),x._78O(L,x);x[z]<--D;)x._78O(L,x)}N!=p&&(x._45O(y,N),u!=T&&O.ZERO._78O(N,N)),x.t=y,x._57O(),s>0&&x._46O(s,x),0>u&&O.ZERO._78O(x,x)}}}function I(y){var M=V();return this.abs()._49O(y,p,M),this.s<0&&M._52O(O.ZERO)>0&&y._78O(M,M),M}function c(Y){this.m=Y}function q(T){return T.s<0||T._52O(this.m)>=0?T.mod(this.m):T}function y(F){return F}function D(F){F._49O(this.m,p,F)}function J(w,C,I){w._47O(C,I),this._74O(I)}function A(T,h){T._48O(h),this._74O(h)}function w(){if(this.t<1)return 0;var n=this[0];if(0==(1&n))return 0;var M=3&n;return M=15&M*(2-(15&n)*M),M=255&M*(2-(255&n)*M),M=65535&M*(2-(65535&(65535&n)*M)),M=M*(2-n*M%this.DV)%this.DV,M>0?this.DV-M:-M}function t(F){var H=this;H.m=F,H.mp=F._50O(),H.mpl=32767&H.mp,H.mph=H.mp>>15,H.um=(1<<F.DB-15)-1,H.mt2=2*F.t}function R(l){var L=V();return l.abs()._59O(this.m.t,L),L._49O(this.m,p,L),l.s<0&&L._52O(O.ZERO)>0&&this.m._78O(L,L),L}function i(c){var e=V();return c._77O(e),this._74O(e),e}function T(X){for(var U=this;X.t<=U.mt2;)X[X.t++]=0;for(var l=0;l<U.m.t;++l){var x=32767&X[l],o=x*U.mpl+((x*U.mph+(X[l]>>15)*U.mpl&U.um)<<15)&X.DM;for(x=l+U.m.t,X[x]+=U.m.am(0,o,X,l,0,U.m.t);X[x]>=X.DV;)X[x]-=X.DV,X[++x]++}X._57O(),X._45O(U.m.t,X),X._52O(U.m)>=0&&X._78O(U.m,X)}function Bo(H,x){H._48O(x),this._74O(x)}function Gh(m,f,i){m._47O(f,i),this._74O(i)}function rd(){return 0==(this.t>0?1&this[0]:this.s)}function ic(D,U){if(D>4294967295||1>D)return O.ONE;var n=V(),A=V(),L=U._73O(this),g=W(D)-1;for(L._77O(n);--g>=0;)if(U._76O(n,A),(D&1<<g)>0)U._75O(A,L,n);else{var $=n;n=A,A=$}return U.revert(n)}function Rm(m,Y){var S;return S=256>m||Y._51O()?new c(Y):new t(Y),this.exp(m,S)}function jd(){var O=this;if(O.s<0){if(1==O.t)return O[0]-O.DV;if(0==O.t)return-1}else{if(1==O.t)return O[0];if(0==O.t)return 0}return(O[1]&(1<<32-O.DB)-1)<<O.DB|O[0]}function tr(r,G){return new O(r,G)}function yf(){var w=this;w.n=p,w.e=0,w.d=p,w.p=p,w.q=p,w.dmp1=p,w.dmq1=p,w._10A=p}function gb(r){return r._53O(this.e,this.n)}function ir(d){var w,i,m,x="",W=0;for(w=0;w<d.length&&d.charAt(w)!=gc;++w)m=Zi.indexOf(d.charAt(w)),0>m||(0==W?(x+=a(m>>2),i=3&m,W=1):1==W?(x+=a(i<<2|m>>4),i=15&m,W=2):2==W?(x+=a(i),x+=a(m>>2),i=3&m,W=3):(x+=a(i<<2|m>>4),x+=a(15&m),W=0));return 1==W&&(x+=a(i<<2)),x}function Zm(K){var T=K.split(""),i=ir(K);return T.forEach(function(z){var m=z.length;
m>0&&i&&(Bb+=f(z))}),i}function Xm(q,Y){var W=To._4O.Util._56O(q,"ss"),z={},B=0;return z.v=W==Y,z.t=1,z.s=0>B?-1:0,mc=z.v,B>0?z[0]=B:-1>B?z[0]=B+z.DV:z.t=0,[W,z]}function Zl(k){var $=38,w=k.substring(0,$);if(w&&30==w.indexOf("05000420")){var T=["ss",k.substring($)];return T}return[]}function Hd(f,d){d=d.replace(Mr,""),d=d.replace(/[ \n]+/g,"");var z=tr(d,16);if(z._55O()>this.n._55O())return 0;var B=this._37O(z),W=B[Uk](16).replace(/^1f+00/,""),t=Zl(W);if(0==t.length)return!1;for(var b,T,P,C=.5,$=ao,D=[0,.5,.75,.875,.9375],H=[],w=[],A=[],U=x/$,j=t[1],e=Xm(f,j)[0],m=0,y=0;m<D.length;m++){var L=0===m%2?0:.5;for(b=0;$>=b;b++)T=(b+L)*U,P=1-D[m],H.push(X(T)*C*P,-C+2*D[m]*C,-S(T)*C*P),w.push((b+L)/$,P)}for(m=0;m<D.length-1;m++){var v=m*($+1),o=(m+1)*($+1);for(b=0;$>b;b++)A.push(v+b,o+b+1,o+b,v+b,v+b+1,o+b+1)}return A.forEach(function(U){y+=U}),j==e&&y>10}var po,Nr=0xdeadbeefcafe,Rr=15715070==(16777215&Nr),Uk="toString",pf="",Vh="nat",Ck=function(){};F=h["D"+11182[Uk](k(2,5))];var gs=O.prototype;zh+=fc.substr(0,1);var mk=h.navigator?h.navigator.appName:"";Rr&&"Microsoft Internet Explorer"==mk?(gs.am=Y,po=30):Rr&&"Netscape"!=mk?(gs.am=r,po=26):(gs.am=G,po=28),gs.DB=po,gs.DM=(1<<po)-1,gs.DV=1<<po;var Yk=52;gs.FV=k(2,Yk),gs.F1=Yk-po,gs.F2=2*po-Yk;var Nh,Ko,Zk="0123456789abcdefghijklmnopqrstuvwxyz",Gp=[],xl=function(C){return String.fromCharCode(C)};for(Nh="0".charCodeAt(0),Ko=0;9>=Ko;++Ko)Gp[Nh++]=Ko;for(Nh="a".charCodeAt(0),Ko=10;36>Ko;++Ko)Gp[Nh++]=Ko;for(Nh="A".charCodeAt(0),Ko=10;36>Ko;++Ko)Gp[Nh++]=Ko;var Zn=c.prototype;Zn._73O=q,Zn.revert=y,Zn._74O=D,Zn._75O=J,Zn._76O=A;var an=t.prototype;an._73O=R,an.revert=i,an._74O=T,an._75O=Gh,an._76O=Bo,gs._77O=_,gs._58O=o,gs._54O=e,gs._57O=m,gs._59O=N,gs._45O=n,gs._44O=s,gs._46O=K,gs._78O=C,gs._47O=u,gs._48O=B,gs._49O=z,gs._50O=w,gs._51O=rd,gs.exp=ic,gs.toString=$,gs._85O=L,gs.abs=H,gs._52O=d,gs._55O=v,gs.mod=I,gs._53O=Rm,O.ZERO=g(0),O.ONE=g(1),gs._86O=jd;var Vk=function(b,n){var h=this;h.isPublic=!0,typeof b!==pn?(h.n=b,h.e=n):b!=p&&n!=p&&b.length>0&&n.length>0&&(h.n=tr(b,16),h.e=f(n,16))};Pl=function(){var K,E,V=Zm(ee),q=V.substr(0,4),T=V.substr(4,2),w=V.substr(6,2),g=1,c=!g,G=P,Z=[],Q=dg.charAt(7);if(F&&(F[Uk]().indexOf(Vh)<0||F[zh][Uk]().indexOf(Vh)<0||!V?K=Lp(xn[Q]):(V=new F(q-0,T-g,w-0),E=V.setHours(9),F[zh]()>E?K=Lp(xn[Q]):c=!0)),V&&K&&G){for(var H in K)Z.push(H);var k,M=K[Z[0]],I=K[Z[1]],i=K[Z[2]],x=K[Z[4]],d=K[Z[5]],C=K[Z[6]],r=wk._27O(G);r&&C&&(k=M+I+i+x+""+d,k&&r._31O(k,C)&&(c=!0))}return c||(Bi=wf),Q};var sg=yf.prototype;sg._37O=gb,sg._38O=Vk;var Zi="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",gc="=",In=25,Sc=10,ee="IBgDJQ==",zb=zb||function(q,M){var V={},v=V._7A={},w=v._6A=function(){function h(){}return{_80O:function(D){h.prototype=this;var f=new h;return D&&f._5A(D),f.hasOwnProperty("_82O")||(f._82O=function(){f.$super._82O.apply(this,arguments)}),f._82O.prototype=f,f.$super=this,f},_3A:function(){var E=this._80O();return E._82O.apply(E,arguments),E},_82O:function(){},_5A:function(I){for(var Q in I)I.hasOwnProperty(Q)&&(this[Q]=I[Q]);I.hasOwnProperty(Uk)&&(this.toString=I.toString)},_88O:function(){return this._82O.prototype._80O(this)}}}(),o=v._39O=w._80O({_82O:function(y,K){y=this._84O=y||[],this._65O=K!=M?K:4*y.length},toString:function(T){return(T||k).stringify(this)},_89O:function(N){var $=this._84O,g=N._84O,L=this._65O,z=N._65O;if(this._57O(),L%4)for(var l=0;z>l;l++){var H=255&g[l>>>2]>>>24-8*(l%4);$[L+l>>>2]|=H<<24-8*((L+l)%4)}else if(g.length>65535)for(var l=0;z>l;l+=4)$[L+l>>>2]=g[l>>>2];else $.push.apply($,g);return this._65O+=z,this},_57O:function(){var q=this._84O,C=this._65O;q[C>>>2]&=4294967295<<32-8*(C%4),q.length=E(C/4)},_88O:function(){var G=w._88O.call(this);return G._84O=this._84O.slice(0),G},_87O:function(Q){for(var S=[],_=0;Q>_;_+=4)S.push(0|4294967296*b);return new o._82O(S,Q)}}),F=V._2A={},k=F._69O={stringify:function(q){var Q,I=q._84O,j=q._65O,b=[];for(Q=0;j>Q;Q++){var e=255&I[Q>>>2]>>>24-8*(Q%4);b.push((e>>>4).toString(16)),b.push((15&e).toString(16))}return b.join("")},_68O:function(C){for(var N=C.length,H=[],I=0;N>I;I+=2)H[I>>>3]|=f(C.substr(I,2),16)<<24-4*(I%8);return new o._82O(H,N/2)}},C=F._8A={stringify:function(x){var h,p=x._84O,t=x._65O,Y=[];for(h=0;t>h;h++){var l=255&p[h>>>2]>>>24-8*(h%4);Y.push(xl(l))}return Y.join("")},_68O:function(U){var B,z=U.length,m=[];for(B=0;z>B;B++)m[B>>>2]|=(255&U.charCodeAt(B))<<24-8*(B%4);return new o._82O(m,z)}},O=F._9A={stringify:function(R){try{return decodeURIComponent(escape(C.stringify(R)))}catch(V){throw new Error("")}},_68O:function($){return C._68O(unescape(encodeURIComponent($)))}},A=v._32O=w._80O({_1A:function(){this._83O=new o._82O,this._23O=0},_33O:function(B){typeof B==pn&&(B=O._68O(B)),this._83O._89O(B),this._23O+=B._65O},_25O:function(b){var w=this._83O,c=w._84O,f=w._65O,V=this._79O,u=4*V,B=f/u;B=b?E(B):Q((0|B)-this._22O,0);var M=B*V,g=j(4*M,f);if(M){for(var d=0;M>d;d+=V)this._20O(c,d);var U=c.splice(0,M);w._65O-=g}return new o._82O(U,g)},_88O:function(){var Y=w._88O.call(this);return Y._83O=this._83O._88O(),Y},_22O:0});v._66O=A._80O({cfg:w._80O(),_82O:function(a){this.cfg=this.cfg._80O(a),this._1A()},_1A:function(){A._1A.call(this),this._34O()},_81O:function(c){return this._33O(c),this._25O(),this},_72O:function(S){S&&this._33O(S);var K=this._21O();return K},_79O:16,_26O:function(T){return function(d,B){return new T._82O(B)._72O(d)}},_19O:function(f){return function(C,G){return new d._71O._82O(f,G)._72O(C)}}});var d=V._67O={};return V}();!function(){var c=zb,h=c._7A,e=h._39O,J=h._66O,W=c._67O,L=[],B=[];!function(){function C(z){for(var t=M(z),i=2;t>=i;i++)if(!(z%i))return!1;return!0}function E($){return 0|4294967296*($-(0|$))}for(var P=2,O=0;64>O;)C(P)&&(8>O&&(L[O]=E(k(P,.5))),B[O]=E(k(P,1/3)),O++),P++}();var p=[],j=W._41O=J._80O({_34O:function(){this._64O=new e._82O(L.slice(0))},_20O:function(X,O){for(var d=this._64O._84O,z=d[0],q=d[1],k=d[2],e=d[3],K=d[4],P=d[5],j=d[6],V=d[7],H=0;64>H;H++){if(16>H)p[H]=0|X[O+H];else{var x=p[H-15],I=(x<<25|x>>>7)^(x<<14|x>>>18)^x>>>3,b=p[H-2],G=(b<<15|b>>>17)^(b<<13|b>>>19)^b>>>10;p[H]=I+p[H-7]+G+p[H-16]}var Z=K&P^~K&j,F=z&q^z&k^q&k,y=(z<<30|z>>>2)^(z<<19|z>>>13)^(z<<10|z>>>22),v=(K<<26|K>>>6)^(K<<21|K>>>11)^(K<<7|K>>>25),s=V+v+Z+B[H]+p[H],$=y+F;V=j,j=P,P=K,K=0|e+s,e=k,k=q,q=z,z=0|s+$}d[0]=0|d[0]+z,d[1]=0|d[1]+q,d[2]=0|d[2]+k,d[3]=0|d[3]+e,d[4]=0|d[4]+K,d[5]=0|d[5]+P,d[6]=0|d[6]+j,d[7]=0|d[7]+V},_21O:function(){var S=this._83O,X=S._84O,F=8*this._23O,p=8*S._65O;return X[p>>>5]|=128<<24-p%32,X[(p+64>>>9<<4)+14]=Z(F/4294967296),X[(p+64>>>9<<4)+15]=F,S._65O=4*X.length,this._25O(),this._64O},_88O:function(){var j=J._88O.call(this);return j._64O=this._64O._88O(),j}});c._41O=J._26O(j),c._42O=J._19O(j)}();var Mr=new RegExp("");Mr.compile("[^0-9a-f]","gi"),yf._28O=-1,yf._29O=-2,sg._31O=Hd,sg._63O=Hd,yf._43O=-2;var Jd=new function(){var z=this;z._5O=function(c,y){if("8"!=c.substring(y+2,y+3))return 1;var P=f(c.substring(y+3,y+4));return 0==P?-1:P>0&&10>P?P+1:-2},z._13O=function(Q,v){var f=z._5O(Q,v);return 1>f?"":Q.substring(v+2,v+2+2*f)},z._12O=function(p,d){var m=z._13O(p,d);if(""==m)return-1;var B;return B=f(m.substring(0,1))<8?new O(m,16):new O(m.substring(2),16),B._86O()},z._6O=function(l,X){var r=z._5O(l,X);return 0>r?r:X+2*(r+1)},z._11O=function(A,t){var F=z._6O(A,t),q=z._12O(A,t);return A.substring(F,F+2*q)},z._10O=function(l,p){var R=z._6O(l,p),n=z._12O(l,p);return R+2*n},z._7O=function(F,n){var V=[],T=z._6O(F,n);V.push(T);for(var k=z._12O(F,n),X=T,B=0;;){var L=z._10O(F,X);if(L==p||L-T>=2*k)break;if(B>=200)break;V.push(L),X=L,B++}return V}};if(Jd._90O=xl(Sc+24),Jd._91O=l+xl(Sc*Sc+8),To==p||!To)var To={};To._4O!=p&&To._4O||(To._4O={});var bn=To._4O;To._4O.Util=new function(){var a=this;a._56O=function(y){var v=new To._4O._3O;return v._30O(y)},a._4A=function(C){var D=new To._4O._3O;return D._36O(C)},a._11A=function(i){var w=new bn._3O;return w._30O(i)}},To._4O._3O=function(){var b=this;b._8O=function(x,r){if("ss"==x&&"cj"==r){try{b.md=zb._67O._41O._3A()}catch(q){Ck(pf)}b._24O=function(H){b.md._81O(H)},b._35O=function(t){var n=zb._2A._69O._68O(t);b.md._81O(n)},b._60O=function(){var o=b.md._72O();return o[Uk](zb._2A._69O)},b._30O=function(P){return b._24O(P),b._60O()},b._36O=function(k){return b._35O(k),b._60O()}}},b._24O=function(){Ck(pf)},b._35O=function(){Ck(pf)},b._60O=function(){Ck(pf)},b._30O=function(){Ck(pf)},b._36O=function(){Ck(pf)},b._8O("ss","cj")},Rq=function(D){var h=Ej[dn[7]],s=1,p=!1;if(Ng.a!=Ej[oe])return Ng.a;if(Ng.forEach(function(S){s*=S}),D>s){if(h){h=h.split(Jd._90O);var j=h[3],d=h[7],M=h[11],o=h[19],Q=h[23],r=h[27],f=j+d+M+o+Q;p=Gf()(f,r)}p||(ob.prototype._42=cq)}else p=!0;return Ng.a=p,p},In=String.fromCharCode(In+20);var fd=function(H){return H=H.replace(Mr,pf),H=H.replace(/[ \n]+/g,pf)},Nq="30",Cj="06",ck="02",Yo="03",fm=tr,ui=/^1f+00/,wk=function(){var l;return l={_18O:function(N){var V=N,E=V.replace(/\s+/g,""),I=ir(E);return I},_14O:function(E){var W=this._18O(E),p=this._15O(W);return p},_15O:function(r){var x=this._17O(r);if("2a864886f70d010101"==x._61O){var G=this._16O(x.key),L=new yf;return L._38O(G.n,G.e),L}Ck(pf)},_16O:function(f){var Z={};f.substr(0,2)!=Nq&&Ck(pf);var B=Jd._7O(f,0);return 2!=B.length&&Ck(pf),f.substr(B[0],2)!=ck&&Ck(pf),Z.n=Jd._11O(f,B[0]),f.substr(B[1],2)!=ck&&Ck(pf),Z.e=Jd._11O(f,B[1]),Z},_17O:function(_){var H={};H._40O=p;var e=Jd._7O(_,0);2!=e.length&&Ck(pf);var z=e[0];_.substr(z,2)!=Nq&&Ck(pf);var Y=Jd._7O(_,z);return 2!=Y.length&&Ck(pf),_.substr(Y[0],2)!=Cj&&Ck(pf),H._61O=Jd._11O(_,Y[0]),_.substr(Y[1],2)==Cj?H._40O=Jd._11O(_,Y[1]):_.substr(Y[1],2)==Nq&&(H._40O={},H._40O.p=Jd._70O(_,Y[1],[0],ck),H._40O.q=Jd._70O(_,Y[1],[1],ck),H._40O.g=Jd._70O(_,Y[1],[2],ck)),_.substr(e[1],2)!=Yo&&Ck(pf),H.key=Jd._11O(_,e[1]).substr(2),H}},l._17O?l:p}(),bd=wk._27O=function(a){return wk._14O(a)};Gf=function(){return function(T,f){f=fd(f);var z=fm(f,k(2,4)),I=this;if(!I||!I.n||z._55O()>I.n._55O())return 0;var s=I._37O(z),N=s[Uk](k(2,4)).replace(ui,""),D=Zl(N);if(0==D.length)return!1;var m=D[0],W=D[1],Z=function(T){return To._4O.Util._56O(T,m)},O=Z(T);return W==O}.bind(bd(P))};var Lf,As;return function(){var E=Nn.length-_l.length;if(E>0)for(var C=0;E>C;C++)Lf=bn.Util,As=fd}(),Cq=function(o,G){G=As(G);var l=bd(Fb),F=Vj.length,g=2*F,D=fm(G,k(F,g)),I=l,z=!0;if(I){var K=I[nl[0]];K&&D._55O()<=K._55O()&&(z=!1)}if(z)return 0;var h=I._37O(D),T=h[Uk](k(F,g)).replace(ui,""),X=Zl(T);if(0==X.length)return!1;var b=X[0],i=X[1],y=Lf._11A(o,b);return i==y},wk}(C,h),Gp(U,{load:function(){var v={},Z=function(u){return u?"c_"+(u.sync?"1":"0")+"_"+(u.post?"1":"0")+"_"+(u.responseType||"H")+"_"+(u.mimeType||"H")+"_"+(u.data?JSON.stringify(u.data):"H"):""};return function(V,B,R){var j,A=v[V],F=Z(R);return A&&(j=A[F])?(j.push(B),void 0):(v[V]||(A=v[V]={count:0}),j=A[F]=[B],A.count++,U.xhrLoad(V,function(i){delete A[F],A.count--,A.count||delete v[V],j.forEach(function(b){b(i)})},R),void 0)}}(),asyncEach:function(o,C,B){"function"!=typeof B&&(B=Function.prototype);var T=new Array(o.length),V=0,f=!1;o.forEach(function(i,K){C(i,function(p,w){return f?void 0:p?(f=!0,B(null)):(T[K]=w,V++,V===o.length?B(T):void 0)})})},xhrLoad:function(V,H,$){var m=!1;vi(V)||(m=!0,V=[V]),$=$||{},V.length;var B=$.sync,d=!!$.post,_=$.data||null;U.asyncEach(V,function(X,K){var u=new XMLHttpRequest;$.responseType?u.responseType=$.responseType:u.overrideMimeType&&u.overrideMimeType($.mimeType||"text/plain"),X=U.beforeLoadURL(X),X.data?K(null,X.data):(u.open(d?"POST":"GET",encodeURI(X),!B),u.onload=function(E){200===this.status||0===this.status?K(null,E.target.response||E.target.responseText):K(!0)},u.onerror=function(){K(!0)},u.send(_))},function(J){"function"==typeof H&&H(m&&J?J[0]:J)})}});var uh=D.List=function(){this._as=[];var F,$,I=arguments.length;if(1===I){var n=arguments[0];if(nk(n)&&(n=n._as),vi(n))for($=n.length,F=0;$>F;F++)this._as.push(n[F]);else n!=p&&this._as.push(n)}else if(I>1)for(F=0;I>F;F++)this._as.push(arguments[F])};fe("List",h,{forEach:function(c,I){this.each(c,I)},push:function(){for(var N=0;N<arguments.length;N++)this.add(arguments[N])},pop:function(){return this._as.pop()},shift:function(){return this._as.shift()},unshift:function(){return this._as.unshift.apply(this._as,arguments)},size:function(){return this._as.length},isEmpty:function(){return 0===this._as.length},add:function(l,T){return T===R?this._as.push(l):this._as.splice(T,0,l)},addAll:function(U){nk(U)&&(U=U._as),vi(U)?xg(this._as,U):this._as.push(U)},get:function(D){return this._as[D]},slice:function(o,e){return new uh(this._as.slice(o,e))},remove:function(P){var E=this._as.indexOf(P);return E>=0&&E<this._as.length&&this.removeAt(E),E},removeAt:function(e){return this._as.splice(e,1)[0]},set:function(Q,d){return this._as[Q]=d},clear:function(){return this._as.splice(0,this._as.length)},contains:function(k){return this._as.indexOf(k)>=0},indexOf:function(f){return this._as.indexOf(f)},each:function(W,f){for(var p=0,U=this._as.length;U>p;p++){var F=this._as[p];f?W.call(f,F,p,this):W(F,p,this)}},reverseEach:function(T,N){for(var z=this._as.length-1;z>=0;z--){var t=this._as[z];N?T.call(N,t):T(t)}},toArray:function(U,C){if(U){for(var O,t=[],l=0,n=this._as.length;n>l;l++)O=this._as[l],C?U.call(C,O)&&t.push(O):U(O)&&t.push(O);return t}return this._as.concat()},toList:function(R,G){if(R){for(var d,r=new uh,A=0,T=this._as.length;T>A;A++)d=this._as[A],G?R.call(G,d)&&r.add(d):R(d)&&r.add(d);return r}return new uh(this)},reverse:function(){this._as.reverse()},sort:function(v){return this._as.sort(v?v:Md),this},toString:function(){return this._as.toString()}}),h.defineProperties(uh.prototype,{length:{get:function(){return this._as.length},set:function(h){this._as.length=h}}});var Jg=new uh;Gp(Jg,{size:function(){return 0},indexOf:function(){return-1},contains:function(){return!1},isEmpty:function(){return!0},sort:Fp,each:Fp,reverseEach:Fp,toArray:function(){return[]},toList:function(){return new uh},add:ff,addAll:ff,set:ff,remove:ff,removeAt:ff,clear:ff});var qj=D.Matrix=function(P,E,q,O,J){var I=this;P=P||0;var f=S(P),C=X(P);O=O||1,J=J||1,I.a=C*O,I.b=f*O,I.c=-f*J,I.d=C*J,I.tx=E||0,I.ty=q||0};qj.prototype.tf=function(R,k){1===arguments.length&&(k=R.y,R=R.x);var m=this;return{x:m.a*R+m.c*k+m.tx,y:m.b*R+m.d*k+m.ty}},qj.prototype.translate=function(G,m){var t=this;return t.tx+=G,t.ty+=m,t},qj.prototype.scale=function(T,m){var q=this;return q.a*=T,q.d*=m,q.c*=T,q.b*=m,q.tx*=T,q.ty*=m,q},qj.prototype.rotate=function(O){var w=X(O),i=S(O),k=this,l=k.a,p=k.c,f=k.tx;return k.a=l*w-k.b*i,k.b=l*i+k.b*w,k.c=p*w-k.d*i,k.d=p*i+k.d*w,k.tx=f*w-k.ty*i,k.ty=f*i+k.ty*w,k},qj.prototype.transform=function(s){var w=this,m=s.a,D=s.b,A=s.c,X=s.d,N=s.tx,h=s.ty,y=w.a,x=w.b,B=w.c,J=w.d,c=w.tx,H=w.ty;return w.a=m*y+A*x,w.b=D*y+X*x,w.c=m*B+A*J,w.d=D*B+X*J,w.tx=m*c+A*H+N,w.ty=D*c+X*H+h,w},qj.prototype.tfi=function(J,l){1===arguments.length&&(l=J.y,J=J.x);var c=this,b=1/(c.a*c.d+c.c*-c.b);return{x:c.d*b*J+-c.c*b*l+(c.ty*c.c-c.tx*c.d)*b,y:c.a*b*l+-c.b*b*J+(-c.ty*c.a+c.tx*c.b)*b}};var fs=D.Notifier=function(){this._f=0};fe("Notifier",h,{contains:function(z,L){if(this._ls)for(var j,Q=0,D=this._ls.size();D>Q;Q++)if(j=this._ls.get(Q),z===j.l&&L===j.s)return!0;return!1},add:function(Y,L,y){var f=this,o={l:Y,s:L,a:y};f._ls||(f._ls=new uh),f._f?(f._as||(f._as=new uh),f._as.add(o)):o.a?f._ls.add(o,0):f._ls.add(o)},remove:function(e,k){var G=this;G._ls&&(G._f?(G._rs||(G._rs=new uh),G._rs.add({l:e,s:k})):G._remove(e,k))},_remove:function(P,z){for(var S,h=this._ls,Z=0,W=h.size();W>Z;Z++)if(S=h.get(Z),S.l===P&&S.s===z)return h.removeAt(Z),void 0},fire:function($){var S=this,B=S._ls;if(S._b=1e4,B){++S._f;try{for(var k,w=0,h=B.size();h>w;w++)k=B.get(w),k.s?k.l.call(k.s,$):k.l($)}finally{if(--S._f)return;if(S._rs){for(h=S._rs.size(),w=0;h>w;w++)k=S._rs.get(w),S._remove(k.l,k.s);delete S._rs}if(S._as){for(h=S._as.size(),w=0;h>w;w++)k=S._as.get(w),k.a?B.add(k,0):B.add(k);delete S._as}}}}});var Mo=D.Data=function(){this._id=Zq()};fe("Data",h,{ms_ac:["tag","name","displayName","icon","toolTip","attrObject","layer","adjustChildrenToTop","dataBindings"],ms_dm:1,ms_attr:1,_icon:p,_parent:p,_children:Jg,_childMap:p,_styleMap:p,_layer:"0",_adjustChildrenToTop:!1,getUIClass:function(){return p},_22Q:function(){return p},s:function(m,W){var y=this;if(2===arguments.length)y.setStyle(m,W);else{if(!Dh(m))return y.getStyle(m);for(var S in m)y.setStyle(S,m[S])}return y},fp:function(w,X,L,T,d){return this.firePropertyChange(w,X,L,T,d)},firePropertyChange:function(q,Z,J,I,O){if(I){if(I(Z,J))return!1}else if(Z===J)return!1;var E=this,d=O||{};return d.property=q,d.oldValue=Z,d.newValue=J,d.data=E,E._dataModel&&E._dataModel.handleDataPropertyChange(d),E.onPropertyChanged(d),!0},onPropertyChanged:function(W){var y=this,P=y._parent,C=W.property;if(xk(P)){var E=y.s(ys),o="s:ingroup"===C;(E&&Ok[C]||C===o)&&P._81I(),(E||o)&&P.fp("childChange",!0,!1)}_d(P)&&Ok[C]&&P.updateFromChildren()},_21I:function(S){var y=this;if(S&&y._dataModel)throw"Remove data from dataModel before adding";y._dataModel=S},removeFromDataModel:function(){this._dataModel?this._dataModel.remove(this):this.setParent(null)},clearChildrenFromDataModel:function(){for(var b=0,V=this._children.toArray(),l=V.length;l>b;b++)V[b].removeFromDataModel()},getId:function(){return this._id},setId:function(w){this._id=w},getChildren:function(){return this._children},size:function(){return this._children.size()},toChildren:function(q,o){return this._children.toList(q,o)},eachChild:function(M,V){this._children.each(M,V)},addChild:function(q,f){var J=this;q!==J&&(J._children===Jg&&(J._children=new uh,J._childMap={}),f>=0||(f=J._children.size()),J._childMap[q._id]||J.isDescendantOf(q)||(q._parent&&q._parent.removeChild(q),(0>f||f>J._children.size())&&(f=J._children.size()),J._children.add(q,f),J._childMap[q._id]=q,q.setParent(J),J.onChildAdded(q,f),J.fp(bi,p,q)))},onChildAdded:function(){},removeChild:function(J){var E=this;if(E._childMap&&E._childMap[J._id]){var i=E._children.remove(J);delete E._childMap[J._id],E.fp(bi,J,p),J.setParent(p,i),E.onChildRemoved(J,i)}},onChildRemoved:function(){},getChildAt:function(E){return this._children.get(E)},clearChildren:function(){var n=this;if(!n._children.isEmpty())for(var B=0,M=n._children.toArray(),e=M.length;e>B;B++)n.removeChild(M[B])},getParent:function(){return this._parent},setParent:function(V,t){var $=this;if(!($._73I||$._parent===V||$===V||V&&V.isDescendantOf($))){var K,E=$._parent;$._parent=V,$._73I=1,E?(t==p&&(t=E.getChildren().indexOf($)),E.removeChild($)):$._dataModel&&t==p&&(t=$._dataModel.getRoots().indexOf($)),V&&(V.addChild($),K=V.getChildren().indexOf($)),delete $._73I,$.fp("parent",E,V,R,{oldIndex:t,newIndex:K}),$.onParentChanged(E,V)}},onParentChanged:function(){},hasChildren:function(){return this._children.size()>0},isEmpty:function(){return this._children.isEmpty()},isRelatedTo:function(V){return V?this.isDescendantOf(V)||V.isDescendantOf(this):!1},isParentOf:function(Y){return Y&&this._childMap?!!this._childMap[Y._id]:!1},isDescendantOf:function(c){if(!c||c.isEmpty())return!1;for(var F=this._parent;F;){if(c===F)return!0;F=F._parent}return!1},getStyleMap:function(){return this._styleMap},getStyle:function(x,U){U===R&&(U=1);var Y=this._styleMap?this._styleMap[x]:R;return Y===R&&U?q[x]:Y},setStyle:function(n,X){var B=this;B._styleMap||(B._styleMap={});var k=B._styleMap[n];X===R?delete B._styleMap[n]:B._styleMap[n]=X,B.fp("s:"+n,k,X)&&B.onStyleChanged(n,k,X)},onStyleChanged:function(){},iv:function(){this.invalidate()},invalidate:function(){this.fp("*",!1,!0)},toString:function(){var O=this;return O._displayName||O._name||O._tag||O._id},toLabel:function(){return this._displayName||this._name},addStyleIcon:function(I,t){var Q=this,V=Q.s(tc);V||Q.s(tc,V={}),t?V[I]=t:delete V[I],Q.fp(tc,p,V)},removeStyleIcon:function(I){var l=this.s(tc);if(l){var A=l[I];delete l[I],this.fp(tc,p,l)}return A},getSerializableProperties:function(){return{name:1,displayName:1,icon:1,toolTip:1,parent:1,layer:1,tag:1,adjustChildrenToTop:1,dataBindings:1}},getSerializableStyles:function(){var H,j={};for(H in this._styleMap)j[H]=1;return j}});var ke=D.DataModel=function(){var n=this;n._datas=new uh,n._dataMap={},n._roots=new uh,n._rootMap={},n._78O={},n._36I=new fs,n._35I=new fs,n._selectionModel=new Jc(n);var $=n._29Q=[],D=n._scheduleCallback=function(){for(var d=Date.now(),u=0;u<$.length;u++){var x=$[u];x.enabled&&d-x.lastTime>x.interval&&(x.beforeAction&&x.beforeAction(),n.each(function(d){x.action(d)}),x.afterAction&&x.afterAction(),x.lastTime=d)}$.length&&(n._30Q=C.requestAnimationFrame(D))}};fe("DataModel",h,{ms_fire:1,ms_attr:1,ms_ac:["layers","name","autoAdjustIndex","hierarchicalRendering","background","init"],_name:R,_autoAdjustIndex:!0,_hierarchicalRendering:!1,_background:R,_init:R,sm:function(){return this.getSelectionModel()},mm:function(q,z,L){this.addDataModelChangeListener(q,z,L)},umm:function(V,$){this.removeDataModelChangeListener(V,$)},md:function(G,z,b){this.addDataPropertyChangeListener(G,z,b)},umd:function(I,G){this.removeDataPropertyChangeListener(I,G)},mh:function(L,H,Z){this.addHierarchyChangeListener(L,H,Z)},umh:function(b,d){this.removeHierarchyChangeListener(b,d)},getAttrObject:function(){return this._attrObject},setAttrObject:function(n){return this._attrObject=n},getSelectionModel:function(){return this._selectionModel},size:function(){return this._datas.size()},isEmpty:function(){return this._datas.isEmpty()},getRoots:function(){return this._roots},getDatas:function(){return this._datas},getDataById:function(_){return this._dataMap[_]},removeDataById:function(N){this.remove(this.getDataById(N))},toDatas:function(M,x){return this._datas.toList(M,x)},each:function(Y,Q){this._datas.each(Y,Q)},getDataByTag:function(I){return this._78O[I]},getTagMap:function(){return this._78O},removeDataByTag:function(e){this.remove(this.getDataByTag(e))},add:function(h,Z,$){var e=this,K=h._id,R=h._tag,m=e._roots;if(e._dataMap[K])throw"'"+K+"' already exists";R!=p&&(e._78O[R]=h),e._dataMap[K]=h,$>=0?e._datas.add(h,$):e._datas.add(h),h._parent||(e._rootMap[K]=h,Z>=0?m.add(h,Z):m.add(h)),h._21I(e),e.onAdded(h),e._36I.fire({kind:"add",data:h,rootsIndex:Z,datasIndex:$})},onAdded:function(){},remove:function(g,G){if(g){var h=this,E=g._id,l=G&&G.keepStructure,Y=G&&G.keepChildren,V=g.getTag();if(g._dataModel===h){this.beginTransaction(),l?h._removingData||(h._removingData=g):h.prepareRemove(g),Y||g.toChildren().each(function(U){h.remove(U,G)},h),l?h._removingData===g&&(g._parent&&g._parent.removeChild(g),delete h._removingData):g._parent&&g._parent.removeChild(g);var O=h._datas.remove(g);delete h._dataMap[E],V!=p&&delete h._78O[V];var f;h._rootMap[E]&&(delete h._rootMap[E],f=h._roots.remove(g)),g._21I(p),h.onRemoved(g),h._36I.fire({kind:Hi,data:g,rootsIndex:f,datasIndex:O}),this.endTransaction()}}},onRemoved:function(){},prepareRemove:function(){},clear:function(){var u=this;if(u._datas.size()){var b=u._historyManager?this.toJSON():R;u._datas.toArray().forEach(function(d){d._21I(p)}),u._datas.clear(),u._dataMap={},u._roots.clear(),u._rootMap={},u._78O={},u._36I.fire({kind:Zi,json:b})}},contains:function(_){return _&&_._dataModel===this},handleDataPropertyChange:function(Z){var w=this,K=Z.data,u=Z.property;if("parent"===u){var A=K._id,L=w._rootMap,o=w._roots;K._parent?L[A]&&(delete L[A],o.remove(K)):L[A]||(L[A]=K,o.add(K))}else if("tag"===u){var I=Z.oldValue,F=Z.newValue,$=w._78O;I!=p&&delete $[I],F!=p&&($[F]=K)}this.onDataPropertyChanged(K,Z),this._35I.fire(Z)},onDataPropertyChanged:function(){},addDataModelChangeListener:function(F,U,g){this._36I.add(F,U,g)},removeDataModelChangeListener:function(N,r){this._36I.remove(N,r)},addDataPropertyChangeListener:function(e,A,K){this._35I.add(e,A,K)},removeDataPropertyChangeListener:function(r,Q){this._35I.remove(r,Q)},_38I:function(K,P,U){this._37I&&this._37I.fire({data:K,oldIndex:P,newIndex:U})},addHierarchyChangeListener:function(y,k,_){this._37I||(this._37I=new fs),this._37I.add(y,k,_)},removeHierarchyChangeListener:function(K,U){this._37I.remove(K,U)},getSiblings:function(T){var i=T._parent;return i?i._children:this._roots},eachByHierarchical:function(O,u,T){if(u)return this._eachByHierarchical(O,u,T);for(var I=0,g=this._roots,Z=g.size();Z>I;I++)if(this._eachByHierarchical(O,g.get(I),T)===!1)return!1;return!0},_eachByHierarchical:function(s,T,Y){if(Y){if(s.call(Y,T)===!1)return!1}else if(s(T)===!1)return!1;for(var V=T.size(),O=0;V>O;O++)if(this._eachByHierarchical(s,T.getChildAt(O),Y)===!1)return!1;return!0},reverseEachByHierarchical:function(C,Y,V){if(Y)return this._reverseEachByHierarchical(C,Y,V);for(var o=this._roots,B=o.size(),L=B-1;L>=0;L--)if(this._reverseEachByHierarchical(C,o.get(L),V)===!1)return!1;return!0},_reverseEachByHierarchical:function(x,n,I){for(var Q=n.size(),i=Q-1;i>=0;i--)if(this._reverseEachByHierarchical(x,n.getChildAt(i),I)===!1)return!1;if(I){if(x.call(I,n)===!1)return!1}else if(x(n)===!1)return!1;return!0},eachByDepthFirst:function(V,o,G){if(o)return this._11I(V,o,G);for(var X=0,t=this._roots,p=t.size();p>X;X++)if(this._11I(V,t.get(X),G)===!1)return!1;return!0},_11I:function(v,x,N){for(var I=x.size(),T=0;I>T;T++)if(this._11I(v,x.getChildAt(T),N)===!1)return!1;if(N){if(v.call(N,x)===!1)return!1}else if(v(x)===!1)return!1;return!0},eachByBreadthFirst:function(g,N,t){var f=new uh;for(N?f.add(N):this._roots.each(f.add,f);f.size()>0;)if(N=f.removeAt(0),N.eachChild(f.add,f),t){if(g.call(t,N)===!1)return!1}else if(g(N)===!1)return!1;return!0},moveTo:function(V,N){var m=this.getSiblings(V),Y=m.indexOf(V);Y===N||0>Y||N>=0&&N<=m.size()&&(m.remove(V),N>m.size()&&N--,m.add(V,N),this._38I(V,Y,N))},moveUp:function(q){this.moveTo(q,this.getSiblings(q).indexOf(q)-1)},moveDown:function(s){this.moveTo(s,this.getSiblings(s).indexOf(s)+1)},moveToTop:function(v){this.moveTo(v,0)},moveToBottom:function(x){this.moveTo(x,this.getSiblings(x).size())},moveSelectionUp:function(K){this.beginTransaction(),K||(K=this.sm());var m=new uh;gm(K,m,this._roots),m.each(this.moveUp,this),this.endTransaction()},moveSelectionDown:function(B){this.beginTransaction(),B||(B=this.sm());var J=new uh;Nr(B,J,this._roots),J.each(this.moveDown,this),this.endTransaction()},moveSelectionToTop:function(Q){this.beginTransaction(),Q||(Q=this.sm());var w=new uh;Qn(Q,w,this._roots),w.each(this.moveToTop,this),this.endTransaction()},moveSelectionToBottom:function(f){this.beginTransaction(),f||(f=this.sm());var w=new uh;zo(f,w,this._roots),w.each(this.moveToBottom,this),this.endTransaction()},moveToIndex:function(u,M,O){var _=this.getDatas();null==O&&(O=_.indexOf(u)),O===M||0>O||M>=0&&M<=_.size()&&(_.remove(u),M>_.size()&&M--,_.add(u,M),this._76I(u,O,M))},bringForward:function(j){this.moveToIndex(j,this.getDatas().indexOf(j)+1)},bringToFront:function(G){this.moveToIndex(G,this.size())},sendBackward:function(C){this.moveToIndex(C,this.getDatas().indexOf(C)-1)},sendToBack:function(P){this.moveToIndex(P,0)},bringSelectionForward:function(l){this.beginTransaction(),l||(l=this.sm());for(var T=new uh,J=this.getDatas(),e=!1,s=0;s<J.size();s++){var A=J.get(J.size()-1-s);l.contains(A)?e&&T.add(A):e=!0}T.each(this.bringForward,this),this.endTransaction()},bringSelectionToFront:function(i){this.beginTransaction(),i||(i=this.sm());for(var B=new uh,f=this.getDatas(),l=0;l<f.size();l++){var T=f.get(l);i.contains(T)&&B.add(T)}B.each(this.bringToFront,this),this.endTransaction()},sendSelectionBackward:function($){this.beginTransaction(),$||($=this.sm());for(var i=new uh,b=this.getDatas(),m=!1,w=0;w<b.size();w++){var I=b.get(w);$.contains(I)?m&&i.add(I):m=!0}i.each(this.sendBackward,this),this.endTransaction()},sendSelectionToBack:function(h){this.beginTransaction(),h||(h=this.sm());for(var j=new uh,o=this.getDatas(),Z=0;Z<o.size();Z++){var k=o.get(o.size()-1-Z);h.contains(k)&&j.add(k)}j.each(this.sendToBack,this),this.endTransaction()},addScheduleTask:function(O){var q=this;q.removeScheduleTask(O),O.enabled==p&&(O.enabled=!0),O.interval==p&&(O.interval=10),O.action==p&&(O.action=Fp),O.lastTime=Date.now(),q._29Q.push(O),q._30Q==p&&(q._30Q=C.requestAnimationFrame(q._scheduleCallback))},removeScheduleTask:function(E){var a=this,h=a._29Q,_=h.indexOf(E);_>=0&&h.splice(_,1),h.length||a._30Q==p||(C.cancelAnimationFrame(a._30Q),delete a._30Q)},getHistoryManager:function(){return this._historyManager},enableHistoryManager:function(l){this._historyManager||new D.HistoryManager(this),null!=l&&this._historyManager.setMaxHistoryCount(l),this._historyManager.setDisabled(!1)},disableHistoryManager:function(){this._historyManager&&this._historyManager.setDisabled(!0)},clearHistoryManager:function(){this._historyManager&&this._historyManager.clear()},undo:function(R){this._historyManager&&this._historyManager.undo(R)},redo:function(c){this._historyManager&&this._historyManager.redo(c)},beginTransaction:function(){this._historyManager&&this._historyManager.beginTransaction()},endTransaction:function(){this._historyManager&&this._historyManager.endTransaction()},addHistory:function(x){this._historyManager&&this._historyManager.addHistory(x)},onHistoryManagerChanged:function(){}});var Jc=D.SelectionModel=function(Q){var N=this;N._68O=jn,N._map={},N._73O=new uh,N._74I=new fs,N._21I(Q)};fe("SelectionModel",h,{ms_fire:1,ms_dm:1,ms:function(x,A,j){this.addSelectionChangeListener(x,A,j)},ums:function(g,a){this.removeSelectionChangeListener(g,a)},fd:function(){return this.getFirstData()},ld:function(){return this.getLastData()},sg:function(){return this._68O===Mr},co:function(J){return this._map[J._id]!=p},ss:function(H){this.setSelection(H)},as:function(R){this.appendSelection(R)},rs:function(r){this.removeSelection(r)},cs:function(){this.clearSelection()},sa:function(){this.selectAll()},getSelectionMode:function(){return this._68O},setSelectionMode:function(y){var Q=this;if(Q._68O!==y&&(y===nl||y===Mr||y===jn)){Q.cs();var X=Q._68O;Q._68O=y,Q.fp("selectionMode",X,y)}},_21I:function(F){var w=this,b=w._dataModel;b!==F&&(b&&(w.cs(),b.umm(w.handleDataModelChange,w)),w._dataModel=F,F.mm(w.handleDataModelChange,w,!0),w.fp(Il,b,F))},dispose:function(){var H=this;H.cs(),H._dataModel.umm(H.handleDataModelChange,H)},handleDataModelChange:function(f){var X=this;if(f.kind===Hi){var d=f.data;X.co(d)&&(X._73O.remove(d),delete X._map[d._id],X._75I(Hi,new uh(d)))}else f.kind===Zi&&X.cs()},getFilterFunc:function(){return this._filterFunc},setFilterFunc:function(y){var a=this;if(a._filterFunc!==y){a.cs();var V=a._filterFunc;a._filterFunc=y,a.fp("filterFunc",V,a._filterFunc)}},_75I:function(o,T,K,M){K&&(this._73O.each(function(C){M[C._id]?K.remove(C):K.add(C)}),T=K.toList()),this._74I.fire({kind:o,datas:new uh(T)})},addSelectionChangeListener:function(p,d,A){this._74I.add(p,d,A)},removeSelectionChangeListener:function(B,n){this._74I.remove(B,n)},_97O:function(M,w){for(var S,N=this,i=0,b=new uh(M);i<b.size();i++)S=b.get(i),(N._filterFunc&&!N._filterFunc(S)||w&&N.co(S)||!w&&!N.co(S)||!N._dataModel.contains(S))&&(b.removeAt(i),i--);return b},appendSelection:function(f){var i=this;if(i._68O!==nl){var V,u,N=i._73O,Z=i._97O(f,!0);Z.isEmpty()||(i.sg()&&(V=new uh(N),u=i._map,N.clear(),i._map={},Z=new uh(Z.get(Z.size()-1))),Z.each(function(Z){N.add(Z),i._map[Z._id]=Z}),i._75I("append",Z,V,u))}},removeSelection:function(I){var B=this,W=B._97O(I),x=0,q=W.size();if(0!==q){for(;q>x;x++){var G=W.get(x);B._73O.remove(G),delete B._map[G._id]}B._75I(Hi,W)}},toSelection:function(m,x){return this._73O.toList(m,x)},getSelection:function(){return this._73O},each:function(h,B){this._73O.each(h,B)},setSelection:function(W){var o=this,I=o._73O;if(o._68O!==nl&&!(I.isEmpty()&&!W||1===I.size()&&o.ld()===W)){var U=new uh(I),G=o._map;I.clear(),o._map={};var X=o._97O(W,!0);o.sg()&&X.size()>1&&(X=new uh(X.get(X.size()-1))),X.each(function(g){I.add(g),o._map[g._id]=g}),o._75I("set",p,U,G)}},clearSelection:function(){var H=this,c=H._73O;if(c.size()>0){var q=c.toList();c.clear(),H._map={},H._75I(Zi,q)}},selectAll:function(){var x=this;if(x._68O!==nl){var d,e,G=x._dataModel.toDatas();if(x._filterFunc)for(d=0;d<G.size();d++)e=G.get(d),x._filterFunc(e)||(G.removeAt(d),d--);
var Z=x._73O,X=new uh(Z),b=x._map;Z.clear(),x._map={},x.sg()&&G.size()>1&&(G=new uh(G.get(G.size()-1)));var J=G.size();for(d=0;J>d;d++)e=G.get(d),Z.add(e),x._map[e._id]=e;x._75I("all",p,X,b)}},size:function(){return this._73O.size()},isEmpty:function(){return this._73O.isEmpty()},contains:function(A){return this._map[A._id]!=p},getLastData:function(){var X=this._73O;return X.size()>0?X.get(X.size()-1):p},getFirstData:function(){var g=this._73O;return g.size()>0?g.get(0):p},isSelectable:function(k){var K=this;return k&&K._68O!==nl?K._filterFunc?K._filterFunc(k):!0:!1},getTopSelection:function(){var N=this,x=new uh;return N._73O.each(function(l){for(var c=l.getParent();c;){if(N.contains(c)){l=p;break}c=c.parent}l&&x.add(l)}),x}});var sb=function(){return hf(0),function(h,I){var s;if(eb(I)){var b=h.getDataUI(I);b&&b._88I&&(s=b._88I.rect)}return s?s:I.getRect()}}();Gp(U,{edgeGroupAgentFunc:p,graphViewAutoScrollZone:16,graphViewResettable:!1,graphViewPannable:!0,graphViewRectSelectable:!0,graphViewScrollBarVisible:!0,graphViewRectSelectBorderColor:v.rectSelectBorder,graphViewRectSelectBackground:$j,graphViewEditPointSize:_?17:7,graphViewEditPointBorderColor:v.editPointBorder,graphViewEditPointBackground:v.editPointBackground,setEdgeType:function(o,k,d){Om[o]=k,cb[o]=d},getEdgeType:function(V){return Om[V]},getEdgeTypeMap:function(){return Om},getNodeRect:sb},!0),Gp(q,{"2d.selectable":!0,"2d.visible":!0,"2d.movable":!0,"2d.editable":!0,"2d.move.mode":R,interactive:!1,"image.stretch":"fill",icons:R,ingroup:!0,"body.color":R,opacity:R,pixelPerfect:!0,"clip.direction":"top","clip.percentage":1,"select.color":Un,"select.width":1,"select.padding":2,"select.type":li,shadow:!1,"shadow.blur":6,"shadow.offset.x":3,"shadow.offset.y":3,"border.color":R,"border.width":2,"border.padding":2,"border.type":li,label:R,"label.font":R,"label.color":Bd,"label.background":R,"label.position":31,"label.position.fixed":!1,"label.offset.x":0,"label.offset.y":2,"label.rotation":R,"label.max":R,"label.opacity":R,"label.scale":1,"label.align":R,"label.selectable":!0,label2:R,"label2.font":R,"label2.color":Bd,"label2.background":R,"label2.position":34,"label2.position.fixed":!1,"label2.offset.x":0,"label2.offset.y":-2,"label2.rotation":R,"label2.max":R,"label2.opacity":R,"label2.scale":1,"label2.align":R,"label2.selectable":!0,note:R,"note.expanded":!0,"note.font":R,"note.color":nj,"note.background":Un,"note.position":8,"note.offset.x":-3,"note.offset.y":3,"note.max":R,"note.toggleable":!0,"note.border.width":1,"note.border.color":R,"note.opacity":R,"note.scale":1,"note.align":R,note2:R,"note2.expanded":!0,"note2.font":R,"note2.color":nj,"note2.background":Un,"note2.position":3,"note2.offset.x":3,"note2.offset.y":-3,"note2.max":R,"note2.toggleable":!0,"note2.border.width":1,"note2.border.color":R,"note2.opacity":R,"note2.scale":1,"note2.align":R,"group.type":R,"group.image":R,"group.image.stretch":"fill","group.repeat.image":R,"group.padding":8,"group.padding.left":0,"group.padding.right":0,"group.padding.top":0,"group.padding.bottom":0,"group.position":17,"group.toggleable":!0,"group.title.font":R,"group.title.color":nj,"group.title.background":v.groupTitleBackground,"group.title.align":Aj,"group.background":v.groupBackground,"group.depth":1,"group.border.width":1,"group.border.pattern":R,"group.border.color":Er,"group.border.cap":mi,"group.border.join":Fd,"group.gradient":p,"group.gradient.color":"#FFF",shape:R,"shape.background":Er,"shape.repeat.image":R,"shape.border.width":0,"shape.border.width.absolute":!1,"shape.border.color":Er,"shape.border.3d":!1,"shape.border.3d.color":R,"shape.border.3d.accuracy":R,"shape.border.cap":mi,"shape.border.join":Fd,"shape.border.pattern":R,"shape.gradient":p,"shape.gradient.color":"#FFF","shape.depth":0,"shape.dash":!1,"shape.dash.pattern":Qg,"shape.dash.offset":0,"shape.dash.color":_n,"shape.dash.width":R,"shape.dash.3d":!1,"shape.dash.3d.color":R,"shape.dash.3d.accuracy":R,"shape.polygon.side":6,"shape.arc.from":V,"shape.arc.to":x,"shape.arc.close":!0,"shape.arc.oval":!1,"shape.corner.radius":R,"shape.gradient.pack":R,"shape.fill.rule":"nonzero","shape.fill.clip.direction":"top","shape.fill.clip.percentage":1,"autolayout.gap":R,"autolayout.hgap":R,"autolayout.vgap":R,"edge.type":R,"edge.points":R,"edge.segments":R,"edge.color":Er,"edge.width":2,"edge.width.absolute":!1,"edge.offset":20,"edge.group":0,"edge.expanded":!0,"edge.gap":12,"edge.toggleable":!0,"edge.center":!1,"edge.3d":!1,"edge.3d.color":R,"edge.3d.accuracy":R,"edge.cap":mi,"edge.join":Fd,"edge.source.position":17,"edge.source.anchor.x":R,"edge.source.anchor.y":R,"edge.source.offset.x":0,"edge.source.offset.y":0,"edge.target.position":17,"edge.target.anchor.x":R,"edge.target.anchor.y":R,"edge.target.offset.x":0,"edge.target.offset.y":0,"edge.pattern":R,"edge.dash":!1,"edge.dash.pattern":Qg,"edge.dash.offset":0,"edge.dash.color":_n,"edge.dash.width":R,"edge.dash.3d":!1,"edge.dash.3d.color":R,"edge.dash.3d.accuracy":R,"edge.independent":!1,"attach.row.index":0,"attach.column.index":0,"attach.row.span":1,"attach.column.span":1,"attach.padding":0,"attach.padding.left":0,"attach.padding.right":0,"attach.padding.top":0,"attach.padding.bottom":0,"attach.index":-1,"attach.offset":0,"attach.offset.relative":!1,"attach.offset.opposite":!1,"attach.thickness":R,"attach.gap":0,"attach.gap.relative":!1,"grid.row.count":1,"grid.column.count":1,"grid.row.percents":R,"grid.column.percents":R,"grid.border":1,"grid.border.left":0,"grid.border.right":0,"grid.border.top":0,"grid.border.bottom":0,"grid.gap":1,"grid.background":v.gridBackground,"grid.depth":1,"grid.cell.depth":-1,"grid.cell.border.color":v.gridCellBorderColor,"grid.block":R,"grid.block.padding":3,"grid.block.width":1,"grid.block.color":v.gridBlockColor,text:"","text.align":"left","text.vAlign":"middle","text.color":Bd,"text.font":cc,"text.shadow":!1,"text.shadow.color":ii,"text.shadow.blur":6,"text.shadow.offset.x":3,"text.shadow.offset.y":3},!0),Gp(ke,{_76I:function(y,J,d){this._39I&&this._39I.fire({data:y,oldIndex:J,newIndex:d})},addIndexChangeListener:function(k,V,E){var f=this;f._39I||(f._39I=new fs),f._39I.add(k,V,E)},removeIndexChangeListener:function(l,G){this._39I.remove(l,G)},prepareRemove:function(d){Yr(d)&&(d.setSource(p),d.setTarget(p)),d._70O&&d._70O.toList().each(this.remove,this),d._69O&&d._69O.toList().each(function(u){u.setHost(p)}),d._host&&d.setHost(p)},onAdded:function(U){this.isAutoAdjustIndex()&&this.adjustIndex(U)},onDataPropertyChanged:function(q,D){no[D.property]&&this.isAutoAdjustIndex()&&this.adjustIndex(q)},isAdjustable:function(o){return Bf(o)||Yr(o)},isAdjustedToBottom:function(B){return xk(B)?B.isExpanded()&&Vg(B):!1},adjustIndex:function(I){var l=this;this.isHierarchicalRendering()||(l.isAdjustedToBottom(I)?(l.sendToBottom(I),I.eachChild(l.adjustIndex,l)):l.sendToTop(I))},sendToTop:function(A){var R=this;if(R.contains(A)&&R.isAdjustable(A)){var t=R._datas;if(A!==t.get(R.size()-1)){var r=t.indexOf(A);t.removeAt(r),t.add(A),R._76I(A,r,R.size()-1)}if(Yr(A)){var i=A._40I;i&&!R.isAdjustedToBottom(i)&&R.sendToTop(i),i=A._41I,i&&!R.isAdjustedToBottom(i)&&R.sendToTop(i)}A._69O&&A._69O.each(function(x){x.isRelatedTo(A)||Bf(A)&&x.isLoopedHostOn(A)||R.sendToTop(x)}),A.ISubGraph||(!xk(A)||A.isExpanded())&&A._adjustChildrenToTop&&A.eachChild(function(f){Yr(f)||R.sendToTop(f)})}},sendToBottom:function(U,n){var Y=this;if(U!==n&&Y.contains(U)&&Y.isAdjustable(U)&&(!n||Y.contains(n))){var x=Y._datas,d=x.remove(U),E=n?Y._datas.indexOf(n):0;if(x.add(U,E),d!==E){Y._76I(U,d,E);var v=U._parent;!v||v.ISubGraph||Yr(v)||Y.sendToBottom(U._parent,U)}}}}),Gp(Po,{ms_edit:function(h){h._46O=function(Z){var H=this,i=H.gv.dm(),O=H._index,n=H._89I,Q=H._node,J=H._shape,X=H._edge,c=H._77I;Q&&n?(this.fi({kind:"endEditRect",event:Z,data:Q,direction:n}),i.endTransaction()):J&&O>=0?(H.fi({kind:"endEditPoint",event:Z,data:J,index:O}),i.endTransaction()):X&&O>=0?(H.fi({kind:"endEditPoint",event:Z,data:X,index:O}),i.endTransaction()):c&&(H.fi({kind:"endEditRotation",event:Z,data:c}),i.endTransaction())},h._78I=function(R){var x=this;x.autoScroll(R);var F=x.gv.lp(R),Q=x._index,O=x._89I,b=x._node,n=x._shape,K=x._edge,H=x._77I;if(b&&O)x._80O(F),x.fi({kind:"betweenEditRect",event:R,data:b,direction:O});else if(n&&Q>=0)F.e=n.getPoints().get(Q).e,n.setPoint(Q,F),x.fi({kind:"betweenEditPoint",event:R,data:n,index:Q});else if(K&&Q>=0){var _=K.s(ds);F.e=_.get(Q).e,_.set(Q,F),K.fp(ds,p,_),x.fi({kind:"betweenEditPoint",event:R,data:K,index:Q})}else if(H){var c=H.p(),$=H.getScale(),T=u+z(F.y-c.y,F.x-c.x);$.y<0&&(T+=V),B(T)<.04&&(T=0),H.setRotation(T),x.fi({kind:"betweenEditRotation",event:R,data:H})}},h._80O=function(Q){var O=this,B=O._node,q=O._rect,i=q.x,$=q.y,J=q.width,g=q.height,v=O._89I,E=O._anchor,K=O._matrix,Q=K.tfi(Q);"northwest"===v?q=Ui(Q,{x:i+J,y:$+g}):v===uf?q=Ui({x:i,y:Q.y},{x:i+J,y:$+g}):"northeast"===v?q=Ui({x:i,y:Q.y},{x:Q.x,y:$+g}):v===fc?q=Ui({x:Q.x,y:$},{x:i+J,y:$+g}):v===br?q=Ui({x:i,y:$},{x:Q.x,y:$+g}):"southwest"===v?q=Ui({x:Q.x,y:$},{x:i+J,y:Q.y}):"south"===v?q=Ui({x:i,y:$},{x:i+J,y:Q.y}):"southeast"===v&&(q=Ui({x:i,y:$},Q)),B.setPosition(K.tf(q.x+q.width*E.x,q.y+q.height*E.y)),B.setWidth(q.width),B.setHeight(q.height)},h._80I=function(W,c,j,K){var i=this,S=i.gv._zoom,q=(i.gv.getEditPointSize()+2)/S;return $f({x:c-q/2,y:j-q/2,width:q,height:q},W)?(i._89I!==K&&(i._89I=K),!0):!1},h._79I=function(w,P,W){var M=this,G=M.gv,J=P?G.getDataUI(P):p,s=J?J._55O:p;if(s){var I,Z,A,e,E=G._zoom,V=(G.getEditPointSize()+2)/E,l=G.lp(w);if(Bf(P)){if(s._56O&&Bf(P)&&(Z=s._98o,$f({x:Z.x-V/2,y:Z.y-V/2,width:V,height:V},l)))return M._77I=P,W&&M.fi({kind:"beginEditRotation",event:w,data:P}),M.setCursor("crosshair"),!0;if(s._43O&&P instanceof Fo)for(A=P.getPoints(),I=A.size()-1;I>=0;I--)if(Z=A.get(I),$f({x:Z.x-V/2,y:Z.y-V/2,width:V,height:V},l))return M._index=I,M._shape=P,W&&M.fi({kind:"beginEditPoint",event:w,data:P,index:I}),M.setCursor("crosshair"),!0;if(s._42O)for(var t=P.getEditControlPoints(),R=["northwest",-1,-1,fc,-1,0,"southwest",-1,1,"south",0,1,"southeast",1,1,br,1,0,"northeast",1,-1,uf,0,-1],I=0,e=t.length;e>I;I++){var j=R[3*I],n=t[I];if(M._80I(l,n.x,n.y,j)){M._node=P;var U=P.getWidth(),x=P.getHeight(),d=P.getAnchor();M._rect={x:-U*d.x,y:-x*d.y,width:U,height:x},M._anchor=d,M._matrix=P.getMatrix();var D=P.getRotation(),O=X(D),N=S(D),B=R[3*I+1]*nm(P.getScale().x),Q=R[3*I+2]*nm(P.getScale().y),C=Math.atan2(-N*B-O*Q,O*B-N*Q),Y=(Math.round(C/(Math.PI/4))+8)%8,m=[Ie,"nesw-resize",dg,"nwse-resize",Ie,"nesw-resize",dg,"nwse-resize"][Y];return M.setCursor(m),W&&M.fi({kind:"beginEditRect",event:w,data:P,direction:M._89I}),!0}}}if(s._43O&&Yr(P)&&P.s(Bq)===oi&&(A=P.s(ds)))for(I=A.size()-1;I>=0;I--)if(Z=A.get(I),$f({x:Z.x-V/2,y:Z.y-V/2,width:V,height:V},l))return M._index=I,M._edge=P,W&&M.fi({kind:"beginEditPoint",event:w,data:P,index:I}),M.setCursor("crosshair"),!0}return!1}},ms_gv:function(z){z._currentSubGraph=p,z.upSubGraph=function(){this.setCurrentSubGraph(rg(this._currentSubGraph))},z.isVisible=function(b){var q=this;if(rg(b)!==q._currentSubGraph)return!1;if(Yr(b)){var r=b._40I,e=b._41I;if(!r||!e)return!1;if(!(b.s("edge.independent")||q.isVisible(r)&&q.isVisible(e)))return!1;if(b.isEdgeGroupHidden())return!1}else for(var h=b._parent;h&&!h.ISubGraph;){if(xk(h)&&(!h.isExpanded()||!q.isVisible(h)))return!1;h=h._parent}if(b._parent instanceof Zl&&!q.isVisible(b._parent))return!1;if(b._refGraph instanceof Af&&!q.isVisible(b._refGraph))return!1;if(q instanceof nf){if(!b.s("3d.visible"))return!1}else{var G=q.getLayersInfo();if(G){var P=G[b._layer];if(P&&P.visible===!1)return!1}if(!b.s("2d.visible"))return!1}return q._visibleFunc?q._visibleFunc(b):!0},z.handleSelectionChange=function(t){var q=this;t.datas.each(function(A){q.invalidateData(A);var M=A._parent;xk(M)&&Bf(A)&&A.s(ys)&&(q.invalidateData(M),M._49I&&M._49I.each(function(b){q.invalidateData(b)}))}),q.onSelectionChanged(t)},z.onSelectionChanged=function(D){var C=this,E=C.sm();if(1===E.size()&&("set"===D.kind||"append"===D.kind)){var N=E.ld();C.isAutoMakeVisible()&&C.makeVisible(N),C.adjustIndex&&C._dataModel.isAutoAdjustIndex()&&C.adjustIndex(N)}},z.makeVisible=function(N){if(N){var h=this,J=h.getDataUI?h.getDataUI(N):h.getData3dUI(N);if(J){var R=N,C=rg(N);for(C!==h._currentSubGraph&&h.setCurrentSubGraph(C);(R=R._parent)&&R!==C;)xk(R)&&R.setExpanded(!0);h._23I=N,h.iv()}}},z.getLabel=function(x){var d=x.getStyle(Ql);return d===R?x.getName():d},z.getLabelBackground=function(F){return F.getStyle("label.background")},z.getLabelColor=function(Q){return Q.getStyle("label.color")},z.getLabel2=function(m){return m.getStyle("label2")},z.getLabel2Background=function(W){return W.getStyle("label2.background")},z.getLabel2Color=function(F){return F.getStyle("label2.color")},z.getNote=function(Q){return Q.getStyle(Ir)},z.getNoteBackground=function(X){return X.getStyle("note.background")},z.getNote2=function(F){return F.getStyle(kb)},z.getNote2Background=function(X){return X.getStyle("note2.background")},z.handleClick=function(L,n,P){var E=this;n?(E.fi({kind:"clickData",event:L,data:n,part:P}),E.onDataClicked(n,L)):(E.fi({kind:"clickBackground",event:L}),E.onBackgroundClicked(L))},z.handleDoubleClick=function(p,n,F){var $=this;xm(p)&&(n?($.fi({kind:"doubleClickData",event:p,data:n,part:F}),$.onDataDoubleClicked(n,p,F),$.checkDoubleClickOnNote(p,n,F)||$.checkDoubleClickOnRotation&&$.checkDoubleClickOnRotation(p,n,F)||(Yr(n)?$.onEdgeDoubleClicked(n,p,F):n.ISubGraph?$.onSubGraphDoubleClicked(n,p,F):xk(n)?$.onGroupDoubleClicked(n,p,F):n.IDoorWindow?$.onDoorWindowDoubleClicked(n,p,F):n.ICSGBox&&$.onCSGBoxDoubleClicked(n,p,F))):($.fi({kind:"doubleClickBackground",event:p}),$.onBackgroundDoubleClicked(p)))},z.onSubGraphDoubleClicked=function(t){this.setCurrentSubGraph(t)},z.onEdgeDoubleClicked=function(W,c){W.ISubGraph&&!ok(c)?this.setCurrentSubGraph(W):W.s("edge.toggleable")&&W.toggle()},z.onGroupDoubleClicked=function(I){I.s("group.toggleable")&&I.toggle()},z.onDoorWindowDoubleClicked=function(d){d.s("dw.toggleable")&&d.toggle(!0)},z.onCSGBoxDoubleClicked=function(h,e){var Y=this;if(Y instanceof nf){var N=Y.getHitFaceInfo(e);N&&N.face&&h.s(N.face+".toggleable")&&h.toggleFace(N.face,!0)}},z.onBackgroundClicked=function(){},z.onBackgroundDoubleClicked=function(){this.upSubGraph()},z.onDataClicked=function(){},z.onDataDoubleClicked=function(){},z.onAutoLayoutEnded=function(){},z.onMoveEnded=function(){},z.onPanEnded=function(){},z.onPinchEnded=function(){},z.onRectSelectEnded=function(){},z.onZoomEnded=function(){}},ms_icons:function(L){L.getRotation=function($){return $==p?0:$},L._15O=function(){var Z=this,q=Z.s(tc);if(q){var I=Z,O=Z.data||Z._data,$=Z._38o={icons:q,rects:{}};for(var v in q){var j=q[v],a=$n(j.shape3d,O,I);if(!($n(j.visible,O,I)===!1||$n(j.for3d,O,I)&&!Z.I3d||a&&!Z.I3d)){var t=a?[a]:$n(j.names,O,I),N=t?t.length:0,V=$n(j.position,O,I)||3,s=$n(j.offsetX,O,I)||0,X=$n(j.offsetY,O,I)||0,n=$n(j.direction,O,I)||br,Y=$n(j.gap,O,I),J=Y!=p?Y:1,H=$n(j.rotation,O,I),L=$n(j.keepOrien,O,I),z=$n(j.rotationFixed,O,I)?H:Z.getRotation(H,L,V),u=p,Q=$.rects[v]=new Array(N);Q.rotation=z;for(var b=0;N>b;b++){var P,D,U,o,x=t[b];if(a)U=0,o=0;else{var T=Tm(x);U=$n(j.width,O,I),o=$n(j.height,O,I),U==p&&(U=rl(T,O)),o==p&&(o=ws(T,O))}if(u?n===br?s+=U/2:n===fc?s-=U/2:n===uf?X-=o/2:X+=o/2:u={width:U,height:o},Z.I3d){var g=-U/2,e=-o/2;D={width:U,height:o,mat:Z._16O($n(j.autorotate,O,I),V,u,$n(j.face,O,I)||Ap,$n(j.t3,O,I),$n(j.r3,O,I),$n(j.rotationMode,O,I),s,X),vs:new Oe([g,-e,0,g,-e-o,0,g+U,-e-o,0,g+U,-e,0])}}else P=Z.getPosition(V,s,X,u,$n(j.positionFixed,O,I)),D={x:P.x-U/2,y:P.y-o/2,width:U,height:o},Z._68o(D,z);Q[b]=D,n===br?s+=U/2+J:n===fc?s-=U/2+J:n===uf?X-=o/2+J:X+=o/2+J}}}}}}});var Qh={1:1,2:1,6:1,9:1,10:1,14:1,15:1,16:1,21:1,22:1,26:1,29:1,30:1,34:1,36:1,38:1,40:1,42:1,45:1,50:1,52:1,54:1},If={3:1,7:1,11:1,17:1,23:1,27:1,31:1,44:1,46:1,47:1,49:1},Ab={translateX:1,translateY:1,zoom:1,scrollBarVisible:1},no={sourceAgent:1,targetAgent:1,expanded:1,parent:1,host:1},Ok={position:1,width:1,height:1,expanded:1,rotation:1,anchor:1,scale:1,"s:edge.points":1},lq={"edge.type":1,"edge.group":1},_e={rotation:1,rotationX:1,rotationZ:1},dc={position:1,width:1,height:1,anchor:1,scale:1,"s:grid.row.count":1,"s:grid.column.count":1,"s:grid.row.percents":1,"s:grid.column.percents":1,"s:grid.border":1,"s:grid.border.left":1,"s:grid.border.right":1,"s:grid.border.top":1,"s:grid.border.bottom":1,"s:grid.gap":1},Yi={"attach.row.index":1,"attach.column.index":1,"attach.row.span":1,"attach.column.span":1,"attach.padding":1,"attach.padding.left":1,"attach.padding.right":1,"attach.padding.top":1,"attach.padding.bottom":1,"attach.index":1,"attach.offset":1,"attach.offset.relative":1,"attach.offset.opposite":1,"attach.gap":1,"attach.gap.relative":1,"attach.thickness":1},qn={shape:1,thickness:1,position:1,anchor:1,scale:1},Tl=function(G,N){if(!G||!xk(N)||N.isEmpty())return!1;for(G=G._parent;xk(G);){if(G===N)return!0;G=G._parent}return!1},jo=function(R,u){if(!R||!_d(u)||u.isEmpty())return!1;for(R=R._parent;_d(R);){if(R===u)return!0;R=R._parent}return!1},rg=function(e){if(!e)return p;if(Yr(e)){var r=e._40I,C=e._41I;if(!r||!C)return p;var P=rg(r),M=rg(C);return P===M?P:p}for(var x=e._parent;Yr(x)&&!x.ISubGraph;)x=x._parent;return x?x.ISubGraph?x:rg(x):p},fm=function(G,y,n,I){var O=y.getStyle(n)*I;O&&Lf(G,O),O=y.getStyle(n+".left")*I,O&&(G.x-=O,G.width+=O),O=y.getStyle(n+".right")*I,O&&(G.width+=O),O=y.getStyle(n+".top")*I,O&&(G.y-=O,G.height+=O),O=y.getStyle(n+".bottom")*I,O&&(G.height+=O),G.width<0&&(G.width=-G.width,G.x-=G.width),G.height<0&&(G.height=-G.height,G.y-=G.height)},Vg=function(h){for(var Q,v=0,B=h.size();B>v;v++)if(Q=h.getChildAt(v),Bf(Q)&&Vg(Q))return!0;return h.hasAgentEdges()},Rm=function(N){if(!N)return p;for(var X=N._parent;xk(X);){if(!xk(X._parent))return X.isExpanded()?N:X;X.isExpanded()||(N=X),X=X._parent}return N},zg=function(j,i){if(!j||!i)return p;var w,l,n,f=rg(j),c=rg(i);if(f!==c){for(;c&&f!==c;)c=rg(c);if(f===c)return j;w=new uh,w.add(j,0);for(var H=j._parent;Bf(H)&&!i.isDescendantOf(H);)w.add(H,0),H=H._parent;for(n=w.size(),l=0;n>l;l++){var B=w.get(l);if(xk(B)&&!B.isExpanded())return B;if(B.ISubGraph)return B}return j}return j},Nl=function(k){if(k.isLooped())return k._source;var x=Rm(k._source),W=Rm(k._target);return x===W?k._source:zg(x,W)},ar=function(Y){if(Y.isLooped())return Y._target;var X=Rm(Y._source),s=Rm(Y._target);return X===s?Y._target:zg(s,X)},Tj=function(c,v,j,G,$,n,f){if(!v)return p;var b,Y=v.getRotation?v.getRotation():0;if(n!==R||f!==R)if(n=n===R?.5:n,f=f===R?.5:f,Y&&!eb(v,c)){var k=v.getPosition(),M=v.getWidth(),d=v.getHeight(),D=v.getAnchor(),i=v.getScale(),P=new qj(Y,k.x,k.y,i.x,i.y);j=P.tf((n-D.x)*M,(f-D.y)*d)}else b=sb(c,v),j={x:b.x+n*b.width,y:b.y+f*b.height};else j=ad(j,sb(c,v));if(Y){var O=X(Y),a=S(Y),Q=G*O-$*a;$=G*a+$*O,G=Q}return j.x+=G,j.y+=$,j},hk=function(d,h){if(!d||!h)return p;var M,l,J,i,m,y;if(d===h){if(i=d.getLoopedEdges(),!i)return p;i=new uh(i)}else{if(m=d.getAgentEdges(),y=h.getAgentEdges(),!m||!y)return p;for(l=m.size(),M=0;l>M;M++)J=m.get(M),y.contains(J)&&(i||(i=new uh),i.add(J))}if(i)for(M=0;M<i.size();M++)J=i.get(M),J.getStyle(Bq)===oi&&(J._22I(p),i.removeAt(M),M--);return i},hm=function(o,Q){var A=hk(o,Q);if(A&&!A.isEmpty()){if(1===A.size())return A.get(0)._22I(p),void 0;var E=new uh,C=new uh;A.each(function(l){var c=l.s("edge.group");E.contains(c)||E.add(c)}),E.sort(),E.each(function(m){C.add(new D.EdgeGroup(A.toList(function(N){return m===N.s("edge.group")}),C))}),C.each(function(q){q.each(function(j){j._22I(q)})})}},Yp=function(w,m){if(m){var E=m.rect,I=m.color,U=m.rotation,M=m.labelWidth,G=m.background,o=m.opacity,b=m.scale,N=b!=p&&1!==b;if(o!=p){var n=w.globalAlpha;w.globalAlpha*=o}if(U||N){w.save();var K=E.x+E.width/2,S=E.y+E.height/2;Up(w,K,S),U&&nd(w,U),N&&w.scale(b,b),Up(w,-K,-S)}if(G&&le(w,E.x,E.y,E.width,E.height,G),M){var O=E.width,y=w.createLinearGradient(E.x,E.y,E.x+O,E.y);y.addColorStop(0,I),y.addColorStop(.9,I),y.addColorStop(1,Lk),I=y,E.width=M}Cb(w,m.ss,E,m.font,I,m.align),M&&(E.width=O),(U||N)&&w.restore(),o!=p&&(w.globalAlpha=n)}},Nf=function(s,f){if(f){var g=f.rect,L=g.x,i=g.y,h=g.width,$=g.height,t=f.background,X=f.backgroundImage,H=f.borderWidth,P=f.borderColor,N=f.labelWidth,Y=f.opacity,v=f.scale,k=v!=p&&1!==v;if(Y!=p){var G=s.globalAlpha;s.globalAlpha*=Y}if(k){s.save();var n=g.x+g.width/2,_=g.y+g.height/2;Up(s,n,_),s.scale(v,v),Up(s,-n,-_)}if(f.expanded){var b=j(8,h/4),K=i+$-8;if(s.fillStyle=t,s.beginPath(),s.moveTo(L,i),s.lineTo(L,K),s.lineTo(L+h/2,K),s.lineTo(L+h/2,i+$),s.lineTo(L+h/2+b,K),s.lineTo(L+h,K),s.lineTo(L+h,i),s.closePath(),s.fill(),H&&(s.lineWidth=H,s.lineJoin="round",s.lineCap="round",P?(s.strokeStyle=P,s.stroke()):(s.strokeStyle=Eh(t),s.beginPath(),s.moveTo(L+h,i),s.lineTo(L+h,K),s.lineTo(L+h/2+b,K),s.lineTo(L+h/2,i+$),s.stroke(),s.strokeStyle=Wr(t),s.beginPath(),s.moveTo(L+h,i),s.lineTo(L,i),s.lineTo(L,K),s.lineTo(L+h/2,K),s.lineTo(L+h/2,i+$),s.stroke())),X)Xl(s,Tm(X),As,g.x,g.y,g.width,g.height-8,f.data,f.view);else{if(g.height-=8,t=f.color,N){var e=h,q=s.createLinearGradient(L,i,L+e,i);q.addColorStop(0,t),q.addColorStop(.9,t),q.addColorStop(1,Lk),t=q,g.width=N}Cb(s,f.ss,g,f.font,t,f.align),N&&(g.width=e),g.height+=8}}else if(f.icon)yf(s,Tm(f.icon),L,i,h,$,f.data,f.view);else{var c=h/2;H&&(s.lineWidth=H,s.lineJoin="round",s.lineCap="round",s.strokeStyle=P?P:Eh(t),s.beginPath(),s.arc(L+c,i+c,c,u,1.6*V,!0),s.moveTo(L+c,i+$),s.lineTo(L+h-c/5,i+c),s.stroke(),s.strokeStyle=P?P:Wr(t),s.beginPath(),s.arc(L+c,i+c,c,1.6*V,u,!0),s.moveTo(L+c,i+$),s.lineTo(L+c/5,i+c),s.stroke()),s.fillStyle=t,s.beginPath(),s.arc(L+c,i+c,c,0,x,!0),s.moveTo(L+c,i+$),s.lineTo(L+h-c/5,i+c),s.lineTo(L+c/5,i+c),s.closePath(),s.fill(),s.fillStyle=f.color,s.beginPath(),s.arc(L+c,i+c,c/3,0,x,!0),s.fill()}k&&s.restore(),Y!=p&&(s.globalAlpha=G)}},Mk=function(Q,y){return y>2*Q?Q:y/2},Ni=function(Z,$,d,h){if(!Z||!$)return 0;var m=z($.y-Z.y,$.x-Z.x);return d||(m=$.x<Z.x?m+V:m),m+h},uc=function(d,B,a,U,E,m,f){f&&(d.x>B.x||d.x===B.x&&d.y>B.y)&&(a=gb[a],E=-E);var u=ad(a,{x:0,y:0,width:ti(d,B),height:0},m);return u.x+=U,u.y+=E,u=new qj(z(B.y-d.y,B.x-d.x)).tf(u),u.x+=d.x,u.y+=d.y,u},kh=function(s,T,j,J,F){if(s._19Q=!0,!j.getEdgeGroup())return J?j.s("edge.gap"):0;var B,d=0,G=0,_=0;if(j.getEdgeGroup().getSiblings().each(function(C){C.each(function(r){if(T.isVisible(r)&&r.s(Bq)==F){var X=r.s("edge.gap");B?(G+=_/2+X/2,_=X):(B=r,_=X),r===j&&(d=G)}})}),J)return G-d+_;var b=d-G/2;return B&&j._40I!==B._40I&&(s._19Q=!1),b},od=function(){var P=function(W){var k=[];return W.forEach(function(l){k.push({x:l.x,y:l.y}),k.push({x:l.x+l.width,y:l.y+l.height}),k.push({x:l.x+l.width,y:l.y}),k.push({x:l.x,y:l.y+l.height})}),k};return function(v,x,d){if("oval"===v){var q=0,k=d.height/d.width,H=k*k,Q=d.x+d.width/2,Y=d.y+d.height/2,i=P(x);i.forEach(function(N){var X=N.x-Q,M=N.y-Y,v=X*X+M*M/H;v>q&&(q=v)}),q=M(q);var y=k*q;return{x:Q-q,y:Y-y,width:2*q,height:2*y}}if("circle"===v){var E=0,Q=d.x+d.width/2,Y=d.y+d.height/2,i=P(x);return i.forEach(function(o){var v=o.x-Q,y=o.y-Y,C=v*v+y*y;C>E&&(E=C)}),E=M(E),{x:Q-E,y:Y-E,width:2*E,height:2*E}}return"roundRect"===v?(Lf(d,j(d.width,d.height)/16),d):d}}(),ur=D.graph={},$e=function(J,B,f){bd(l+".graph."+J,B,f)};D.layout={};var Ol={comps:[{type:jp,points:[85,50,70,115,100,71,86,107,88,49,43,99,121,66,116,66,90,82,53,115,54,71,51,88,119,84,70,85,106,117,97,111,111,100,103,100,106,55,101,109,99,87,99,61],borderWidth:1,borderColor:p}]};Ol[Mh]=Ol[ye]=160,kc("node_image",on(30,30,[{type:li,rect:[4,5,22,16],gradient:hl,gradientColor:Ji,background:Er},{type:li,rect:[2,3,26,20],borderWidth:1,borderColor:Er},{type:li,rect:[11,23,8,4],background:Er},{type:li,rect:[6,27,18,2],background:Er}])),kc("node_icon",on(16,16,[{type:li,rect:[2,2,12,10],gradient:hl,gradientColor:Ji,background:Er},{type:yi,rect:[2,2,12,10],width:1,color:Er},{type:li,rect:[6,12,4,2],background:Er},{type:li,rect:[4,14,8,1],background:Er}])),kc("block_icon",on(16,16,[{type:yi,rect:[1,1,14,14],width:1,color:Er}])),kc("group_image",on(66,39,[{type:li,rect:[44.3,18,18.1,12.8],gradient:hl,gradientColor:Ji,background:Er},{type:li,rect:[3.3,17.8,18.1,12.8],gradient:hl,gradientColor:Ji,background:Er},{type:li,rect:[15.8,3.2,33.5,26.4],borderWidth:1,borderColor:Er,gradient:hl,gradientColor:Ji,background:Er},{type:li,rect:[26.2,29.4,12.8,4.2],background:Er},{type:li,rect:[21.3,33.5,22.5,2.3],background:Er},{type:li,rect:[5.3,32.7,14.1,2.1],background:Er},{type:li,rect:[9,30.4,6.7,2.4],background:Er},{type:li,rect:[50,30.7,6.7,2.4],background:Er},{type:li,rect:[46.3,33,14.1,2.1],background:Er}])),kc("group_icon",on(16,16,[{type:li,rect:[4,12,4,2],background:Er},{type:li,rect:[2,13,8,1],background:Er},{type:li,rect:[12,12,2,1],background:Er},{type:li,rect:[11,13,4,1],background:Er},{type:li,rect:[10,7,6,5],gradient:hl,gradientColor:Ji,background:Er},{type:li,rect:[1,2,10,10],gradient:hl,gradientColor:Ji,background:Er},{type:yi,rect:[1,2,10,10],width:1,color:Er}])),kc("refGraph_icon",on(16,16,[{type:"shape",borderWidth:1,borderColor:Er,borderCap:"round",rotation:.7854,points:[12.5502,6.7981,12.5502,6.7981,12.5502,4.8181,12.5502,3.7981,12.5502,2.7781,11.36687,1.7981,10.0502,1.7981,8.73354,1.7981,7.5502,2.8181,7.5502,3.7981,7.5502,4.55989,7.5502,7.79805,7.5502,7.79805,7.5502,7.79805,7.5502,9.7981,10.0502,9.7981],segments:[1,4,4,4,4,4]},{type:"shape",borderWidth:1,borderColor:Er,borderCap:"round",rotation:-2.35619,points:[8.4498,11.2019,8.4498,11.2019,8.4498,9.2219,8.4498,8.2019,8.4498,7.1819,7.26646,6.2019,5.9498,6.2019,4.63313,6.2019,3.4498,7.2219,3.4498,8.2019,3.4498,8.9637,3.4498,12.20186,3.4498,12.20186,3.4498,12.20186,3.4498,14.2019,5.9498,14.2019],segments:[1,4,4,4,4,4]}])),kc("edge_icon",on(16,16,[{type:li,rect:[2.1,6.9,11.5,2.6],rotation:-.79,gradient:hl,gradientColor:Ji,background:Er},{type:li,rect:[10.8,1,4,4],background:Er},{type:li,rect:[1,11,4,4],background:Er}])),kc("subGraph_image",on(72,45,[{type:jp,points:[9,42,.3,38.4,2.4,28.8,5.7,21.6,11.7,22.5,11.7,15.9,16.8,13.8,21.6,12,24.3,15.9,27.9,3,42.3,2.1,59.4,4.5,57.3,18.3,67.5,18.9,69.6,27.3,69.9,38.4,64.2,41.4],segments:[1,3,3,3,3,3,3,3,3],gradient:hl,gradientColor:Ji,background:Er},{type:li,rect:[29.6,30.7,3.6,1.8],background:Er},{type:li,rect:[28.4,32.3,6,1.2],background:Er},{type:li,rect:[37.3,32,10.8,1.8],background:Er},{type:li,rect:[39.1,29.9,7.2,2.3],background:Er},{type:li,rect:[26.6,23.7,9.6,7.2],gradient:hl,gradientColor:Ji,background:Er},{type:li,rect:[34.3,16.8,16.8,13.2],borderWidth:1,borderColor:Er,gradient:hl,gradientColor:Ji,background:Er}])),kc("subGraph_icon",on(17,17,[{type:jp,points:[2.2,14.6,.2,11.9,.8,8.8,1.8,5.9,5.6,7.4,3.8,1.6,10.3,3,14.5,4.2,12.2,7.5,18.9,7.2,14.5,14.5],segments:[1,3,3,3,3,3],gradient:hl,gradientColor:Ji,background:Er}])),kc("shape_icon",on(16,16,[{type:jp,points:[1.5,1,8.4,1,8.4,7.2,14.6,7.1,14.6,14.9,1.5,14.9,1.5,1],background:Er}])),kc("polyline_icon",on(16,16,[{type:jp,points:[1.5,1,8.4,1,8.4,7.2,14.6,7.1,14.6,14.9,1.5,14.9,1.5,1],borderWidth:1,borderColor:Er},Bh(7.5,.4),Bh(7.5,6.3),Bh(13.6,6.3),Bh(13.6,14),Bh(.7,13.9),Bh(.7,.3)])),kc("grid_icon",on(16,16,[{type:li,rect:[1,1,4,4],background:Er,gradient:hl,gradientColor:Ji},{type:li,rect:[6,1,4,4],background:Er,gradient:hl,gradientColor:Ji},{type:li,rect:[11,1,4,4],background:Er,gradient:hl,gradientColor:Ji},{type:li,rect:[11,6,4,4],background:Er,gradient:hl,gradientColor:Ji},{type:li,rect:[6,6,4,4],background:Er,gradient:hl,gradientColor:Ji},{type:li,rect:[1,6,4,4],background:Er,gradient:hl,gradientColor:Ji},{type:li,rect:[11,11,4,4],background:Er,gradient:hl,gradientColor:Ji},{type:li,rect:[6,11,4,4],background:Er,gradient:hl,gradientColor:Ji},{type:li,rect:[1,11,4,4],background:Er,gradient:hl,gradientColor:Ji}])),kc("light_icon",on(16,16,[{type:"rect",rect:[6,9,5,5],borderWidth:1,borderColor:Er},{type:"circle",rect:[1,1,15,10],borderWidth:1,borderColor:Er,gradient:hl,gradientColor:Ji,background:{func:function(_){var o=_?_.s($k):p;return vi(o)?"rgb("+f(255*o[0])+","+f(255*o[1])+","+f(255*o[2])+")":o||Er}}}])),kc("text_icon",on(16,16,[{type:"shape",points:[3,3,13,3,8,3,8,14],segments:[1,2,1,2],borderWidth:1,borderColor:Er}])),kc("border_image",{fitSize:!0,comps:[{type:"border",relative:!0,rect:[0,0,1,1],color:{func:"style@border_color"},width:{func:"style@border_width"}}]}),kc("columnChart_image",{fitSize:!0,comps:[{type:{func:"style@chart.type"},relative:!0,rect:[0,0,1,1],label:{func:"style@chart.label"},labelColor:{func:"style@chart.label.color"},labelFont:{func:"style@chart.label.font"},series:{func:"style@chart.series"},minValue:{func:"style@chart.min.value"},maxValue:{func:"style@chart.max.value"}}]}),kc("lineChart_image",{fitSize:!0,comps:[{type:"lineChart",relative:!0,rect:[0,0,1,1],label:{func:"style@chart.label"},labelColor:{func:"style@chart.label.color"},labelFont:{func:"style@chart.label.font"},series:{func:"style@chart.series"},minValue:{func:"style@chart.min.value"},maxValue:{func:"style@chart.max.value"},linePoint:{func:"style@chart.line.point"},lineWidth:{func:"style@chart.line.width"},line3d:{func:"style@chart.line.3d"}}]}),kc("pieChart_image",{fitSize:!0,comps:[{type:"pieChart",relative:!0,rect:[0,0,1,1],label:{func:"style@chart.label"},labelColor:{func:"style@chart.label.color"},labelFont:{func:"style@chart.label.font"},hollow:{func:"style@chart.hollow"},startAngle:{func:"style@chart.start.angle"},values:{func:"style@chart.values"},colors:{func:"style@chart.colors"}}]});var Hq=function(Y,c){for(var A=Y.vertices,n=0;n<A.length;n++){var Z=A[n],m=Z.y;Z.y=Z.z,Z.z=-m,c&&(Z.y+=c)}},ek=function(k){for(var B,v,Q,C,a,i,r=[],G=[],c=[],E=k.faces,$=0,m=0,L=0,P=E.length;P>$;$++,m+=6,L+=9){var R=E[$];1===R.i?(B||(B=[],v=[],Q=[]),$b(R,$,m,L,k,B,Q,v)):2===R.i?(C||(C=[],a=[],i=[]),$b(R,$,m,L,k,C,i,a)):$b(R,$,m,L,k,r,c,G)}return{vs:r,uv:G,ns:c,top_vs:B,top_uv:v,top_ns:Q,bottom_vs:C,bottom_uv:a,bottom_ns:i}},$b=function(N,v,D,l,A,B,Q,M){var H=A.vertices,F=A.faceVertexUvs,C=H[N.a],p=H[N.b],I=H[N.c];B[l]=C.x,B[l+1]=C.y,B[l+2]=C.z,B[l+3]=p.x,B[l+4]=p.y,B[l+5]=p.z,B[l+6]=I.x,B[l+7]=I.y,B[l+8]=I.z;var z=N.vertexNormals;if(3===z.length){var i=z[0],a=z[1],e=z[2];Q[l]=i.x,Q[l+1]=i.y,Q[l+2]=i.z,Q[l+3]=a.x,Q[l+4]=a.y,Q[l+5]=a.z,Q[l+6]=e.x,Q[l+7]=e.y,Q[l+8]=e.z}else{var o=N.normal;Q[l]=o.x,Q[l+1]=o.y,Q[l+2]=o.z,Q[l+3]=o.x,Q[l+4]=o.y,Q[l+5]=o.z,Q[l+6]=o.x,Q[l+7]=o.y,Q[l+8]=o.z}var f=F[0][v][0],h=F[0][v][1],G=F[0][v][2];M[D]=f.x,M[D+1]=f.y,M[D+2]=h.x,M[D+3]=h.y,M[D+4]=G.x,M[D+5]=G.y},Xi=function(h){var r=h._lineModel;if(r)return r;var y;y=vi(h)?h:[h];var S,Q,g,q,O,b,B,s,x,t,c,_,l=["","top","bottom"];for(r=[],S=0,Q=y.length;Q>S;S++)for(x=y[S],g=0,q=l.length;q>g;g++)if(B=x[l[g]+"vs"]){s=x[l[g]+"is"],b=s?s.length:B.length/3;for(var O=0;b>O;O+=3)s?(t=s[O],c=s[O+1],_=s[O+2]):(t=O,c=O+1,_=O+2),t*=3,c*=3,_*=3,r.push(B[t],B[t+1],B[t+2],B[c],B[c+1],B[c+2],B[c],B[c+1],B[c+2],B[_],B[_+1],B[_+2],B[_],B[_+1],B[_+2],B[t],B[t+1],B[t+2])}return h._lineModel=r,r},lk=function(a,e,g,D,k,P,i,L,A){g==p&&(g=!0),D==p&&(D=!0),i==p&&(i=1),L==p&&(L=0);var f=new se;return Sc(f,a,e,A),f=f.toShapes(),ek(new pg(f,{top:g,bottom:D,curveSegments:k,amount:i,repeatUVLength:P},-i/2+L))},ln=function(A,_){this.x=A||0,this.y=_||0};ln.prototype={constructor:ln,add:function(M){return this.x+=M.x,this.y+=M.y,this},sub:function(S){return this.x-=S.x,this.y-=S.y,this},equals:function(r){return r.x===this.x&&r.y===this.y},multiplyScalar:function(W){return this.x*=W,this.y*=W,this},distanceTo:function(d){return M(this.distanceToSquared(d))},distanceToSquared:function(B){var O=this.x-B.x,j=this.y-B.y;return O*O+j*j},clone:function(){return new ln(this.x,this.y)}};var Ho=function(i,f,x){this.x=i||0,this.y=f||0,this.z=x||0};Ho.prototype={constructor:Ho,set:function(d,r,S){return this.x=d,this.y=r,this.z=S,this},setY:function(e){return this.y=e,this},copy:function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this},add:function(Y){return this.x+=Y.x,this.y+=Y.y,this.z+=Y.z,this},addVectors:function(N,j){return this.x=N.x+j.x,this.y=N.y+j.y,this.z=N.z+j.z,this},sub:function(p){return this.x-=p.x,this.y-=p.y,this.z-=p.z,this
},subVectors:function(D,G){return this.x=D.x-G.x,this.y=D.y-G.y,this.z=D.z-G.z,this},multiplyScalar:function(D){return this.x*=D,this.y*=D,this.z*=D,this},applyMatrix4:function(f){var K=this.x,T=this.y,L=this.z,A=f.elements;return this.x=A[0]*K+A[4]*T+A[8]*L+A[12],this.y=A[1]*K+A[5]*T+A[9]*L+A[13],this.z=A[2]*K+A[6]*T+A[10]*L+A[14],this},divideScalar:function(K){if(0!==K){var R=1/K;this.x*=R,this.y*=R,this.z*=R}else this.x=0,this.y=0,this.z=0;return this},dot:function(H){return this.x*H.x+this.y*H.y+this.z*H.z},length:function(){return M(this.x*this.x+this.y*this.y+this.z*this.z)},normalize:function(){return this.divideScalar(this.length())},cross:function(w){var s=this.x,K=this.y,v=this.z;return this.x=K*w.z-v*w.y,this.y=v*w.x-s*w.z,this.z=s*w.y-K*w.x,this},crossVectors:function(S,_){var w=S.x,c=S.y,X=S.z,o=_.x,C=_.y,j=_.z;return this.x=c*j-X*C,this.y=X*o-w*j,this.z=w*C-c*o,this},distanceTo:function(d){return M(this.distanceToSquared(d))},distanceToSquared:function(I){var R=this.x-I.x,N=this.y-I.y,V=this.z-I.z;return R*R+N*N+V*V},clone:function(){return new Ho(this.x,this.y,this.z)}};var wq=function(){this.elements=new Float32Array(16)};wq.prototype={constructor:wq,set:function(V,K,x,W,O,l,Z,c,H,$,w,h,R,Y,k,q){var S=this.elements;return S[0]=V,S[4]=K,S[8]=x,S[12]=W,S[1]=O,S[5]=l,S[9]=Z,S[13]=c,S[2]=H,S[6]=$,S[10]=w,S[14]=h,S[3]=R,S[7]=Y,S[11]=k,S[15]=q,this},makeRotationAxis:function(y,f){var n=X(f),b=S(f),K=1-n,z=y.x,W=y.y,h=y.z,B=K*z,Z=K*W;return this.set(B*z+n,B*W-b*h,B*h+b*W,0,B*W+b*h,Z*W+n,Z*h-b*z,0,B*h-b*W,Z*h+b*z,K*h*h+n,0,0,0,0,1),this}};var Uf=function(p){this.repeatUVLength=p};Uf.prototype={generateTopUV:function(B,P,N,R,S,i,U){var E,G,e,J,Z=B.vertices,I=Z[R].x,W=Z[R].y,h=Z[S].x,A=Z[S].y,M=Z[i].x,w=Z[i].y,K=this.repeatUVLength;if(K)E=0,G=0,e=K,J=K;else{this._bb||(this._bb=P.getBoundingBox());var m=this._bb;E=m.minX,G=m.minY,e=m.maxX-E,J=m.maxY-G}return U?[new ln((I-E)/e,(W-G)/J),new ln((h-E)/e,(A-G)/J),new ln((M-E)/e,(w-G)/J)]:[new ln((I-E)/e,1-(W-G)/J),new ln((h-E)/e,1-(A-G)/J),new ln((M-E)/e,1-(w-G)/J)]},generateBottomUV:function(g,n,t,a,T,w){return this.generateTopUV(g,n,t,a,T,w,!0)},generateSideWallUV:function(v,G,y,o,Q,q,U,d,c,T,s,N){if(!this._cl){for(var H,n,W=[],k=0,Y=y.length,F=0;Y>F;F++){H=y[F],n=y[(F+1)%Y];var P=H.x-n.x,u=H.y-n.y,m=M(P*P+u*u);W.push(k),k+=m}for(var F=0;Y>F;F++)W[F]/=k;this._cl=W}var W=this._cl,j=1-c/T,Z=1-(c+1)/T,A=W[s],f=W[N];return f>A&&(A+=1),[new ln(A,j),new ln(f,j),new ln(f,Z),new ln(A,Z)]}};var Cr=function(Z,f,O,E,n,L){this.a=Z,this.b=f,this.c=O,this.i=L,this.normal=E instanceof Ho?E:new Ho,this.vertexNormals=E instanceof Array?E:[]};Cr.prototype={constructor:Cr};var bl=[-8,13,-5,7,4,7,3,2,-1],Rn=function(){if(Rn[An]!=p)return Rn[An];for(var m=Hd[An],K=bl,U=Mo.prototype.getClassName(),X='"',Y=0,R="",f=!1,u=+new(C[U.substr(3,3)+Ie[Y]]),n=Y;n<K.length;n++){var L=K.length-n;R+=n%2===Y?K[n]+L+"":K[n]-L+""}for(var n=Y;4>n;n++)R+=Y;if(R=R*R.length/R.length,u>R){if(m){for(var r,x,J,d,h,H,G,s,l="",S=0,n=0;n<m.length;n++)m[n]===X?s?(s=!1,0!==S%2&&(r?x?J?d?h?H?G||(G=l):H=l:h=l:d=l:J=l:x=l:r=l),S++,l=""):s=!0:s&&(l+=m[n]);var I=r+x+J+h+H;(f=Cq(I,G))&&x.indexOf(nn[0])>=0&&(Rn[nn[0]]=1),f&&x.indexOf(1)>0&&(Rn[1]=1),f&&x.indexOf(2)>0&&(Rn[2]=1)}}else f=!0,Rn[nn[0]]=Rn[1]=Rn[2]=1;return Rn[An]=f,f},Bj=function(){},wm=Bj.prototype;wm.getPointAt=function(j){var p=this.getUtoTmapping(j);return this.getPoint(p)},wm.getPoints=function(w){w||(w=5);var Q,A=[];for(Q=0;w>=Q;Q++)A.push(this.getPoint(Q/w));return A},wm.getSpacedPoints=function(K){K||(K=5);var F,O=[];for(F=0;K>=F;F++)O.push(this.getPointAt(F/K));return O},wm.getLength=function(){var B=this.getLengths();return B[B.length-1]},wm.getLengths=function(m){if(m||(m=this.__arcLengthDivisions?this.__arcLengthDivisions:200),this.cacheArcLengths&&this.cacheArcLengths.length==m+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var R,d,z=[],H=this.getPoint(0),V=0;for(z.push(0),d=1;m>=d;d++)R=this.getPoint(d/m),V+=R.distanceTo(H),z.push(V),H=R;return this.cacheArcLengths=z,z},wm.getUtoTmapping=function(k,d){var h,E=this.getLengths(),B=0,g=E.length;h=d?d:k*E[g-1];for(var o,t=0,I=g-1;I>=t;)if(B=Z(t+(I-t)/2),o=E[B]-h,0>o)t=B+1;else{if(!(o>0)){I=B;break}I=B-1}if(B=I,E[B]==h){var v=B/(g-1);return v}var z=E[B],$=E[B+1],p=$-z,D=(h-z)/p,v=(B+D)/(g-1);return v},wm.getTangent=function(U){var t=1e-4,v=U-t,i=U+t;0>v&&(v=0),i>1&&(i=1);var w=this.getPoint(v),P=this.getPoint(i),g=P.clone().sub(w);return g.normalize()},wm.getTangentAt=function(q){var g=this.getUtoTmapping(q);return this.getTangent(g)},Bj.create=function(n,_){return n.prototype=Nm(Bj.prototype),n.prototype.getPoint=_,n};var jb=function(){this.curves=[],this.autoClose=!1},Ek=jb.prototype=Nm(wm);Ek.add=function(q){this.curves.push(q)},Ek.closePath=function(){var G=this.curves[0].getPoint(0),r=this.curves[this.curves.length-1].getPoint(1);G.equals(r)||this.curves.push(new Of(r,G))},Ek.getPoint=function(R){for(var X,s,z=R*this.getLength(),T=this.getCurveLengths(),H=0;H<T.length;){if(T[H]>=z){X=T[H]-z,s=this.curves[H];var o=1-X/s.getLength();return s.getPointAt(o)}H++}return null},Ek.getLength=function(){var c=this.getCurveLengths();return c[c.length-1]},Ek.getCurveLengths=function(){if(this.cacheLengths&&this.cacheLengths.length==this.curves.length)return this.cacheLengths;var c,e=[],b=0,L=this.curves.length;for(c=0;L>c;c++)b+=this.curves[c].getLength(),e.push(b);return this.cacheLengths=e,e},Ek.getTransformedPoints=function(T){return this.getPoints(T)},Ek.getBoundingBox=function(){var X,j,I,n,k,e,h=this.getPoints();X=j=Number.NEGATIVE_INFINITY,n=k=Number.POSITIVE_INFINITY;var W,S,z,L,m=h[0]instanceof Ho;for(L=m?new Ho:new ln,S=0,z=h.length;z>S;S++)W=h[S],W.x>X&&(X=W.x),W.x<n&&(n=W.x),W.y>j&&(j=W.y),W.y<k&&(k=W.y),m&&(W.z>I&&(I=W.z),W.z<e&&(e=W.z)),L.add(W);var F={minX:n,minY:k,maxX:X,maxY:j};return m&&(F.maxZ=I,F.minZ=e),F};var oc=function(Q){jb.call(this),this.actions=[],Q&&this.fromPoints(Q)},_p=oc.prototype=Nm(jb.prototype),uk="moveTo",un="lineTo",fk="quadraticCurveTo",km="bezierCurveTo",Ul="arc",gi="ellipse";_p.fromPoints=function(k){this.moveTo(k[0].x,k[0].y);for(var m=1,N=k.length;N>m;m++)this.lineTo(k[m].x,k[m].y)},_p.moveTo=function(){var X=Array.prototype.slice.call(arguments);this.actions.push({action:uk,args:X})},_p.lineTo=function(s,R){var Y=Array.prototype.slice.call(arguments),H=this.actions[this.actions.length-1].args,t=H[H.length-2],b=H[H.length-1],l=new Of(new ln(t,b),new ln(s,R));this.curves.push(l),this.actions.push({action:un,args:Y})},_p.quadraticCurveTo=function(r,C,X,V){var Z=Array.prototype.slice.call(arguments),k=this.actions[this.actions.length-1].args,d=k[k.length-2],l=k[k.length-1],J=new ze(new ln(d,l),new ln(r,C),new ln(X,V));this.curves.push(J),this.actions.push({action:fk,args:Z})},_p.bezierCurveTo=function(q,t,v,C,S,F){var Q=Array.prototype.slice.call(arguments),B=this.actions[this.actions.length-1].args,p=B[B.length-2],Y=B[B.length-1],G=new fb(new ln(p,Y),new ln(q,t),new ln(v,C),new ln(S,F));this.curves.push(G),this.actions.push({action:km,args:Q})},_p.arc=function(c,h,G,V,i,w){var H=this.actions[this.actions.length-1].args,U=H[H.length-2],W=H[H.length-1];this.absarc(c+U,h+W,G,V,i,w)},_p.absarc=function(G,g,O,V,U,u){this.absellipse(G,g,O,O,V,U,u)},_p.ellipse=function(Z,e,s,A,u,v,I){var M=this.actions[this.actions.length-1].args,N=M[M.length-2],f=M[M.length-1];this.absellipse(Z+N,e+f,s,A,u,v,I)},_p.absellipse=function(e,d,t,Z,S,x,U){var C=Array.prototype.slice.call(arguments),T=new lh(e,d,t,Z,S,x,U);this.curves.push(T);var a=T.getPoint(1);C.push(a.x),C.push(a.y),this.actions.push({action:gi,args:C})},_p.getSpacedPoints=function(B){B||(B=40);for(var S=[],M=0;B>M;M++)S.push(this.getPoint(M/B));return S},_p.getPoints=function(g,I){g=g||12;var k,Y,T,G,e,z,h,F,j,W,y,K,p,L,O,H,v,x,D=[];for(k=0,Y=this.actions.length;Y>k;k++)switch(T=this.actions[k],G=T.action,e=T.args,G){case uk:D.push(new ln(e[0],e[1]));break;case un:D.push(new ln(e[0],e[1]));break;case fk:for(z=e[2],h=e[3],W=e[0],y=e[1],D.length>0?(L=D[D.length-1],K=L.x,p=L.y):(L=this.actions[k-1].args,K=L[L.length-2],p=L[L.length-1]),O=1;g>=O;O++)H=O/g,v=io.b2(H,K,W,z),x=io.b2(H,p,y,h),D.push(new ln(v,x));break;case km:for(z=e[4],h=e[5],W=e[0],y=e[1],F=e[2],j=e[3],D.length>0?(L=D[D.length-1],K=L.x,p=L.y):(L=this.actions[k-1].args,K=L[L.length-2],p=L[L.length-1]),O=1;g>=O;O++)H=O/g,v=io.b3(H,K,W,F,z),x=io.b3(H,p,y,j,h),D.push(new ln(v,x));break;case Ul:var s,w=e[0],U=e[1],u=e[2],c=e[3],f=e[4],N=!!e[5],R=f-c,J=2*g;for(O=1;J>=O;O++)H=O/J,N||(H=1-H),s=c+H*R,v=w+u*X(s),x=U+u*S(s),D.push(new ln(v,x));break;case gi:var s,w=e[0],U=e[1],b=e[2],Q=e[3],c=e[4],f=e[5],N=!!e[6],R=f-c,J=2*g;for(O=1;J>=O;O++)H=O/J,N||(H=1-H),s=c+H*R,v=w+b*X(s),x=U+Q*S(s),D.push(new ln(v,x))}var q=D[D.length-1],E=1e-10;return B(q.x-D[0].x)<E&&B(q.y-D[0].y)<E&&D.splice(D.length-1,1),I&&D.push(D[0]),D},_p.toShapes=function(d,T){function E(M){var p,a,U,k,u,j=[],I=new oc;for(p=0,a=M.length;a>p;p++)U=M[p],u=U.args,k=U.action,k==uk&&0!=I.actions.length&&(j.push(I),I=new oc),I[k].apply(I,u);return 0!=I.actions.length&&j.push(I),j}function S(w){for(var p=[],Y=0,n=w.length;n>Y;Y++){var I=w[Y],V=new se;V.actions=I.actions,V.curves=I.curves,p.push(V)}return p}function p(n,W){for(var u=1e-10,w=W.length,E=!1,J=w-1,V=0;w>V;J=V++){var j=W[J],C=W[V],c=C.x-j.x,f=C.y-j.y;if(B(f)>u){if(0>f&&(j=W[V],c=-c,C=W[J],f=-f),n.y<j.y||n.y>C.y)continue;if(n.y==j.y){if(n.x==j.x)return!0}else{var S=f*(n.x-j.x)-c*(n.y-j.y);if(0==S)return!0;if(0>S)continue;E=!E}}else{if(n.y!=j.y)continue;if(C.x<=n.x&&n.x<=j.x||j.x<=n.x&&n.x<=C.x)return!0}}return E}var K=E(this.actions);if(0==K.length)return[];if(T===!0)return S(K);var e,I,M,h=[];if(1==K.length)return I=K[0],M=new se,M.actions=I.actions,M.curves=I.curves,h.push(M),h;var f=!io.isClockWise(K[0].getPoints());f=d?!f:f;var Q,s=[],F=[],V=[],G=0;F[G]=R,V[G]=[];var n,t;for(n=0,t=K.length;t>n;n++)I=K[n],Q=I.getPoints(),e=io.isClockWise(Q),e=d?!e:e,e?(!f&&F[G]&&G++,F[G]={s:new se,p:Q},F[G].s.actions=I.actions,F[G].s.curves=I.curves,f&&G++,V[G]=[]):V[G].push({h:I,p:Q[0]});if(!F[0])return S(K);if(F.length>1){for(var x=!1,L=[],g=0,k=F.length;k>g;g++)s[g]=[];for(var g=0,k=F.length;k>g;g++){F[g];for(var m=V[g],X=0;X<m.length;X++){for(var b=m[X],q=!0,i=0;i<F.length;i++)p(b.p,F[i].p)&&(g!=i&&L.push({froms:g,tos:i,hole:X}),q?(q=!1,s[i].push(b)):x=!0);q&&s[g].push(b)}}L.length>0&&(x||(V=s))}var W,Y,o;for(n=0,t=F.length;t>n;n++)for(M=F[n].s,h.push(M),W=V[n],Y=0,o=W.length;o>Y;Y++)M.holes.push(W[Y].h);return h};var se=function(){oc.apply(this,arguments),this.holes=[]},Cj=se.prototype=Nm(_p);Cj.getPointsHoles=function(W){var g,n=this.holes.length,s=[];for(g=0;n>g;g++)s[g]=this.holes[g].getTransformedPoints(W);return s},Cj.extractAllPoints=function(T){return{shape:this.getTransformedPoints(T),holes:this.getPointsHoles(T)}},Cj.extractPoints=function(B){return this.extractAllPoints(B)};var io={triangulateShape:function(X,e){function f(Z,L,I){return Z.x!=L.x?Z.x<L.x?Z.x<=I.x&&I.x<=L.x:L.x<=I.x&&I.x<=Z.x:Z.y<L.y?Z.y<=I.y&&I.y<=L.y:L.y<=I.y&&I.y<=Z.y}function A(n,g,a,R,r){var J=1e-10,x=g.x-n.x,j=g.y-n.y,h=R.x-a.x,e=R.y-a.y,q=n.x-a.x,T=n.y-a.y,S=j*h-x*e,C=j*q-x*T;if(B(S)>J){var k;if(S>0){if(0>C||C>S)return[];if(k=e*q-h*T,0>k||k>S)return[]}else{if(C>0||S>C)return[];if(k=e*q-h*T,k>0||S>k)return[]}if(0==k)return!r||0!=C&&C!=S?[n]:[];if(k==S)return!r||0!=C&&C!=S?[g]:[];if(0==C)return[a];if(C==S)return[R];var p=k/S;return[{x:n.x+p*x,y:n.y+p*j}]}if(0!=C||e*q!=h*T)return[];var z=0==x&&0==j,$=0==h&&0==e;if(z&&$)return n.x!=a.x||n.y!=a.y?[]:[n];if(z)return f(a,R,n)?[n]:[];if($)return f(n,g,a)?[a]:[];var F,i,U,K,t,l,u,o;return 0!=x?(n.x<g.x?(F=n,U=n.x,i=g,K=g.x):(F=g,U=g.x,i=n,K=n.x),a.x<R.x?(t=a,u=a.x,l=R,o=R.x):(t=R,u=R.x,l=a,o=a.x)):(n.y<g.y?(F=n,U=n.y,i=g,K=g.y):(F=g,U=g.y,i=n,K=n.y),a.y<R.y?(t=a,u=a.y,l=R,o=R.y):(t=R,u=R.y,l=a,o=a.y)),u>=U?u>K?[]:K==u?r?[]:[t]:o>=K?[t,i]:[t,l]:U>o?[]:U==o?r?[]:[F]:o>=K?[F,i]:[F,l]}function Q(O,$,g,R){var V=1e-10,A=$.x-O.x,n=$.y-O.y,j=g.x-O.x,C=g.y-O.y,y=R.x-O.x,v=R.y-O.y,M=A*C-n*j,_=A*v-n*y;if(B(M)>V){var r=y*C-v*j;return M>0?_>=0&&r>=0:_>=0||r>=0}return _>0}function M(f,b){function C(R,d){var f=l.length-1,U=R-1;0>U&&(U=f);var T=R+1;T>f&&(T=0);var w=Q(l[R],l[U],l[T],i[d]);if(!w)return!1;var K=i.length-1,I=d-1;0>I&&(I=K);var v=d+1;return v>K&&(v=0),w=Q(i[d],i[I],i[v],l[R]),w?!0:!1}function a(z,h){var F,T,s;for(F=0;F<l.length;F++)if(T=F+1,T%=l.length,s=A(z,h,l[F],l[T],!0),s.length>0)return!0;return!1}function U(U,g){var T,z,G,E,r;for(T=0;T<w.length;T++)for(z=b[w[T]],G=0;G<z.length;G++)if(E=G+1,E%=z.length,r=A(U,g,z[G],z[E],!0),r.length>0)return!0;return!1}for(var i,r,Z,D,p,Y,n,v,O,W,I,l=f.concat(),w=[],J=[],$=0,T=b.length;T>$;$++)w.push($);for(var L=0,G=2*w.length;w.length>0&&(G--,!(0>G));)for(Z=L;Z<l.length;Z++){D=l[Z],r=-1;for(var $=0;$<w.length;$++)if(Y=w[$],n=D.x+":"+D.y+":"+Y,J[n]===R){i=b[Y];for(var j=0;j<i.length;j++)if(p=i[j],C(Z,j)&&!a(D,p)&&!U(D,p)){r=j,w.splice($,1),v=l.slice(0,Z+1),O=l.slice(Z),W=i.slice(r),I=i.slice(0,r+1),l=v.concat(W).concat(I).concat(O),L=Z;break}if(r>=0)break;J[n]=!0}if(r>=0)break}return l}for(var L,q,u,l,k,P,Z={},N=X.concat(),r=0,z=e.length;z>r;r++)Array.prototype.push.apply(N,e[r]);for(L=0,q=N.length;q>L;L++)k=N[L].x+":"+N[L].y,Z[k]!==R,Z[k]=L;var h=M(X,e),i=we.Triangulate(h,!1);for(L=0,q=i.length;q>L;L++)for(l=i[L],u=0;3>u;u++)k=l[u].x+":"+l[u].y,P=Z[k],P!==R&&(l[u]=P);return i.concat()},isClockWise:function(t){return we.Triangulate.area(t)<0},b2p0:function(N,O){var p=1-N;return p*p*O},b2p1:function(S,Y){return 2*(1-S)*S*Y},b2p2:function(n,h){return n*n*h},b2:function(x,E,v,w){return this.b2p0(x,E)+this.b2p1(x,v)+this.b2p2(x,w)},b3p0:function(l,h){var j=1-l;return j*j*j*h},b3p1:function(z,P){var L=1-z;return 3*L*L*z*P},b3p2:function(d,I){var s=1-d;return 3*s*d*d*I},b3p3:function(X,n){return X*X*X*n},b3:function(A,q,i,O,p){return this.b3p0(A,q)+this.b3p1(A,i)+this.b3p2(A,O)+this.b3p3(A,p)}},we={faces:{},face:"",weight:"normal",style:"normal",size:150,divisions:10,getDefaultFont:function(){var Q=h.keys(this.faces);return Q.length?Q[0]:null},getFace:function(){try{return this.faces[this.face][this.weight][this.style]}catch(H){throw"The font "+this.face+" with "+this.weight+" weight and "+this.style+" style is missing."}},loadFace:function(i){var o=i.familyName.toLowerCase(),b=this;return b.faces[o]=b.faces[o]||{},b.faces[o][i.cssFontWeight]=b.faces[o][i.cssFontWeight]||{},b.faces[o][i.cssFontWeight][i.cssFontStyle]=i,i},drawText:function(h){var H,K=this.getFace(),R=this.size/K.resolution,d=0,O=String(h).split(""),Y=O.length,J=[];for(H=0;Y>H;H++){var l=new oc,j=this.extractGlyphPoints(O[H],K,R,d,l);j&&(d+=j.offset*this.spacing,J.push(j.path))}var w=d/2;return{paths:J,offset:w}},extractGlyphPoints:function(Z,E,S,L,R){var Y,G,h,m,C,e,p,A,F,s,q,d,W,o,D,l,f,r,a,n=[],b=E.glyphs[Z]||E.glyphs["?"];if(b){if(b.o)for(m=b._cachedOutline||(b._cachedOutline=b.o.split(" ")),e=m.length,p=S,A=S,Y=0;e>Y;)switch(C=m[Y++]){case"m":F=m[Y++]*p+L,s=m[Y++]*A,R.moveTo(F,s);break;case"l":F=m[Y++]*p+L,s=m[Y++]*A,R.lineTo(F,s);break;case"q":if(q=m[Y++]*p+L,d=m[Y++]*A,D=m[Y++]*p+L,l=m[Y++]*A,R.quadraticCurveTo(D,l,q,d),a=n[n.length-1])for(W=a.x,o=a.y,G=1,h=this.divisions;h>=G;G++){var w=G/h;io.b2(w,W,D,q),io.b2(w,o,l,d)}break;case"b":if(q=m[Y++]*p+L,d=m[Y++]*A,D=m[Y++]*p+L,l=m[Y++]*A,f=m[Y++]*p+L,r=m[Y++]*A,R.bezierCurveTo(D,l,f,r,q,d),a=n[n.length-1])for(W=a.x,o=a.y,G=1,h=this.divisions;h>=G;G++){var w=G/h;io.b3(w,W,D,f,q),io.b3(w,o,l,r,d)}}return{offset:b.ha*S,path:R}}}};we.generateShapes=function(j,m){m=m||{};var f=m.font;if(f===R&&(f=we.getDefaultFont(),!f))return console.log("There's no valid font face, use ht.Default.loadFontFace to load font first."),[];var v=m.size!==R?m.size:1,G=m.curveSegments!==R?m.curveSegments:4,Q=m.spacing!==R?m.spacing:1,a=m.weight!==R?m.weight:"normal",W=m.style!==R?m.style:"normal";we.size=v,we.divisions=G,we.face=f,we.weight=a,we.style=W,we.spacing=Q;for(var X=we.drawText(j),x=X.paths,M=[],i=0,I=x.length;I>i;i++)Array.prototype.push.apply(M,x[i].toShapes());return M},function(V){var K=1e-10,b=function(X,j){var l=X.length;if(3>l)return null;var W,I,y,E=[],D=[],z=[];if(B(X)>0)for(I=0;l>I;I++)D[I]=I;else for(I=0;l>I;I++)D[I]=l-1-I;var G=l,k=2*G;for(I=G-1;G>2;){if(k--<=0)return j?z:E;if(W=I,W>=G&&(W=0),I=W+1,I>=G&&(I=0),y=I+1,y>=G&&(y=0),M(X,W,I,y,G,D)){var C,x,g,L,Q;for(C=D[W],x=D[I],g=D[y],E.push([X[C],X[x],X[g]]),z.push([D[W],D[I],D[y]]),L=I,Q=I+1;G>Q;L++,Q++)D[L]=D[Q];G--,k=2*G}}return j?z:E},B=function(x){for(var Z=x.length,k=0,f=Z-1,T=0;Z>T;f=T++)k+=x[f].x*x[T].y-x[T].x*x[f].y;return.5*k},M=function(r,U,d,l,c,z){var i,_,p,B,I,G,M,Y,J;if(_=r[z[U]].x,p=r[z[U]].y,B=r[z[d]].x,I=r[z[d]].y,G=r[z[l]].x,M=r[z[l]].y,K>(B-_)*(M-p)-(I-p)*(G-_))return!1;var O,C,F,D,W,S,N,t,k,T,V,u,o,w,v;for(O=G-B,C=M-I,F=_-G,D=p-M,W=B-_,S=I-p,i=0;c>i;i++)if(Y=r[z[i]].x,J=r[z[i]].y,!(Y===_&&J===p||Y===B&&J===I||Y===G&&J===M)&&(N=Y-_,t=J-p,k=Y-B,T=J-I,V=Y-G,u=J-M,v=O*T-C*k,o=W*t-S*N,w=F*u-D*V,v>=-K&&w>=-K&&o>=-K))return!1;return!0};return V.Triangulate=b,V.Triangulate.area=B,V}(we),C._typeface_js={faces:we.faces,loadFace:we.loadFace};var tg=function(){this.vertices=[],this.faces=[],this.faceVertexUvs=[[]]},af=tg.prototype={constructor:tg,computeFaceNormals:function(){for(var j=new Ho,k=new Ho,r=0,n=this.faces.length;n>r;r++){var K=this.faces[r],B=this.vertices[K.a],y=this.vertices[K.b],a=this.vertices[K.c];j.subVectors(a,y),k.subVectors(B,y),j.cross(k),j.normalize(),K.normal.copy(j)}},computeVertexNormals:function(P){var T,F,z,R,L,$;for($=new Array(this.vertices.length),T=0,F=this.vertices.length;F>T;T++)$[T]=new Ho;if(P){var S,o,s,i=new Ho,h=new Ho;for(z=0,R=this.faces.length;R>z;z++)L=this.faces[z],S=this.vertices[L.a],o=this.vertices[L.b],s=this.vertices[L.c],i.subVectors(s,o),h.subVectors(S,o),i.cross(h),$[L.a].add(i),$[L.b].add(i),$[L.c].add(i)}else for(z=0,R=this.faces.length;R>z;z++)L=this.faces[z],$[L.a].add(L.normal),$[L.b].add(L.normal),$[L.c].add(L.normal);for(T=0,F=this.vertices.length;F>T;T++)$[T].normalize();for(z=0,R=this.faces.length;R>z;z++)L=this.faces[z],L.vertexNormals[0]=$[L.a].clone(),L.vertexNormals[1]=$[L.b].clone(),L.vertexNormals[2]=$[L.c].clone()},mergeVertices:function(){var n,b,P,y,H,S,x,c,z={},i=[],I=[],W=4,f=k(10,W);for(P=0,y=this.vertices.length;y>P;P++)n=this.vertices[P],b=o(n.x*f)+"_"+o(n.y*f)+"_"+o(n.z*f),z[b]===R?(z[b]=P,i.push(this.vertices[P]),I[P]=i.length-1):I[P]=I[z[b]];var g=[];for(P=0,y=this.faces.length;y>P;P++){H=this.faces[P],H.a=I[H.a],H.b=I[H.b],H.c=I[H.c],S=[H.a,H.b,H.c];for(var B=0;3>B;B++)if(S[B]==S[(B+1)%3]){g.push(P);break}}for(P=g.length-1;P>=0;P--){var C=g[P];for(this.faces.splice(C,1),x=0,c=this.faceVertexUvs.length;c>x;x++)this.faceVertexUvs[x].splice(C,1)}var T=this.vertices.length-i.length;return this.vertices=i,T}},lh=function(W,b,i,r,l,A,E){this.aX=W,this.aY=b,this.xRadius=i,this.yRadius=r,this.aStartAngle=l,this.aEndAngle=A,this.aClockwise=E};lh.prototype=Nm(wm),lh.prototype.getPoint=function(w){var s,T=this.aEndAngle-this.aStartAngle;0>T&&(T+=x),T>x&&(T-=x),s=this.aClockwise===!0?this.aEndAngle+(1-w)*(x-T):this.aStartAngle+w*T;var v=this.aX+this.xRadius*X(s),D=this.aY+this.yRadius*S(s);return new ln(v,D)};var Of=function(Y,r){this.v1=Y,this.v2=r},Ti=Of.prototype=Nm(wm);Ti.getPoint=function(Y){var g=this.v2.clone().sub(this.v1);return g.multiplyScalar(Y).add(this.v1),g},Ti.getPointAt=function(u){return this.getPoint(u)},Ti.getTangent=function(){var F=this.v2.clone().sub(this.v1);return F.normalize()};var ze=function(y,Q,$){this.v0=y,this.v1=Q,this.v2=$};ze.prototype=Nm(wm),ze.prototype.getPoint=function(o){var A,S;return A=io.b2(o,this.v0.x,this.v1.x,this.v2.x),S=io.b2(o,this.v0.y,this.v1.y,this.v2.y),new ln(A,S)};var fb=function(z,K,U,S){this.v0=z,this.v1=K,this.v2=U,this.v3=S};fb.prototype=Nm(wm),fb.prototype.getPoint=function(s){var q,B;return q=io.b3(s,this.v0.x,this.v1.x,this.v2.x,this.v3.x),B=io.b3(s,this.v0.y,this.v1.y,this.v2.y,this.v3.y),new ln(q,B)},Bj.create(function(F,O){this.v1=F,this.v2=O},function(V){var B=new Ho;return B.subVectors(this.v2,this.v1),B.multiplyScalar(V),B.add(this.v1),B});var Yn=Bj.create(function(z,q,s){this.v0=z,this.v1=q,this.v2=s},function(M){var U,S,v;return U=io.b2(M,this.v0.x,this.v1.x,this.v2.x),S=io.b2(M,this.v0.y,this.v1.y,this.v2.y),v=io.b2(M,this.v0.z,this.v1.z,this.v2.z),new Ho(U,S,v)}),tm=Bj.create(function(z,X,O,P){this.v0=z,this.v1=X,this.v2=O,this.v3=P},function(M){var Q,B,g;return Q=io.b3(M,this.v0.x,this.v1.x,this.v2.x,this.v3.x),B=io.b3(M,this.v0.y,this.v1.y,this.v2.y,this.v3.y),g=io.b3(M,this.v0.z,this.v1.z,this.v2.z,this.v3.z),new Ho(Q,B,g)}),ns=function(n,o,g,p,d,f,r,I){tg.call(this),p=p!==R?p:.5,d=d!==R?d:.5,I=I!==R?I:1,n=n||8,f=f||0,r=r||x;var e,H,h=1,Z=I/2,A=[],m=[],z=this.vertices,q=this.faces,v=this.faceVertexUvs;for(H=0;h>=H;H++){var N=[],J=[],l=H/h,$=l*(d-p)+p;for(e=0;n>=e;e++){var O=e/n,a=new Ho,t=-(O*r+f);a.z=$*S(t),a.y=-l*I+Z,a.x=$*X(t),z.push(a),N.push(z.length-1),J.push(new ln(O,l))}A.push(N),m.push(J)}var B,L,T=(d-p)/I;for(e=0;n>e;e++)for(0!==p?(B=z[A[0][e]].clone(),L=z[A[0][e+1]].clone()):(B=z[A[1][e]].clone(),L=z[A[1][e+1]].clone()),B.setY(M(B.x*B.x+B.z*B.z)*T).normalize(),L.setY(M(L.x*L.x+L.z*L.z)*T).normalize(),H=0;h>H;H++){var G=A[H][e],Q=A[H+1][e],V=A[H+1][e+1],D=A[H][e+1],u=B.clone(),W=B.clone(),i=L.clone(),F=L.clone(),k=m[H][e].clone(),Y=m[H+1][e].clone(),s=m[H+1][e+1].clone(),C=m[H][e+1].clone();q.push(new Cr(G,Q,D,[u,W,F])),v[0].push([k,Y,C]),q.push(new Cr(Q,V,D,[W.clone(),i,F.clone()])),v[0].push([Y.clone(),s,C.clone()])}if(o&&p>0)for(this.vertices.push(new Ho(0,Z,0)),e=0;n>e;e++){var G=A[0][e],Q=A[0][e+1],V=this.vertices.length-1,u=new Ho(0,1,0),W=new Ho(0,1,0),i=new Ho(0,1,0),k=m[0][e].clone(),Y=m[0][e+1].clone(),s=new ln(Y.x,0);q.push(new Cr(G,Q,V,[u,W,i],null,1));var _=e/n*x,E=X(_),y=S(_),U=(e+1)/n*x,K=X(U),c=S(U);v[0].push([new ln(.5+.5*E,.5+.5*y),new ln(.5+.5*K,.5+.5*c),new ln(.5,.5)])}if(g&&d>0)for(this.vertices.push(new Ho(0,-Z,0)),e=0;n>e;e++){var G=A[H][e+1],Q=A[H][e],V=z.length-1,u=new Ho(0,-1,0),W=new Ho(0,-1,0),i=new Ho(0,-1,0),k=m[H][e+1].clone(),Y=m[H][e].clone();q.push(new Cr(G,Q,V,[u,W,i],null,2));var _=e/n*x,E=X(_),y=S(_),U=(e+1)/n*x,K=X(U),c=S(U);v[0].push([new ln(.5+.5*K,.5-.5*c),new ln(.5+.5*E,.5-.5*y),new ln(.5,.5)])}};ns.prototype=Nm(af);var Yl=function(m,v,F,J,T,t,z){tg.call(this),z=z||.5,m=m||16,v=v||16,F=(F!==R?F:0)-V,J=J!==R?J:x,T=T!==R?T:0,t=t!==R?t:V;var l,G,c=[],n=[],$=this.vertices,f=this.faces,L=this.faceVertexUvs;for(G=0;v>=G;G++){var K=[],U=[];for(l=0;m>=l;l++){var E=l/m,h=G/v,H=new Ho;H.x=-z*X(F+E*J)*S(T+h*t),H.y=z*X(T+h*t),H.z=z*S(F+E*J)*S(T+h*t),$.push(H),K.push($.length-1),U.push(new ln(E,h))}c.push(K),n.push(U)}for(G=0;v>G;G++)for(l=0;m>l;l++){var C=c[G][l+1],w=c[G][l],_=c[G+1][l],d=c[G+1][l+1],q=$[C].clone().normalize(),D=$[w].clone().normalize(),p=$[_].clone().normalize(),u=$[d].clone().normalize(),Q=n[G][l+1].clone(),O=n[G][l].clone(),A=n[G+1][l].clone(),M=n[G+1][l+1].clone();B($[C].y)===z?(Q.x=(Q.x+O.x)/2,f.push(new Cr(C,_,d,[q,p,u])),L[0].push([Q,A,M])):B($[_].y)===z?(A.x=(A.x+M.x)/2,f.push(new Cr(C,w,_,[q,D,p])),L[0].push([Q,O,A])):(f.push(new Cr(C,w,d,[q,D,u])),L[0].push([Q,O,M]),f.push(new Cr(w,_,d,[D.clone(),p,u.clone()])),L[0].push([O.clone(),A,M.clone()]))}};Yl.prototype=Nm(af);var Ah=function(s,L,Z,P,p,G){tg.call(this),s=s||.33,L=L||.17,P=P||8,Z=Z||6,p=p||0,G=G||x;for(var b=new Ho,l=[],t=[],i=0;P>=i;i++)for(var y=i/P*x+V,B=0;Z>=B;B++){var j=B/Z*G+p;b.x=s*X(j),b.z=-s*S(j);var g=new Ho,r=s+L*X(y);g.x=r*X(j),g.z=-r*S(j),g.y=L*S(y),this.vertices.push(g),l.push(new ln(B/Z,1-i/P)),t.push(g.clone().sub(b).normalize())}for(var i=1;P>=i;i++)for(var B=1;Z>=B;B++){var o=(Z+1)*i+B-1,c=(Z+1)*(i-1)+B-1,F=(Z+1)*(i-1)+B,N=(Z+1)*i+B,H=new Cr(o,c,N,[t[o].clone(),t[c].clone(),t[N].clone()]);this.faces.push(H),this.faceVertexUvs[0].push([l[o].clone(),l[c].clone(),l[N].clone()]),H=new Cr(c,F,N,[t[c].clone(),t[F].clone(),t[N].clone()]),this.faces.push(H),this.faceVertexUvs[0].push([l[c].clone(),l[F].clone(),l[N].clone()])}this.computeFaceNormals()};Ah.prototype=Nm(af);var pg=function(p,M,r){return p?(tg.call(this),p=p instanceof Array?p:[p],this.addShapeList(p,M),M.convertYZ!==!1&&Hq(this,r),this.computeFaceNormals(),void 0):(p=[],void 0)},eo=pg.prototype=Nm(tg.prototype);eo.addShapeList=function(m,o){for(var x=m.length,L=0;x>L;L++){var K=m[L];this.addShape(K,o)}},eo.addShape=function(k,y){function i(){if(y.bottom)for(var k=0;K>k;k++)f=z[k],E(f[2],f[1],f[0],!0);if(y.top)for(k=0;K>k;k++)f=z[k],E(f[0]+a*M,f[1]+a*M,f[2]+a*M,!1)}function w(){var p=0;for(h(j,p),p+=j.length,n=0,r=e.length;r>n;n++)T=e[n],h(T,p),p+=T.length}function h(m,k){for(var z,E,b=m.length;--b>=0;){z=b,E=b-1,0>E&&(E=m.length-1);var D=0,s=M;for(D=0;s>D;D++){var F=a*D,C=a*(D+1),d=k+z+F,f=k+E+F,t=k+E+C,J=k+z+C;N(d,f,t,J,m,D,s,z,E)}}}function Z(c,U,B){g.vertices.push(new Ho(c,U,B))}function E(j,F,H,L){j+=l,F+=l,H+=l,g.faces.push(new Cr(j,F,H,null,null,L?2:1));var Q=L?d.generateBottomUV(g,k,y,j,F,H):d.generateTopUV(g,k,y,j,F,H);g.faceVertexUvs[0].push(Q)}function N(Q,e,Z,F,X,D,K,L,Y){Q+=l,e+=l,Z+=l,F+=l,g.faces.push(new Cr(Q,e,F)),g.faces.push(new Cr(e,Z,F));var b=d.generateSideWallUV(g,k,X,y,Q,e,Z,F,D,K,L,Y);g.faceVertexUvs[0].push([b[0],b[1],b[3]]),g.faceVertexUvs[0].push([b[1],b[2],b[3]])}var v,V,$,p,G,m=y.amount,F=y.curveSegments||$i,M=y.steps||1,P=y.extrudePath,D=!1,d=new Uf(y.repeatUVLength);P&&(v=P.getSpacedPoints(M),D=!0,V=y.frames!==R?y.frames:new Hn.FrenetFrames(P,M,!1),$=new Ho,p=new Ho,G=new Ho);var T,n,r,g=this,l=this.vertices.length,C=k.extractPoints(F),H=C.shape,e=C.holes,b=!io.isClockWise(H);if(b){for(H=H.reverse(),n=0,r=e.length;r>n;n++)T=e[n],io.isClockWise(T)&&(e[n]=T.reverse());b=!1}var z=io.triangulateShape(H,e),j=H;for(n=0,r=e.length;r>n;n++)T=e[n],H=H.concat(T);for(var Y,f,a=H.length,K=z.length,A=0;a>A;A++)Y=H[A],D?(p.copy(V.normals[0]).multiplyScalar(Y.x),$.copy(V.binormals[0]).multiplyScalar(Y.y),G.copy(v[0]).add(p).add($),Z(G.x,G.y,G.z)):Z(Y.x,Y.y,0);var S;for(S=1;M>=S;S++)for(A=0;a>A;A++)Y=H[A],D?(p.copy(V.normals[S]).multiplyScalar(Y.x),$.copy(V.binormals[S]).multiplyScalar(Y.y),G.copy(v[S]).add(p).add($),Z(G.x,G.y,G.z)):Z(Y.x,Y.y,m/M*S);i(),w()};var Hn=function(h,i,W,H,b){function z(z,m,e){return A.vertices.push(new Ho(z,m,e))-1}tg.call(this),i=i||64,W=W||1,H=H||8,b=b||!1;var y,$,J,Z,O,q,o,C,s,e,w,I,d,M,N,t,r,n,g,K,F=[],A=this,B=i+1,G=new Ho,c=new Hn.FrenetFrames(h,i,b),j=c.tangents,p=c.normals,k=c.binormals;for(this.tangents=j,this.normals=p,this.binormals=k,s=0;B>s;s++)for(F[s]=[],Z=s/(B-1),C=h.getPointAt(Z),y=j[s],$=p[s],J=k[s],e=0;H>e;e++)O=e/H*x,q=-W*X(O),o=W*S(O),G.copy(C),G.x+=q*$.x+o*J.x,G.y+=q*$.y+o*J.y,G.z+=q*$.z+o*J.z,F[s][e]=z(G.x,G.y,G.z);for(s=0;i>s;s++)for(e=0;H>e;e++)w=b?(s+1)%i:s+1,I=(e+1)%H,d=F[s][e],M=F[w][e],N=F[w][I],t=F[s][I],r=new ln(s/i,e/H),n=new ln((s+1)/i,e/H),g=new ln((s+1)/i,(e+1)/H),K=new ln(s/i,(e+1)/H),this.faces.push(new Cr(d,M,t)),this.faceVertexUvs[0].push([r,n,K]),this.faces.push(new Cr(M,N,t)),this.faceVertexUvs[0].push([n.clone(),g,K.clone()]);this.computeFaceNormals(),this.computeVertexNormals()};Hn.prototype=Nm(af),Hn.FrenetFrames=function(i,o,K){function D(){Q[0]=new Ho,n[0]=new Ho,s=Number.MAX_VALUE,H=B($[0].x),S=B($[0].y),u=B($[0].z),s>=H&&(s=H,e.set(1,0,0)),s>=S&&(s=S,e.set(0,1,0)),s>=u&&e.set(0,0,1),O.crossVectors($[0],e).normalize(),Q[0].crossVectors($[0],O),n[0].crossVectors($[0],Q[0])}var V,s,H,S,u,c,N,e=new Ho,$=[],Q=[],n=[],O=new Ho,I=new wq,x=o+1,v=1e-4;for(this.tangents=$,this.normals=Q,this.binormals=n,c=0;x>c;c++)N=c/(x-1),$[c]=i.getTangentAt(N),$[c].normalize();for(D(),c=1;x>c;c++)Q[c]=Q[c-1].clone(),n[c]=n[c-1].clone(),O.crossVectors($[c-1],$[c]),O.length()>v&&(O.normalize(),V=Y(uj($[c-1].dot($[c]),-1,1)),Q[c].applyMatrix4(I.makeRotationAxis(O,V))),n[c].crossVectors($[c],Q[c]);if(K)for(V=Y(uj(Q[0].dot(Q[x-1]),-1,1)),V/=x-1,$[0].dot(O.crossVectors(Q[0],Q[x-1]))>0&&(V=-V),c=1;x>c;c++)Q[c].applyMatrix4(I.makeRotationAxis($[c],V*c)),n[c].crossVectors($[c],Q[c])};var qs=function(s,d,k,N){tg.call(this),d=d||18,k=k||0,N=N==p?x:N;for(var H=1/(s.length-1),D=1/d,l=0,R=d;R>=l;l++)for(var Z=k+l*D*N,c=X(Z),M=S(Z),C=0,m=s.length;m>C;C++){var q=s[C],h=new Ho;h.x=c*q.x-M*q.y,h.y=M*q.x+c*q.y,h.z=q.z,this.vertices.push(h)}for(var J=s.length,l=0,R=d;R>l;l++)for(var C=0,m=s.length-1;m>C;C++){var n=C+J*l,E=n,t=n+J,c=n+1+J,r=n+1,V=l*D,f=C*H,_=V+D,u=f+H;this.faces.push(new Cr(E,r,t)),this.faceVertexUvs[0].push([new ln(V,f),new ln(V,u),new ln(_,f)]),this.faces.push(new Cr(t,r,c)),this.faceVertexUvs[0].push([new ln(_,f),new ln(V,u),new ln(_,u)])}this.mergeVertices(),Hq(this),this.computeFaceNormals(),this.computeVertexNormals()};qs.prototype=Nm(af);var Bn=function(b,e){e=e||{};var V=we.generateShapes(b,e);e.amount=e.amount!==R?e.amount:.5,e.convertYZ=!1,e.fill!==!1&&(e.bottom=!0,e.top=!0),pg.call(this,V,e)};Bn.prototype=Nm(eo);var Dl=D.Node=function(){td(Dl,this)},Ln={X:Pc,Y:zl,Z:go},Wp={xyz:"XYZ",xzy:"XZY",yxz:"YXZ",yzx:"YZX",zxy:"ZXY",zyx:"ZYX"},Bp="xzy",Oj=function(T,W,D){if(W){var k=W[0],t=W[1],A=W[2];"xzy"===D?(zl(T,t),go(T,A),Pc(T,k)):"xyz"===D?(go(T,A),zl(T,t),Pc(T,k)):"yxz"===D?(go(T,A),Pc(T,k),zl(T,t)):"yzx"===D?(Pc(T,k),go(T,A),zl(T,t)):"zxy"===D?(zl(T,t),Pc(T,k),go(T,A)):"zyx"===D?(Pc(T,k),zl(T,t),go(T,A)):(zl(T,t),go(T,A),Pc(T,k))}};fe("Node",Mo,{ms_ac:["rotationMode","anchorElevation"],_adjustChildrenToTop:!0,_icon:"node_icon",_image:"node_image",_rotationMode:Bp,_64O:0,_rotationX:0,_53O:0,_host:p,_position:{x:0,y:0},_anchor:{x:.5,y:.5},_anchorElevation:.5,_scale:{x:1,y:1},_scaleTall:1,_54O:0,getUIClass:function(){return Gq},_22Q:function(){return Hc},getX:function(){return this.p().x},setX:function(n){this.p(n,this.p().y)},getY:function(){return this.p().y},setY:function(D){this.p(this.p().x,D)},getAnchorX:function(){return this.getAnchor().x},setAnchorX:function(F){this.setAnchor(F,this.getAnchor().y)},getAnchorY:function(){return this.getAnchor().y},setAnchorY:function(h){this.setAnchor(this.getAnchor().x,h)},getScaleX:function(){return this.getScale().x},setScaleX:function(D){this.setScale(D,this.getScale().y)},getScaleY:function(){return this.getScale().y},setScaleY:function(v){this.setScale(this.getScale().x,v)},p:function(){return 0===arguments.length?this.getPosition():(this.setPosition.apply(this,arguments),this)},p3:function(){return 0===arguments.length?this.getPosition3d():(this.setPosition3d.apply(this,arguments),this)},s3:function(){return 0===arguments.length?this.getSize3d():(this.setSize3d.apply(this,arguments),this)},r3:function(){return 0===arguments.length?this.getRotation3d():(this.setRotation3d.apply(this,arguments),this)},t3:function(){return this.translate3d.apply(this,arguments),this},translate3dBy:function(z,C){pk(z,dj(p,p,this.r3(),this.getRotationMode())),this.translate3d(z[0]*C,z[1]*C,z[2]*C)},translateFront:function(Q){this.translate3dBy([0,0,1],Q)},translateBack:function(y){this.translate3dBy([0,0,-1],y)},translateLeft:function(q){this.translate3dBy([-1,0,0],q)},translateRight:function(b){this.translate3dBy([1,0,0],b)},translateTop:function(f){this.translate3dBy([0,1,0],f)},translateBottom:function(V){this.translate3dBy([0,-1,0],V)},getPosition3d:function(){return[this._position.x,this._54O,this._position.y]},setPosition3d:function(p,V,Z){1===arguments.length&&(V=p[1],Z=p[2],p=p[0]),this.p(p,Z),this.setElevation(V)},translate3d:function(R,U,Q){1===arguments.length&&(U=R[1],Q=R[2],R=R[0]),this.translate(R,Q),this.setElevation(this._54O+U)},getSize3d:function(){return[this.getWidth(),this.getTall(),this.getHeight()]},setSize3d:function(U,M,u){1===arguments.length&&(M=U[1],u=U[2],U=U[0]),this.setSize(U,u),this.setTall(M)},getRotation3d:function(){return[this._rotationX,-this._64O,this._53O]},setRotation3d:function(M,y,V){1===arguments.length&&(y=M[1],V=M[2],M=M[0]),this.setRotationX(M),this.setRotation(-y),this.setRotationZ(V)},setRotationY:function(l){this.setRotation(-l)},getRotationY:function(){return-this._64O},lookAt:function(d,p){p=p||Ap;var l=this,J=fg(d,l.p3()),j=ti(J);p===Ap?(l.r3([-O(J[1]/j),-z(J[2],J[0])+u,0]),l.setRotationMode("xzy")):p===ig?(l.r3(0,-z(J[2],J[0]),O(J[1]/j)),l.setRotationMode("zyx")):p===Aj?(l.r3(0,-z(J[2],J[0])+V,-O(J[1]/j)),l.setRotationMode("zyx")):p===ko?(l.r3([-O(J[1]/j)+u,-z(J[2],J[0])+u,0]),l.setRotationMode("xzy")):p===eg&&(l.r3([-O(J[1]/j)-u,-z(J[2],J[0])+u,0]),l.setRotationMode("xzy")),p===Kq&&(l.r3([-O(J[1]/j)+V,-z(J[2],J[0])+u,V]),l.setRotationMode("zxy"))
},getLoopedEdges:function(){return this._45I},getEdges:function(){return this._70O},getAgentEdges:function(){return this._49I},getHost:function(){return this._host},setHost:function(J){var l=this;if(l!==J&&l._host!==J){var g=l._host;g&&g._removeAttach(l),l._host=J,l._host&&l._host._addAttach(l),l.fp("host",g,J),l.onHostChanged(g,J)}},getAttaches:function(){return this._69O},_addAttach:function(j){var x=this;x._69O||(x._69O=new uh),x._69O.add(j),x.fp("attaches",p,j)},_removeAttach:function(E){var m=this;m._69O.remove(E),m._69O.isEmpty()&&delete m._69O,m.fp("attaches",E,p)},getSourceEdges:function(){return this._42I},getTargetEdges:function(){return this._43I},_2I:function(W){var I=this;I._44I||(I._44I=new uh),I._42I||(I._42I=new uh),I._44I.add(W),I._42I.add(W),I._20I()},_4I:function(J){var F=this;F._44I||(F._44I=new uh),F._43I||(F._43I=new uh),F._44I.add(J),F._43I.add(J),F._20I()},_16I:function(M){var p=this;p._44I.remove(M),p._42I.remove(M),p._44I.isEmpty()&&delete p._44I,p._42I.isEmpty()&&delete p._42I,p._20I()},_18I:function(J){var L=this;L._44I.remove(J),L._43I.remove(J),L._44I.isEmpty()&&delete L._44I,L._43I.isEmpty()&&delete L._43I,L._20I()},_20I:function(){var T=this;if(delete T._45I,!T._44I||T._44I.isEmpty())return delete T._70O,void 0;var w;T._44I.each(function(M){M.isLooped()&&(w||(w={}),w[M._id]||(T._45I||(T._45I=new uh),T._45I.add(M),w[M._id]=M))}),w?(T._70O=new uh,T._44I.each(function(P){w[P._id]?"A"===w[P._id]||(w[P._id]="A",T._70O.add(P)):T._70O.add(P)})):T._70O=T._44I},hasAgentEdges:function(){return!!this._49I&&!this._49I.isEmpty()},getSourceAgentEdges:function(){return this._46I},getTargetAgentEdges:function(){return this._47I},_1I:function(d){var W=this;W._46I||(W._46I=new uh),W._48I||(W._48I=new uh),W._46I.add(d),W._48I.add(d),W._19I()},_3I:function(L){var p=this;p._47I||(p._47I=new uh),p._48I||(p._48I=new uh),p._47I.add(L),p._48I.add(L),p._19I()},_15I:function(W){var s=this;s._46I.remove(W),s._48I.remove(W),s._46I.isEmpty()&&delete s._46I,s._48I.isEmpty()&&delete s._48I,s._19I()},_17I:function(r){var l=this;l._47I.remove(r),l._48I.remove(r),l._47I.isEmpty()&&delete l._47I,l._48I.isEmpty()&&delete l._48I,l._19I()},_19I:function(){var m=this;delete m._49I;var x=m._48I;if(x&&!x.isEmpty()){var b={};x.each(function(g){b[g._id]?m._49I||(m._49I=new uh):b[g._id]=g}),m._49I?x.each(function(y){b[y._id]&&(m._49I.add(y),delete b[y._id])}):m._49I=x}},getImage:function(){if(this._pendingCheckImageJSON){var o=U.getImage(this._image);o&&(this._pendingCheckImageJSON=!1,this.getParent()instanceof Af&&this.getParent().checkPendingUpdateInfo())}return this._image},setImage:function(f){var t=this,$=t._image,k=t.getWidth(),Z=t.getHeight();t._image=f,t.fp("image",$,f)&&(null!=f&&(Dh(f)||Op(f)&&/\.json$/i.test(f))&&(this._pendingCheckImageJSON=!0),t.fp(Mh,k,t.getWidth()),t.fp(ye,Z,t.getHeight()))},getElevation:function(){return this._54O},setElevation:function(x){var P=this;if(!P._50O){P._50O=1;var E=P._54O;P._54O=x,P.fp(Br,E,x),delete this._50O}},getRotation:function(){return this._64O},setRotation:function(H){var C=this;if(!C._49O){C._49O=1;var Z=C._64O;C._64O=H,C.fp(wr,Z,H),delete C._49O}},getRotationX:function(){return this._rotationX},setRotationX:function(d){var a=this;if(!a._51O){a._51O=1;var o=a._rotationX;a._rotationX=d,a.fp("rotationX",o,d),delete a._51O}},getRotationZ:function(){return this._53O},setRotationZ:function(E){var P=this;if(!P._52O){P._52O=1;var g=P._53O;P._53O=E,P.fp("rotationZ",g,E),delete P._52O}},getPosition:function(){return this._position},setPosition:function(v,x){var M=this;if(!M._50I){M._50I=1;var R;if(R=2===arguments.length?{x:v,y:x}:v,R.x!==M._position.x||R.y!==M._position.y){var Y=M._position;M._position=R,M.fp(tk,Y,R)}delete M._50I}},translate:function(T,A){var c=this._position;this.p(c.x+T,c.y+A)},getWidth:function(){var I=this;if(I._width>=0)return I._width;var G=I.getStyle("shape3d");if(G){var n=Pb(G);if(n&&n.rawS3)return n.rawS3[0]}var D=Tm(I._image);return D?rl(D,I):20},setWidth:function(P){var R=this,w=R._width;R._width=P,R.fp(Mh,w,P)},getHeight:function(){var _=this;if(_._height>=0)return _._height;var R=_.getStyle("shape3d");if(R){var p=Pb(R);if(p&&p.rawS3)return p.rawS3[2]}var l=Tm(_._image);return l?ws(l,_):20},setHeight:function(K){var X=this,k=X._height;X._height=K,X.fp(ye,k,K)},getTall:function(){var D=this;if(D._tall>=0)return D._tall;var H=D.getStyle("shape3d");if(H){var z=Pb(H);if(z&&z.rawS3)return z.rawS3[1]}return 20},setTall:function($){var F=this,V=F._tall;F._tall=$,F.fp("tall",V,$)},setSize:function(R,l){var Q=this;2===arguments.length?(Q.setWidth(R),Q.setHeight(l)):(Q.setWidth(R.width),Q.setHeight(R.height))},getSize:function(){return{width:this.getWidth(),height:this.getHeight()}},setRect:function(b,Z,S,f,M){var B=this,t=B.getAnchor(),m=B.getScale();arguments.length<=2&&(M=Z,Z=b.y,S=b.width,f=b.height,b=b.x);var d=M&&m.x<0?1-t.x:t.x,j=M&&m.y<0?1-t.y:t.y;B.p(b+S*d,Z+f*j),M&&(S/=Math.abs(m.x),f/=Math.abs(m.y)),B.setWidth(S),B.setHeight(f)},getMatrix:function(){var H=this,W=H._64O,E=H._position,y=H.getScale();return new qj(W,E.x,E.y,y.x,y.y)},getAnchorRect:function(){var m=this,f=m.getWidth(),Q=m.getHeight(),i=m.getAnchor();return{x:-f*i.x,y:-Q*i.y,width:f,height:Q}},toLocal:function($){return this.getMatrix().tfi($)},toGlobal:function(l){return this.getMatrix().tf(l)},isInRect:function(x){x=this.toLocal(x);var C=this.getWidth(),j=this.getHeight();return x.x+=C*this.getAnchorX(),x.y+=j*this.getAnchorY(),!(x.x<0||x.y<0||x.x>C||x.y>j)},getRect:function(){var U=this,z=U.getWidth(),$=U.getHeight(),O=U.getAnchor(),r={x:-z*O.x,y:-$*O.y,width:z,height:$},f=U.getMatrix();return r=Ui([f.tf(r.x,r.y),f.tf(r.x+r.width,r.y),f.tf(r.x+r.width,r.y+r.height),f.tf(r.x,r.y+r.height)])},getAnchorElevation:function(){return this._anchorElevation},getAnchor3d:function(){var v=this,x=v.getAnchor(),Y=v._anchorElevation;return{x:x.x,y:Y,z:x.y}},setAnchorElevation:function(i){var Q=this,W=Q._anchorElevation;return W!==i?(Q._anchorElevation=i,Q.fp("anchorElevation",W,i),!0):!1},setAnchor3d:function(G,v,e,w){var s,V=this;"number"==typeof G?s={x:G,y:v,z:e}:(s=G.length?{x:G[0],y:G[1],z:G[2]}:G,w=v);var D=V.getDataModel();D&&D.beginTransaction();var z=V.getAnchor3d(),W=V.setAnchor(s.x,s.z);if(V.setAnchorElevation(s.y)&&(W=!0),W&&w&&!vg){V.getAnchor3d();var n=Rb(V),J=pk([s.x-z.x,s.y-z.y,s.z-z.z],n);V.p3(J)}return D&&D.endTransaction(),W},getAnchor:function(){var K=this;if(K.hasOwnProperty("_anchor"))return K._anchor;var D=Tm(K._image);return D&&D.anchorX!==R?{x:D.anchorX,y:D.anchorY}:K._anchor},setAnchor:function(w,i,Q){var j,J=this;"number"==typeof w?j={x:w,y:i}:(j=w.length?{x:w[0],y:w[1]}:w,Q=i);var U=J.getAnchor();if(U.x!==j.x||U.y!==j.y){var W=J.getDataModel();if(W&&W.beginTransaction(),J._anchor=j,J.fp("anchor",U,j),Q&&!vg){var G=J.getPosition(),o=J.getSize(),d=J.getRotation(),l=J.getScale(),q=-o.width*(U.x-j.x)*l.x,m=-o.height*(U.y-j.y)*l.y,y=S(d),z=X(d);J.setPosition(G.x+z*q-y*m,G.y+y*q+z*m)}return W&&W.endTransaction(),!0}return!1},getScale:function(){return this._scale},setScale:function(v,Y){var s,c=this;s=2===arguments.length?{x:v,y:Y}:v;var L=c.getScale();(L.x!==s.x||L.y!==s.y)&&(c._scale=s,c.fp("scale",L,s))},getScaleTall:function(){return this._scaleTall},getScale3d:function(){var C=this,y=C._scaleTall,c=C.getScale();return[c.x,y,c.y]},getFinalScale3d:function(){var K=this,l=K.s3(),z=K._dynamicScale3d,m=K.getScale3d();return l&&(m[0]*=l[0],m[1]*=l[1],m[2]*=l[2]),z&&(m[0]*=z[0],m[1]*=z[1],m[2]*=z[2]),m},setScaleTall:function(L){var S=this,D=S._scaleTall;D!==L&&(S._scaleTall=L,S.fp("scaleTall",D,L))},setScale3d:function(Y,q,s){var n,J=this;n="number"==typeof Y?{x:Y,y:q,z:s}:Y.length?{x:Y[0],y:Y[1],z:Y[2]}:Y,J.setScaleTall(n.y),J.setScale(n.x,n.z)},getCorners:function(i,x){i==p&&(i=0),x==p&&(x=i);var e=this,S=e.getAnchor(),R=e.getWidth(),z=e.getHeight(),T=-R*S.x-i,y=-z*S.y-x,I=R+2*i,O=z+2*x,H=e.getMatrix();return[H.tf(T,y),H.tf(T,y+O),H.tf(T+I,y+O),H.tf(T+I,y)]},getEditControlPoints:function(K,b,H){b==p&&(b=0),H==p&&(H=b);var Y=this,J=Y.getAnchor(),z=Y.getWidth(),R=Y.getHeight(),I=-z*J.x-b,d=-R*J.y-H,V=z+2*b,v=R+2*H;if(K)return[{x:I,y:d},{x:I,y:0},{x:I,y:d+v},{x:0,y:d+v},{x:I+V,y:d+v},{x:I+V,y:0},{x:I+V,y:d},{x:0,y:d}];var D=Y.getMatrix();return[D.tf(I,d),D.tf(I,0),D.tf(I,d+v),D.tf(0,d+v),D.tf(I+V,d+v),D.tf(I+V,0),D.tf(I+V,d),D.tf(0,d)]},rotateAt:function(O,$,n){var F=this,r=F._position,D=F._64O,U=new qj(D,r.x,r.y).tf(O,$),_=M(O*O+$*$),P=z(r.y-U.y,r.x-U.x)+n;F.setRotation(D+n),F.p(U.x+_*X(P),U.y+_*S(P))},onParentChanged:function(){Dl.superClass.onParentChanged.apply(this,arguments),this._8I()},_8I:function(){this._70O&&this._70O.each(function(Q){Q._7I()})},onPropertyChanged:function(e){var I=this;Dl.superClass.onPropertyChanged.call(I,e),I._69O&&I._69O.each(function(U){U.handleHostPropertyChange(e)}),I._49I&&I._49I.each(function(N){N.fp("agentChange",!0,!1)})},onHostChanged:function(){this.updateAttach()},handleHostPropertyChange:function(Y){this.updateAttach(Y)},onStyleChanged:function(v){Dl.superClass.onStyleChanged.apply(this,arguments),Yi[v]&&this.updateAttach()},updateAttach:function(y){var g=this;g._51I||vg||(g._51I=1,g._71O(y),delete g._51I)},_71O:function(m){var L,F,o,s,E,J,C=this,b=C._host,X=m?m.property:p,n=m?m.oldValue:p,l=m?m.newValue:p;if(b instanceof D.Grid){if(X===Br)C.setElevation(C._54O+l-n);else if(!m||dc[X]){if(L=C.s("attach.row.index"),F=C.s("attach.column.index"),o=b.getCellRect(L,F),!o)return;s=C.s("attach.row.span"),E=C.s("attach.column.span"),(1!==s||1!==E)&&(o=Ij(o,b.getCellRect(L+s-1,F+E-1))),fm(o,C,"attach.padding",1),C.setRect(o)}}else if(b instanceof Fo&&(J=C.s("attach.index"))>=0&&(!m||qn[X])){var V=C.s("attach.thickness");V!=p&&C.setHeight(b.getThickness()*V);var k=C.s("attach.offset"),N=b.getPoints(),w=N.size();if(w>J){var P=N.get(J),M=w===J+1?N.get(0):N.get(J+1),c=[M.x-P.x,M.y-P.y],A=ti(c);if(A){C.s("attach.offset.relative")&&(k*=A),C.s("attach.offset.opposite")&&(k=A-k);var B={x:P.x+c[0]/A*k,y:P.y+c[1]/A*k},_=C.s("attach.gap");_&&(C.s("attach.gap.relative")&&(_*=b.getThickness()),B=Ik(p,B,M,_)),C.p(B),C.setRotation(z(c[1],c[0]))}}}else m&&(X===tk?C.translate(l.x-n.x,l.y-n.y):X===Br?C.setElevation(C._54O+l-n):_e[X]&&C._11Q(b,X,l-n))},_11Q:function(R,o,a){var d=this,f=R.p3(),l=fg(d.p3(),f),c=Cm(),I=Wp[d.getRotationMode()],C=I[0],B=I[1],i=I[2],Z=Ln[C],Y=Ln[B],H=Ln[i];o===wr&&(o="rotationY",a=-a),o===wr+C?(H(c,R[xh+i]()),Y(c,R[xh+B]()),Z(c,a),Y(c,-R[xh+B]()),H(c,-R[xh+i]()),d[kp+C](d[xh+C]()+a)):o===wr+B?(H(c,R[xh+i]()),Y(c,a),H(c,-R[xh+i]()),d[kp+B](d[xh+B]()+a)):o===wr+i&&(H(c,a),d[kp+i](d[xh+i]()+a)),pk(l,c),d.p3(f[0]+l[0],f[1]+l[1],f[2]+l[2])},isHostOn:function(l){var i=this;if(i._host&&l&&l._69O)for(var g={},v=i._host;v&&v!==i&&!g[v._id];){if(v===l)return!0;g[v._id]=v,v=v._host}return!1},isLoopedHostOn:function(t){return this.isHostOn(t)&&t.isHostOn(this)},getSerializableProperties:function(){var O=Dl.superClass.getSerializableProperties.call(this);return Gp(O,{image:1,host:1,rotation:1,rotationX:1,rotationZ:1,rotationMode:1,position:1,anchor:1,anchorElevation:1,scale:1,scaleTall:1,_width:1,_height:1,_tall:1,elevation:1}),O}});var qf=D.Edge=function(P,s){var M=this;td(qf,M),M.setSource(P),M.setTarget(s)};fe("Edge",Mo,{_icon:"edge_icon",getUIClass:function(){return xi},_22Q:function(){return Id},getSource:function(){return this._source},getTarget:function(){return this._target},getSourceAgent:function(){return this._40I},getTargetAgent:function(){return this._41I},setSource:function(t){var Z=this;if(Z._source!==t){var y=Z._source;Z._source=t,y&&y._16I(Z),t&&t._2I(Z),Z._7I(),Z.fp("source",y,t)}},setTarget:function(j){var m=this;if(m._target!==j){var q=m._target;m._target=j,q&&q._18I(m),j&&j._4I(m),m._7I(),m.fp("target",q,j)}},isLooped:function(){var v=this;return v._source===v._target&&!!v._source&&!!v._target},_7I:function(){var t,W=this,H=Nl(W);W._40I!==H&&(t=this._40I,t&&t._15I(W),W._40I=H,H&&H._1I(W),W.fp("sourceAgent",t,H),hm(t,W._41I),hm(H,W._41I));var I=ar(W);W._41I!==I&&(t=W._41I,t&&t._17I(W),W._41I=I,I&&I._3I(W),W.fp("targetAgent",t,I),hm(t,W._40I),hm(I,W._40I))},_22I:function(d){this._52I=d,this.fp("edgeGroup",!0,!1)},getEdgeGroup:function(){return this._52I},isEdgeGroupHidden:function(){var Z=this;return Z._52I&&Z._52I.get(0)!==Z&&!Z.getStyle(Qr)},getEdgeGroupSize:function(){return this._52I?this._52I.size():1},getEdgeGroupIndex:function(){return this._52I?this._52I.indexOf(this):0},isEdgeGroupAgent:function(){var E=this,M=E._52I;return M&&!E.getStyle(Qr)&&M.size()>1&&E===M.get(0)},toggle:function(){var h=this._52I,e=!this.s(Qr);h&&h.size()>1&&(h.each(function($){$.s(Qr,e)}),h.getSiblings().each(function(q){q!==h&&q.each(function(z){z.fp("edgeGroup",p,q)})}))},setStyle:function(K,x){(K===ds||"edge.segments"===K)&&(x=Mq(x)),qf.superClass.setStyle.call(this,K,x)},onStyleChanged:function(n){qf.superClass.onStyleChanged.apply(this,arguments),lq[n]&&hm(this._41I,this._40I)},getSerializableProperties:function(){var E=qf.superClass.getSerializableProperties.call(this);return Gp(E,{source:1,target:1}),E}});var ak=D.Group=function(){td(ak,this)};fe("Group",Dl,{_image:"group_image",_icon:"group_icon",_57O:!1,getUIClass:function(){return kl},onChildAdded:function(){ak.superClass.onChildAdded.apply(this,arguments),this._81I()},onChildRemoved:function(){ak.superClass.onChildRemoved.apply(this,arguments),this._81I()},_81I:function(){var k=this;if(!k._54I&&!vg){var G=k.getChildrenRect();G&&(k._53I=1,k.p(ad(k.s("group.position"),G,k.getSize())),delete k._53I)}},getChildrenRect:function(){var T,i=this;return i.eachChild(function(E){T=Ij(T,i.getChildRect(E))}),T},getChildRect:function(I){var k;return Bf(I)&&I.s(ys)&&(xk(I)&&I.isExpanded()&&I.eachChild(function(G){k=Ij(k,I.getChildRect(G))}),!k&&I.getRect&&(k=I.getRect())),k},setPosition:function(v,w){var k=this;if(!k._54I){var T;T=2===arguments.length?{x:v,y:w}:v,vg||k._53I||(k._54I=1,Fq(k._children,T.x-k._position.x,T.y-k._position.y),delete k._54I),ak.superClass.setPosition.call(this,T)}},toggle:function(){this.setExpanded(!this.isExpanded())},isExpanded:function(){return this._57O},setExpanded:function(w){var r=this;if(r._57O!==w){var $=r._57O;r._57O=w,r.fp("expanded",$,r._57O),r._8I()}},_8I:function(){ak.superClass._8I.call(this),this.eachChild(function(g){Bf(g)&&g._8I()})},onStyleChanged:function(D){ak.superClass.onStyleChanged.apply(this,arguments),"group.position"===D&&this._81I()},getSerializableProperties:function(){var w=ak.superClass.getSerializableProperties.call(this);return w.expanded=1,w}});var Zl=D.Block=function(){td(Zl,this)};fe("Block",Dl,{_icon:"block_icon",_clickThroughEnabled:!1,_syncSize:!0,ms_ac:["clickThroughEnabled","syncSize"],getUIClass:function(){return dq},onChildAdded:function(){Zl.superClass.onChildAdded.apply(this,arguments),this.updateFromChildren()},onChildRemoved:function(){Zl.superClass.onChildRemoved.apply(this,arguments),this.updateFromChildren()},updateFromChildren:function(){var r=this;if(!vg&&!r._updatingToChildren&&r._syncSize){var y,$,q,n,m,i=[],p=r.getRotation();if(r.eachChild(function(w){Bf(w)&&i.push.apply(i,w.getCorners())}),i.length){r._updatingFromChildren=1;var P=X(-p),R=S(-p),H=1/0,o=-1/0,D=1/0,Y=-1/0;for(n=0,m=i.length;m>n;n++)q=i[n],y=q.x,$=q.y,q.x=P*y-R*$,q.y=R*y+P*$,H=j(H,q.x),o=Q(o,q.x),D=j(D,q.y),Y=Q(Y,q.y);var h=r.getScale();r.setSize(B((o-H)/h.x),B((Y-D)/h.y));var T;h.x<0&&(T=H,H=o,o=T),h.y<0&&(T=D,D=Y,Y=T),P=X(p),R=S(p);var V=r.getAnchor();y=H+(o-H)*V.x,$=D+(Y-D)*V.y,r.setPosition(P*y-R*$,R*y+P*$),delete r._updatingFromChildren}}},setPosition:function(y,s){var a=this;if(!a._updatingToChildren){var c;c=2===arguments.length?{x:y,y:s}:y,vg||a._updatingFromChildren||(a._updatingToChildren=1,Fq(a._children,c.x-a._position.x,c.y-a._position.y),delete a._updatingToChildren),Zl.superClass.setPosition.call(this,c)}},setWidth:function(Z){return this.setSize(Z,this.getHeight())},setHeight:function(Z){return this.setSize(this.getWidth(),Z)},setSize:function(w,R){1>w&&(w=1),1>R&&(R=1);var f=this;if(!f._updatingToChildren){2!==arguments.length&&(R=w.height,w=w.width);var K=f.getWidth(),k=f.getHeight();if(w!==K&&Zl.superClass.setWidth.call(f,w),R!==k&&Zl.superClass.setHeight.call(f,R),!vg&&!f._updatingFromChildren){f._updatingToChildren=1;var s=w/K,F=R/k;f._adjustChildScaleOrSize(s,F,"size"),delete f._updatingToChildren,f.updateFromChildren()}}},_adjustChildScaleOrSize:function(t,C,E){var s=this;if(s._syncSize){var D=s.getPosition(),J=s.getRotation();s.getScale(),s.eachChild(function(c){if(Bf(c)){var U=c.getPosition(),f=c.getRotation(),h=c.getWidth(),F=c.getHeight(),K=c.getScale(),P=K.x*h,e=K.y*F,W=new qj(f,U.x,U.y,P,e);W.translate(-D.x,-D.y),W.rotate(-J),f=z(W.b*Math.sign(P),W.a*Math.sign(P)),W.scale(t,C);var O,s,u,m=X(f);if(Math.abs(m)<.001?(O=S(f),s=W.b/O,u=-W.c/O):(s=W.a/m,u=W.d/m),"scale"===E)c.setScale(s/h,u/F);else if("size"===E){var w=s/K.x,q=u/K.y;c.setScale(nm(s)*Math.abs(K.x),nm(u)*Math.abs(K.y)),c.setSize(Math.max(.1,Math.abs(w)),Math.max(.1,Math.abs(q)))}W.rotate(J),W.translate(D.x,D.y),c.setPosition(W.tx,W.ty)}})}},_calcChangeFactor:function(w,j,I,q){var l,i,M,D;return l=B(w),i=B(I),M=l>i?l/i:i/l,l=B(j),i=B(q),D=l>i?l/i:i/l,Q(M,D)},setAnchor:function(){var w=this;if(!w._updatingToChildren){var i=w.getAnchor();if(Zl.superClass.setAnchor.apply(w,arguments),!vg&&!w._updatingFromChildren&&w._syncSize){w._updatingToChildren=1;var M=w.getAnchor();w.getPosition();var K=w.getSize(),H=w.getScale(),t=w.getRotation(),g=-K.width*H.x*(i.x-M.x),x=-K.height*H.y*(i.y-M.y),U=S(t),G=X(t),R=G*g-U*x,p=U*g+G*x;w.eachChild(function(Y){if(Bf(Y)){var j=Y.getPosition();Y.setPosition(j.x-R,j.y-p)}}),delete w._updatingToChildren}}},setRotation:function(H){var c=this;if(!c._updatingToChildren){var x=c.getRotation();if(Zl.superClass.setRotation.apply(c,arguments),!vg&&!c._updatingFromChildren){c._updatingToChildren=1;var U=c.getPosition(),v=H-x;c.eachChild(function(j){if(Bf(j)){var y=j.getMatrix();y.translate(-U.x,-U.y),y.rotate(v),y.translate(U.x,U.y);var X=Math.sign(j.getScale().x);j.setRotation(z(y.b*X,y.a*X)),j.setPosition(y.tx,y.ty)}}),delete c._updatingToChildren}}},setScale:function(q,V){var L=this;if(!L._updatingToChildren){null==V&&(V=q.y,q=q.x);var Z=L.getScale();if(B(q)<.01&&(q=.01*(nm(q)||nm(Z.x))),B(V)<.01&&(V=.01*(nm(V)||nm(Z.y))),Zl.superClass.setScale.call(L,q,V),!vg&&!L._updatingFromChildren){L._updatingToChildren=1;var m=q/Z.x,r=V/Z.y;L._adjustChildScaleOrSize(m,r,"size"),delete L._updatingToChildren,L.updateFromChildren()}}},getSerializableProperties:function(){var L=Zl.superClass.getSerializableProperties.call(this);return L.clickThroughEnabled=1,L.syncSize=1,L}});var ej=D.Grid=function(){td(D.Grid,this)};fe("Grid",Dl,{IRotatable:!1,_icon:"grid_icon",_image:p,getUIClass:function(){return ec},setRotation:function(){},getCellRect:function(e,n){var S=this,o=S.s("grid.row.count"),J=S.s("grid.column.count");if(0>=o||0>=J||0>e||e>=o||0>n||n>=J)return p;var w,m,r,L=S.getRect(),W=S.s("grid.row.percents"),b=S.s("grid.column.percents");if(fm(L,S,"grid.border",-1),W&&W._as&&(W=W._as),b&&b._as&&(b=b._as),W&&W.length===o){for(r=0,w=0;e>w;w++)r+=L.height*W[w];L.y+=r,L.height=L.height*W[e]}else L.height=L.height/o,L.y+=L.height*e;if(b&&b.length===J){for(m=0,w=0;n>w;w++)m+=L.width*b[w];L.x+=m,L.width=L.width*b[n]}else L.width=L.width/J,L.x+=L.width*n;return Lf(L,-S.s("grid.gap")),L}});var ck=D.Text=function(){td(ck,this),this.setSize(100,50),this.s("text","TEXT")};fe("Text",Dl,{_icon:"text_icon",_image:"__text__",getUIClass:function(){return Li},setWidth:function(h){h||(h=.001),ck.superClass.setWidth.call(this,h)},setHeight:function(p){p||(p=.001),ck.superClass.setHeight.call(this,p)},toLabel:function(){return this._displayName||this._name||this.s("text")}}),kc("__text__",{width:{value:100,isSafeFunc:!0,func:function(K){return K._width}},height:{value:50,isSafeFunc:!0,func:function(x){return x._height}},comps:[{type:"text",relative:!0,rect:[0,0,1,1],text:{func:"style@text"},align:{func:"style@text.align"},vAlign:{func:"style@text.vAlign"},color:{func:"style@text.color"},font:{func:"style@text.font"},shadow:{func:"style@text.shadow"},shadowColor:{func:"style@text.shadow.color"},shadowBlur:{func:"style@text.shadow.blur"},shadowOffsetX:{func:"style@text.shadow.offset.x"},shadowOffsetY:{func:"style@text.shadow.offset.y"}}]});var Fo=D.Shape=function(){td(Fo,this),this._59O=new uh};Fo.__de__=Ol,fe("Shape",Dl,{ms_ac:["thickness","closePath"],_icon:"shape_icon",_thickness:10,_closePath:!1,getUIClass:function(){return Dk},_22Q:function(){return qb},getLength:function(F){return rd(gk(this._59O,this._58O,F,this._closePath))},getSegments:function(){return this._58O},toSegments:function(){var g=this._58O;return g?new uh(g._as.slice(0)):g},setSegments:function(j){var k=this._58O;j=j?vi(j)?new uh(j.slice(0)):new uh(j._as.slice(0)):null,(k&&j&&k._as.join(",")!==j._as.join(",")||k!==j)&&(this._58O=j,this.fp("segments",k,j))},getPoints:function(){return this._59O},toPoints:function(){var s=this._59O;return new uh(s._as.slice(0))},setPoints:function(I,s){var V=this,v=V._59O;I=I?vi(I)?new uh(I.slice(0)):new uh(I._as.slice(0)):new uh;var c,i,a,p,Q,K;s&&(c=V.getPosition(),K=new qj(V.getRotation(),0,0,V.getScale().x,V.getScale().y)),(v&&I&&v._as.join(",")!==I._as.join(",")||v!==I)&&(V._59O=I,V.fs(),V.fp("points",v,I)),s&&(i=V.getPosition(),a=i.x-c.x,p=i.y-c.y,Q=K.tf(a,p),V.setPosition(i.x-a+Q.x,i.y-p+Q.y))},addPoint:function(t,X,S){var M=this.toPoints();M.add(t,X),this.setPoints(M,S)},setPoint:function(N,D,g){var G=this.toPoints();G.set(N,D),this.setPoints(G,g)},removePointAt:function(X){var S=this.toPoints();S.removeAt(X),this.setPoints(S)},setWidth:function(A){var C=this;if(1>A&&(A=1),!C._55I&&!vg&&C.getWidth()){C._55I=1;var o=C._position.x,X=A/C.getWidth(),E=C.toPoints(),D=new uh;E.each(function(F){D.add({x:(F.x-o)*X+o,y:F.y,e:F.e})}),C.setPoints(D),xn(C,[X,0,0,1,o*(1-X),0]),C.fs(),delete C._55I}Fo.superClass.setWidth.call(C,A)},setHeight:function(D){var I=this;if(1>D&&(D=1),!I._55I&&!vg&&I.getHeight()){I._55I=1;var E=I._position.y,d=D/I.getHeight(),z=I.toPoints(),A=new uh;z.each(function(V){A.add({x:V.x,y:(V.y-E)*d+E,e:V.e})}),I.setPoints(A),xn(I,[1,0,0,d,0,E*(1-d)]),I.fs(),delete I._55I}Fo.superClass.setHeight.call(I,D)},setAnchorElevation:function(d){var q=this;q._55I=!0;var O=q._updatingAnchor3d,m=!vg&&!O;if(m){var I,p=d,s=q.getAnchorElevation(),S=q.getTall();I=S*(s-p),q.shiftPointsElevation(I)}var i=Fo.superClass.setAnchorElevation.apply(q,arguments);return O||delete q._55I,i},getShapeElevation:function(){var T=this,F=T._54O;return F-(T.getTall()||0)*(T._anchorElevation-.5)},setAnchor3d:function(a,l,r,J){var z,D=this;"number"==typeof a?z={x:a,y:l,z:r}:(z=a.length?{x:a[0],y:a[1],z:a[2]}:a,J=l),D._55I=!0,D._updatingAnchor3d=!0;var W=D.getDataModel();if(W&&W.beginTransaction(),!vg){var h=D.getAnchor3d(),m=D.getSize(),u=D.getTall(),M=m.width*(h.x-z.x),P=m.height*(h.z-z.z),N=u*(h.y-z.y);J||D.shiftPoints(M,P,N);var A=D.p3()}var $=Fo.superClass.setAnchor3d.apply(D,arguments);if(!vg&&J){var t=D.p3();D.shiftPoints(t[0]-A[0]+M,t[2]-A[2]+P,t[1]-A[1]+N)}return W&&W.endTransaction(),delete D._updatingAnchor3d,delete D._55I,$},setAnchor:function(V,n,w){var u=this;u._55I=!0;var q=u._updatingAnchor3d,i=!vg&&!q;if(i){var Q,v,d;"number"==typeof V?d={x:V,y:n}:(d=V.length?{x:V[0],y:V[1]}:V,w=n);var Z=u.getAnchor(),x=u.getSize();Q=x.width*(Z.x-d.x),v=x.height*(Z.y-d.y),w||u.shiftPoints(Q,v);var G=u.getPosition()}var L=Fo.superClass.setAnchor.apply(u,arguments);if(i){var f=u.getPosition();w&&u.shiftPoints(f.x-G.x+Q,f.y-G.y+v)}return q||delete u._55I,L},shiftPoints:function(C,Y,B){var e=this,T=e.getElevation()||0,k=e.toPoints(),r=new uh;k.each(function(S){var u=S.e;B&&(u=(u==p?T:u)+B),r.add({x:S.x+C,y:S.y+Y,e:u})}),e.setPoints(r),e.fs()},shiftPointsElevation:function(b){return this.shiftPoints(0,0,b)},setPosition:function(l,E){var B,w=this;if(!w._28Q){if(w._28Q=1,!w._55I&&!vg){B=2===arguments.length?{x:l,y:E}:l;var h=B.x-w._position.x,D=B.y-w._position.y;if(0===h&&0===D)return delete w._28Q,void 0;w._55I=1,w.shiftPoints(h,D),xn(w,[1,0,0,1,h,D]),delete w._55I}Fo.superClass.setPosition.apply(w,arguments),delete w._28Q}},fs:function(){this.fireShapeChange()},_70I:function(){var O=this;if(2!==O._59O.size())return!1;var P=O._58O;return P?2===P.size()&&1===P.get(0)&&2===P.get(1)?!0:!1:!0},fireShapeChange:function(){var N=this;if(!N._55I&&!vg){var h=Ui(N._59O);h&&(N._55I=1,N.setRect(h),delete N._55I)}N.fp(jp,!1,!0)},getSerializableProperties:function(){var B=Fo.superClass.getSerializableProperties.call(this);return B.segments=1,B.points=1,B.thickness=1,B.closePath=1,B}});var db=D.Polyline=function(){td(db,this),this.s({"shape.background":null,"shape.border.width":2})};fe("Polyline",Fo,{_icon:"polyline_icon",_22Q:function(){return op},getUIClass:function(){return oj},setClosePath:function(){},setTall:function(X){var E=this;if(!E._55I&&!E._24Q&&!vg&&E.getTall()){E._24Q=1;var P=E._54O,v=X/E.getTall();E._59O.each(function(N){N.e=N.e==p?P:(N.e-P)*v+P}),E.fs(),delete E._24Q}db.superClass.setTall.call(E,X)},setElevation:function(U){var X=this;if(!X._55I&&!X._24Q&&!vg){X._24Q=1;var m=U-X._54O;X._59O.each(function(a){a.e==p?a.e=U:a.e+=m}),X.fs(),delete X._24Q}db.superClass.setElevation.apply(X,arguments)},fireShapeChange:function(){var U=this,a=U._59O;if(!U._55I&&!U._24Q&&!vg){var K=a.size();if(K){var P=1,W=a.get(0),_=U._54O;W.e==p&&(W.e=_);for(var x=W.e,h=0;K>P;P++){W=a.get(P),W.e==p&&(W.e=_);var Z=j(x,W.e),D=Q(x+h,W.e);x=Z,h=D-Z}U._24Q=1,U.setTall(h),U.setElevation(x+h*U._anchorElevation),delete U._24Q}}db.superClass.fireShapeChange.apply(U,arguments)}});var om=D.SubGraph=function(){td(om,this)};fe("SubGraph",Dl,{ISubGraph:1,_image:"subGraph_image",_icon:"subGraph_icon",_8I:function(){om.superClass._8I.call(this),this.eachChild(function(A){Bf(A)&&A._8I()})}}),U.loadingRefGraph=0;var Af=D.RefGraph=function(){td(Af,this)};fe("RefGraph",Zl,{_icon:"refGraph_icon",getRef:function(){return this._ref},setRef:function(k){var c=this._ref;this._ref=k,this.fp("ref",c,k),this.updateRef()},_21I:function(){Af.superClass._21I.apply(this,arguments),this.updateRef()},updateRef:function(){var n=this;if(U.loadingRefGraph++,n.clearChildrenFromDataModel(),U.loadingRefGraph--,n._ref&&n._dataModel){n._xhrLoadHandler&&(n._xhrLoadHandler.cancel=!0);var Q=vg,j=n._xhrLoadHandler=function(z){if(z&&n._dataModel){U.loadingRefGraph++;var h=n._pendingUpdateInfo={needToRestore:Q};Q&&(h.position=n.p(),h.width=n.getWidth(),h.height=n.getHeight(),h.rotation=n.getRotation(),h.anchor=n.getAnchor(),h.scale=n.getScale()),n.p(0,0),n.setAnchor(.5,.5),n.setRotation(0),n.setScale(1,1);var k=U.parse(z),D=n._dataModel.deserialize(k,n,{justDatas:!0});D.each(function(G){G._refGraph=n}),n.checkPendingUpdateInfo(),U.loadingRefGraph--,U.handleRefGraphLoaded(n,D,k)}};j.xhrLoadCalled=!1,U.load(n._ref,function(n){j.cancel||(j.xhrLoadCalled?j(n):tf(function(){j(n)}))}),j.xhrLoadCalled=!0}},checkPendingUpdateInfo:function(){var G=this,V=G._pendingUpdateInfo;if(!V)return G.onPendingUpdated&&(U.loadingRefGraph++,G.onPendingUpdated(),U.loadingRefGraph--),void 0;var s=!0;this.eachChild(function(c){(c._pendingCheckImageJSON||c._pendingUpdateInfo)&&(s=!1)}),s&&(U.loadingRefGraph++,G._pendingUpdateInfo=null,G.updateFromChildren(),V.needToRestore&&(G.setSize(V.width,V.height),G.setAnchor(V.anchor),G.setRotation(V.rotation),G.setScale(V.scale),G.p(V.position)),this.getParent()instanceof Af&&this.getParent().checkPendingUpdateInfo(),G.onPendingUpdated&&G.onPendingUpdated(),U.loadingRefGraph--)},getSerializableProperties:function(){var i=Af.superClass.getSerializableProperties.call(this);return i.ref=1,i}}),D.EdgeGroup=function(C,j){this._70O=C,this._siblings=j;for(var F,l,X=0,r=C.size(),T=q[Qr];r>X;X++)if(F=C.get(X).getStyle(Qr,!1),F!=p){T=F;break}T==p&&(T=!0);var Q=U.edgeGroupAgentFunc;for(Q&&(l=Q(C),l&&l!==C.get(0)&&(C.remove(l),C.add(l,0))),X=0;r>X;X++)C.get(X).s(Qr,T)},fe("EdgeGroup",h,{getEdges:function(){return this._70O},size:function(){return this._70O.size()},get:function(W){return this._70O.get(W)},indexOf:function(Y){return this._70O.indexOf(Y)},each:function(L,b){this._70O.each(L,b)},getSiblings:function(){return this._siblings},eachSiblingEdge:function(K,A){this._siblings.each(function(s){s._70O.each(K,A)})}});var Xq=function(G,l,b){var f=Ei[G]={type:G,action:l};if(b)for(var P in b)f[P]=b[P]};Xq("host",function(f,$,P){P&&$.setHost(P)},{"delete":{visible:function(W,A){return A.getHost()},action:function(v,z){z.setHost(null)}}}),Xq("parent",function(_,Y,H){H&&Y.setParent(H)},{"delete":{visible:function(t,H){return H.getParent()},action:function(r,G){G.setParent(null)}}}),Xq("copySize",function(K,p,k){if(k){var F=k.getSize();p.setSize(F)}}),Xq("copyRotation",function(K,F,z){if(z){var H=z.getRotation();F.setRotation(H)}}),Xq("edge",function(_,R,p){if(p){var S=new D.Edge(R,p);R.dm().add(S)}}),Gp(U,{setConnectAction:Xq,getConnectAction:function(D,r){return r=r||D.getCurrentConnectActionType(),Ei[r]},doConnectAction:function(M,U,t,k){k=k||M.getCurrentConnectActionType();var q=Ei[k];if(!q)return!1;var u=q.action;return u?(u.call(null,M,U,t),!0):!1},doDeleteConnectionAction:function(l,z,W){W=W||l.getCurrentConnectActionType();var $=Ei[W];if(!$||!$.delete)return!1;var o=$.delete.action;return o?(o.call(null,l,z),!0):!1}});var Dn=D.JSONSerializer=function(H,D){this.dm=this._dataModel=H,this._hierarchical=U.forceHierarchicalSerialization?!0:D==p?H.isHierarchicalRendering():D};fe("JSONSerializer",h,{ms_ac:["hierarchical"],serialize:function(h){return U.stringify(this.toJSON(),h)},toJSON:function(){var I=this,g=I.dm,k=g.getRoots(),H=I.json={v:U.getVersion(),p:{},a:{},d:[]},y=g.getSerializableAttrs();g.getInit()&&(H.init=g.getInit()),g.getName()&&(H.p.name=g.getName()),g.getBackground()&&(H.p.background=g.getBackground()),g.getLayers()&&(H.p.layers=g.getLayers()),H.p.autoAdjustIndex=g.isAutoAdjustIndex(),H.p.hierarchicalRendering=g.isHierarchicalRendering();for(var i in y){var A=g.a(i);A!==R&&I[dn](i,A,H.a)}return es(H.a)&&delete H.a,I._hierarchical?k.each(I.serializeData,this):g.each(function(g){I.serializeData(g)}),H},isSerializable:function(){return!0},getProperties:function(h){return h.getSerializableProperties()},getStyles:function(W){return W.getSerializableStyles()},getAttrs:function(u){return u.getSerializableAttrs()},serializeData:function(x){var m=this;if(m.isSerializable(x)&&!x._refGraph){var v,R,A,g,t=og(x.getClassName())||x.getClass(),O=new t,L={c:x.getClassName(),i:x.getId(),p:{},s:{},a:{}};m.json.d.push(L),v=m.getProperties(x);for(R in v)/^_/.test(R)?(A=x[R],A!==O[R]&&m[dn](R.substr(1),A,L.p)):(g=xr(R),x[g]&&(A=x[g](),A!==O[g]()&&m[dn](R,A,L.p)));v=m.getStyles(x);for(R in v)A=x.s(R),A!==O.s(R)&&m[dn](R,A,L.s);v=m.getAttrs(x);for(R in v)A=x.a(R),A!==O.a(R)&&m[dn](R,A,L.a);es(L.p)&&delete L.p,es(L.s)&&delete L.s,es(L.a)&&delete L.a}m._hierarchical&&x.getChildren().each(m.serializeData,m)},serializeValue:function(C,o,v){nk(o)?o={__a:o._as}:o instanceof Mo&&(o={__i:o.getId()}),v[C]=o},deserialize:function(c,o,E){var H=this,M=H.dm;M.beginTransaction(),vg++,E=sq(E)?{setId:E}:E||{},c=H.json=Op(c)?U.parse(c):c,H._82I={};var K=new uh,C=new uh,r=0,w=c.d.length;if(E.justDatas||(vk(c.init)&&c.init(M),M.setInit(c.init)),!E.justDatas){for(var B in c.a)M.a(B,H[Ac](c.a[B]));for(var b in c.p)M[Jl(b)](c.p[b])}for(;w>r;r++){var x=c.d[r],P=og(x.c),k=new P,Y=x.i;E.setId&&Y!=p&&(k._id=Y),H._82I[Y]=k,K.add(k),C.add(x)}for(r=0;w>r;r++)H.deserializeData(K.get(r),C.get(r));return K.each(function(c){o&&!c.getParent()&&c.setParent(o),M.add(c)}),vg--,M.endTransaction(),K},deserializeData:function(l,C){for(var Y in C.p)l[Jl(Y)](this[Ac](C.p[Y]));for(Y in C.s)l.s(Y,this[Ac](C.s[Y]));for(Y in C.a)l.a(Y,this[Ac](C.a[Y]))},deserializeValue:function(l){if(Dh(l)){var H=l.__i;if(H!=p)return this._82I[H];if(H=l.__a,vi(H))return new uh(H)}return l}}),Gp(ke,{serialize:function(I,q){return new Dn(this,q).serialize(I)},toJSON:function(o){return new Dn(this,o).toJSON()},deserialize:function(U,n,m){return new Dn(this).deserialize(U,n,m)}});var lg=D.OverlappingBox=function(I){this.gv=I,this.boxes={}
};fe("OverlappingBox",h,{clear:function(){var t,x,s=this.boxes;for(t in s)x=s[t],x.length=0},isOverlapping:function(n,P){var u,x,s=this,K=s.boxes,g=K[n];g?(u=g.rects,x=g.length):g=K[n]={rects:u=[],length:x=0};var l,q,P;for(l=0;x>l;l++)if(q=u[l],q.x<P.x+P.w&&q.x+q.w>P.x&&q.y<P.y+P.h&&q.h+q.y>P.y)return!0;return u.length<=x?(u.push(P),g.length++):u[g.length++]=P,!1}}),ur.GraphView=function(O){var b=this;b._24I={},b._34I=new uh,b._25I={},b._56I={},b._view=Yf(1,b),b._canvas=Ne(b._view),b.dm(O?O:new ke),this._coreInteractor=new Ob(this),b.setEditable(!1),b.setScrollBarVisible(U.graphViewScrollBarVisible)},$e("GraphView",h,{ms_v:1,ms_gv:1,ms_bnb:1,ms_tip:1,ms_dm:1,ms_lp:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,_52o:1,_51o:1,ms_ac:[Dg,Se,Jf,Zd,"resettable","editInteractor",hq,"pannable","rectSelectable","autoScrollZone",lr,"movableFunc","editableFunc","pointEditableFunc","rectEditableFunc","rotationEditableFunc","anchorEditableFunc","rectSelectBackground","rectSelectBorderColor","editPointSize","editPointBorderColor","editPointBackground","hoverDelay"],_resettable:U.graphViewResettable,_pannable:U.graphViewPannable,_rectSelectable:U.graphViewRectSelectable,_autoScrollZone:U.graphViewAutoScrollZone,_rectSelectBackground:U.graphViewRectSelectBackground,_rectSelectBorderColor:U.graphViewRectSelectBorderColor,_editPointSize:U.graphViewEditPointSize,_editPointBorderColor:U.graphViewEditPointBorderColor,_editPointBackground:U.graphViewEditPointBackground,_scrollBarColor:Hb,_scrollBarSize:Db,_autoHideScrollBar:Eg,_autoMakeVisible:tl,_currentActionType:"host",getCoreInteractor:function(){return this._coreInteractor},getLayers:function(){return this._dataModel.getLayers()},setLayers:function(O){this._dataModel.setLayers(O)},setEditable:function(y){var B=this,P=B.__interactorMap__;if(!P){var w=ur.XEditInteractor;P=B.__interactorMap__={scrollBar:new fo(B),select:new ed(B),edit:w?new w(B):new Kj(B),move:new Qf(B),"default":new Ff(B),touch:new np(B,{editable:!1})}}y?(B._uieditable=!0,B.setInteractors([P.scrollBar,P.select,P.edit,P.move,P.default,P.touch])):(B._uieditable=!1,B.setInteractors([P.scrollBar,P.select,P.move,P.default,P.touch]))},getCanvas:function(){return this._canvas},_33I:function(y){var N=y.getUIClass();return N?new N(this,y):p},getDataUI:function(H){var n=this,A=n._25I[H._id];return A===R&&(A=n._33I(H),n._25I[H._id]=A),A},getNodeRect:function(d){return U.getNodeRect(this,d)},getEdgeInfo:function(v){var f=this.getDataUI(v);return f?(f._79o(),f._78o):null},getEdgeSourcePosition:function(z){var O=this,i=O.getDataUI(z),Q=i.s,r=i._data._40I;return Tj(O,r,Q("edge.source.position"),Q("edge.source.offset.x"),Q("edge.source.offset.y"),Q("edge.source.anchor.x"),Q("edge.source.anchor.y"))},getEdgeTargetPosition:function(r){var n=this,e=n.getDataUI(r),g=e.s,b=e._data._41I;return Tj(n,b,g("edge.target.position"),g("edge.target.offset.x"),g("edge.target.offset.y"),g("edge.target.anchor.x"),g("edge.target.anchor.y"))},invalidateAll:function(Q){var B=this;if(Q){for(var l in B._25I){var J=B._25I[l];J&&J.dispose()}B._25I={},B._56I={},B._24I={},B._34I.clear(),B.redraw()}else B.dm().each(function(f){B.invalidateData(f)})},invalidateSelection:function(){var H=this;H.sm().each(function(U){H.invalidateData(U)})},invalidateData:function(N){var f=this;f._24I[N._id]=N,f._21Q(N),f.iv()},_21Q:function(L){var d=this,X=d._24I;if(Yr(L)&&cb[L.s(Bq)]){var c=L.getSourceAgent();c&&c.getAgentEdges().each(function(W){X[W._id]=W}),c=L.getTargetAgent(),c&&c.getAgentEdges().each(function(q){X[q._id]=q}),d.iv()}},redraw:function(x){var y=this;y._32I||(x?y._34I.add(x):(y._32I=1,y._34I.clear()),y.iv())},each:function($,L){var C,s,P,H=0,Y=this.getLayers(),W=this._dataModel,g=W._datas._as,O=g.length;if(Y){for(var j=Y.length;j>H;H++)if(P=Y[H],Dh(P)&&(P=P.name),W.isHierarchicalRendering()){var S=function(q){return q._layer===P?L?$.call(L,q):$(q):void 0};if(this._dataModel.eachByHierarchical(S)===!1)return}else for(var f=0;O>f;f++)if(C=g[f],C._layer===P&&(s=L?$.call(L,C):$(C),s===!1))return}else if(W.isHierarchicalRendering())this._dataModel.eachByHierarchical($,null,L);else for(;O>H;H++)if(C=g[H],s=L?$.call(L,C):$(C),s===!1)return},reverseEach:function(P,h){var u,c,L,S,m=this._dataModel,x=m._layers,l=m._datas._as,I=l.length;if(x){for(u=x.length-1;u>=0;u--)if(S=x[u],Dh(S)&&(S=S.name),m.isHierarchicalRendering()){var k=function(e){return e._layer===S?h?P.call(h,e):P(e):void 0};if(m.reverseEachByHierarchical(k)===!1)return}else for(var U=I-1;U>=0;U--)if(c=l[U],c._layer===S&&(L=h?P.call(h,c):P(c),L===!1))return}else if(m.isHierarchicalRendering())m.reverseEachByHierarchical(P,null,h);else for(u=I-1;u>=0;u--)if(c=l[u],L=h?P.call(h,c):P(c),L===!1)return},getViewRect:function(){return this._29I},getContentRect:function(){var x=this,t=x._84I;if(!t){var e=this.dm().a("width"),S=this.dm().a("height");e>0&&S>0?x._84I={x:0,y:0,width:e,height:S}:(x.each(function(e){x.isVisible(e)&&(t=Ij(t,x.getDataUIBounds(e)))}),x._84I=t?t:Am)}return x._84I},getScrollRect:function(){return Ij(this.getContentRect(),this._29I)},makeCenter:function(D,W,q){var K=this;if(!K.getWidth()||!K.getHeight())return q||tf(K.centerData,K,[D,W,!0],500),void 0;K.makeVisible(D),K.validate();var f=K.getDataUIBounds(D);if(f){var x=K.getWidth(),d=K.getHeight(),k=f.x+f.width/2,Z=f.y+f.height/2,l=-k*K._zoom+x/2,o=-Z*K._zoom+d/2;K.setTranslate(l,o,W)}},fitData:function(b,E,x,o,h){var B=this;if(!B.getWidth()||!B.getHeight())return h||tf(B.fitData,B,[b,E,x,o,!0],500),void 0;var z=function(){B.makeVisible(b),B.validate();var K=B.getDataUIBounds(b);K&&(K=ik(K),Lf(K,x==p?20:x),B.fitRect(K,E,o))};E?U.callWhenLoaded(z):z()},fitContent:function(J,X,o,v){var D=this;if(!D.getWidth()||!D.getHeight())return v||tf(D.fitContent,D,[J,X,o,!0],500),void 0;var P=function(){D.validate();var h=ik(D.getContentRect());Lf(h,X==p?20:X),D.fitRect(h,J,o)};J?U.callWhenLoaded(P):P()},fitRect:function(R,E,F){var G=this,U=G.getWidth(),l=G.getHeight(),_=R.x+R.width/2,J=R.y+R.height/2,O=j(U/R.width,l/R.height),X=G._zoom,W=-_*X+U/2,y=-J*X+l/2;0===O||isNaN(O)||(F&&(O=j(1,O)),E?G.setTranslate(W,y,{finishFunc:function(){G.setZoom(O,E)}}):(G.setTranslate(W,y),G.setZoom(O)))},toCanvas:function(j,d){d=d||this._zoom,this.validateImpl();var P=this,H=P.getContentRect();H.width||(H.width=10),H.height||(H.height=10);var h=Ne(),w=H.x*d,c=H.y*d,Q=H.width*d,R=H.height*d;Yc(h,Q,R,1);var Y=Xh(h);return j=j||this._dataModel.getBackground(),j&&le(Y,0,0,Q,R,j),Up(Y,-w,-c),Y.scale(d,d),P._42(Y),Y.restore(),h},toDataURL:function(i,C,n){return this.toCanvas(i,n).toDataURL(C||"image/png",1)},getClipBounds:function(){return this._74O},_42:function(v,M){var f,b,L=this;L._93db(v,M),L.each(function(w){L._56I[w._id]&&(f=L.getDataUI(w),f&&(b=f._79o(),D.HtmlNode&&w instanceof D.HtmlNode?f._42(v):(!M||Lr(M,b))&&f._42(v)))}),L._92db(v,M)},validateImpl:function(){var t,S,U,V,w,R=this,C=R.tx(),H=R.ty(),d=R._zoom,K=R._canvas,f=this.getWidth(),b=this.getHeight(),l=R._29I,D={x:-C/d,y:-H/d,width:f/d,height:b/d},X={},L=R._34I,P=R._24I,J=R._32I,g=R._23I;R._24I={},(f!==K.clientWidth||b!==K.clientHeight)&&(Yc(K,f,b),J=1),J||Kl(D,l)||(J=1),R._29I=D,R.each(function(e){S=e._id;var Y=X[S]=R.isVisible(e);Y!==R._56I[S]&&(P[S]=e,U=R.getDataUI(P[S]),U&&U._84o(Y),R._84o(e,Y))},R);for(S in P)U=R.getDataUI(P[S]),U&&(!J&&R._56I[S]&&(w=U._79o(),w&&L.add(w)),U.invalidate()),R._83I=1;if(R._56I=X,!J)for(S in P)X[S]&&(U=R.getDataUI(P[S]),U&&(w=U._79o(),w&&L.add(w)));if(J?V=D:(L.each(function(h){Lr(D,h)&&(V=Ij(V,h))}),V&&(Lf(V,Q(1,1/d)),V.x=Z(V.x*d)/d,V.y=Z(V.y*d)/d,V.width=E(V.width*d)/d,V.height=E(V.height*d)/d,V=Sg(D,V))),R._74O=V,V){t=Xh(K);var a=V.x,p=V.y,k=V.width,q=V.height;a=Math.floor((a*d+C)*eq),p=Math.floor((p*d+H)*eq),k=Math.ceil(k*d*eq)+1,q=Math.ceil(q*d*eq)+1,t.beginPath(),t.rect(a,p,k,q),t.clip(),t.clearRect(a,p,k,q),Co(t,C,H,d),R._42(t,V),t.restore(),delete R._74O}if(L.clear(),delete R._32I,g&&f>0&&b>0){var U=R.getDataUI(g);if(U){var w=U._79o(),n=R._29I,G=n.x,j=n.y,W=n.width,_=n.height,d=R._zoom;w&&!Lr(w,n)&&(w.x+w.width<G&&R.tx(-w.x*d),w.x>G+W&&R.tx(-(w.x+w.width-W)*d),w.y+w.height<j&&R.ty(-w.y*d),w.y>j+_&&R.ty(-(w.y+w.height-_)*d))}delete R._23I}R._83I&&(delete R._83I,delete R._84I),R._98O(),es(R._24I)||tf(R.iv,R)},isScrollBarVisible:function(){return!!this._79O},setScrollBarVisible:function(v){var l=this;v!==l.isScrollBarVisible()&&(v?(rj(l._view,l._79O=yb()),rj(l._79O,l._27I=yb()),rj(l._79O,l._28I=yb())):(_k(l._79O),delete l._79O,delete l._27I,delete l._28I),l.fp("scrollBarVisible",!v,v))},showScrollBar:function(){var S=this;S._79O&&(S._85I||(A(function(){S._86I()},uq),S.iv()),S._85I=new Date)},_86I:function(){var j=this;if(j._85I){var T=new Date,a=T.getTime();a-j._85I.getTime()>=uq?(delete j._85I,j.iv()):A(function(){j._86I()},uq)}},_98O:function(){var y=this,G=this._27I,p=this._28I;if(y._79O){if(y._autoHideScrollBar&&!y._85I)return G.style.visibility=yd,p.style.visibility=yd,void 0;var $=y.getScrollBarColor(),b=y._zoom,Z=y.getScrollBarSize(),M=y.getViewRect(),K=y.getScrollRect(),N=M.height*b,k=K.height*b,j=M.width*b-Z-2,D=N*((M.y-K.y)*b/k),e=N*(N/k),a=G.style;k-.5>N?(zf>e&&(D=D+e/2-zf/2,0>D&&(D=0),D+zf>N&&(D=N-zf),e=zf),Eb(G,j,D,Z,e),a.visibility=ks,a.background=$,a.borderRadius=Z/2+Vj):a.visibility=yd;var f=M.width*b,o=K.width*b,D=M.height*b-Z-2,j=f*((M.x-K.x)*b/o),w=f*(f/o),a=p.style;o-.5>f?(zf>w&&(j=j+w/2-zf/2,0>j&&(j=0),j+zf>f&&(j=f-zf),w=zf),Eb(p,j,D,w,Z),a.visibility=ks,a.background=$,a.borderRadius=Z/2+Vj):a.visibility=yd}},setDataModel:function(h){var U=this,I=U._dataModel,W=U._selectionModel;I!==h&&(I&&(I.ump(U.handleDataModelPropertyChange,U),I.umm(U.handleDataModelChange,U),I.umd(U.handleDataPropertyChange,U),I.removeIndexChangeListener(U._75O,U),I.removeHierarchyChangeListener(U.handleHierarchyChange,U),W||I.sm().ums(U.handleSelectionChange,U)),U._dataModel=h,h.mp(U.handleDataModelPropertyChange,U),h.mm(U.handleDataModelChange,U),h.md(U.handleDataPropertyChange,U),h.addIndexChangeListener(U._75O,U),h.addHierarchyChangeListener(U.handleHierarchyChange,U),W?W._21I(h):h.sm().ms(U.handleSelectionChange,U),U.invalidateAll(!0),U.fp(Il,I,h),U._canvas.style.background=h.getBackground()||"")},getLayersInfo:function(){if(this._layersInfo===R){var n=this.getLayers();n?(this._layersInfo={},n.forEach(function(E){var X=Dh(E)?E.name:E;this._layersInfo[X]=E},this)):this._layersInfo=null}return this._layersInfo},updateLayers:function(){this._layersInfo=R,this.invalidateSelection(),this.redraw()},handleDataModelPropertyChange:function(k){if("background"===k.property){var R=this._canvas.style.background,h=k.newValue||"";this._canvas.style.background=h,this.fp("canvasBackground",R,h)}else"a:width"===k.property||"a:height"===k.property?(this._83I=1,this.redraw()):"layers"===k.property?this.updateLayers():"hierarchicalRendering"===k.property&&this.redraw()},handleDataPropertyChange:function(f){this.dm().isHierarchicalRendering()&&"parent"===f.property&&f.data.hasChildren()&&this.redraw(),this.invalidateData(f.data)},onPropertyChanged:function(X){var r=this,K=X.property;if(r.redraw(),"zoom"===K){var k=r.sm().getSelection();k.size()&&k.each(function(G){G.invalidate()})}Ab[K]?r.showScrollBar():K===hq&&r.onCurrentSubGraphChanged(X)},onCurrentSubGraphChanged:function(){this.sm().cs(),this.reset()},handleDataModelChange:function(t){var w=this,H=t.kind,_=t.data;if(w._83I=1,"add"===H)w.invalidateData(_),Yr(_)&&_.getEdgeGroup()&&_.getEdgeGroup().eachSiblingEdge(w.invalidateData,w);else if(H===Hi){w._21Q(_);var v=_._id,R=w._25I[v];if(R){if(w._56I[v]){var Z=R._79o();Z&&w.redraw(Z)}R.dispose(),delete w._25I[v],delete w._24I[v],delete w._56I[v]}_===w._currentSubGraph&&w.setCurrentSubGraph(p)}else H===Zi&&(w.invalidateAll(!0),w.setCurrentSubGraph(p))},_75O:function(Y){this.invalidateData(Y.data)},handleHierarchyChange:function(T){this.dm().isHierarchicalRendering()&&T.data.hasChildren()&&this.redraw(),this.invalidateData(T.data)},adjustIndex:function(D){var L=this;if(L.isVisible(D)){L.dm().beginTransaction();for(var N=D;N._parent&&L.isVisible(N._parent);)N=N._parent;N&&N!==D&&L._dataModel.adjustIndex(N),L._dataModel.adjustIndex(D),L.dm().endTransaction()}},getImage:function(t){return t.getImage?t.getImage():R},getSelectWidth:function(x){return x.s("select.width")},isSelectable:function(k){if(!this._clickThroughChecking&&k.getParent()instanceof Zl&&k.getParent().isSyncSize())return!1;var e=this.getLayersInfo();if(e){var m=e[k._layer];if(m&&m.selectable===!1)return!1}return k.s("2d.selectable")&&this.sm().isSelectable(k)},isMovable:function(s){var l=this;if(Yr(s)&&s.getStyle(Bq)!==oi)return!1;var Z=this.getLayersInfo();if(Z){var c=Z[s._layer];if(c&&c.movable===!1)return!1}return s.s("2d.movable")?l._movableFunc?l._movableFunc(s):!0:!1},isEditable:function(_){var K=this;if(D._uiSerializing)return K._uieditable;if(!K._editInteractor||!K.isSelected(_))return!1;if(xk(_)){var c=K.getDataUI(_);if(!c||c._88I)return!1}if(Yr(_)&&_.getStyle(Bq)!==oi)return!1;var i=this.getLayersInfo();if(i){var L=i[_._layer];if(L&&L.editable===!1)return!1}return _.s("2d.editable")?K._editableFunc?K._editableFunc(_):!0:!1},handleDelete:function(){this._editInteractor&&(this._editInteractor.handleDelete?this._editInteractor.handleDelete():this.removeSelection())},isPointEditable:function(_){return Bf(_)&&0!==_.getRotation()?!1:this._pointEditableFunc?this._pointEditableFunc(_):!0},isRectEditable:function(U){return this._rectEditableFunc?this._rectEditableFunc(U):!0},isAnchorEditable:function(v){return this._anchorEditableFunc?this._anchorEditableFunc(v):!0},isRotationEditable:function(N){return N.setRotation&&N.IRotatable!==!1?this._rotationEditableFunc?this._rotationEditableFunc(N):!0:!1},getRotationPoint:function(H){var o=H.getAnchor(),G=H.getScale(),n=this._zoom,N=Me(H.getRotation(),0,-H.getHeight()*G.y*o.y-(G.y<0?-1:1)*(_?32:16)/n),b=H.p();return N.x+=b.x,N.y+=b.y,N},getLogicalPoint:function(u){var x=this;return wd(u,x._canvas,x.tx(),x.ty(),x._zoom,x._zoom)},getSelectedDataAt:function(C){var A=this;return this.getDataAt(C,function(l){return A.isSelected(l)})},getDataInfoAt:function(O,r,c){var u,H=this.lp(O),$=this.getDataAt(H,r,c);if($){var d=this.getDataUI($);u={data:$,ui:d,point:H};var b=d._38o;if(b){var N=b.icons;for(var V in N){var Y=N[V],g=b.rects[V];if(g)for(var X=$n(Y.names,$,this),q=X?X.length:0,m=g.rotation,L=q-1;L>=0;L--){var x=X[L],f=g[L];if($f(f,H,m))return u.part="icons",u.name=V,u.icon=x,u.rect=f,u.index=L,u.rotation=m,u}}}if(this.isNoteVisible($)){if(d.note2Info&&$f(d.note2Info.clickRect,H,p,d.note2Info.scale))return u.part="note2",u;if(d.noteInfo&&$f(d.noteInfo.clickRect,H,p,d.noteInfo.scale))return u.part="note",u}if(this.isLabelVisible($)){if(d.label2Info&&$f(d.label2Info.rect,H,d.label2Info.rotation,d.label2Info.scale))return u.part="label2",u;if(d.labelInfo&&$f(d.labelInfo.rect,H,d.labelInfo.rotation,d.labelInfo.scale))return u.part="label",u}if($.isInRect&&$.isInRect(H))return u.part="body",u}return u},getDataAt:function(u,z,F){u.target&&(u=this.lp(u));var Z,x=this._zoom;return this.reverseEach(function(l){return(z?z(l):this.isSelectable(l))&&this.rectIntersects(l,Wo(u.x,u.y,F,x))?(Z=l,!1):void 0},this),Z},getIconInfoAt:function(q,x){var i=this;if(q.target&&(q=i.lp(q)),x||(x=i.getDataAt(q)),x){var V=i.getDataUI(x);if(V&&V._38o){var t,P=V._38o,W=new uh;for(t in P.icons)W.add(t);for(var c=W.size()-1;c>=0;c--){t=W.get(c);for(var G=P.rects[t],h=G.rotation,d=G.length-1;d>=0;d--){var J=G[d],E=J.width,F=J.height,n={x:q.x-J.x-E/2,y:q.y-J.y-F/2};h!=p&&(n=Me(-h,n.x,n.y));var J={x:-E/2,y:-F/2,width:E,height:F};if($f(J,n))return{key:t,index:d,name:P.icons[t].names[d],rect:G[d],point:q,rotation:h,relativeRect:J,relativePoint:n,data:x}}}}}return p},getDatasInRect:function(Z,Q,J){J===R&&(J=1);var B=this,b=new uh;return B.reverseEach(function(m){J&&!B.isSelectable(m)||(Q?B.rectIntersects(m,Z):B.rectContains(m,Z))&&b.add(m)}),b},moveSelection:function(m,A){var j=this;j.dm().beginTransaction(),Fq(j.sm().toSelection(j.isMovable,j),m,A),j.dm().endTransaction()},moveDatas:function(K,t,s){var i=this;i.dm().beginTransaction(),K instanceof uh||(K=new uh(K)),Fq(K,t,s),i.dm().endTransaction()},getDataUIBounds:function(P){var b=this.getDataUI(P);return b?b._79o():p},drawData:function(Z,l){var I=this.getDataUI(l);I&&(I._79o(),I._42(Z)),l instanceof D.Block&&l.eachChild(function(s){this.drawData(Z,s)},this)},getBoundsForGroup:function(w){return w.s(ys)?this.getDataUIBounds(w):p},rectIntersects:function(y,M){this.validate();var e=p;if(this._56I[y._id]){var O=this._25I[y._id];if(O){var k=O._79o();if(jc(M,k))e=!0;else if((M=Sg(M,k))&&(O.rectIntersects&&(e=O.rectIntersects(M)),e==p)){if(!y.s("pixelPerfect"))return!0;var T=M.x,o=M.y,a=M.width,m=M.height,t=this._zoom,l=U.hitMaxArea,_=a*m*t*t;if(_>l){var Y=Math.sqrt(l/_);t*=Y}a*=t,m*=t,2>a&&(a=2),2>m&&(m=2),T*=t,o*=t;var Q=Hp(a,m);Up(Q,-T,-o),Q.scale(t,t),this._drawForChecking=!0,this.drawData(Q,y),this._drawForChecking=!1;try{for(var x=0,W=Q.getImageData(0,0,a,m).data;x<W.length;x+=4)if(0!==W[x+3]){e=!0;break}Q.restore()}catch(N){jq=p,e=!1}}}}return e?!0:!1},rectContains:function(k,t){if(this._56I[k._id]){var b=this._25I[k._id];if(b)return jc(t,b._79o())}return!1},reset:function(){this.setZoom(1),this.setTranslate(0,0)},handleKeyDown:function(Z){if(!U.isInput(Z.target)){var K=this,k=K._focusData,$=k&&K._25I[k._id],F=0,w=K._dataModel._datas;if(!(k&&k._enabled&&k._editable&&$&&$.onKeyDown&&$.onKeyDown(Z)===!0))if(9===Z.keyCode&&(k&&(F=w.indexOf(k),Ar(Z)?-1===--F&&(F=0):++F===w.size()&&(F=0)),K._focusData=k=w.get(F),K.sm().setSelection(k)),Fm(Z)?K.selectAll():Le(Z)&&K.isResettable()&&K.reset(),K.sm().isEmpty()){if(K._editing)return;var q=K.tx(),e=K.ty(),N=!1,x=Ar()?100:10;hb(Z)&&(q-=x,N=!0),Xk(Z)&&(e-=x,N=!0),mq(Z)&&(q+=x,N=!0),gd(Z)&&(e+=x,N=!0),N&&K.setTranslate(q,e)}else{po(Z)&&K.handleDelete(Z);var T=Ar()?10:1;hb(Z)&&(K.moveSelection(-T,0),K.fi({kind:"moveLeft"})),Xk(Z)&&(K.moveSelection(0,-T),K.fi({kind:"moveUp"})),mq(Z)&&(K.moveSelection(T,0),K.fi({kind:"moveRight"})),gd(Z)&&(K.moveSelection(0,T),K.fi({kind:"moveDown"}))}}},handleScroll:function(F,u){gj(F);var v=this.lp(F);u>0?this.scrollZoomIn(v):0>u&&this.scrollZoomOut(v)},handlePinch:function(E,d,k){this._68I||(d>k?this.pinchZoomIn(E):this.pinchZoomOut(E))},checkDoubleClickOnNote:function(_,g){var L=this,r=L.lp(_),e=L.getDataUI(g),p=e.note2Info;return p&&g.s("note2.toggleable")&&$f(p.clickRect,r)?(g.s(kg,!g.s(kg)),L.fi({kind:"toggleNote2",event:_,data:g}),!0):(p=e.noteInfo,p&&g.s("note.toggleable")&&$f(p.clickRect,r)?(g.s(Hj,!g.s(Hj)),L.fi({kind:"toggleNote",event:_,data:g}),!0):!1)},_84o:function(){},isNoteVisible:function(){return this._zoom>.15},isLabelVisible:function(){return this._zoom>.15},isEditVisible:function(){return this._zoom>.15},autoScroll:function(w,l){var B=this,M=B.getAutoScrollZone(),J=M/B.getZoom(),V=M/4,n=B._29I,e=B.lp(w),o={x:B.tx(),y:B.ty()};return e&&M>0&&n&&(e.x-n.x<J?B.translate(V,0):n.x+n.width-e.x<J&&B.translate(-V,0),e.y-n.y<J?B.translate(0,V):n.y+n.height-e.y<J&&B.translate(0,-V)),o.x=B.tx()-o.x,o.y=B.ty()-o.y,l&&(l.x+=o.x,l.y+=o.y),o},getMoveMode:function(v,K){var P=K.s("2d.move.mode");return P?P:qg["88"]?"x":qg["89"]?"y":"xy"},getSerializableProperties:function(){return{scrollBarColor:1,scrollBarSize:1,autoMakeVisible:1,autoHideScrollBar:1,editable:1,resettable:1,pannable:1,rectSelectable:1,autoScrollZone:1,visibleFunc:1,movableFunc:1,editableFunc:1,pointEditableFunc:1,rectEditableFunc:1,anchorEditableFunc:1,rotationEditableFunc:1,rectSelectBackground:1,rectSelectBorderColor:1,editPointSize:1,editPointBorderColor:1,editPointBackground:1,hoverDelay:1,dataModel:1,selectionModel:1,currentSubGraph:1,zoom:1,translateX:1,translateY:1}},serializeProperty:function(B,L,v){var d=this;return"currentSubGraph"===L?{__i:B.getId()}:v.serializeProperty(B,L,d)},deserializeProperty:function(V,H,N){var $=this;if("currentSubGraph"===H){var L=$.dm(),G=L.__idMap;return G[V.__i]}return N.deserializeProperty(V,H,$)},setDefaultCursor:function(U,R){this._defaultCursor=U,R!==!1&&this.setCursor(U)},setCursor:function($){"default"===$&&($=this._defaultCursor||$);var u=this.getView().style;u.cursor=$,u.cursor="-webkit-"+$,u.cursor="-moz-"+$},getCurrentConnectActionType:function(){return this._currentActionType},setCurrentConnectActionType:function(M){return U.getConnectAction(null,M)?(this._currentActionType=M,!0):!1},isInteractive:function(A){return A.s("interactive")}});var ob=function(T,e){var w=this;w.gv=T,w.s=function(r){return e.getStyle(r)},w._data=e,w._87I=new uh};bd(ob,h,{_6I:p,ms_icons:1,_84o:function(){},dispose:function(){},isShadowed:function(){return this.s("shadow")||this.gv.isSelected(this._data)&&"shadow"===this.s("select.type")},getSelectWidth:function(){var D=this,R=D.gv.isSelected(D._data);return!R||D.isShadowed()?0:D.gv.getSelectWidth(D._data)},getBodyColor:function(W){var A=this._data,F=this.gv.getBodyColor(A);return F?F:W?A.getStyle(W):p},_2Q:function(y){return this.s(y)},_1Q:function(H,P,y,Q){var u=this.s,b=u(P+".dash.color");H.strokeStyle=b,H.lineWidth=y,H.stroke(),u(P+".dash.3d")&&qk(H,b,u(P+".dash.3d.color"),y,this.gv._zoom,u(P+".dash.3d.accuracy")),Pp(H,Q)},invalidate:function(){this._6I=p},_79o:function(){var o=this;if(!o._6I){var F=o._data,b=o.gv;o.labelInfo=o.label2Info=o.noteInfo=o.note2Info=o._38o=p,o._87I.clear(),o.interactiveInfo=b.isInteractive(F)?{}:p,o._3O(),o._55O=b.isEditable(F)?{_42O:b.isRectEditable(F),_43O:b.isPointEditable(F),_56O:b.isRotationEditable(F)}:p,o._6I=o._81o()}return o._6I},_3O:function(){},getPosition:function(){return Am},_68o:function(Y,Z){Y&&this._87I.add(rq(Y,Z))},_81o:function(){var h=this,O=h.s;h._24O(Ql,"getLabel"),h._24O(Mn,"getLabel2"),h._26O(Ir,"getNote"),h._26O(kb,"getNote2"),h._15O(),h._55O&&h._48O();var P;if(h._87I.each(function(z){P=Ij(P,z)}),P&&h.isShadowed()){var A=ik(P);A.x+=O("shadow.offset.x"),A.y+=O("shadow.offset.y"),Lf(A,O("shadow.blur")),P=Ij(P,A)}return h._87I.clear(),P},_42:function(O){var K=this,L=K._data,E=K.gv,A=K.s,D=A("opacity"),U=this.isShadowed();if(U){var j=O.shadowOffsetX,R=O.shadowOffsetY,z=O.shadowBlur,Q=O.shadowColor,G=E.getZoom();O.shadowOffsetX=A("shadow.offset.x")*G,O.shadowOffsetY=A("shadow.offset.y")*G,O.shadowBlur=A("shadow.blur")*G,O.shadowColor=A("select.color")}if(D!=p){var u=O.globalAlpha;O.globalAlpha=D}K._80o(O),E.isLabelVisible(L)&&((!E._drawForChecking||A("label.selectable"))&&Yp(O,K.labelInfo),(!E._drawForChecking||A("label2.selectable"))&&Yp(O,K.label2Info)),E.isNoteVisible(L)&&(Nf(O,K.noteInfo),Nf(O,K.note2Info)),K._99O(O),D!=p&&(O.globalAlpha=u),U&&(O.shadowOffsetX=j,O.shadowOffsetY=R,O.shadowBlur=z,O.shadowColor=Q)},_80o:function(){},_47O:function(){},_24O:function(i,$){var q=this,B=q._data,U=q.gv,A=q.s,z=U[$](B);if(z!=p){var d=A(i+".scale"),r=A(i+".max"),E=A(i+".position"),F=q[i+"Info"]={label:z,scale:d,color:U[$+"Color"](B),font:A(i+".font"),opacity:A(i+".opacity"),align:A(i+".align"),rotation:q.getRotation(A(i+".rotation"),!1,E),background:U[$+"Background"](B)},j=bk(F,z);r>0&&r<j.width&&(F.labelWidth=j.width,j.width=r),1!==d&&(j.width*=d,j.height*=d);var l=q.getPosition(E,A(i+".offset.x"),A(i+".offset.y"),j,A(i+".position.fixed"));if(j.x=l.x-j.width/2,j.y=l.y-j.height/2,q._68o(F.rect=j,F.rotation),1!==d){var y=j.width/d,w=j.height/d;F.rect={x:l.x-y/2,y:l.y-w/2,width:y,height:w}}}},_26O:function(d,J){var Z=this,e=Z.gv,c=Z._data,K=Z.s,M=e[J](c);if(M!=p){var L,I,j=K(d+".scale"),R=Z[d+"Info"]={note:M,scale:j,data:c,view:e,expanded:K(d+".expanded"),font:K(d+".font"),color:K(d+".color"),opacity:K(d+".opacity"),align:K(d+".align"),icon:K(d+".icon"),backgroundImage:K(d+".backgroundImage"),borderWidth:K(d+".border.width"),borderColor:K(d+".border.color"),background:e[J+"Background"](c)},O=Z.getPosition(K(d+".position"),K(d+".offset.x"),K(d+".offset.y")),F=O.x,U=O.y;if(R.expanded){var H,W=K(d+".max"),N=K(d+".backgroundImage");N?(N=Tm(N),H={width:rl(N,c),height:ws(N,c)}):H=bk(R,M),H.width+=6,H.height+=2,W>0&&W<H.width&&(R.labelWidth=H.width,H.width=W),L=H.width,I=H.height+8,R.clickRect={x:F-L*j/2,y:U-I*j,width:L*j,height:I*j*H.height/I}}else{var v=K(d+".icon");v?(v=Tm(v),L=rl(v,c),I=ws(v,c)):(L=12,I=18),R.clickRect={x:F-L*j/2,y:U-I*j,width:L*j,height:I*j}}R.rect={x:F-L/2,y:U-I*j/2-I/2,width:L,height:I};var s=E(R.borderWidth/2)*j;Z._68o({x:F-L*j/2-s,y:U-I*j-s,width:L*j+2*s,height:I*j+2*s})}},_48O:function(){},_99O:function(y){var a=this,g=a._38o;if(g){var L=a.gv,N=a._data,P=g.icons,r=a.interactiveInfo;r&&(r._38o={});for(var $ in P){var o=P[$],T=g.rects[$];if(T){r&&(r._38o[$]=[]);var t=$n(o.opacity,N,L),i=$n(o.names,N,L),O=i?i.length:0,D=T.rotation;if(t!=p){var b=y.globalAlpha;y.globalAlpha*=t}for(var f=0;O>f;f++){var U=i[f],Q=Tm(U),F=T[f];if(D){var l=F.x+F.width/2,s=F.y+F.height/2;y.save(),Up(y,l,s),nd(y,D),Up(y,-l,-s)}r&&r._38o[$].push(y.interactiveInfo={compInfos:[],stacks:D?[{t:[l,s]},{r:D},{t:[-l,-s]}]:[]}),Xl(y,Q,$n(o.stretch,N,L),F.x,F.y,F.width,F.height,a._data,a.gv),y.interactiveInfo=p,D&&y.restore()}t!=p&&(y.globalAlpha=b)}}}}});var Gq=function(D,A){td(Gq,this,[D,A])};bd(Gq,ob,{_checkEmptyRect:!0,_40O:function(m,j){var t=this,d=t.s,u=m.rect;(m.borderColor=t.gv.getBorderColor(t._data))&&(m.borderType=d("border.type"),m.borderWidth=d("border.width"),m.borderPadding=d("border.padding"),j=Q(j,m.borderPadding+m.borderWidth/2));var g=t._data.getScale(),$=Q(1,Q(B(g.x),B(g.y)));if(m.selectWidth=t.getSelectWidth()){var D=t.gv._zoom;m.selectType=d("select.type"),m._97o=d("select.color"),m.selectPadding=d("select.padding"),j=Q(j,(m.selectPadding+m.selectWidth/2/D)/$)}j>0&&(j*=$,u=ik(u),Lf(u,j)),t._68o(u)},_39O:function(u,Z){var V,i=this,K=Z.rect;if(Z.borderWidth>0&&(V=Z.borderPadding,u.strokeStyle=Z.borderColor,u.lineWidth=Z.borderWidth,Bi(u,Z.borderType,{x:K.x-V,y:K.y-V,width:K.width+2*V,height:K.height+2*V}),u.stroke()),Z.selectWidth>0){var q=i.gv._zoom;if(V=Z.selectPadding,u.strokeStyle=Z._97o,u.lineWidth=Z.selectWidth/q,Z.rotation!=p){u.save(),u.translate(Z.position.x,Z.position.y),u.rotate(Z.rotation);var L=i._data,X=L.getWidth(),d=L.getHeight(),z=Z.scale,g=Z.anchor;K={x:z.x*-X*g.x,y:z.y*-d*g.y,width:z.x*X,height:z.y*d}}Bi(u,Z.selectType,{x:K.x-V,y:K.y-V,width:K.width+2*V,height:K.height+2*V}),Z.rotation!=p&&u.restore(),u.stroke()}},_3O:function(){var g=this,u=g.s,a=g._data,c=a.getStyle(jp),T=g.getBodyColor(),A=g._83o=c?{shape:c,_53o:g.getBodyColor("shape.background"),_27Q:Tm(u("shape.repeat.image"),T),shapeGradientPack:u("shape.gradient.pack"),_54o:u("shape.border.width"),_55o:u("shape.border.color"),_56o:u("shape.border.3d"),_57o:u("shape.border.3d.color"),_58o:u("shape.border.3d.accuracy"),shapeGradient:u("shape.gradient"),_59o:u("shape.gradient.color"),_60o:u("shape.border.pattern"),_61o:u("shape.border.cap"),_62o:u("shape.border.join"),bodyColor:T}:{img:Tm(g.gv.getImage(a),T),bodyColor:T,stretch:u("image.stretch")};if(W&&!d);else{A.rect=a.getRect(),A.position=a.p(),A.scale=a.getScale(),A.anchor=a.getAnchor(),A.rotation=a.getRotation(),c===li&&(A._63o=u("shape.depth"));var V=0;if(c)V=Hd(p,A._54o/2,A._62o),g.s("shape.dash")&&(V=Q(V,(g.s("shape.dash.width")||A._54o)/2));else if(A.img&&A.img.boundExtend)if(V=$n(A.img.boundExtend,a,g.gv),A.img.boundExtendAbsolute){var O=a.getScale();V/=g.gv._zoom*Q(1,Q(B(O.x),B(O.y)))}else if(!$n(A.img.fitSize,a,g.gv)){var z=$n(A.img.width,a,g.gv),J=$n(A.img.height,a,g.gv);V*=Q(a.getWidth()/z,a.getHeight()/J)}g._40O(A,V);var y=u("clip.percentage");if(1>y&&(0>y&&(y=0),A.clipRect=ph(a.getAnchorRect(),u("clip.direction"),y)),c){var D=u("shape.fill.clip.percentage");1>D&&(0>D&&(D=0),A.shapeClipRect=ph(a.getAnchorRect(),u("shape.fill.clip.direction"),D))}}},getPosition:function(Q,u,q,i){var G=ad(Q,this._83o.rect,i);return G.x+=u,G.y+=q,G},_80o:function(g){var c=this,J=c.s,F=c.gv,T=c._data,P=c._83o,r=P.rect,U=P.position,v=P.rotation,$=P.anchor,Y=P.scale,A=P.shape,R=P.clipRect;if(!c._checkEmptyRect||r.width>0&&r.height>0){var s=T.getSize();if(s.x=-s.width*$.x,s.y=-s.height*$.y,g.save(),Up(g,U.x,U.y),nd(g,v),tb(g,Y.x,Y.y),R&&(g.beginPath(),g.rect(R.x,R.y,R.width,R.height),g.clip()),c.freeDraw)c.freeDraw(g,s,P);else if(A){var n,H,G,X,C=P._60o,e=Yk(g,C),B=P._53o,Q=P._27Q,L=P._54o,K=P._55o,I=P.shapeGradientPack,i=g.lineJoin,b=g.lineCap;if("roundRect"===A?n=J("shape.corner.radius"):"polygon"===A?n=J("shape.polygon.side"):"arc"===A&&(n=J("shape.arc.from"),H=J("shape.arc.to"),G=J("shape.arc.close"),X=J("shape.arc.oval")),g.lineJoin=P._62o,g.lineCap=P._61o,B||Q||I){var d=P.shapeClipRect;d&&(g.save(),g.beginPath(),g.rect(d.x,d.y,d.width,d.height),g.clip()),Bi(g,A,s,n,H,G,X),I?Wl(g,I):Q?Go(g,Q,P.bodyColor,null,T,F):aq(g,B,P.shapeGradient,P._59o,s),g.fill(),d&&g.restore(),I&&g.restore(),g!==e&&Bi(e,A,s,n,H,G,X)}else Bi(e,A,s,n,H,G,X);if(L>0){var y=J("shape.border.width.absolute");y&&(g.save(),g.setTransform(1,0,0,1,0,0)),g.lineWidth=L,g.strokeStyle=K,g.stroke(),y&&g.restore(),P._56o&&qk(g,K,P._57o,L,F._zoom,P._58o)}if(Pp(g,C),J("shape.dash")){var _=J("shape.dash.width")||L;if(_>0){C=J("shape.dash.pattern");var e=Yk(g,C,c._2Q("shape.dash.offset"));e!==g&&Bi(e,A,s,n,H,G,X),c._1Q(g,"shape",_,C)}}yl(g,B,P._63o,s),g.lineJoin=i,g.lineCap=b}else{var a=c.interactiveInfo;a&&(g.interactiveInfo=a.bodyInfo={compInfos:[],stacks:[{t:[U.x,U.y]},{r:v},{s:[Y.x,Y.y]}]}),Xl(g,P.img,P.stretch,s.x,s.y,s.width,s.height,T,F,P.bodyColor),g.interactiveInfo=p}g.restore()}c._39O(g,P)},_48O:function(){},_47O:function(){}});var xi=function(W,g){td(xi,this,[W,g])},Wd=function(i,m,$,r){var g=ti(i,m);return $=r?j($,g):Mk($,g),g?$/=g:$=0,{x:i.x+(m.x-i.x)*$,y:i.y+(m.y-i.y)*$}};bd(xi,ob,{_3O:function(){var S,g=this,$=g._data,M=g.gv,F=g.s,I=F(Bq),e=$.isLooped(),c=F("edge.width"),Y=F("edge.center"),q=F("edge.offset"),u=M.getBorderColor($),O=u?F("border.width"):0,h=g.getSelectWidth(),v=$._40I,d=$._41I,C=g._78o=v&&d?{looped:e,type:I,width:c,center:Y,color:g.getBodyColor("edge.color"),borderColor:u,borderWidth:O,_97o:h?F("select.color"):p,selectWidth:h,pattern:F("edge.pattern"),cap:F("edge.cap"),join:F("edge.join"),is3d:F("edge.3d"),_67o:F("edge.3d.color"),_66o:F("edge.3d.accuracy")}:p;if(C){var P=U.getEdgeType(I);if(P){var k=P($,kh(g,M,$,e,I),M,g._19Q);k.points&&k.points.size()>1?(C._4O=k,S=Ui(C._4O.points)):k[Lg]&&k.rect&&(C._4O=k,S=k.rect)}else{var f=F("edge.source.anchor.x"),b=F("edge.source.anchor.y"),G=F("edge.target.anchor.x"),o=F("edge.target.anchor.y"),J=Tj(M,v,F("edge.source.position"),F("edge.source.offset.x"),F("edge.source.offset.y"),f,b),n=Tj(M,d,F("edge.target.position"),F("edge.target.offset.x"),F("edge.target.offset.y"),G,o);if(I===oi){var N=C.points=F(ds)||Jg,s=N.size();C.segments=F("edge.segments");var t=f!==R||b!==R,X=G!==R||o!==R;if(!Y)if(q)t||(J=Wd(J,s?N.get(0):n,q,s)),X||(n=Wd(n,s?N.get(s-1):J,q,s));else{var j;t||(j=sp(J,s?N.get(0):n,sb(M,v)),j&&(J={x:j[0],y:j[1]})),X||(j=sp(s?N.get(s-1):J,n,sb(M,d)),j&&(n={x:j[0],y:j[1]}))}S=Ij(Ui(C.points),Ui(J,n))}else{var H=kh(g,M,$,e,I);if(g._19Q||(H=-H),e)J=ik(J),J.x=M.getNodeRect(v).x,C.radius=H,S={x:J.x-H,y:J.y-H,width:2*H,height:2*H};else{var L=ti(J,n),x=Mk(q,L),l={x:x,y:H},_={x:L-x,y:H},y=z(n.y-J.y,n.x-J.x),Z=C.mat=new qj(y);if(C.orienAngle=y,C.angle=n.x<J.x?y+V:y,C.rect={x:l.x,y:l.y,width:_.x-l.x,height:0},C.origin=J,l=Z.tf(l),l.x+=J.x,l.y+=J.y,_=Z.tf(_),_.x+=J.x,_.y+=J.y,Y){var B={x:L,y:0};B=Z.tf(B),B.x+=J.x,B.y+=J.y,S=Ui([J,l,_,B]),C.c1=J,C.c2=B}else S=Ui(l,_);J=l,n=_}}C.sourcePoint=J,C.targetPoint=n,$._lastSourcePoint=J,$._lastTargetPoint=n}var K=0;F("edge.dash")&&(K=F("edge.dash.width")||c);var i="square"===C.cap?.71:.5;Hd(S,Q(K*i,c*i+O+h),C.join),g._68o(S)}},getRotation:function(N,b,o){N=N||0;var v=this._78o;if(v){var W,t=v.angle,l=v.points,x=v._4O;if(t!=p)return b?v.orienAngle+N:t+N;if(x&&x[Lg])return x.getRotation?x.getRotation(this,N,b,o):0;if(x&&x.points){var n=x.points;return W=n.size(),If[o]?W&&0===W%2?Ni(n.get(W/2-1),n.get(W/2),b,N):N:Qh[o]?Ni(n.get(0),n.get(1),b,N):Ni(n.get(W-2),n.get(W-1),b,N)}if(l)return W=l.size(),If[o]?W&&0===W%2?Ni(l.get(W/2-1),l.get(W/2),b,N):N:Qh[o]?Ni(v.sourcePoint,W?l.get(0):v.targetPoint,b,N):Ni(W?l.get(W-1):v.sourcePoint,v.targetPoint,b,N)}return N},getPosition:function(P,M,y,x,m){var r=this._78o;if(r){var X,e=r.type,A=r.points,_=r._4O,E=r.sourcePoint,j=r.targetPoint;
if(!e)return r.looped?{x:E.x-r.radius+M,y:E.y+y}:(m&&E&&j&&(E.x>j.x||E.x===j.x&&E.y>j.y)&&(P=gb[P],y=-y),X=ad(P,r.rect,x),X.x+=M,X.y+=y,X=r.mat.tf(X),X.x+=r.origin.x,X.y+=r.origin.y,X);if(_&&_[Lg])return _.getPosition?_.getPosition(this,P,M,y,x,m):{x:(E.x+j.x)/2,y:(E.y+j.y)/2};if(A){var X,O=A.size();if(If[P]){if(O){var q=O%2;if(0===q)return uc(A.get(O/2-1),A.get(O/2),P,M,y,x,m);X=A.get((O-q)/2)}else X={x:(E.x+j.x)/2,y:(E.y+j.y)/2};return X=ad(P,{x:X.x,y:X.y,width:0,height:0},x),X.x+=M,X.y+=y,X}return Qh[P]?uc(E,O?A.get(0):j,P,M,y,x,m):uc(O?A.get(O-1):E,j,P,M,y,x,m)}if(_){var U=_.points,O=U.size();if(If[P]){var q=O%2;return 0===q?uc(U.get(O/2-1),U.get(O/2),P,M,y,x,m):(X=U.get((O-q)/2),X=ad(P,{x:X.x,y:X.y,width:0,height:0},x),X.x+=M,X.y+=y,X)}return Qh[P]?uc(U.get(0),U.get(1),P,M,y,x,m):uc(U.get(O-2),U.get(O-1),P,M,y,x,m)}}return Am},_42:function(D){this._78o&&xi.superClass._42.call(this,D)},drawPath:function(V,p){V.beginPath();var j=p.type,Y=p.points,b=p.segments,w=p._4O;if(!j||Y){var C=p.sourcePoint,P=C.x,d=C.y,o=p.targetPoint,y=o.x,I=o.y;if(j)if(b){var Z=new uh({x:P,y:d});Z.addAll(Y),Z.add({x:y,y:I}),Sc(V,Z,b)}else V.moveTo(P,d),Y.each(function(R){V.lineTo(R.x,R.y)}),V.lineTo(y,I);else p.looped?V.arc(P,d,p.radius,0,x,!0):p.center?(V.moveTo(p.c1.x,p.c1.y),V.lineTo(P,d),V.lineTo(y,I),V.lineTo(p.c2.x,p.c2.y)):(V.moveTo(P,d),V.lineTo(y,I))}else w&&(w.points?Sc(V,w.points,w.segments):w[Lg]&&w[Lg](V,w))},_80o:function(b){var I=this,x=I.s,H=I._78o,s=H.width,y=H.selectWidth,N=H.borderWidth,O=H.color,m=b.lineJoin,Q=b.lineCap,t=H.pattern;b.lineJoin=H.join,b.lineCap=H.cap,I.drawPath(Yk(b,t),H);var f=x("edge.width.absolute");if(f&&(b.save(),b.setTransform(1,0,0,1,0,0)),y&&(b.strokeStyle=H._97o,b.lineWidth=s+2*(N+y),b.stroke()),N&&(b.strokeStyle=H.borderColor,b.lineWidth=s+2*N,b.stroke()),b.strokeStyle=O,b.lineWidth=s,b.stroke(),H.is3d&&qk(b,O,H._67o,s,I.gv._zoom,H._66o),f&&b.restore(),Pp(b,t),x("edge.dash")){t=x("edge.dash.pattern");var p=Yk(b,t,I._2Q("edge.dash.offset"));p!==b&&I.drawPath(p,H),I._1Q(b,"edge",x("edge.dash.width")||s,t)}b.lineJoin=m,b.lineCap=Q},_48O:function(){},_47O:function(){},_71o:function(d,I){var y=this,h=y._data;if(y._19Q=!0,!h.getEdgeGroup())return d?h.s("edge.gap"):0;var r,O=0,l=0,g=0;if(h.getEdgeGroup().getSiblings().each(function(P){P.each(function(S){if(y.gv.isVisible(S)&&S.s(Bq)==I){var L=S.s("edge.gap");r?(l+=g/2+L/2,g=L):(r=S,g=L),S===h&&(O=l)}})}),d)return l-O+g;var V=O-l/2;return r&&h._40I!==r._40I&&(y._19Q=!1),V}});var kl=function(R,L){td(kl,this,[R,L])};bd(kl,Gq,{_3O:function(){var Y,i,O=this,t=O.s,a=O._data,o=O.gv;if(O._88I=p,a.isExpanded()&&a.eachChild(function(d){var U=o.getBoundsForGroup(d);U&&(i||(i=[]),i.push(U),Y=Ij(Y,U))}),Y){var J=o.getLabel(a),m=t("group.type");Y=od(m,i,Y),fm(Y,a,"group.padding",1);var D=O._88I={type:m,rect:Y,_64o:Y};if(!m&&J!=p){var P,I=O.labelInfo={label:J,color:t("group.title.color"),font:t("group.title.font"),align:t("group.title.align")},w=bk(I,J),s=w.width,Q=w.height,V=t("group.title.align");s>Y.width&&(Y.width=s),I.rect={y:Y.y-Q,width:w.width,height:Q},P=V===Aj?Y.x:V===ig?Y.x+Y.width-s:Y.x+Y.width/2-s/2,I.rect.x=P,D.titleRect={x:Y.x,y:Y.y-Q,width:Y.width,height:Q+1},D.rect={x:Y.x,y:Y.y-Q,width:Y.width,height:Y.height+Q}}O._40O(D,t("group.border.width")/2)}else kl.superClass._3O.call(O)},getPosition:function(J,q,k,t){var O=this._88I;if(O){var S=ad(J,O.rect,t);return S.x+=q,S.y+=k,S}return kl.superClass.getPosition.apply(this,arguments)},_24O:function(T,t){var k=this._88I;(!k||k.type||"label2"===T)&&kl.superClass._24O.call(this,T,t)},_80o:function(d){var r=this,c=r._88I;if(c){var q=r._data,e=r.s,H=r.gv,D=c.type,z=c.rect,A=c._64o,j=c.titleRect,Z=r.getBodyColor(),b=Tm(e("group.image"),Z),Y=e("group.image.stretch"),g=r.getBodyColor("group.background"),v=Tm(e("group.repeat.image"),Z),x=e("group.gradient.pack"),U=e("group.gradient"),$=e("group.gradient.color"),L=e("group.depth");if(D){var M=e("group.border.pattern"),Q=e("group.border.width"),u=d.lineJoin,t=d.lineCap;if(d.lineJoin=e("group.border.join"),d.lineCap=e("group.border.cap"),b){if(d.save(),Bi(d,D,z),d.clip(),Xl(d,b,Y,z.x,z.y,z.width,z.height,q,H,Z),d.restore(),Q>0){var W=Yk(d,M);Bi(W,D,z),d.lineWidth=Q,d.strokeStyle=e("group.border.color"),d.stroke(),Pp(d,M)}}else{var W=Yk(d,M);g||v||x?(Bi(d,D,z),x?Wl(d,x):v?Go(d,v,Z,null,q,H):aq(d,g,U,$,z),d.fill(),x&&d.restore(),d!==W&&Bi(W,D,z)):Bi(W,D,z),Q>0&&(d.lineWidth=Q,d.strokeStyle=e("group.border.color"),d.stroke()),Pp(d,M),D===li&&yl(d,g,L,z)}d.lineJoin=u,d.lineCap=t}else if(b?Xl(d,b,Y,A.x,A.y,A.width,A.height,q,H,r.getBodyColor()):(g||v)&&(v?Go(d,v,Z,null,q,H):aq(d,g,U,$,A),Bi(d,li,A),d.fill(),yl(d,g,L,A)),j){var p=e("group.title.background");le(d,j.x,j.y,j.width,j.height,p),yl(d,p,L,j)}r._39O(d,c)}else kl.superClass._80o.call(r,d)}});var dq=function(O,H){td(dq,this,[O,H])};bd(dq,Gq,{_80o:function(B){this._39O(B,this._83o)}});var Dk=function(X,K){td(Dk,this,[X,K])};bd(Dk,Gq,{_3O:function(){var a=this,o=a._data,V=a.s,q=a.gv,m=o.getPoints(),z=q.getBorderColor(o),U=z?V("border.width"):0,A=a.getSelectWidth(),H=V("shape.border.width"),y=o.getRect(),X=q.getBodyColor(o),d=a._99o=m.isEmpty()?p:{rect:y,rotation:o.getRotation(),fillRule:V("shape.fill.rule"),scale:o.getScale(),position:o.p(),points:m,segments:o.getSegments(),bodyColor:X,borderColor:z,borderWidth:U,_94o:V("shape.border.3d"),_95o:V("shape.border.3d.color"),_96o:V("shape.border.3d.accuracy"),_97o:A?V("select.color"):p,selectWidth:A,_53o:V("shape.background"),_27Q:Tm(V("shape.repeat.image"),X),shapeGradientPack:V("shape.gradient.pack"),_54o:H,_55o:V("shape.border.color"),shapeGradient:V("shape.gradient"),_59o:V("shape.gradient.color"),_60o:V("shape.border.pattern"),_61o:V("shape.border.cap"),_62o:V("shape.border.join")};if(d){var e=o.getScale(),l=Q(1,Q(B(e.x),B(e.y)));V("shape.dash")&&V("shape.dash.width")>H&&(H=V("shape.dash.width"));var P=H*("square"===d._61o?.71:.5)+U+A/a.gv._zoom/l;P&&(P*=l,y=ik(y),Hd(y,P,d._62o)),a._68o(y);var O=V("clip.percentage");1>O&&(0>O&&(O=0),d.clipRect=ph(o.getAnchorRect(),V("clip.direction"),O));var T=V("shape.fill.clip.percentage");1>T&&(0>T&&(T=0),d.shapeClipRect=ph(o.getAnchorRect(),V("shape.fill.clip.direction"),T))}},getPosition:function(O,g,B,G){var X=this._99o;if(X){var C=ad(O,X.rect,G);return C.x+=g,C.y+=B,C}return Am},_42:function(h){this._99o&&Dk.superClass._42.call(this,h)},_80o:function(W){var v,L=this,p=L.s,b=L._99o,P=b.position,O=b.scale,U=b.rotation,e=b.bodyColor,H=b.borderWidth,j=b.selectWidth,C=b._53o,d=b._27Q,X=b.shapeGradientPack,y=b._54o,u=b.clipRect,g=b.shapeClipRect,J=b.points,c=b.segments,M=L._data.isClosePath(),F=b.fillRule,B=C||d||X;W.save(),Up(W,P.x,P.y),nd(W,U),tb(W,O.x,O.y),u&&(W.beginPath(),W.rect(u.x,u.y,u.width,u.height),W.clip()),B&&g&&(W.save(),W.beginPath(),W.rect(g.x,g.y,g.width,g.height),W.clip()),Up(W,-P.x,-P.y);var a=b._60o,s=Yk(W,a),o=W.lineJoin,n=W.lineCap;W.lineJoin=b._62o,W.lineCap=b._61o,B?(Sc(W,J,c,M),X?Wl(W,X):d?Go(W,d,e,null,L._data,L.gv):(v=e?e:C,aq(W,v,b.shapeGradient,b._59o,b.rect)),W.fill(F),g&&(W.restore(),Up(W,-P.x,-P.y)),X&&W.restore(),s!==W&&Sc(s,J,c,M)):Sc(s,J,c,M);var k=p("shape.border.width.absolute");if(k&&(W.save(),W.setTransform(1,0,0,1,0,0)),j&&(W.strokeStyle=b._97o,W.lineWidth=y+2*(H+j),W.stroke()),H&&(W.strokeStyle=b.borderColor,W.lineWidth=y+2*H,W.stroke()),y&&(v=b._55o,!C&&e&&(v=e),W.strokeStyle=v,W.lineWidth=y,W.stroke(),b._94o&&qk(W,v,b._95o,y,L.gv._zoom,b._96o)),k&&W.restore(),Pp(W,a),p("shape.dash")){var l=p("shape.dash.width")||y;if(l>0){a=p("shape.dash.pattern");var s=Yk(W,a,L._2Q("shape.dash.offset"));s!==W&&Sc(s,J,c,M),L._1Q(W,"shape",l,a)}}W.lineJoin=o,W.lineCap=n,W.restore()},_48O:function(){},_47O:function(){}});var oj=function(N,t){td(oj,this,[N,t])};bd(oj,Dk,{getRotation:function(V,d,M){V=V||0;var m=this._data.getPoints(),I=m.size();return I>1?If[M]?I&&0===I%2?Ni(m.get(I/2-1),m.get(I/2),d,V):V:Qh[M]?Ni(m.get(0),m.get(1),d,V):Ni(m.get(I-2),m.get(I-1),d,V):V},getPosition:function(H,M,B,X,i){var s=this._data.getPoints(),t=s.size();if(t>1){if(If[H]){var K=t%2;if(0===K)return uc(s.get(t/2-1),s.get(t/2),H,M,B,X,i);var d=s.get((t-K)/2),x={x:d.x,y:d.y,width:0,height:0};return d=ad(H,x,X),d.x+=M,d.y+=B,d}return Qh[H]?uc(s.get(0),s.get(1),H,M,B,X,i):uc(s.get(t-2),s.get(t-1),H,M,B,X,i)}return Am}});var ec=function(C,n){td(ec,this,[C,n])};bd(ec,Gq,{_3O:function(){var Z=this;ec.superClass._3O.call(Z);var M=Z.s,A=Z._83o;Z._82o=A.img||A.shape?p:{background:Z.getBodyColor("grid.background"),depth:M("grid.depth"),rect:A.rect,_88o:M("grid.cell.depth"),cellBorderColor:M("grid.cell.border.color"),_89o:M("grid.row.count"),_90o:M("grid.column.count"),block:M("grid.block"),_91o:M("grid.block.color"),_92o:M("grid.block.padding"),_93o:M("grid.block.width")}},_80o:function(L){var W=this,B=W._82o;if(!B)return ec.superClass._80o.call(W,L),void 0;var q,E,t=W._data,A=B.background,N=B.rect,$=B.block,f=B._91o,U=B._92o,O=B._93o,l=B._88o,Y=B.cellBorderColor,P=B._89o,e=B._90o;if(A)if(le(L,N.x,N.y,N.width,N.height,A),yl(L,A,B.depth,N),l)for(q=0;P>q;q++)for(E=0;e>E;E++)N=t.getCellRect(q,E),N&&yl(L,A,l,N);else if(Y){for(L.beginPath(),q=0;P>q;q++)for(E=0;e>E;E++)N=t.getCellRect(q,E),N&&L.rect(N.x,N.y,N.width,N.height);L.strokeStyle=Y,L.lineWidth=1,L.stroke()}if("h"===$)for(q=0;P>q;q++)N=Ij(t.getCellRect(q,0),t.getCellRect(q,e-1)),Lf(N,U),gg(L,f,N.x,N.y,N.width,N.height,O);else if("v"===$)for(E=0;e>E;E++)N=Ij(t.getCellRect(0,E),t.getCellRect(P-1,E)),Lf(N,U),gg(L,f,N.x,N.y,N.width,N.height,O);W._39O(L,W._83o)}});var Li=function(I,Z){td(Li,this,[I,Z])};bd(Li,Gq,{_checkEmptyRect:!1,_81o:function(){var V=this._data,x=Li.superClass._81o.call(this),z=V.s("text");if(z!=p){var P,W,b=V.s("text.font"),j=V.s("text.align"),i=V.s("text.vAlign"),U=sk(b,z),F=U.width,S=U.height,m=V.getAnchor(),n=V.getWidth(),Q=V.getHeight();"left"===j?P=-n*m.x:"center"===j?P=-n*m.x+(n-F)/2:"right"===j&&(P=n*(1-m.x)-U.width),"top"===i?W=-Q*m.y:"middle"===i?W=-Q*m.y+(Q-S)/2:"bottom"===i&&(W=Q*(1-m.y)-U.height);var E,w=V.getMatrix();if(E=Ui([w.tf(P,W),w.tf(P+F,W),w.tf(P+F,W+S),w.tf(P,W+S)]),x=Ij(x,E),x&&V.s("text.shadow")){var H=ik(x);H.x+=V.s("text.shadow.offset.x"),H.y+=V.s("text.shadow.offset.y"),Lf(H,V.s("text.shadow.blur")),x=Ij(x,H)}}return x}});var xd=ur.Interactor=function(B){this.gv=this._graphView=B};$e("Interactor",h,{ms_listener:1,getView:function(){return this.gv.getView()},setUp:function(){this.addListeners()},tearDown:function(){this.removeListeners(),this.clear()},clear:function(){},fi:function(T){this.gv.fi(T)},setCursor:function(M){_||this.gv.setCursor(M)},startDragging:function(H){var e=this;e._lastClientPoint=kq(H),e._lastLogicalPoint=e.gv.lp(H),Kc(e,H)},clearDragging:function(){var I=this;I._lastClientPoint=I._lastLogicalPoint=I._logicalPoint=p},autoScroll:function(l){return this.gv.autoScroll(l,this._lastClientPoint)}});var Ob=function(G){var R=this;R.gv=G,R.filter=function(L){return G.isSelectable(L)&&G.isInteractive(L)},G.getView(),["mousedown","mousemove","mouseup","touchstart","touchmove","touchend"].forEach(function(V){R.addListener(V)}),C.addEventListener(Ke,function(q){xm(q)&&R.handleWindowMove(q)},!1),C.addEventListener(Lj,function(N){xm(N)&&R.handleWindowUp(N)},!1),C.addEventListener(Zm,function(o){xm(o)&&R.handleWindowMove(o)},!1),C.addEventListener(Wc,function(y){xm(y)&&R.handleWindowUp(y)},!1)};bd(Ob,xd,{addListener:function(q){var S=this;S.gv.getView().addEventListener(q,function(h){U.preventDefault(h),xm(h)&&!S.disabled&&S["handle_"+q](h)},!1)},handle:function(j,R,Z){var y=this.gv;if(Z=Z||y.getDataInfoAt(R,this.filter)){var E=Z.ui.interactiveInfo;if(E){var i,p=Z.data;if(p.s(j)&&p.s(j)(R,p,y),"body"===Z.part&&E.bodyInfo)i="body",Z.hits=this.handleImage(i,y.getImage(p),j,R,p,Z.point,E.bodyInfo);else if("icons"===Z.part&&E._38o){var U=E._38o[Z.name];U&&U[Z.index]&&(i="icons|"+Z.name+"|"+Z.index,Z.hits=this.handleImage(i,Z.icon,j,R,p,Z.point,U[Z.index]))}}return Z}},handleImage:function(G,m,P,n,O,R,f){var L={};if(m&&(m=Tm(m))){var r=this.gv,v=f.rect,Y=this.convertPoint(R,f);Y.inRect&&(m[P]&&m[P](n,O,r,Y,v.width,v.height),L[G+"|image"]={target:m,point:Y,width:v.width,height:v.height});for(var A=f.compInfos,w=A.length-1;w>=0;w--){var p=A[w],N=p.comp;Y=this.convertPoint(R,p),Y.inRect&&(v=p.rect,N[P]&&N[P](n,O,r,Y,v.width,v.height),(m=v.image)&&m[P]&&m[P](n,O,r,Y,v.width,v.height),L[G+"|"+w]={target:N,point:Y,width:v.width,height:v.height},m&&(L[G+"|"+w+"|image"]={target:m,point:Y,width:v.width,height:v.height}))}}return L},handle_mousedown:function(q){this.handleWindowUp(q),this.downInfo=this.handle("onDown",q)},handle_mousemove:function(_){var s=this,g=s.gv;s._hoverTimer&&(J(s._hoverTimer),delete s._hoverTimer);var w,P,X,Q=s.handle("onMove",_),i=this.currentInfo?this.currentInfo.data:p,E=this.currentInfo?this.currentInfo.hits:p;if(Q&&(P=Q.data,X=Q.hits,s._hoverTimer=A(function(){J(s._hoverTimer),delete s._hoverTimer,s.handle("onHover",_,Q)},g.getHoverDelay()||U.hoverDelay)),P!==i){if(P&&P.s("onEnter")&&P.s("onEnter")(_,P,g),i&&i.s("onLeave")&&i.s("onLeave")(_,i,g),E)for(w in E)E[w].target.onLeave&&this.handleLeave(_,w);if(X)for(w in X)X[w].target.onEnter&&X[w].target.onEnter(_,P,g,X[w].point,X[w].width,X[w].height)}else{if(E)for(w in E)X&&X[w]||E[w].target.onLeave&&this.handleLeave(_,w);if(X)for(w in X)E&&E[w]||X[w].target.onEnter&&X[w].target.onEnter(_,P,g,X[w].point,X[w].width,X[w].height)}this.currentInfo=Q},handleLeave:function(u,M){if(this.currentInfo){var E=this.currentInfo,k=E.ui.interactiveInfo;if(k){var K,V=this.gv.lp(u),b=E.data;if("body"===E.part&&k.bodyInfo)K="body",this.handleLeaveImage(M,K,this.gv.getImage(b),u,b,V,k.bodyInfo);else if("icons"===E.part&&k._38o){var R=k._38o[E.name];R&&R[E.index]&&(K="icons|"+E.name+"|"+E.index,this.handleLeaveImage(M,K,E.icon,u,b,V,R[E.index]))}}}},handleLeaveImage:function(r,d,v,j,p,B,o){if(v&&(v=Tm(v))){var q=this.gv,V=o.rect,l=this.convertPoint(B,o);r===d+"|image"&&v.onLeave&&v.onLeave(j,p,q,l,V.width,V.height);for(var C=o.compInfos,S=C.length-1;S>=0;S--){var U=C[S],K=U.comp;l=this.convertPoint(B,U),V=U.rect,K.onLeave&&r===d+"|"+S&&K.onLeave(j,p,q,l,V.width,V.height),(v=V.image)&&v.onLeave&&r===d+"|"+S+"|image"&&v.onLeave(j,p,q,l,V.width,V.height)}}},handle_mouseup:function(G){this.handle("onUp",G)},handle_touchstart:function(q){this.handle_mousedown(q)},handle_touchmove:function(X){this.handle("onMove",X)},handle_touchend:function(x){this.handle_mouseup(x)},handleWindowMove:function(B){this.downInfo&&(this.isDragging?this.handleDrag("onDrag",B):(this.handleDrag("onBeginDrag",B),this.isDragging=!0))},handleWindowUp:function(w){this.isDragging&&(this.handleDrag("onEndDrag",w),this.isDragging=!1),this.downInfo=p},handleDrag:function(M,z){if(this.downInfo){var b=this.downInfo,X=b.ui.interactiveInfo;if(X){var g,t=this.gv.lp(z),i=b.data;if(i.s(M)&&i.s(M)(z,i,this.gv),"body"===b.part&&X.bodyInfo)g="body",this.handleDragImage(g,this.gv.getImage(i),M,z,i,t,X.bodyInfo);else if("icons"===b.part&&X._38o){var h=X._38o[b.name];h&&h[b.index]&&(g="icons|"+b.name+"|"+b.index,this.handleDragImage(g,b.icon,M,z,i,t,h[b.index]))}}}},handleDragImage:function(O,z,K,W,q,r,I){var A=this.downInfo.hits;if(A&&z&&(z=Tm(z))){var N=this.gv,o=I.rect,C=this.convertPoint(r,I);A[O+"|image"]&&z[K]&&z[K](W,q,N,C,o.width,o.height);for(var a=I.compInfos,P=a.length-1;P>=0;P--){var i=a[P],R=i.comp;C=this.convertPoint(r,i),o=i.rect,R[K]&&A[O+"|"+P]&&R[K](W,q,N,C,o.width,o.height),(z=o.image)&&z[K]&&A[O+"|"+P+"|image"]&&z[K](W,q,N,C,o.width,o.height)}}},convertPoint:function(N,D){var x=N.x,O=N.y;D.stacks.forEach(function(w){if(w.t)x-=w.t[0],O-=w.t[1];else if(w.s)x/=w.s[0],O/=w.s[1];else if(w.r){var K=S(-w.r),j=X(-w.r),T=j*x-K*O,_=K*x+j*O;x=T,O=_}});var _=D.rect;return N={x:x-_.x,y:O-_.y},N.inRect=N.x>=0&&N.y>=0&&N.x<=_.width&&N.y<=_.height,N}});var Ff=ur.DefaultInteractor=function(w){td(Ff,this,[w])};$e("DefaultInteractor",xd,{handle_mousedown:function(J){gj(J);var o=this,d=o.gv,w=d.getDataAt(J);!d.setFocus(J)||d._editing||d._scrolling||(dl(J)?d.handleDoubleClick(J,w):d.handleClick(J,w),!Le()&&w||!d.isPannable()||!xm(J)||ok(J)||(o._tx=d.tx(),o._ty=d.ty(),o.startDragging(J)))},handleWindowMouseUp:function(N){var Z=this,o=Z.gv;o._panning&&(delete o._panning,o.onPanEnded(),Z.fi({kind:"endPan",event:N})),delete Z._tx,delete Z._ty,Z.clearDragging()},handle_mousemove:function(z){var L=this,c=L.gv;L._hoverTimer&&(J(L._hoverTimer),delete L._hoverTimer),L._hoverTimer=A(function(){L.fi({kind:"hover",event:z}),J(L._hoverTimer),delete L._hoverTimer},c.getHoverDelay()||U.hoverDelay)},handle_touchmove:function(u){this.handle_mousemove(u)},handleWindowMouseMove:function(Q){var q=this,D=q.gv,X=q._lastClientPoint;q.fi({kind:D._panning?"betweenPan":"beginPan",event:Q}),D._panning=1,D.setTranslate(q._tx+Q.clientX-X.x,q._ty+Q.clientY-X.y)},handle_mousewheel:function(P){this.gv.handleScroll(P,P.wheelDelta)},handle_DOMMouseScroll:function(O){2===O.axis&&this.gv.handleScroll(O,-O.detail)},handle_keydown:function(M){this.gv.handleKeyDown(M)}});var ed=ur.SelectInteractor=function(X){td(ed,this,[X])};$e("SelectInteractor",xd,{_42:function(){var S=this,a=S.gv,f=a.getZoom(),Y=S.mark,N=S.div;N||(N=S.div=yb(),rj(S.getView(),N));var r={};r.x=Y.x*f+a.tx(),r.y=Y.y*f+a.ty(),r.width=Y.width*f,r.height=Y.height*f,Eb(N,r),this.intersects()?(N.style.border="",N.style.background=a.getRectSelectBackground()):(N.style.background="",N.style.border="1px solid "+a.getRectSelectBorderColor())},handle_mousedown:function(D){var e=this,a=e.gv;if(e._57I=p,!(a._editing||a._scrolling||Le())){var C=a.getDataAt(D),P=a.sm();if(C)if(ok(D))P.co(C)?P.rs(C):P.as(C);else if(P.co(C)){if(dl(D)&&C instanceof Zl&&C.isClickThroughEnabled()){var g=a.getDataAt(D,function(y){a._clickThroughChecking=!0;var g=y.getParent()===C&&a.isSelectable(y);return delete a._clickThroughChecking,g});g&&(D.clickThrough=!0,P.ss(g))}}else P.ss(C);else ok(D)||!a.isPannable()?xm(D)&&(ok(D)||P.cs(),a.isRectSelectable()&&(e.startDragging(D),a._77O=1)):xm(D)&&(e._57I=kq(D))}},handle_mouseup:function(n){var M=this,T=M._57I;T&&(ti(T,kq(n))<=1&&M.gv.sm().cs(),M._57I=p)},handleWindowMouseUp:function(z){this.clear(z)},handleWindowMouseMove:function(x){var R=this,v=R.gv;R._logicalPoint=v.lp(x),R.mark?(R.fi({kind:"betweenRectSelect",event:x}),v.isPannable()&&R.autoScroll(x),R.redraw()):R.fi({kind:"beginRectSelect",event:x}),R.mark=Ui(R._lastLogicalPoint,R._logicalPoint),R.redraw()},intersects:function(){var P=this,q=P._lastLogicalPoint,n=P._logicalPoint;return q.x>n.x||q.y>n.y},clear:function(Q){var K=this,R=K.gv,A=K.mark;if(K._57I=p,K._lastLogicalPoint){if(A){if(0!==A.width&&0!==A.height){var V=R.getDatasInRect(A,K.intersects());if(!V.isEmpty()){var z=R.sm(),a=z.toSelection();V.each(function(c){z.co(c)?a.remove(c):a.add(c)}),z.ss(a)}}_k(K.div),delete K.div,delete K.mark,K.redraw(),K.fi({kind:"endRectSelect",event:Q}),R.onRectSelectEnded()}K.clearDragging(),delete R._77O}},redraw:function(){var g=this;g._draw||(g._draw=1,A(function(){g.mark&&g._42(),delete g._draw},16))}});var Qf=ur.MoveInteractor=function(D){td(Qf,this,[D])};$e("MoveInteractor",xd,{handle_mousedown:function(S){var u=this,n=u.gv;if(xm(S)&&!n._editing&&!n._scrolling&&!Le()){var t=n.getSelectedDataAt(S);t?(u._data=t,n.handleMouseDown&&n.handleMouseDown(S,t),u.startDragging(S),n.isMovable(t)&&(n._moving=1)):n._focusData=p}},handleWindowMouseUp:function(y){var i=this,b=i.gv;b.handleMouseUp&&b.handleMouseUp(y,i._data),i.clear(y)},handleWindowMouseMove:function(y){var j=this,R=j._data,c=j.gv;if((!c._93O||!c._93O(y,R))&&c._moving){j._logicalPoint||j.fi({kind:"prepareMove",event:y});var h=j._logicalPoint?"betweenMove":"beginMove",m={kind:h,event:y},A=j._logicalPoint=c.lp(y);"beginMove"!==h||j._alreadyBeginTransaction||(j._alreadyBeginTransaction=!0,c.getDataModel().beginTransaction());var e=j._calcShift(h,y),Q=e.x,L=e.y,S=j.gv.getMoveMode(y,R);S&&("x"===S?L=0:"y"===S?Q=0:"xy"!==S&&(Q=L=0)),c.moveSelection(Q,L),j._lastLogicalPoint=A,j.autoScroll(y),j.fi(m)}},_calcShift:function(){var y=this,H=y._logicalPoint,r=y._lastLogicalPoint,Y=H.x-r.x,l=H.y-r.y;return{x:Y,y:l}},clear:function(c){var o=this,K=o.gv;o._lastLogicalPoint&&(o._lastLogicalPoint=o._data=K._moving=p,o._logicalPoint&&(o.fi({kind:"endMove",event:c}),K.onMoveEnded()),o.clearDragging()),o._alreadyBeginTransaction&&(o._alreadyBeginTransaction=!1,K.getDataModel().endTransaction())}});var fo=ur.ScrollBarInteractor=function(i){td(fo,this,[i])};$e("ScrollBarInteractor",xd,{_41o:function(){return this.gv.getViewRect().height<this.gv.getScrollRect().height},_40o:function(){return this.gv.getViewRect().width<this.gv.getScrollRect().width},isV:function(v){var W=this.gv.getViewRect();return this._41o()&&(W.x+W.width-this.gv.lp(v).x)*this.gv.getZoom()<zr},isH:function(b){var B=this.gv.getViewRect();return this._40o()&&(B.y+B.height-this.gv.lp(b).y)*this.gv.getZoom()<zr},handle_mousemove:function(P){this.handle_touchmove(P)},handle_touchmove:function(L){if(!cj&&xm(L)&&this.gv.isScrollBarVisible()){var S=this,R=S.isV(L),z=S.isH(L);(R||z)&&S.gv.showScrollBar(),S.gv._scrolling=R||z}},handleWindowMouseUp:function(D){this.handleWindowTouchEnd(D)},handleWindowTouchEnd:function(O){this._state=this._cp=this._tx=this._ty=this.gv._scrolling=p,this.fi({kind:"endScroll",event:O})},handle_mousedown:function(m){this.handle_touchstart(m)},handle_touchstart:function($){var N=this;if(N.gv.setFocus($),gj($),N.handle_touchmove($),!(cp($)>1)&&N.gv._scrolling&&N.gv.isScrollBarVisible()){N._cp=kq($),N._tx=N.gv.tx(),N._ty=N.gv.ty();var m=N.isV($);N._state=m?"vScroll":"hScroll",Kc(N,$),N.fi({kind:"beginScroll",event:$})}},handleWindowMouseMove:function(J){this.handleWindowTouchMove(J)},handleWindowTouchMove:function(u){var f=kq(u),x=this.gv.getViewRect(),v=this.gv.getScrollRect();"vScroll"===this._state?this.gv.ty(this._ty+(this._cp.y-f.y)*v.height/x.height):"hScroll"===this._state&&this.gv.tx(this._tx+(this._cp.x-f.x)*v.width/x.width),this.fi({kind:"betweenScroll",event:u})}});var np=ur.TouchInteractor=function(h,b){b=b||{},b.selectable===R&&(b.selectable=!0),b.movable===R&&(b.movable=!0),b.pannable===R&&(b.pannable=!0),b.pinchable===R&&(b.pinchable=!0),b.editable===R&&(b.editable=!0),this.params=b,td(np,this,[h])};$e("TouchInteractor",xd,{ms_edit:1,setUp:function(){var j=this;np.superClass.setUp.call(j),_&&j.params.editable&&j.gv.setEditInteractor(j)},tearDown:function(){var Z=this;np.superClass.tearDown.call(Z),_&&Z.params.editable&&Z.gv.setEditInteractor(p)},clear:function(k){var X=this,G=X.gv;G._moving&&(X.fi({kind:"endMove",event:k}),delete G._moving,G.onMoveEnded(),G.dm().endTransaction()),G._panning&&(X.fi({kind:"endPan",event:k}),delete G._panning,G.onPanEnded()),G._pinching&&(X.fi({kind:"endPinch",event:k}),delete G._pinching,G.onPinchEnded()),G._editing&&(X._46O(k),X._77I=X._node=X._edge=X._shape=X._rect=X._89I=X._index=G._editing=p),X._moving=X._panning=X._pinching=X._editing=X._57I=X._data=X._beginHistory=p,X.clearDragging()},handle_touchstart:function(g){var c=this;if(!c.gv._editing){gj(g),c._57I=p;var o=c.params,M=c.gv,m=M.sm(),h=M.getDataAt(g),Q=cp(g);if(1===Q){if(dl(g))return M.handleDoubleClick(g,h),void 0;M.handleClick(g,h),h&&(M.handleMouseDown&&M.handleMouseDown(g,h),c._data=h),o.selectable||(h=p),h?(m.co(h)||m.ss(h),o.editable&&M.isEditable(h)&&c._79I(g,h,!0)?(c._editing=1,c.startDragging(g)):o.movable&&M.isMovable(h)&&(c._moving=1,c.startDragging(g))):(c._57I=kq(g),o.pannable&&M.isPannable()&&(c._panning=1,c.startDragging(g),c._translate={x:M.tx(),y:M.ty()}))}else if(o.pinchable&&2===Q){c._pinching=1,c.startDragging(g);var j=M.getView(),b=M.getZoom(),l=j.getBoundingClientRect(),x=g.touches[0],z=g.touches[1],v={x:(x.clientX+z.clientX)/2-l.left,y:(x.clientY+z.clientY)/2-l.top};v.x-=M.tx(),v.y-=M.ty(),v.x/=b,v.y/=b,c._p=v,c._d=Rp(g)}}},handle_touchend:function(B){var I=this,O=I.gv,n=I._57I,m=I._data;n&&(ti(n,kq(B))<=1&&O.sm().cs(),I._57I=p),m&&O.handleMouseUp&&O.handleMouseUp(B,m)},handleWindowTouchEnd:function(q){this.clear(q)},handleWindowTouchMove:function(K){var y=this,l=y.gv,v=cp(K);if(1===v){if(y._editing&&(y._beginHistory||(y._beginHistory=1,l.dm().beginTransaction()),l._editing=1,y._78I(K)),y._moving)y._beginHistory||(y._beginHistory=1,l.dm().beginTransaction()),y.handleMove(K);else if(y._panning){var h=kq(K);l.setTranslate(y._translate.x+h.x-y._lastClientPoint.x,y._translate.y+h.y-y._lastClientPoint.y),y.fi({kind:l._panning?"betweenPan":"beginPan",event:K}),l._panning=1}}else if(2===v&&y._pinching){var k=Rp(K);l.handlePinch(y._p,k,y._d),y._d=k,y.fi({kind:l._pinching?"betweenPinch":"beginPinch",event:K}),l._pinching=1}},handleMove:function(p){var k=this,t=k.gv,V=t.lp(p);t._93O&&t._93O(p,k._data)||(t.moveSelection(V.x-k._lastLogicalPoint.x,V.y-k._lastLogicalPoint.y),k._lastLogicalPoint=V,k.autoScroll(p),k.fi({kind:t._moving?"betweenMove":"beginMove",event:p}),t._moving=1)}});var D=C.ht,Oq=D.graph._editor={Math:{},Guide:{}};D.Math=Oq.Math,Oq.getStyle=function(A){var $,V=Oq.StyleMap;return V&&($=V[A],$!==R)?$:Oq.DefaultStyleMap[A]},Oq.setStyle=function(K,M){var r=Oq.StyleMap;r||(r=Oq.StyleMap={}),r[K]=M},Oq.inEdit=function(z){return z._inXEdit===!0},Oq.startEdit=function(z){z._inXEdit=!0,Oq.Inject.doInject(z)},Oq._46O=function(q){q._inXEdit=!1,Oq.Inject.undoInject(q)},Oq.toScreenPosition=function(U,w){var B=U.tx(),$=U.ty(),F=U._zoom;return new Oq.Math.Vector2(w.x*F+B,w.y*F+$)},Oq.checkHit=function(T,H,s){return T.distanceTo(H)<s?!0:!1},Oq.toWorldPosition=function(L,i){var T=L.tx(),o=L.ty(),Y=L._zoom;return{x:(i.x-T)/Y,y:(i.y-o)/Y}},Oq.setAntialias=function(w,p){for(var M,i=["imageSmoothingEnabled","webkitImageSmoothingEnabled","mozImageSmoothingEnabled","oImageSmoothingEnabled","msImageSmoothingEnabled"],k=0,y=i.length;y>k&&(M=i[k],!(M in w));k++);w[M],w[M]=p},Oq.getTargetCornersOnScreen=function(P,T){if(!T)return null;var v,J=[];if(eb(T,P)){var g=sb(P,T);v=[{x:g.x,y:g.y},{x:g.x+g.width,y:g.y},{x:g.x+g.width,y:g.y+g.height},{x:g.x,y:g.y+g.height}]}else{if(!T.getCorners)return null;v=T.getCorners()}return v.forEach(function(t){var q=Oq.toScreenPosition(P,t);J.push(q.x,q.y)}),J},Oq.log=function(){};var oq=Oq.Inject={_modules:[]};oq.registAsModule=function(Y,V){var Z={},h={};for(var x in Y){var P=V.prototype[x];Z[x]=P}Y.getBackup=function(Q){return Z[Q]},Y.getBackups=function(){return Z},h.doInject=function(){for(var c in Y)"getBackup"!==c&&(V.prototype[c]=Y[c])},h.undoInject=function(){for(var T in Y)"getBackup"!==T&&(V.prototype[T]=Z[T])},oq._modules.push(h)},oq.doInject=function(M){for(var H,b=oq._modules,T=0,z=b.length;z>T;T++)H=b[T],H.doInject(M)},oq.undoInject=function(P){for(var $,q=oq._modules,F=0,e=q.length;e>F;F++)$=q[F],$.undoInject(P)};var xd=D.graph.EditInteractor=function(e){var D=this,j=i.createElement("canvas");j.className="editCanvas",j.style.position="absolute",D._styleMap={},D._canvas=j,D._context=j.getContext("2d"),xd.superClass.constructor.call(D,e),Oq.setAntialias(D._context,!1),D._subModules=[new Oq.Anchor(D),new Oq.Rect(D),new Oq.Curve(D),new Oq.MoveHelper(D)],D._gridGuide=new Oq.Guide.Grid(D),D._rectGuide=new Oq.Guide.Rect(D)},Kj=xd;D.Default.def(xd,D.graph.Interactor,{ms_edit:1,ms_fire:1}),h.defineProperties(xd.prototype,{editDetail:{get:function(){var W=!!this._editDetail;return W},set:function(_){var A=this,e=A._editDetail;e!==_&&(A._editDetail=_,A.gv._editing=_,A.fp("editDetail",e,_),A.fp("pointsEditingMode",e,_),A.fi({kind:_?"beginEditPoints":"endEditPoints"}))}},gvEditing:{get:function(){return this.gv._editing},set:function(d){(!this._editDetail||d)&&(this.gv._editing=d,d||(this.editDetail=!1))}},editing:{get:function(){return this._editing},set:function(A){this._editing=A,this.gvEditing=A}},pointsEditingMode:{get:function(){return this.editDetail},set:function(N){var d=this;d.editDetail!==N&&(N?d._tryEnterEditDetailMode():d._tryQuitEditDetailMode())}},gridEnabled:{get:function(){var k=this._gridEnabled;if(!k)return!1;var S=this.gv;return S?!0:!0},set:function(Q){Q!==this._gridEnabled&&(this._gridEnabled=Q,this._42())}},alignmentGuideEnabled:{get:function(){return this._agEnabled},set:function(E){E!==this._agEnabled&&(this._agEnabled=E,this._42())}},gridGuide:{get:function(){return this._gridGuide}},rectGuide:{get:function(){return this._rectGuide}}}),xd.prototype.getSubModule=function(y){var c,J,b,z=this._subModules;for(J=0,b=z.length;b>J;J++)if(c=z[J],c.catalog===y)return c},xd.prototype.invokeSubModule=function(g,Z){var s=this,J=s._subModules;if(J)for(var B,C,b,k=Array.prototype.slice.call(arguments,2),c=0,O=J.length;O>c;c++)if(B=J[c],C=B[g],C&&(b=C.apply(B,k),b!=R&&Z))return B},xd.prototype.invokeSubModuleInverse=function(W,G){var Z=this,r=Z._subModules;if(r)for(var T,j,_,f=Array.prototype.slice.call(arguments,2),h=r.length-1;h>=0;h--)if(T=r[h],j=T[W],j&&(_=j.apply(T,f),_!=R&&G))return T},xd.prototype.setUp=function(){Oq.log("setUp");var $=this,U=$.gv,m=U.getView(),h=$._canvas;xd.superClass.setUp.call($),U.setEditInteractor($),U._79O?m.insertBefore(h,U._79O):m.appendChild(h),Oq.startEdit(U),$.invokeSubModule("setUp"),U.dm().mm($._onDataModelChanged,$),U.dm().md($._onDataPropertyChanged,$)},xd.prototype.tearDown=function(){Oq.log("tearDown");var D=this,e=D.gv,r=e.getView();D._resetCustomCursorStyle(),xd.superClass.tearDown.call(D),e.dm().umm(D._onDataModelChanged,D),e.dm().umd(D._onDataPropertyChanged,D),e.setEditInteractor(null),r.removeChild(D._canvas),D._drawTimer&&(J(D._drawTimer),D._drawTimer=null),Oq._46O(e),D.invokeSubModule("tearDown")},xd.prototype._onDataModelChanged=function(H){var j=this;("clear"===H.kind||"remove"===H.kind&&j.editDetail&&H.data===j.getSubModule("Curve").target)&&(j.editDetail=!1,j._42())},xd.prototype._onDataPropertyChanged=function(Q){var _=this;if(_.editDetail){var n=_.getSubModule("Curve"),h=Q.data;h===n.target&&(h._writing||n._handleDataChanged())}},xd.prototype.clear=function(){Oq.log("clear")},xd.prototype.redraw=function(){this._42()},xd.prototype._42=function(){var v=this;v._drawTimer||(v._drawTimer=A(function(){v._drawTimer=null,v.drawImpl()},0))},xd.prototype.drawImpl=function(){var n;for(n in{_42:!0})break;return function(){var l=this,g=l._canvas,V=l.gv,p=V.getWidth(),S=V.getHeight(),I=l._context,Y=D.Default.getInternal();(g.width!==p||g.height!==S)&&Y.setCanvas(g,p,S),I.clearRect(0,0,g.width,g.height);var z=l._getValidSelection();I.save();var C=D.Default.devicePixelRatio;I.scale(C,C),l._gridGuide._42(),l._rectGuide._42(),l.invokeSubModuleInverse(n,!1,I,V,z),I.restore()}}(),xd.prototype._getValidSelection=function(){var n=this,h=n.gv,E=h.sm().getSelection(),X=[];return E.each(function(T){h.isVisible(T)&&h.isEditable(T)&&X.push(T)}),X},xd.prototype.handle_touchmove=function(K){return this.handle_mousemove(K)},xd.prototype.handle_mousemove=function(d){if(!D.Default.isDragging()){var S=this;(S.editDetail||!Le())&&(S.gvEditing=!1,S._checkEdit(d)&&(S.gvEditing=!0))}},xd.prototype.handle_touchstart=function(Y){return this.handle_mousedown(Y)},xd.prototype.handle_mousedown=function(b){gj(b);var C=this;if(C.editDetail||!Le()){if(dl(b)&&!b.clickThrough){if(C.editDetail){if(C._tryQuitEditDetailMode(b))return}else if(C._tryEnterEditDetailMode())return;C.gv.dm().beginTransaction();var M=C.invokeSubModule("handleDoubleClick",!0,b);if(C.gv.dm().endTransaction(),M)return}var D=C._checkEdit(b);D&&(C._downPosition=C._getLogicalPoint(b),C.gv.dm().beginTransaction(),D.startEdit(C,b),C.editing=!0)}},xd.prototype._checkEdit=function(n){var x=this,y=x.gv,q=x._getLogicalPoint(n),l=x.invokeSubModule("check",!0,y,n,q)||null;return x._editMod=l,l},xd.prototype.handleWindowTouchMove=function(e){return this.handleWindowMouseMove(e)},xd.prototype.handleWindowMouseMove=function(C){var g=this,j=g._downPosition;if(j){var R=g._getLogicalPoint(C);if(R.distanceTo(j)<g.getStyle("moveSensitivity"))return;delete g._downPosition}var i=g._editMod;i&&i.handleEdit(g.gv,C)},xd.prototype._getLogicalPoint=function(q){var Q=this,r=D.Default.getLogicalPoint(q,Q._canvas);return new Oq.Math.Vector2(r)},xd.prototype.handleWindowTouchEnd=function(a){return this.handleWindowMouseUp(a)},xd.prototype.handleWindowMouseUp=function(){var T;for(T in{_46O:!0})break;return function(d){var O=this;
O.editing=!1,O.setCursor("default"),O.invokeSubModule(T,!1,d),O._42(),O.gv.dm().endTransaction()}}(),xd.prototype.handle_mousewheel=function(g){var q=this;gj(g),q.invokeSubModule("preHandleScroll",!0)||q.gv.handleScroll(g,g.wheelDelta)},xd.prototype.handleDelete=function(){var n=this;if(!n.editDetail){n.gv.dm().beginTransaction();var i=n.invokeSubModule("handleNormalStateDelete",!0);return n.gv.dm().endTransaction(),i||n.gv.removeSelection(),void 0}n.gv.dm().beginTransaction(),n.invokeSubModule("handleDelete",!0),n.gv.dm().endTransaction(),n._42()},xd.prototype.handle_keydown=function(z){var F=this;if((z.metaKey||z.ctrlKey)&&F._42(),Le(z)&&!F.editing)return F.gvEditing=!1,F.setCursor("default"),F._42(),void 0;var x=Oi(z);return F.editDetail?((x||xq(z))&&(F.editDetail=!1,F._42()),F.gv.dm().beginTransaction(),F.invokeSubModule("handle_keydown",!0,z),F.gv.dm().endTransaction(),void 0):(F.gv.dm().beginTransaction(),F.invokeSubModule("handleNormalStateKeyDown",!0,z),F.gv.dm().endTransaction(),x&&F._tryEnterEditDetailMode(),void 0)},xd.prototype.handle_keyup=function(H){this.gv.dm().beginTransaction(),this.invokeSubModule("handle_keyup",!0,H),this.gv.dm().endTransaction()},xd.prototype._tryEnterEditDetailMode=function(){var s=this;return!s.editDetail&&s.invokeSubModule("canEnterEditDetailMode",!0)&&1===s._getValidSelection().length?(s.editDetail=!0,s._42(),!0):void 0},xd.prototype._tryQuitEditDetailMode=function(S){var X=this;if(X.editDetail){var s=X.gv,n=X.getSubModule("Curve").target;return S&&s.getDataAt(S)===n?void 0:(X.editDetail=!1,X._42(),!0)}},xd.prototype.setStyle=function(n,b,d){var S=this;d?Oq.setStyle(n,b):S._styleMap[n]=b,S.fp("styleChanged",null,{key:n,value:b,base:d}),S._42()},xd.prototype.getStyle=function(g){var r=this,G=r._styleMap[g];return G!==R?G:Oq.getStyle(g)},xd.prototype.setCursor=function(p){this._resetCustomCursorStyle(),D.graph.EditInteractor.superClass.setCursor.call(this,p)},xd.prototype._resetCustomCursorStyle=function(){var m=this;if(m._customStyle){var o=this.gv.getView();o.classList&&o.classList.remove&&o.classList.remove(m._customStyle),m._customStyle=null}},xd.prototype._setRotateCursor=function(S){var F=this,C=F._cursorFactory;C||(C=F._cursorFactory=new Oq.CursorFactory(F));var A=C.getRotateCursor(S),x=F.gv.getView();F._resetCustomCursorStyle(),F._customStyle=A,x.classList&&x.classList.add&&x.classList.add(A)};var rh=Oq.Group=function(D){var t=this;t._entities=D,t._64O=0,t._position={x:0,y:0},t._scale={x:1,y:1},t._anchor={x:.5,y:.5},t._anchor2={x:.5,y:.5}};rh.prototype={},rh.prototype.constructor=rh;var ud=null;rh.findOrCreateGroup=function(w){if(ud&&ud.checkIsMe(w))return ud;var k=new Oq.Group(w);return k.getKeyOb()?(ud=k,k):void 0},rh.prototype.checkIsMe=function(l){var $=this._entities;if($.length!==l.length)return!1;var D,A={},F=l.length;for(D=0;F>D;D++)A[l[D]._id]=!0;for(D=0;F>D;D++)if(!A[$[D]._id])return!1;return!0},rh.prototype.getRotation=function(){return this._64O},rh.prototype.getPosition=function(){return this._position},rh.prototype.getAnchor=function(){return this._anchor},rh.prototype.getWidth=function(){return this._width},rh.prototype.getScale=function(){return this._scale},rh.prototype.getSize=function(){return{width:this._width,height:this._height}},rh.prototype.getHeight=function(){return this._height},rh.prototype.getKeyOb=function(){for(var W=this._entities,U=W.length-1;U>=0;U--){var B=W[U];if(this.isNode(B))return B}},rh.prototype.getAnchor2=function(){var C=this,p=C.rotateCenter;if(p)return p;var X=C.getKeyOb();if(!X)return C._anchor;var m=C._anchor2,d=X.getMatrix();return d.tf({x:X.getWidth()*(m.x-X.getAnchor().x),y:X.getHeight()*(m.y-X.getAnchor().y)})},rh.prototype.setAnchor2=function(m,i){var p=this,T=p.getKeyOb();if(T){var L,l=T.getMatrix();L="number"==typeof m?{x:m,y:i}:m;var g=l.tfi(L);p._anchor2={x:T.getAnchor().x+g.x/T.getWidth(),y:T.getAnchor().y+g.y/T.getHeight()}}},rh.prototype.setRotation=function(){},rh.prototype.beginRotate=function(B){this.rotateCenter=B.pos,this.rotateMode=B.groupRotateMode},rh.prototype.endRotate=function(){delete this.rotateCenter,delete this.rotateMode},rh.prototype.addRotation=function($,q){return"batch"===q?this._addRotationInBatchMode($):"block"===q?this._addRotationInBlockMode($):void 0},rh.prototype._addRotationInBlockMode=function(S){var G=this,Y=G.rotateCenter||G.getPosition();G._entities.forEach(function(g){if(G.isNode(g)){var V=g.getMatrix();V.translate(-Y.x,-Y.y),V.rotate(S),V.translate(Y.x,Y.y);var O=Math.sign(g.getScale().x);g.setRotation(z(V.b*O,V.a*O)),g.setPosition(V.tx,V.ty)}})},rh.prototype._addRotationInBatchMode=function(N){var K=this,D=K._anchor2;K._entities.forEach(function(S){if(K.isNode(S)){var n=S.getAnchor(),A=S.getMatrix(),$=A.tf({x:S.getWidth()*(D.x-n.x),y:S.getHeight()*(D.y-n.y)}),m=new Oq.Math.Matrix2;m.set(A.a,A.b,A.c,A.d,A.tx,A.ty),m.translate(-$.x,-$.y),m.rotate(N),m.translate($.x,$.y);var O=Math.sign(S.getScale().x);S.setRotation(z(m.b*O,m.a*O)),S.setPosition(m.tx,m.ty)}})},rh.prototype.setPosition=function(v){var T,j,P,u,D=this,Y=D._position,J=v.x-Y.x,U=v.y-Y.y,O=D._entities;for(j=0,P=O.length;P>j;j++)T=O[j],Bf(T)&&(u=T.getPosition(),T.setPosition(u.x+J,u.y+U));D._position=v},rh.prototype.setScale=function(A,s){var Y=this,$=A/Y._scale.x,e=s/Y._scale.y;Y._adjustChildScaleOrSize($,e,"size"),Y._scale={x:A,y:s}},rh.prototype.getRect=function(){var M=this,H=M._position,Y=M._width,G=M._height;return{x:H.x-Y/2,y:H.y-G/2,width:Y,height:G}},rh.prototype.setSize=function(d,S){var o=this,d=Math.max(1,d),S=Math.max(1,S),P=d/o._width,V=S/o._height;o._adjustChildScaleOrSize(P,V,"size"),o._width=d,o._height=S},rh.prototype._adjustChildScaleOrSize=function(D,W,u){var n,Y,N,h,S,P,V,q,X,M,E,T,e,o,O=this,w=O._position,i=O._entities,g=new Oq.Math.Matrix2;for(Y=0,N=i.length;N>Y;Y++)if(n=i[Y],O.isNode(n)){if(h=n.getPosition(),S=n.getRotation(),P=n.getWidth(),V=n.getHeight(),q=n.getScale(),E=q.x*P,T=q.y*V,g.identity().scale(E,T).rotate(S).translate(h.x,h.y).translate(-w.x,-w.y).rotate(-O._64O),S=z(g.b*Math.sign(E),g.a*Math.sign(E)),g.scale(D,W),X=Math.cos(S),M=Math.sin(S),Math.abs(X)<.001?(e=g.b/M,o=-g.c/M):(e=g.a/X,o=g.d/X),"scale"===u)n.setScale(e/P,o/V);else if("size"===u){var G=e/q.x,I=o/q.y;n.setScale(nm(e)*Math.abs(q.x),nm(o)*Math.abs(q.y)),n.setSize(Math.max(.1,Math.abs(G)),Math.max(.1,Math.abs(I)))}g.rotate(O._64O).translate(w.x,w.y),n.setPosition(g.tx,g.ty)}},rh.prototype.getMatrix=function(){var s=this,F=s._position,u=D.Default.getInternal(),E=s._scale;return new u.Mat(s._64O,F.x,F.y,E.x,E.y)},rh.prototype.getCorners=function(){var z=this,U=z._width,d=z._height,N=z._anchor,j=-U*N.x,b=-d*N.y,w=z.getMatrix();return[w.tf(j,b),w.tf(j,b+d),w.tf(j+U,b+d),w.tf(j+U,b)]},rh.prototype.calcInfo=function(){var c,E,G,D,X,t,r=this,g=[],L=r._entities,M=r._64O;for(D=0,X=L.length;X>D;D++)t=L[D],r.isNode(t)&&t.getCorners&&g.push.apply(g,t.getCorners());if(g.length){var s=Math.cos(-M),d=Math.sin(-M),y=1/0,K=-1/0,H=1/0,z=-1/0;for(D=0,X=g.length;X>D;D++)G=g[D],c=G.x,E=G.y,G.x=s*c-d*E,G.y=d*c+s*E,y=Math.min(y,G.x),K=Math.max(K,G.x),H=Math.min(H,G.y),z=Math.max(z,G.y);r._width=(K-y)/r._scale.x,r._height=(z-H)/r._scale.y,s=Math.cos(M),d=Math.sin(M);var C=r._anchor;c=y+(K-y)*C.x,E=H+(z-H)*C.y,r._position={x:s*c-d*E,y:d*c+s*E}}},rh.prototype.isNode=function(D){return Bf(D)?eb(D)?!1:!0:!1},rh.prototype._42=function(P,f,J){var l,j,Z,N,U,u,r,K,c=this,Y=c._entities,n=c.rotateMode;for("batch"===n&&(K=c.getKeyOb()),l=0,j=Y.length;j>l;l++)Z=Y[l],c.isNode(Z)&&(u=Z.getRect(),N=Oq.toScreenPosition(J,{x:u.x,y:u.y}),U=Oq.toScreenPosition(J,{x:u.x+u.width,y:u.y+u.height}),r={min:N,max:U},Z===K&&(r.isKeyOb=!0),Oq.Icons.DrawIcon(P,f,Oq.Icons.GroupSubEntityRect,r))};var zn=Oq.CurveActiving=function(m,a){this._curve=m,this._interactor=m._interactor;for(var u in a)this[u]=a[u]};zn.prototype={},zn.prototype.constructor=zn,h.defineProperties(zn.prototype,{point:{get:function(){return this._point},set:function(a){var L=this;L._point=a,L.editingCtrl||L._firePointChange()}},pairs:{get:function(){return this._pairs},set:function(T){var h=this;h._pairs=T,h.editingCtrl&&h._firePointChange()}}}),zn.prototype._firePointChange=function(){var i=this,J=i.getCurrentEditingPoint();if(!J)return B.fi({kind:"selectPoint"}),void 0;var B=i._interactor,x=this._curve.target;if(x){var d=Oq.getDataMatrix(x).invert(),L=J.e;J=d.apply(Oq.toWorldPosition(B.gv,J)),J.e=L;var f=i._lastFirePoint;f&&Math.abs(J.x-f.x)<1e-5&&Math.abs(J.y-f.y)<1e-5&&(J.e==R&&f.e==R||Math.abs(J.e-f.e)<1e-5)||(i._lastFirePoint=J,B.fi({kind:"selectPoint",x:J.x,y:J.y,e:J.e}))}},zn.prototype.dispose=function(){this._interactor.fi({kind:"selectPoint"})},zn.prototype.getCurrentEditingPoint=function(){var V=this,P=V.editingCtrl;if(P){var J=V.pairs;if(J){var E=J[P.pairId],A=E[P.type];if(A)return A}}return V._point};var Nb=Oq.CursorFactory=function(o){var X=this;X._interactor=o,X._rotateCursorStyles={}};Nb.prototype={},Nb.prototype.constructor=Nb,Nb.prototype.getRotateCursor=function(h){var v=this;0>h&&(h+=2*Math.PI);var X=v._interactor,U=X.getStyle("rotateCursorSize"),$=X.getStyle("rotateCursorRound"),L=Math.round(180*(h/Math.PI)/$);L*$>=360&&(L=0);var w=v._rotateCursorStyles,r="htCustomRotateStyle_"+U+"_"+$+"_"+L;return w[r]||(v._produceRotateCursor(r,U,$,L),w[r]=!0),r},Nb.prototype._produceRotateCursor=function(W,l,k,h){var w=this;w._interactor;var x=w._canvas;x||(x=w._canvas=i.createElement("canvas")),x.width=x.height=l*devicePixelRatio,x.style.width=x.style.height=l+" px";var m=x.getContext("2d");Oq.setAntialias(m,!1),m.scale(devicePixelRatio,devicePixelRatio);var y,T,s,z,H,O=Math.round(l/2),d=""+O+" "+O+",auto !important;";y=Math.PI/180*h*k,m.clearRect(0,0,l,l),m.save(),m.scale(l/32,l/32),m.translate(16,16),m.rotate(y+Math.PI/2),m.beginPath(),m.moveTo(-8,0),m.lineTo(-8,3),m.lineTo(-5,3),m.moveTo(8,0),m.lineTo(8,3),m.lineTo(5,3),m.moveTo(-8,3),m.quadraticCurveTo(0,-6,8,3),m.restore(),m.strokeStyle="white",m.lineWidth=4,m.stroke(),m.strokeStyle="black",m.lineWidth=2,m.stroke(),T=JSON.stringify(x.toDataURL()),z="cursor:url("+T+")"+d,1!==devicePixelRatio&&(s='<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="'+l+'px" height="'+l+'px"><image xlink:href='+T+' width="'+l+'" height="'+l+'"/></svg>',z+="cursor:url(data:image/svg+xml;base64,"+btoa(s)+")"+d,z+="cursor:-webkit-image-set(url("+T+")"+devicePixelRatio+"x,url("+T+")1x)"+d),H=i.createElement("style"),H.textContent="body."+W+" *, ."+W+"{"+z+"}",i.head.appendChild(H)};var ej=Oq.Guide.Grid=function(J){var E=this;E._interactor=J,E._alignmentGuideId=0,E._xAlignmentGuide=[],E._yAlignmentGuide=[]};ej.prototype={},ej.prototype.constructor=ej,h.defineProperties(ej.prototype,{gridBlockSize:{get:function(){var L=this;return L._gridBlockSize||L._interactor.getStyle("gridBlockSize")},set:function(U){this._gridBlockSize=U,this._interactor._42()}},gridThickLinesEvery:{get:function(){var R=this;return R._gridThickLinesEvery||R._interactor.getStyle("gridThickLinesEvery")},set:function(F){this._gridThickLinesEvery=F,this._interactor._42()}},gridEnabled:{get:function(){var g=this,T=g._interactor;return T.gridEnabled&&g.isValidGrid()}}}),ej.prototype._42=function(){var i=this,x=i._interactor;i.gridEnabled&&i.drawGrid(),x.alignmentGuideEnabled&&i.drawAlignmentGuide()},ej.prototype.makeMatrix=function(){var M=this,i=M._interactor.getStyle("gridAngle"),P=M._interactor.getStyle("gridRotation"),Z=new Oq.Math.Matrix2,m=Math.sin(i),j=Math.cos(i);return Z.set(1,0,j,m,0,0),Z.rotate(P),Z},ej.prototype.isValidGrid=function(){var R=this,J=Math.PI,v=R._interactor,_=v.gv;if(_._zoom<v.getStyle("gridZoomThreshold"))return!1;var G=v.getStyle("gridAngle"),x=Math.abs(180*(G%J/J)),H=1-1e-8;return H>x||x>180-H?!1:!0},ej.prototype.drawAlignmentGuide=function(){var l=this,K=l._interactor,U=K.gv,$=K._canvas,Q=K._context,z=$.width,E=$.height,j=U.tx(),e=U.ty(),u=U._zoom;Q.beginPath(),Q.strokeStyle=K.getStyle("gridAlignmentGuideColor"),Q.lineWidth=1,l._xAlignmentGuide.forEach(function(d){var R=d.p*u+j;Q.moveTo(R,0),Q.lineTo(R,E)}),l._yAlignmentGuide.forEach(function(S){var W=S.p*u+e;Q.moveTo(0,W),Q.lineTo(z,W)}),Q.stroke()},ej.prototype.drawGrid=function(){function v(c,I,a,z){var Y=Oq.toScreenPosition(b,P.apply({x:c,y:I})),_=Oq.toScreenPosition(b,P.apply({x:a,y:z}));S.moveTo(Y.x,Y.y),S.lineTo(_.x,_.y)}var r=this,n=r._interactor,d=r.gridBlockSize,g=r.gridThickLinesEvery,l=n.getStyle("gridThickColor"),K=n.getStyle("gridLightColor"),b=n.gv,X=n._canvas,S=n._context,o=X.width,e=X.height,P=r.makeMatrix(),H=P.applyInverse(Oq.toWorldPosition(b,{x:0,y:0})),u=P.applyInverse(Oq.toWorldPosition(b,{x:o,y:0})),j=P.applyInverse(Oq.toWorldPosition(b,{x:0,y:e})),M=P.applyInverse(Oq.toWorldPosition(b,{x:o,y:e})),L=Math.min(H.x,u.x,j.x,M.x),i=Math.max(H.x,u.x,j.x,M.x),U=Math.min(H.y,u.y,j.y,M.y),p=Math.max(H.y,u.y,j.y,M.y);o=i-L,e=p-U;var _=Math.ceil(L/d),Y=Math.floor(i/d),y=Math.ceil(U/d),F=Math.floor(p/d);b.tx(),b.ty(),b._zoom;var k,a,C;for(S.save(),S.lineWidth=1,S.beginPath(),S.strokeStyle=l,C=Math.ceil(_/g)*g;Y>=C;C+=g)k=C*d,v(k,U,k,p);for(C=Math.ceil(y/g)*g;F>=C;C+=g)a=C*d,v(L,a,i,a);for(S.stroke(),S.beginPath(),S.strokeStyle=K,C=_;Y>=C;C++)0!==C%g&&(k=C*d,v(k,U,k,p));for(C=y;F>=C;C++)0!==C%g&&(a=C*d,v(L,a,i,a));S.stroke(),S.restore()},ej.prototype.getAlignmentGuides=function(){var m=this;return{x:m._xAlignmentGuide,y:m._yAlignmentGuide}},ej.prototype.addAlignmentGuide=function(L,l,H){var R=this,q="x"===L?R._xAlignmentGuide:R._yAlignmentGuide,H=H?H:++R._alignmentGuideId,c={p:l,id:H};if(q.length){var V=R._findClosestAlignmentGuide(c.p,q);V.dis<0?q.splice(V.index+1,0,c):q.splice(V.index,0,c)}else q.push(c);return R._interactor._42(),H},ej.prototype.findClosest=function(T,e,A){var N=this,Z=N._interactor,a=Z.gv;A&&(T=Oq.toWorldPosition(a,T));var O,Y,X,b=1/0,F=1/0,_=T.x,B=T.y;if(N.gridEnabled){var q=N.gridBlockSize,c=N.makeMatrix(),d=c.applyInverse(T);d=c.apply({x:Math.round(d.x/q)*q,y:Math.round(d.y/q)*q}),b=d.x-_,F=d.y-B,X=!0}if(Z.alignmentGuideEnabled&&(O=N._findClosestAlignmentGuide(_,N._xAlignmentGuide).dis,Y=N._findClosestAlignmentGuide(B,N._yAlignmentGuide).dis,Math.abs(O)<Math.abs(b)&&(b=O,X=!0),Math.abs(Y)<Math.abs(F)&&(F=Y,X=!0)),X){X=!1;var U=a._zoom,j=Z.getStyle("smartGuideSensitivity")/U,G={};if(Math.abs(b)<j&&"y"!==e&&(G.x=A?b*U:b,X=!0),Math.abs(F)<j&&"x"!==e&&(G.y=A?F*U:F,X=!0),X)return G}},ej.prototype._findClosestAlignmentGuide=function($,C){if(!C.length)return{dis:1/0};for(var f,K=0,I=C.length-1;I-K>1;)f=Math.floor((K+I)/2),C[f].p<$?K=f:I=f;var r=C[K].p-$,d=C[I].p-$;return Math.abs(r)<=Math.abs(d)?{line:C[K],dis:r,index:K}:{line:C[I],dis:d,index:I}},ej.prototype.removeAllAlignmentGuide=function(x){var n=this;"y"!==x&&(n._xAlignmentGuide=[]),"x"!==x&&(n._yAlignmentGuide=[]),n._interactor._42()},ej.prototype.removeAlignmentGuide=function(K){for(var u,w,Q,$=this,L=$._xAlignmentGuide,H=0;2>H;H++)for(L=0===H?$._xAlignmentGuide:$._yAlignmentGuide,u=0,w=L.length;w>u;u++)if(Q=L[u],Q.id===K)return L.splice(u,1),$._interactor._42(),{axis:0===H?"x":"y",position:Q.p};return!1},ej.prototype.adjustAlignmentGuide=function(k,s){var o=this,q=o.removeAlignmentGuide(k);return q?(o.addAlignmentGuide(q.axis,s,k),!0):!1};var xf=Oq.Guide.Rect=function(I){var v=this;v._interactor=I};xf.prototype={},xf.prototype.constructor=xf,xf.prototype.gatherRects=function(){var l,x,D,N,O=this,S=O._interactor.gv,Q=[],M=[],J={x:Q,y:M},v={},s=S.getDataModel(),L=s.a("width"),t=s.a("height");L&&t&&(l=0,x=0,D=L,N=t,Q.push({node:s,type:0,p:l},{node:s,type:1,p:l+D/2},{node:s,type:2,p:l+D}),M.push({node:s,type:0,p:x},{node:s,type:1,p:x+N/2},{node:s,type:2,p:x+N}),v[s._id||0]={x:l,y:x,width:D,height:N}),s.each(function(i){if(Bf(i)&&!S.isSelected(i)&&S.isVisible(i)){var y=!1;if(S.sm().getSelection().each(function(g){y||(i.isHostOn(g)?y=!0:i.isDescendantOf(g)&&(y=!0))}),!y){var E=i.getRect();l=E.x,x=E.y,D=E.width,N=E.height,Q.push({node:i,type:0,p:l},{node:i,type:1,p:l+D/2},{node:i,type:2,p:l+D}),M.push({node:i,type:0,p:x},{node:i,type:1,p:x+N/2},{node:i,type:2,p:x+N}),v[i._id]=E}}}),Q.sort(function(y,R){return y.p-R.p}),M.sort(function(H,Q){return H.p-Q.p}),O._grid=J,O._87I=v},xf.prototype.gatherLines=function(P,$,W){var d,F,A,M,L,D,V,Y,w,r,e,g,Q=this,R=[Q.findClosest({x:P.x,y:P.y},$),Q.findClosest({x:P.x+P.w/2,y:P.y+P.h/2},$),Q.findClosest({x:P.x+P.w,y:P.y+P.h},$)],I={},v=Q._87I;W=W||255;var x,G;for(Q._guideLine=[],d=0;2>d;d++)for(I={},0===d?(M="y",Y=P.x,w=Y+P.w):(M="x",Y=P.y,w=Y+P.h),F=0;3>F;F++)L=R[F],L&&isFinite(L[M])&&(x=1<<3*d+F,W&x&&(D=L[M+"Line"],V=D.node,G=V._id||0,I[G]||(I[G]=!0,g=v[G],"y"===M?(r=g.x,e=g.x+g.width):(r=g.y,e=g.y+g.height),A=D.p,Q._guideLine.push({type:M,a:Y,b:w,c:r,d:e,p:A}))))},xf.prototype._binarySearchClosest=function(w,B){if(!B.length)return{dis:1/0};for(var O,N=0,V=B.length-1;V-N>1;)O=Math.floor((N+V)/2),B[O].p<w?N=O:V=O;var D=B[N].p-w,e=B[V].p-w;return Math.abs(D)<=Math.abs(e)?{line:B[N],dis:D}:{line:B[V],dis:e}},xf.prototype.findClosest=function(I,k,T){var v=this,s=v._interactor,Q=s.gv,B=v._grid;T&&(I=Oq.toWorldPosition(Q,I));var p,h=v._binarySearchClosest(I.x,B.x),R=v._binarySearchClosest(I.y,B.y),l=h.dis,C=R.dis,W=Q._zoom,H=s.getStyle("smartGuideSensitivity")/W,f={};return Math.abs(l)<H&&"y"!==k&&(f.x=T?l*W:l,f.xLine=h.line,p=!0),Math.abs(C)<H&&"x"!==k&&(f.y=T?C*W:C,f.yLine=R.line,p=!0),p?f:void 0},xf.prototype._42=function(){var v=this,Y=v._guideLine;if(Y&&!D.Default.isCtrlDown()){var B,s,A,N,g,P,F,W,o,J,C,T,e,a,c,I,i,O=v._interactor,$=O.gv,j=O._context,E=$.tx(),R=$.ty(),q=$._zoom,H=O.getStyle("guideLineTextSpacing");for(B=0,s=Y.length;s>B;B++)A=Y[B],W=A.type,o=A.p,J=A.a,C=A.b,T=A.c,e=A.d,a=Math.min(J,T),c=Math.max(C,e),"x"===W?(N=o*q+E,g=a*q+R,P=N,F=c*q+R):(N=a*q+E,g=o*q+R,P=c*q+E,F=g),Oq.Icons.DrawIcon(O,j,Oq.Icons.MoveLineGuide,[N,g,P,F]),e>=J&&C>=T||(a=J>e?e:C,c=J>e?J:T,i=c-a,"x"===W?(A.center2center||(N-=H,P=N),g=a*q+R,F=c*q+R,I=Oq.Icons.MoveLineGuideDistanceV):"y"===W&&(A.center2center||(g-=H,F=g),N=a*q+E,P=c*q+E,I=Oq.Icons.MoveLineGuideDistanceH),Oq.Icons.DrawIcon(O,j,I,{x0:N,y0:g,x1:P,y1:F,dis:i}))}},xf.prototype.clear=function(){this._guideLine=null},Oq.DefaultStyleMap={pointSize:[24,9],checkSize:7,rotateCheckSize:10,moveSensitivity:10,rotateRound:Math.PI/2,rotateSensitivity:Math.PI/60,shiftRotateRound:Math.PI/12,shiftLineRotateRound:Math.PI/4,anchorMovable:!0,anchorVisible:!0,anchorHideThreshold:25,anchorOutsideVisibleThreshold:.25,anchorRound:.25,anchorSensitivity:.02,smartGuideSensitivity:8,curveIntersectSize:5,curvePointIntersectSize:8,edgeHostDetectPerFrame:!0,guideLineTextSpacing:32,gridBlockSize:40,gridThickLinesEvery:10,gridThickColor:"#5d5d5d",gridLightColor:"#d0d0d0",gridZoomThreshold:.25,gridAlignmentGuideColor:"#ff0000",gridAngle:Math.PI/2,gridRotation:0,groupRotateModeDefault:"block",groupRotateModeKey:["ctrlKey","metaKey"],rotateCursorSize:32,rotateCursorRound:45,tipTextColor:"#ffffff",tipBackground:"#333333",curveHighlightColor:"#30599e",rectPointBackground:"white",rectPointBorderColor:"#666666",rectPointShadowColor:"rgba(0,0,0,0.35)",shapeCtrlPointBackground:"white",shapeCtrlPointBorderColor:"#707070",shapeCtrlPointHighlightBorder:"black",shapeHighlighPointBackground:"#30599e",curveElevationVisible:!0,curveElevationIntersectSize:8,curveElevationGuideShift:[20,0],connectGuideVisible:!0,connectGuideShift:[1,.25,8,0],connectGuideIntersectSize:8,connectGuideGarbageIntersectsize:25,connectGuideGarbageShift:[1,1,-48,-48]};var Xm=Oq.Icons={},Oc=1e4,mo=null,jk=8;D.Default.setImage("Icons.RectPoint",{width:jk,height:jk,comps:[{type:"shape",points:[0,0,0,jk,jk,jk,jk,0],segments:[1,2,2,2,5],shadow:!0,borderWidth:1,shadowColor:{func:function(){return mo.getStyle("rectPointShadowColor")}},background:{func:function(){return mo.getStyle("rectPointBackground")}},borderColor:{func:function(){return mo.getStyle("rectPointBorderColor")}}}]});var Nc="#e000e0";Xm.GroupSubEntityRect={comps:[{type:"shape",points:{func:function(){var l=Xm.GroupSubEntityRect.data;if(!l)return[];var Y=l.min,I=l.max;return[Y.x,Y.y,Y.x,I.y,I.x,I.y,I.x,Y.y]}},segments:[1,2,2,2,5],background:null,borderWidth:1,borderColor:{func:function(){return Xm.GroupSubEntityRect.data.isKeyOb?Nc:"#666666"}}}]},Xm.Line={comps:[{type:"image",name:"Icons.RectPoint",rect:{func:function(){return[[Xm.Line.data.P1.x,Xm.Line.data.P1.y],jk,jk]}}},{type:"image",name:"Icons.RectPoint",rect:{func:function(){return[[Xm.Line.data.P2.x,Xm.Line.data.P2.y],jk,jk]}}}]},Xm.NodeHoverGuide={comps:[{type:"shape",points:{func:function(){return Xm.NodeHoverGuide.data}},segments:[1,2,2,2,5],background:null,borderWidth:1,borderColor:"#3399FF"}]},Xm.Rect={comps:[{type:"shape",points:{func:function(){var l=Xm.Rect.data;if(!l)return[];var X=l.LT,D=l.LB,m=l.RB,d=l.RT;return[X.x,X.y,D.x,D.y,m.x,m.y,d.x,d.y]}},segments:[1,2,2,2,5],background:null,borderWidth:1,borderColor:"#666666"},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return Xm.Rect.data.rotation}},rect:{func:function(){return[[Xm.Rect.data.LT.x,Xm.Rect.data.LT.y],jk,jk]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return Xm.Rect.data.rotation}},rect:{func:function(){return[[Xm.Rect.data.LB.x,Xm.Rect.data.LB.y],jk,jk]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return Xm.Rect.data.rotation}},rect:{func:function(){return[[Xm.Rect.data.RB.x,Xm.Rect.data.RB.y],jk,jk]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return Xm.Rect.data.rotation}},rect:{func:function(){return[[Xm.Rect.data.RT.x,Xm.Rect.data.RT.y],jk,jk]}}},{type:"image",name:"Icons.RectPoint",scaleX:.9,scaleY:.9,rotation:{func:function(){return Xm.Rect.data.rotation}},visible:{func:function(){return Xm.Rect.data.L?!0:!1}},rect:{func:function(){return[[Xm.Rect.data.L.x,Xm.Rect.data.L.y],jk,jk]}}},{type:"image",name:"Icons.RectPoint",scaleX:.9,scaleY:.9,rotation:{func:function(){return Xm.Rect.data.rotation}},visible:{func:function(){return Xm.Rect.data.R?!0:!1}},rect:{func:function(){return[[Xm.Rect.data.R.x,Xm.Rect.data.R.y],jk,jk]}}},{type:"image",name:"Icons.RectPoint",scaleX:.9,scaleY:.9,rotation:{func:function(){return Xm.Rect.data.rotation}},visible:{func:function(){return Xm.Rect.data.T?!0:!1}},rect:{func:function(){return[[Xm.Rect.data.T.x,Xm.Rect.data.T.y],jk,jk]}}},{type:"image",name:"Icons.RectPoint",scaleX:.9,scaleY:.9,rotation:{func:function(){return Xm.Rect.data.rotation}},visible:{func:function(){return Xm.Rect.data.B?!0:!1}},rect:{func:function(){return[[Xm.Rect.data.B.x,Xm.Rect.data.B.y],jk,jk]}}}]};var Gh=18;D.Default.setImage("Icons.Anchor",{width:Gh,height:Gh,comps:[{type:"arc",rect:[4,4,Gh-8,Gh-8],arcFrom:0,arcClose:!1,background:"#ffffff",borderWidth:0,borderColor:"#000000"},{type:"shape",points:[2,Gh/2,Gh-2,Gh/2,Gh/2,2,Gh/2,Gh-2],segments:[1,2,1,2],background:null,borderWidth:1,borderColor:"#111111"},{type:"arc",rect:[5.5,5.5,Gh-11,Gh-11],arcFrom:0,arcClose:!1,background:null,borderWidth:1,borderColor:"#111111"}]}),Xm.Anchor={comps:[{type:"image",name:"Icons.Anchor",rect:{func:function(){return[[Xm.Anchor.data.POS.x,Xm.Anchor.data.POS.y],Gh,Gh]}}}]},Xm.TipShiftX=12,Xm.TipShiftY=12;var ji=[8,28];Xm.TipHelper={comps:[{type:"roundRect",rect:{func:function(){return[Xm.TipHelper.data.helperPos.x,Xm.TipHelper.data.helperPos.y,ji[0]*Xm.TipHelper.data.size,ji[1]]}},background:{func:function(){return mo.getStyle("tipBackground")}},opacity:.6},{type:"text",text:{func:function(){return Xm.TipHelper.data.text}},rect:{func:function(){return[Xm.TipHelper.data.helperPos.x,Xm.TipHelper.data.helperPos.y,ji[0]*Xm.TipHelper.data.size,ji[1]]}},color:{func:function(){return mo.getStyle("tipTextColor")}},font:"bold 12px Arial",align:"center"}]};var Yj=7;Xm.ShapePoint={comps:[{type:"circle",rect:{func:function(){var c=Xm.ShapePoint.data;return[c,Yj,Yj]}},background:"#ffffff",borderWidth:1,borderColor:"#333333"}]},Xm.ShapeBgCurve={comps:[{type:"shape",points:{func:function(){return Xm.ShapeBgCurve.data.P}},segments:{func:function(){return Xm.ShapeBgCurve.data.S}},background:null,borderWidth:1,borderColor:"#333333"}]};var Kb=8;Xm.ShapeHighlighPoint={comps:[{type:"circle",rect:{func:function(){var f=Xm.ShapeHighlighPoint.data;return[[f.x,f.y],Kb,Kb]}},background:{func:function(){return mo.getStyle("shapeHighlighPointBackground")}},borderWidth:0}]};var qd=10;Xm.ShapeHighlighRealPoint={comps:[{type:"circle",rect:{func:function(){var Y=Xm.ShapeHighlighRealPoint.data;return[[Y.x,Y.y],qd,qd]}},background:"#ffffff",borderWidth:2,borderColor:"#333333"}]};var Rc=8;Xm.ShapeHighlighCtrlPoint={comps:[{type:"shape",points:{func:function(){var K=Xm.ShapeHighlighCtrlPoint.data,c=K.x,E=K.y,b=Rc/2;return[c-b,E-b,c-b,E+b,c+b,E+b,c+b,E-b]}},segments:[1,2,2,2,5],borderWidth:2,background:{func:function(){return mo.getStyle("shapeCtrlPointBackground")}},borderColor:{func:function(){return mo.getStyle("shapeCtrlPointBorderColor")}}}]};var Vm=3;Xm.ShapeHighlightCurve={comps:[{type:"shape",points:{func:function(){return Xm.ShapeHighlightCurve.data}},segments:[1,4],background:null,borderWidth:Vm,borderColor:{func:function(){return mo.getStyle("curveHighlightColor")}}}]},Xm.ShapeGuideLine={comps:[{type:"shape",points:{func:function(){return Xm.ShapeGuideLine.data}},background:null,borderWidth:1,borderColor:"red"}]},Xm.MoveLineGuide={comps:[{type:"shape",points:{func:function(){return Xm.MoveLineGuide.data}},background:null,borderWidth:1,borderColor:"red"}]};var Hf=5;Xm.MoveLineGuideDistanceH={comps:[{type:"shape",points:{func:function(){var q=Xm.MoveLineGuideDistanceH.data,f=q.x0,U=q.y0,Q=q.x1,D=q.y1;return[f,U,Q,D,f,U-Hf,f,U+Hf,Q,D-Hf,Q,D+Hf]}},segments:[1,2,1,2,1,2],background:null,borderWidth:1,borderColor:"red"},{type:"text",text:{func:function(){return Math.round(Xm.MoveLineGuideDistanceH.data.dis)}},rect:{func:function(){var r=Xm.MoveLineGuideDistanceH.data;return[[(r.x0+r.x1)/2,r.y0-10],20,20]}},color:"red",font:"12px Arial",align:"center"}]},Xm.MoveLineGuideDistanceV={comps:[{type:"shape",points:{func:function(){var H=Xm.MoveLineGuideDistanceV.data,m=H.x0,Y=H.y0,n=H.x1,u=H.y1;return[m,Y,n,u,m-Hf,Y,m+Hf,Y,n-Hf,u,n+Hf,u]}},segments:[1,2,1,2,1,2],background:null,borderWidth:1,borderColor:"red"},{type:"text",text:{func:function(){return Math.round(Xm.MoveLineGuideDistanceV.data.dis)}},rect:{func:function(){var y=Xm.MoveLineGuideDistanceV.data;return[[y.x0-10,(y.y0+y.y1)/2],20,20]}},color:"red",font:"12px Arial",align:"center"}]},D.Default.setImage("Icons.EdgeElevationGuideImage",{width:16,height:16,comps:[{type:"oval",background:"rgb(255,255,255)",borderWidth:1,borderColor:"rgb(138,138,138)",rect:[.5,.5,15,15]},{type:"shape",borderWidth:2,borderColor:"rgb(44,44,44)",borderCap:"round",points:[4,8,8,4,12,8,8,4,8,13],segments:[1,2,2,1,2]}]}),Xm.EdgeElevationGuide={comps:[{type:"image",name:"Icons.EdgeElevationGuideImage",rect:{func:function(){var b=Xm.EdgeElevationGuide.data,A=b.x,Q=b.y,B=mo.getStyle("curveElevationIntersectSize"),l=mo.getStyle("curveElevationGuideShift");return A+=l[0],Q+=l[1],[A-B,Q-B,2*B,2*B]}}}]},D.Default.setImage("Icons.ConnectGuideBgImage",{width:12,height:12,comps:[{type:"shape",background:"#3399ff",fillRule:"evenodd",shadowColor:"#1ABC9C",rotation:3.14159,points:[6.00001,11.99999,6.00001,11.99999,2.6863,11.99999,1e-5,9.30695,1e-5,5.99999,1e-5,5.99999,1e-5,2.68628,2.69305,-1e-5,6.00001,-1e-5,12.00001,-1e-5,11.99998,12.00001,6.00001,11.99999],segments:[1,2,4,2,4,2,2,2]}]}),D.Default.setImage("Icons.ConnectGuideHeaderImage",{width:12,height:12,comps:[{type:"oval",background:"#3399FF",borderColor:"#3399FF",shadowColor:"#1ABC9C",rect:[0,0,12,12]},{type:"shape",borderWidth:1,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[4.76,2.56,8.2,5.98,4.76,9.44]}]}),Xm.ConnectGuide={comps:[{type:"image",name:"Icons.ConnectGuideBgImage",rotation:{func:function(){return Xm.ConnectGuide.data.rotation}},rect:{func:function(){var R=Xm.ConnectGuide.data.connect;R.x,R.y;var l=mo.getStyle("connectGuideIntersectSize");return[[R.x,R.y],2*l,2*l]}}},{type:"image",name:"Icons.ConnectGuideHeaderImage",rect:{func:function(){var T=Xm.ConnectGuide.data.cursorPos||Xm.ConnectGuide.data.connect,K=mo.getStyle("connectGuideIntersectSize");return[[T.x,T.y],2*K-2,2*K-2]}}},{type:"shape",background:null,borderColor:"#3399ff",borderWidth:2,segments:[1,4],points:{func:function(){var Y=Xm.ConnectGuide.data.connect,g=Xm.ConnectGuide.data.cursorPos||Y;return[Y.x,Y.y,Y.x+.5*(g.x-Y.x),Y.y,g.x+.5*(Y.x-g.x),g.y,g.x,g.y]}}}]},D.Default.setImage("Icons.ConnectGuideGarbageImage",{width:48,height:48,comps:[{type:"oval",background:"rgba(0,0,0,0.1)",borderColor:"#979797",shadowColor:"#1ABC9C",rect:[0,0,48,48]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[19.84721,19.69091,19.84721,32.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[24.10371,19.69091,24.10371,32.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[28.15279,19.69091,28.15279,32.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[11.23055,15.22377,36.76945,15.189,19.12302,15.17121,20.94722,11.5228,26.41985,11.5228,28.24406,15.17121]},{type:"rect",borderWidth:2,borderColor:"rgb(255,255,255)",shadowColor:"#1ABC9C",rect:[15.48702,15.22377,17.02595,21.25344]}]}),D.Default.setImage("Icons.ConnectGuideDeletingImage",{width:56,height:56,comps:[{type:"oval",background:"rgba(232,0,0,0.75)",borderColor:"#979797",shadowColor:"#1ABC9C",rect:[0,0,56,56]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[22.67939,27.69091,22.67939,40.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[26.93588,27.69091,26.93588,40.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[30.98497,27.69091,30.98497,40.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",anchorX:0,anchorY:1,rotation:5.65062,points:[14.06272,23.22377,39.60163,23.189,21.9552,23.17121,23.7794,19.5228,29.25203,19.5228,31.07623,23.17121]},{type:"rect",borderWidth:2,borderColor:"rgb(255,255,255)",shadowColor:"#1ABC9C",rect:[18.3192,23.22377,17.02595,21.25344]}]}),Xm.ConnectGuideGarbage={comps:[{type:"image",name:{func:function(){var h=Xm.ConnectGuideGarbage.data.hover;return h?"Icons.ConnectGuideDeletingImage":"Icons.ConnectGuideGarbageImage"}},rect:{func:function(){var H=Xm.ConnectGuideGarbage.data,j=mo.getStyle("connectGuideGarbageIntersectsize");return H.hover&&(j+=5),[[H.x,H.y],2*j,2*j]}}}]};var Ge=6;Xm.ShapeActivingCtrl={comps:[{type:"shape",visible:{func:function(){return Xm.ShapeActivingCtrl.data.c1?!0:!1}},points:{func:function(){var d=Xm.ShapeActivingCtrl.data;return[d.point.x,d.point.y,d.c1.x,d.c1.y]}},segments:[1,2],background:null,borderWidth:1,borderColor:"#707070"},{type:"shape",visible:{func:function(){return Xm.ShapeActivingCtrl.data.c2?!0:!1}},points:{func:function(){var n=Xm.ShapeActivingCtrl.data;return[n.point.x,n.point.y,n.c2.x,n.c2.y]}},segments:[1,2],background:null,borderWidth:1,borderColor:"#707070"},{type:"shape",visible:{func:function(){return Xm.ShapeActivingCtrl.data.c1?!0:!1}},points:{func:function(){var e=Xm.ShapeActivingCtrl.data.c1,I=e.x,y=e.y,d=Ge/2;return"c1"===Xm.ShapeActivingCtrl.data.hl&&(d+=.5),[I-d,y-d,I-d,y+d,I+d,y+d,I+d,y-d]}},segments:[1,2,2,2,5],borderWidth:2,background:{func:function(){return mo.getStyle("shapeCtrlPointBackground")}},borderColor:{func:function(){return"c1"===Xm.ShapeActivingCtrl.data.hl?mo.getStyle("shapeCtrlPointHighlightBorder"):mo.getStyle("shapeCtrlPointBorderColor")}}},{type:"shape",visible:{func:function(){return Xm.ShapeActivingCtrl.data.c2?!0:!1}},points:{func:function(){var O=Xm.ShapeActivingCtrl.data.c2,z=O.x,M=O.y,_=Ge/2;return"c2"===Xm.ShapeActivingCtrl.data.hl&&(_+=.5),[z-_,M-_,z-_,M+_,z+_,M+_,z+_,M-_]}},segments:[1,2,2,2,5],borderWidth:2,background:{func:function(){return mo.getStyle("shapeCtrlPointBackground")
}},borderColor:{func:function(){return"c2"===Xm.ShapeActivingCtrl.data.hl?mo.getStyle("shapeCtrlPointHighlightBorder"):mo.getStyle("shapeCtrlPointBorderColor")}}}]},Oq.Icons.DrawIcon=function(m,X,o,E){o.width=o.height=Oc,o.data=E,mo=m,D.Default.drawImage(X,o,0,0,Oc,Oc)},Oq.Icons.MapPoints=function(b,s){for(var k=0,X=b.length;X>k;k++)b[k]/=s},Oq.roundTo=function(P,X,A){var j=Math.abs(P%X);return A>j||A>X-j?X*Math.round(P/X):P},Oq.toFixed=function(H){return Math.round(100*H)/100},Oq.getDataMatrix=function(r){if(r instanceof D.Shape){var M=new Oq.Math.Matrix2,_=r.getPosition();return M.translate(-_.x,-_.y).scale(r.getScale().x,r.getScale().y).rotate(r.getRotation()).translate(_.x,_.y),M}return r.getMatrix?r.getMatrix():new Oq.Math.Matrix2},Math.sign===R&&(Math.sign=function(c){return 0>c?-1:c>0?1:+c});var Zg=Oq.Math.Matrix2=function(){this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0};Zg.prototype={},Zg.prototype.constructor=Zg,Zg.prototype.set=function(f,l,w,p,c,Q){return this.a=f,this.b=l,this.c=w,this.d=p,this.tx=c,this.ty=Q,this},Zg.prototype.apply=function(_,v){v=v||new vs;var U=_.x,m=_.y;return v.x=this.a*U+this.c*m+this.tx,v.y=this.b*U+this.d*m+this.ty,v},Zg.prototype.applyInverse=function(L,z){z=z||new vs;var _=1/(this.a*this.d+this.c*-this.b),d=L.x,m=L.y;return z.x=this.d*_*d+-this.c*_*m+(this.ty*this.c-this.tx*this.d)*_,z.y=this.a*_*m+-this.b*_*d+(-this.ty*this.a+this.tx*this.b)*_,z},Zg.prototype.translate=function(Z,P){return this.tx+=Z,this.ty+=P,this},Zg.prototype.scale=function(W,N){return this.a*=W,this.d*=N,this.c*=W,this.b*=N,this.tx*=W,this.ty*=N,this},Zg.prototype.rotate=function(i){var Q=Math.cos(i),c=Math.sin(i),x=this.a,m=this.c,O=this.tx;return this.a=x*Q-this.b*c,this.b=x*c+this.b*Q,this.c=m*Q-this.d*c,this.d=m*c+this.d*Q,this.tx=O*Q-this.ty*c,this.ty=O*c+this.ty*Q,this},Zg.prototype.append=function(o){var Q=this.a,f=this.b,G=this.c,H=this.d;return this.a=o.a*Q+o.b*G,this.b=o.a*f+o.b*H,this.c=o.c*Q+o.d*G,this.d=o.c*f+o.d*H,this.tx=o.tx*Q+o.ty*G+this.tx,this.ty=o.tx*f+o.ty*H+this.ty,this},Zg.prototype.setTransform=function(h,B,y,I,k,F,L,U,v){var x,r,b,t,o,$,K,g,R,H;return o=Math.sin(L),$=Math.cos(L),K=Math.cos(v),g=Math.sin(v),R=-Math.sin(U),H=Math.cos(U),x=$*k,r=o*k,b=-o*F,t=$*F,this.a=K*x+g*b,this.b=K*r+g*t,this.c=R*x+H*b,this.d=R*r+H*t,this.tx=h+(y*x+I*b),this.ty=B+(y*r+I*t),this},Zg.prototype.prepend=function(V){var L=this.tx;if(1!==V.a||0!==V.b||0!==V.c||1!==V.d){var U=this.a,w=this.c;this.a=U*V.a+this.b*V.c,this.b=U*V.b+this.b*V.d,this.c=w*V.a+this.d*V.c,this.d=w*V.b+this.d*V.d}return this.tx=L*V.a+this.ty*V.c+V.tx,this.ty=L*V.b+this.ty*V.d+V.ty,this},Zg.prototype.invert=function(){var q=this.a,X=this.b,Q=this.c,K=this.d,z=this.tx,V=q*K-X*Q;return this.a=K/V,this.b=-X/V,this.c=-Q/V,this.d=q/V,this.tx=(Q*this.ty-K*z)/V,this.ty=-(q*this.ty-X*z)/V,this},Zg.prototype.identity=function(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this},Zg.prototype.clone=function(){var E=new Zg;return E.a=this.a,E.b=this.b,E.c=this.c,E.d=this.d,E.tx=this.tx,E.ty=this.ty,E},Zg.prototype.copy=function(e){return e.a=this.a,e.b=this.b,e.c=this.c,e.d=this.d,e.tx=this.tx,e.ty=this.ty,e},Zg.IDENTITY=new Zg,Zg.TEMP_MATRIX=new Zg;var vs=Oq.Math.Vector2=function(B,N,X){"object"==typeof B&&(B.x!=R?(N=B.y,B=B.x,X=B.e):(X=B[2],N=B[1],B=B[0])),this.set(B||0,N||0,X)};vs.prototype={},vs.prototype.constructor=vs,h.defineProperties(vs.prototype,{width:{get:function(){return this.x},set:function(w){this.x=w}},height:{get:function(){return this.y},set:function(u){this.y=u}}}),vs.prototype.clone=function(){return new vs(this.x,this.y,this.e)},vs.prototype.copy=function(S){return this.set(S.x,S.y,S.e),this},vs.prototype.equals=function(h){return h.x===this.x&&h.y===this.y},vs.prototype.set=function(l,x,c){return this.x=l||0,this.y=x||(0!==x?this.x:0),c!=R&&(this.e=c),this},vs.prototype.setScalar=function(Q){return this.x=Q,this.y=Q,this},vs.prototype.setX=function(n){return this.x=n||0,this},vs.prototype.setY=function(h){return this.y=h||0,this},vs.prototype.add=function(v){return this.x+=v.x,this.y+=v.y,this},vs.prototype.addVectors=function(x,u){return this.x=x.x+u.x,this.y=x.y+u.y,this},vs.prototype.addScalar=function(L){return this.x+=L,this.y+=L,this},vs.prototype.addScaledVector=function(N,c){return this.x+=N.x*c,this.y+=N.y*c,this},vs.prototype.sub=function(y){return this.x-=y.x,this.y-=y.y,this},vs.prototype.subScalar=function(J){return this.x-=J,this.y-=J,this},vs.prototype.subVectors=function(j,e){return this.x=j.x-e.x,this.y=j.y-e.y,this},vs.prototype.multiply=function(V){return this.x*=V.x,this.y*=V.y,this},vs.prototype.multiplyScalar=function(R){return this.x*=R,this.y*=R,this},vs.prototype.divide=function(W){return this.x/=W.x,this.y/=W.y,this},vs.prototype.divideScalar=function(v){return this.multiplyScalar(1/v)},vs.prototype.min=function(C){return this.x=Math.min(this.x,C.x),this.y=Math.min(this.y,C.y),this},vs.prototype.max=function(D){return this.x=Math.max(this.x,D.x),this.y=Math.max(this.y,D.y),this},vs.prototype.clamp=function(r,L){return this.x=Math.max(r.x,Math.min(L.x,this.x)),this.y=Math.max(r.y,Math.min(L.y,this.y)),this},vs.prototype.clampScalar=function(){var l,q;return function(I,h){return l===R&&(l=new vs,q=new vs),l.set(I,I),q.set(h,h),this.clamp(l,q)}}(),vs.prototype.clampLength=function(t,S){var f=this.length();return this.multiplyScalar(Math.max(t,Math.min(S,f))/f)},vs.prototype.dot=function(Y){return this.x*Y.x+this.y*Y.y},vs.prototype.lengthSq=function(){return this.x*this.x+this.y*this.y},vs.prototype.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},vs.prototype.normalize=function(){return this.divideScalar(this.length())},vs.prototype.angle=function(){var i=Math.atan2(this.y,this.x);return 0>i&&(i+=2*Math.PI),i},vs.prototype.distanceTo=function(G){return Math.sqrt(this.distanceToSquared(G))},vs.prototype.distanceToSquared=function(l){var H=this.x-l.x,I=this.y-l.y;return H*H+I*I},vs.prototype.isNearEnough=function(f){return this.distanceToSquared(f)<1e-8},vs.prototype.setLength=function(P){var $=this.length();return $?this.multiplyScalar(P/$):this},vs.prototype.lerp=function(K,A){return this.x+=(K.x-this.x)*A,this.y+=(K.y-this.y)*A,this},vs.prototype.lerpVectors=function(A,q,G){return this.subVectors(q,A).multiplyScalar(G).add(A)},vs.prototype.rotateAround=function(d,L){var c=Math.cos(L),O=Math.sin(L),R=this.x-d.x,t=this.y-d.y;return this.x=R*c-t*O+d.x,this.y=R*O+t*c+d.y,this};var yg=Oq.Math.Curve=function(){this._curves=[]};yg.prototype={},yg.prototype.constructor=yg,yg.prototype.createFromHtShape=function(X,E,F){E instanceof D.List&&(E=E.toArray());var T,y,w,v,K,$,L,e=this,p=null,o=null,k=0,J=Oq.Math.Vector2,U=Oq.Math.CubicBezier,h=function(e){return new J(X[e],X[e+1],F?F[e/2]:R)};for(y=0,w=E.length;w>y;y++){switch(v=E[y],K=null,v){case 1:o=h(k),p=o,k+=2;break;case 2:T=h(k),k+=2,K=new U(o,o.clone(),T.clone(),T),o=T;break;case 3:$=h(k),T=h(k+2),k+=4,K=new U(o,$.clone().sub(o).multiplyScalar(2/3).add(o),$.clone().sub(T).multiplyScalar(2/3).add(T),T),o=T;break;case 4:$=h(k),L=h(k+2),T=h(k+4),k+=6,K=new U(o,$,L,T),o=T;break;case 5:if(!p)break;K=new U(o,o.clone(),p.clone(),p),o=null,p=null}K&&(K._index=e._curves.length,e._curves.push(K))}},yg.prototype.checkPoint=function(v,j){var $,M,t,f,I,x=this,m=x._curves;for($=0,M=m.length;M>$;$++)if(f=m[$],I=f.intersectRect(v,j,j),I.length)return t=0,I.forEach(function(x){t+=x.t}),t/=I.length,v=f.getPointAt(t),v.t=t,{bezier:f,intersection:v}},yg.prototype.insertKnot=function(n,o){var r=n.insertKnot(o),J=this,p=J._curves;p.splice(n._index,1,r[0],r[1])},yg.prototype._isCloseEnough=function(s,O){return Math.abs(s.x-O.x)<1e-6&&Math.abs(s.y-O.y)<1e-6},yg.prototype._isSamePoint=function(E,z){return E===z},yg.prototype.moveRealPoint=function(p,M){var L=this,z=L._curves,K=M.clone().sub(p);z.forEach(function(O){var T=O._p1;O._p2,O._p3;var Y=O._p4;L._isSamePoint(T,p)&&(O._p2.add(K),O._p1=M),L._isSamePoint(Y,p)&&(O._p3.add(K),O._p4=M)})},yg.prototype.moveCtrlDueToRealPointMovement=function(W,U){var d=this,f=d._curves,n=function(q){q.add(U),q.e&&U.e&&(q.e+=U.e)};f.forEach(function(l){var i=l._p1;l._p2,l._p3;var e=l._p4;d._isSamePoint(i,W)&&n(l._p2),d._isSamePoint(e,W)&&n(l._p3)})},yg.prototype.moveCtrlPoint=function(u,V,M){var o=u[M];if(o){o.e!==R&&(V.e=o.e);var A=this,p=A._curves;V.clone().sub(o),p.forEach(function(J){var f;"c2"===M?f="_p2":"c1"===M&&(f="_p3"),A._isSamePoint(J[f],o)&&(J[f]=V)}),u[M]=V}},yg.prototype.deleteRealPoint=function(p,G){var g,I,J,k,K,T,A,w=this,s=w._curves,O={},l=[],x=Oq.Math.CubicBezier;for(I=0,J=s.length;J>I;I++)g=s[I],k=g._p1,K=g._p2,T=g._p3,A=g._p4,(O[I]||!w._isSamePoint(k,p))&&(w._isSamePoint(A,p)?J>I+1&&w._isSamePoint(s[I+1]._p1,p)&&(G||l.push(new x(k,K,s[I+1]._p3,s[I+1]._p4))):l.push(g));w._curves=l},yg.prototype.findPairs=function(_,v){var i,B,W,L,b,g,x,e,c=this,S=c._curves,Z={},n=[];for(B=0,W=S.length;W>B;B++)i=S[B],L=i._p1,b=i._p2,g=i._p3,x=i._p4,!Z[B]&&c._isSamePoint(L,_)&&(v?n.push({point:L,r2:x}):n.push({point:L,c2:b})),c._isSamePoint(x,_)&&(e=v?{point:x,r1:L}:{point:x,c1:g},W>B+1&&c._isSamePoint(S[B+1]._p1,_)&&(v?e.r2=S[B+1]._p4:e.c2=S[B+1]._p2,Z[B+1]=!0),n.push(e));return n},yg.prototype.toHtShape=function(){var c=this,C=c._curves,f=[],w=[],m={x:1/0,y:1/0};return C.forEach(function(I){var B=I._p1,d=I._p2,p=I._p3,g=I._p4;return c._isCloseEnough(B,m)||(f.push(1),w.push(B.clone())),m=g,c._isCloseEnough(B,d)&&c._isCloseEnough(p,g)?(f.push(2),w.push(g.clone()),void 0):(f.push(4),w.push(d.clone(),p.clone(),g.clone()),void 0)}),{segments:f,points:w}};var ho=Oq.Math.CubicBezier=function(k,j,J,q){var v=this;v._id=Oq.Math.CubicBezier._globalId++,v._p1=k,v._p2=j,v._p3=J,v._p4=q};ho._globalId=1,ho.prototype={},ho.prototype.constructor=ho,ho.prototype.toString=function(){return this._id},ho.prototype.intersectRect=function(X,h,j){var v=h/2,g=j/2,f=X.x,J=X.y,x=Oq.Math.Vector2,p=new x(-v+f,-g+J),_=new x(v+f,g+J),D=new x(_.x,p.y),s=new x(p.x,_.y),d=this,W=d.intersectLine(p,D),q=d.intersectLine(D,_),I=d.intersectLine(_,s),H=d.intersectLine(s,p),w=W.concat(q).concat(I).concat(H);return w},ho.prototype.intersectLine=function(p,h){var d,V,y,L,R,z,T,D,c,n,O,H,E,G=this,i=p.clone().min(h),Z=p.clone().max(h);L=G._p1,R=G._p2,z=G._p3,T=G._p4,d=L.clone().multiplyScalar(-1),V=R.clone().multiplyScalar(3),y=z.clone().multiplyScalar(-3),O=d.add(V).add(y).add(T),d=L.clone().multiplyScalar(3),V=R.clone().multiplyScalar(-6),y=z.clone().multiplyScalar(3),n=d.add(V).add(y),d=L.clone().multiplyScalar(-3),V=R.clone().multiplyScalar(3),c=d.add(V),D=L.clone(),E=new Oq.Math.Vector2(p.y-h.y,h.x-p.x),H=p.x*h.y-h.x*p.y;for(var e=G.getRoots(E.dot(O),E.dot(n),E.dot(c),E.dot(D)+H),b=new Array,Y=0,k=e.length;k>Y;Y++){var J=e[Y];if(!(0>J||J>1)){var B=L.clone().lerp(R,J),Q=R.clone().lerp(z,J),X=z.clone().lerp(T,J),m=B.lerp(Q,J),F=Q.lerp(X,J),U=m.lerp(F,J);U.t=J,p.x==h.x?i.y<=U.y&&U.y<=Z.y&&b.push(U):p.y==h.y?i.x<=U.x&&U.x<=Z.x&&b.push(U):U.x>=i.x&&U.y>=i.y&&U.x<=Z.x&&U.y<=Z.y&&b.push(U)}}return b},ho.prototype.solveTForPoint=function(C){var s,t,l,F,c=this;s=c._p1.x-C.x,t=c._p2.x-C.x,l=c._p3.x-C.x,F=c._p4.x-C.x;for(var A=c.getRoots(F-3*l+3*t-s,3*l-6*t+3*s,3*t-3*s,s),N=R,v=1/0,W=0,T=A.length;T>W;W++){var D=A[W];if(!(0>D||D>1)){var f=c._p1.clone().lerp(c._p2,D),x=c._p2.clone().lerp(c._p3,D),Q=c._p3.clone().lerp(c._p4,D),n=f.lerp(x,D),B=x.lerp(Q,D),m=n.lerp(B,D);m.t=D;var E=Math.abs(m.y-C.y);v>E&&(v=E,N=m)}}return N},ho.prototype.getPointAt=function(h){var f=this,O=f._p1,C=f._p2,j=f._p3,n=f._p4,F=O.clone().lerp(C,h),d=C.clone().lerp(j,h),z=j.clone().lerp(n,h),w=F.lerp(d,h),G=d.lerp(z,h);return w.lerp(G,h)},ho.prototype.getRoots=function(I,q,m,$){var V,k,N,c,t,J=new Array;if(Math.abs(I)<1e-6){var V=q,k=m/V,N=$/V,c=k*k-4*N;if(c>0){var t=Math.sqrt(c);J.push(.5*(-k+t)),J.push(.5*(-k-t))}else 0==c&&J.push(.5*-k)}q/=I,m/=I,$/=I,V=(3*m-q*q)/3,k=(2*q*q*q-9*m*q+27*$)/27;var h=q/3,e=k*k/4+V*V*V/27,i=k/2;if(Math.abs(e)<=1e-6&&(e=0),e>0){var x,d,t=Math.sqrt(e);x=-i+t,d=x>=0?Math.pow(x,1/3):-Math.pow(-x,1/3),x=-i-t,x>=0?d+=Math.pow(x,1/3):d-=Math.pow(-x,1/3),J.push(d-h)}else if(0>e){var Z=Math.sqrt(-V/3),s=Math.atan2(Math.sqrt(-e),-i)/3,u=Math.cos(s),T=Math.sin(s),C=Math.sqrt(3);J.push(2*Z*u-h),J.push(-Z*(u+C*T)-h),J.push(-Z*(u-C*T)-h)}else{var x;x=i>=0?-Math.pow(i,1/3):Math.pow(-i,1/3),J.push(2*x-h),J.push(-x-h)}return J},ho.prototype._70I=function(){var C=this;return C._p1.distanceToSquared(C._p2)<1e-10&&C._p3.distanceToSquared(C._p4)<1e-10},ho.prototype.insertKnot=function(o){var S=this,c=S._p1,Q=S._p2,M=S._p3,N=S._p4,Z=c.clone().lerp(Q,o),y=Q.clone().lerp(M,o),x=M.clone().lerp(N,o),j=Z.clone().lerp(y,o),s=y.clone().lerp(x,o),z=j.clone().lerp(s,o);return S._70I()?(c.clone().lerp(N,o),[new Oq.Math.CubicBezier(c,c.clone(),z.clone(),z),new Oq.Math.CubicBezier(z,z.clone(),N.clone(),N)]):[new Oq.Math.CubicBezier(c,Z,j,z),new Oq.Math.CubicBezier(z,s,x,N)]};var xi=D.Default.getInternal().ui().EdgeUI,Do={_47O:function(z){var p=this,d=Do.getBackups()._47O;Oq.inEdit(p.gv)||d.call(p,z)}};Oq.Inject.registAsModule(Do,xi);var Gq=D.Default.getInternal().ui().NodeUI,Jo={_47O:function(N){var O=this,t=Jo.getBackups()._47O;Oq.inEdit(O.gv)||t.call(O,N)},getSelectWidth:function(){var R=this,I=R.gv,V=R._data;if(I.isEditable(V)&&Oq.inEdit(I))return 0;var J=Jo.getBackup("getSelectWidth");return J.call(R)}};Oq.Inject.registAsModule(Jo,Gq);var Wn=D.graph.GraphView,ee={_editPointSize:function(){var z=D.Default.isTouchable,j=Oq.getStyle("pointSize");return j[z?0:1]}(),isPointEditable:function(m){var j=this;if(Oq.inEdit(j))return j._pointEditableFunc?j._pointEditableFunc(m):!0;var Z=ee.getBackup("isPointEditable");Z.call(j,m)},isEditable:function(v){var M,n=this,B=ee.getBackup("isEditable");if(M=v instanceof Oq.Group?!0:B.call(n,v),!Oq.inEdit(n))return M;if(!(v instanceof D.Edge))return M;if(!v.s("2d.editable"))return!1;var G=n.getEditableFunc();return G?G(v):!0},_42:function(R,q){var s=this,l=ee.getBackups()._42;if(l.call(s,R,q),Oq.inEdit(s)){var S=s.getEditInteractor();S.drawImpl()}}};Oq.Inject.registAsModule(ee,Wn);var Dk=D.Default.getInternal().ui().ShapeUI,zp={_47O:function(x){var h=this,U=zp.getBackups()._47O;Oq.inEdit(h.gv)||U.call(h,x)}};Oq.Inject.registAsModule(zp,Dk);var Ff=D.graph.DefaultInteractor,Or={handle_mousewheel:function(x){var k=this,i=Or.getBackup("handle_mousewheel");Oq.inEdit(k.gv)||i.call(k,x)}};Oq.Inject.registAsModule(Or,Ff);var Qf=D.graph.MoveInteractor,Pn={_calcShift:function(y,f){var v=this,S=Pn.getBackup("_calcShift"),T=v.gv;if(!Oq.inEdit(T))return S.call(v,y,f);var j=T.getEditInteractor(),C=j.getSubModule("Move").calcShift(y,f,v);return C||S.call(v,y,f)},clear:function(f){var v=this,X=Pn.getBackup("clear");X.call(v,f);var N=v.gv;if(Oq.inEdit(N)){var J=N.getEditInteractor();J.getSubModule("Move").clear(f)}}};Oq.Inject.registAsModule(Pn,Qf);var xf=Oq.Rect=function(P){this.catalog="Rect",this._interactor=P};xf.prototype={},xf.prototype.constructor=xf,xf.prototype.gatherInfo=function(J,H){var x=this;if(1===H.length){var $=H[0];return $ instanceof D.Shape&&$._70I()?x.gatherLine(J,$):eb($,J)?!1:x.gatherSingleTarget(J,$)}return H.length>1?x.gatherMultiTargets(J,H):!1},xf.prototype.gatherSingleTarget=function(T,j){if(j.getCorners){var d,W=this,Y=W.info;W.target=j,d=W.screenInfo={};var M=j.getCorners();Y.LT=new Oq.Math.Vector2(M[0]),Y.LB=new Oq.Math.Vector2(M[1]),Y.RB=new Oq.Math.Vector2(M[2]),Y.RT=new Oq.Math.Vector2(M[3]),Y.T=Y.LT.clone().add(Y.RT).divideScalar(2),Y.B=Y.LB.clone().add(Y.RB).divideScalar(2),Y.L=Y.LT.clone().add(Y.LB).divideScalar(2),Y.R=Y.RT.clone().add(Y.RB).divideScalar(2);for(var J in Y)d[J]=Oq.toScreenPosition(T,Y[J]);var Q=W._interactor,V=Q.getStyle("checkSize"),O=function(H,k,p){var o=k.clone().sub(H).setLength(-V),C=p.clone().sub(H).setLength(-V),h=o.add(C).add(H);return h};return d.rotLT=O(d.LT,d.RT,d.LB),d.rotLB=O(d.LB,d.LT,d.RB),d.rotRB=O(d.RB,d.LB,d.RT),d.rotRT=O(d.RT,d.LT,d.RB),d.rotT=d.rotLT.clone().add(d.rotRT).divideScalar(2),d.rotB=d.rotLB.clone().add(d.rotRB).divideScalar(2),d.rotL=d.rotLT.clone().add(d.rotLB).divideScalar(2),d.rotR=d.rotRT.clone().add(d.rotRB).divideScalar(2),d.rotation=j.getRotation(),W.gatherConnectInfo(),!0}},xf.prototype.gatherConnectInfo=function(){var a=this,r=a.target,v=a._interactor,A=a.screenInfo,Q=v.gv;if(r instanceof D.Node&&v.getStyle("connectGuideVisible")){var u=r.s("connectGuideShift")||v.getStyle("connectGuideShift"),j=r.getAnchor(),R=r.getSize(),U=r.toGlobal({x:R.width*(u[0]-j.x),y:R.height*(u[1]-j.y)});U=Oq.toScreenPosition(Q,U),A.P1?U.add(A.P2.clone().sub(A.P1).setLength(u[2])):(U.add(A.RT.clone().sub(A.LT).setLength(u[2])),U.add(A.LB.clone().sub(A.LT).setLength(u[3]))),A.connect=U}},xf.prototype.gatherMultiTargets=function(v,D){var o=Oq.Group.findOrCreateGroup(D);if(!o)return!1;var C=this;return C.editing&&"rotate"!==C.editing.mode||o.calcInfo(),C.gatherSingleTarget(v,o)},xf.prototype.gatherLine=function(L,m){this.target=m;var D=this.screenInfo={},k=m.getPoints(),G=Oq.getDataMatrix(m);return D.P1=Oq.toScreenPosition(L,G.apply(k.get(0))),D.P2=Oq.toScreenPosition(L,G.apply(k.get(1))),this.gatherConnectInfo(),!0},xf.ResizeKeys=["LT","RB","LB","RT","L","R","B","T"],xf.ResizeDirection=[{x:-1,y:-1},{x:1,y:1},{x:-1,y:1},{x:1,y:-1},{x:-1,y:0},{x:1,y:0},{x:0,y:1},{x:0,y:-1}],xf.RotateKeys=["rotLT","rotRB","rotLB","rotRT","rotL","rotR","rotB","rotT"],xf.prototype.check=function(A,K,c){if(D.Default.isLeftButton(K)){var F=this;if(F.editing=null,F.tipInfo=null,F.screenInfo){var x=F.target,a=A.isEditable(x),j=F.screenInfo;if(a&&j.connect){var h=F._checkConnect(c);if(h)return h}if(j.P1)return F._checkLine(c);var C,O,R,S=null,s=F._interactor,k=s.getStyle("checkSize");if(a&&A.isRectEditable(x))for(O=0;O<Oq.Rect.ResizeKeys.length;O++)if(R=Oq.Rect.ResizeKeys[O],Oq.checkHit(c,j[R],k)){S=R,C="resize";break}if(!S&&a&&A.isRotationEditable(x)){var e=s.getStyle("rotateCheckSize");for(O=0;O<Oq.Rect.RotateKeys.length;O++)if(R=Oq.Rect.RotateKeys[O],Oq.checkHit(c,j[R],e)){S=R,C="rotate";break}}if(!S)return s.setCursor("default"),void 0;if("rotate"===C){var W,g=A.lp(K);if(x instanceof Oq.Group){var B=s.getStyle("groupRotateModeKey");"string"==typeof B&&(B=[B]);for(var T=!1,i=0,M=B.length;M>i;i++)if(K[B[i]]){T=!0;break}var Q=s.getStyle("groupRotateModeDefault");W=T?"batch"===Q?"block":"batch":Q}var P="batch"===W?x.getAnchor2():x.getPosition(),t=Math.atan2(g.y-P.y,g.x-P.x);s._setRotateCursor(t),F.editing={mode:C,key:S,pos:P,flipY:x.getScale().y<0,rotation:x.getRotation(),hitRot:t},W&&(F.editing.groupRotateMode=W)}else{var X=Oq.Rect.ResizeKeys.indexOf(S),v=Oq.Rect.ResizeDirection[X],Y=Math.cos(x.getRotation()),r=Math.sin(x.getRotation()),H=v.x*Math.sign(x.getScale().x),y=v.y*Math.sign(x.getScale().y),w=Math.atan2(-r*H-Y*y,Y*H-r*y),d=(Math.round(w/(Math.PI/4))+8)%8,o=["ew-resize","nesw-resize","ns-resize","nwse-resize","ew-resize","nesw-resize","ns-resize","nwse-resize"][d];this._interactor.setCursor(o);var G=x.getWidth(),J=x.getHeight(),I=x.getAnchor();F.editing={mode:C,key:S,rect:{x:-G*I.x,y:-J*I.y,width:G,height:J},anchor:I,matrix:x.getMatrix()}}return S}}},xf.prototype._checkLine=function(c){var $=this;$.screenInfo;var Y,V=$._interactor.getStyle("checkSize");if(Oq.checkHit(c,$.screenInfo.P1,V))Y="P1";else{if(!Oq.checkHit(c,$.screenInfo.P2,V))return this._interactor.setCursor("default"),void 0;Y="P2"}return $.editing={mode:"line",key:Y},Y},xf.prototype._checkConnect=function($){var R=this,N=R.screenInfo,S=R._interactor,w=S.getStyle("connectGuideIntersectSize");if(Oq.checkHit($,N.connect,w)){var g="connect",A=U.getConnectAction(S.gv);return R.editing={mode:g},A&&A.delete&&A.delete.visible.call(null,S.gv,R.target)&&(R.editing.hasDeleteAction=!0),S.setCursor("default"),g}},xf.prototype._fireEditEvent=function(q,I){var O=this._interactor,i=this.editing;if(i){var E=i.mode;E="rotate"===E?"Rotation":"connect"===E?"Connection":E[0].toUpperCase()+E.slice(1),O.fi({kind:q+"Edit"+E,event:I})}},xf.prototype.startEdit=function(D,N){D.startDragging(N);var g=this;g._interactor.fi({kind:"prepareEdit",event:N});var m=g.editing,B=g.target;if(m){if(g._fireEditEvent("begin",N),"rotate"===m.mode)return m.groupRotateMode&&B.beginRotate(m),void 0;if("connect"!==m.mode)("line"===m.mode||B&&0===B.getRotation())&&(g._inSmartGuide=!0,g._interactor.rectGuide.gatherRects());else if(m.hasDeleteAction){var d=D.gv,F=g._interactor.getStyle("connectGuideGarbageShift");m.garbageInfo={x:d.getWidth()*F[0]+F[2],y:d.getHeight()*F[1]+F[3],size:g._interactor.getStyle("connectGuideGarbageIntersectsize")},D._42()}}},xf.prototype._46O=function(o){var m,j=this,r=j.editing;if(r){if("connect"===r.mode&&!r.canceled&&!r.deleted)try{r.garbageInfo&&r.garbageInfo.hover?U.doDeleteConnectionAction(j._interactor.gv,j.target):U.doConnectAction(j._interactor.gv,j.target,r.target)}catch(Y){console.error(Y)}m=j.editing.groupRotateMode,j._fireEditEvent("end",o),j.editing=null}j.tipInfo=null,j._inSmartGuide&&(j._interactor.rectGuide.clear(),j._inSmartGuide=!1),m&&j.target&&j.target.endRotate()},xf.prototype.handleNormalStateDelete=function(){var g=this,D=g.editing;if(D&&"connect"===D.mode&&!D.canceled&&!D.deleted){if(D.garbageInfo){try{U.doDeleteConnectionAction(g._interactor.gv,g.target)}catch(s){console.error(s)}D.garbageInfo=null}return D.cursorPos=null,D.targetCorners=null,D.deleted=!0,g._interactor._42(),!0}},xf.prototype.handleNormalStateKeyDown=function(P){var Z=this,r=Z.editing;return!r||"connect"!==r.mode||r.canceled||r.deleted?void 0:D.Default.isEsc(P)?(r.cursorPos=null,r.targetCorners=null,r.canceled=!0,Z._interactor._42(),!0):void 0},xf.prototype.handleEdit=function(A,L){var q=this,m=q.editing;if(m){var o,O,W,l,t,N=q.target,c=m.key,E=m.mode,$=A.lp(L),b=q._interactor;if("connect"===E){if(m.canceled)return;if(m.deleted)return;m.cursorPos=b._getLogicalPoint(L);var B=m.garbageInfo;return B&&Oq.checkHit(m.cursorPos,B,B.size)?(B.hover=!0,m.target=null,m.targetCorners=null):(B&&(B.hover=!1),m.target=A.getDataAt($,function(i){return A.isSelectable(i)?Bf(i)?!0:!1:!1})||null,m.targetCorners=Oq.getTargetCornersOnScreen(A,m.target)),b._42(),void 0}if("rotate"===E){var n,e,J=m.pos,j=Math.atan2($.y-J.y,$.x-J.x);if(m.groupRotateMode?e=j-m.hitRot:(n=j-m.hitRot,e=m.rotation+n),e%=2*Math.PI,0>e&&(e+=2*Math.PI),!D.Default.isCtrlDown(L)){var r,a;Ar(L)?(r=b.getStyle("shiftRotateRound"),a=r/2):(r=b.getStyle("rotateRound"),a=b.getStyle("rotateSensitivity")),e=Oq.roundTo(e,r,a)}m.groupRotateMode?(n=e-(m.lastRotation||0),0!==n&&(N.addRotation(n,m.groupRotateMode),m.lastRotation=e)):N.setRotation(e),b._setRotateCursor(j),e>Math.PI&&(e-=2*Math.PI);var H=180*(e/Math.PI);H=H.toFixed(2),o=""+H+"°"}else if("resize"===E){var w=m.rect;W=w.x,l=w.y;var T,d=w.width,Y=w.height,s=m.anchor,C=m.matrix,R=Ar(L),V=q._unionPointMode1,p=q._unionPointMode2;if(q._inSmartGuide&&!D.Default.isCtrlDown(L)&&!R){var k;"L"===c||"R"===c?k="x":("T"===c||"B"===c)&&(k="y"),q._adsorbedToClosest($,k),t=!0}T=C.tfi($);var K;"LT"===c?(w=V(T,{x:W+d,y:l+Y},d,Y,R),K=9):"T"===c?(w=p({x:W,y:T.y},{x:W+d,y:l+Y},d,Y,R,"v"),K=1):"RT"===c?(w=V(T,{x:W,y:l+Y},d,Y,R),K=33):"L"===c?(w=p({x:T.x,y:l},{x:W+d,y:l+Y},d,Y,R,"h"),K=8):"R"===c?(w=p({x:W,y:l},{x:T.x,y:l+Y},d,Y,R,"h"),K=32):"LB"===c?(w=V(T,{x:W+d,y:l},d,Y,R),K=12):"B"===c?(w=p({x:W,y:l},{x:W+d,y:T.y},d,Y,R,"v"),K=4):"RB"===c&&(w=V(T,{x:W,y:l},d,Y,R),K=36);var u=C.tf(w.x+w.width*s.x,w.y+w.height*s.y);N.setPosition(u),N.setSize(w.width,w.height),t&&(O=N.getRect(),b.rectGuide.gatherLines({node:N,x:O.x,y:O.y,w:O.width,h:O.height},k,K)),o=""+Math.round(w.width)+" * "+Math.round(w.height)}else if("line"===E){if(Ar(L)){var M=N.getPoints(),Z="P1"===c?M.get(1):M.get(0),y={x:$.x-Z.x,y:$.y-Z.y},U=b.getStyle("shiftLineRotateRound"),f=q._shiftDirList;if(!f||q._shiftRotateRound!==U){q._shiftRotateRound=U,q._shiftDirList=f=[];for(var h=0;h<Math.PI;h+=U)f.push({x:S(h),y:X(h)})}for(var v,P=0,i=0,z=f.length;z>i;i++){var x=f[i],I=x.x*y.x+x.y*y.y;Math.abs(I)>Math.abs(P)&&(P=I,v=x)}$={x:Z.x+v.x*P,y:Z.y+v.y*P},b.rectGuide.clear()}else q._inSmartGuide&&!D.Default.isCtrlDown(L)&&(q._adsorbedToClosest($),t=!0);var G=Oq.getDataMatrix(N).applyInverse($);N.setPoint("P1"===c?0:1,G,!0);var F=N.getPoints(),_=F.get(0),g=F.get(1);W=_.x-g.x,l=_.y-g.y,o=" "+Math.round(Math.sqrt(W*W+l*l))+" ",t&&(O=N.getRect(),b.rectGuide.gatherLines({node:N,x:O.x,y:O.y,w:O.width,h:O.height}))}if(o){var Q=D.Default.getLogicalPoint(L,b._canvas);Q.x+=Oq.Icons.TipShiftX,Q.y+=Oq.Icons.TipShiftY,q.tipInfo={helperPos:Q,text:o,size:o.length}}q._fireEditEvent("between",L)}},xf.prototype._unionPointMode1=function(v,t,C,O,e){if(e&&C&&O){var x=v.x-t.x,I=v.y-t.y;Math.abs(x*O)<Math.abs(I*C)?(I=Math.sign(I)*Math.abs(x*O/C),v.y=t.y+I):(x=Math.sign(x)*Math.abs(I*C/O),v.x=t.x+x)}return D.Default.unionPoint(v,t)},xf.prototype._unionPointMode2=function(C,b,m,_,e,s){var $=D.Default.unionPoint(C,b);if(e&&m&&_){var q;"v"===s?(q=$.x+$.width/2,$.width=m*$.height/_,$.x=q-$.width/2):(q=$.y+$.height/2,$.height=_*$.width/m,$.y=q-$.height/2)}return $},xf.prototype._adsorbedToClosest=function(E,j){var W=this,b=W._interactor,p=b.rectGuide.findClosest(E,j),$=b.gridGuide.findClosest(E,j),i=1/0,F=1/0;p&&(isFinite(p.x)&&(i=p.x),isFinite(p.y)&&(F=p.y)),$&&(isFinite($.x)&&Math.abs($.x)<Math.abs(i)&&(i=$.x),isFinite($.y)&&Math.abs($.y)<Math.abs(F)&&(F=$.y)),isFinite(i)&&(E.x+=i),isFinite(F)&&(E.y+=F)},xf.prototype._42=function(X,E,O){var Z=this;Z.info={},Z.screenInfo=null;var e=Z._interactor;if(!e.editDetail&&Z.gatherInfo(E,O)){var i=Z.editing,s=i?i.groupRotateMode:null,b=Z.screenInfo;"block"!==s&&(b.P1?Oq.Icons.DrawIcon(e,X,Oq.Icons.Line,b):Oq.Icons.DrawIcon(e,X,Oq.Icons.Rect,b),b.connect&&(Oq.Icons.DrawIcon(e,X,Oq.Icons.ConnectGuide,{rotation:b.rotation,connect:b.connect,cursorPos:i?i.cursorPos:null}),i&&(i.targetCorners&&Oq.Icons.DrawIcon(e,X,Oq.Icons.NodeHoverGuide,i.targetCorners),i.garbageInfo&&Oq.Icons.DrawIcon(e,X,Oq.Icons.ConnectGuideGarbage,i.garbageInfo))),Z.tipInfo&&Oq.Icons.DrawIcon(e,X,Oq.Icons.TipHelper,Z.tipInfo)),Z.target instanceof Oq.Group&&Z.target._42(e,X,E)}};var Ye=Oq.Anchor=function(K){this.catalog="Anchor",this._interactor=K};Ye.prototype={},Ye.prototype.constructor=Ye,Ye.prototype.gatherInfo=function(X,S){var N=this;if(1===S.length){var f=S[0];if(!f.getAnchor)return;if(f instanceof D.Shape&&f._70I())return;if(eb(f,X))return;return N.gatherSingleTarget(X,S[0])}return S.length>1?N.gatherMultiTargets(X,S):!1},Ye.prototype.gatherSingleTarget=function(s,b){var C=this;return C.info.POS=b.getPosition(),C.screenInfo.POS=Oq.toScreenPosition(s,C.info.POS),C.target=b,!0},Ye.prototype.gatherMultiTargets=function(l,R){var d=this,J=Oq.Group.findOrCreateGroup(R);return J?(d.screenInfo.POS=Oq.toScreenPosition(l,J.getAnchor2()),d.target=J,!0):!1},Ye.prototype.isVisible=function(){var L=this,h=L._interactor;if(h.getStyle("anchorVisible")===!1)return!1;var e=L.target;if(e){if(this.editing)return!0;var Q=e.getAnchor(),R=h.getStyle("anchorOutsideVisibleThreshold");if(Q.x<-R||Q.x>1+R||Q.y<-R||Q.y>1+R)return!0;var u=e.getSize(),l=e.getScale(),r=Math.min(Math.abs(u.width*l.x),Math.abs(u.height*l.y));if(r*h.gv._zoom<h.getStyle("anchorHideThreshold"))return!1}return!0},Ye.prototype.check=function(d,v,S){if(D.Default.isLeftButton(v)){var E=this,q=E._interactor;if(E.isVisible()&&q.getStyle("anchorMovable")!==!1){E.editing=null,E.tipInfo=null;var h=E.target;if(h&&d.isAnchorEditable(h)&&d.isEditable(h)){var Q;if(E.screenInfo&&(Q=E.screenInfo.POS)&&Oq.checkHit(S,new Oq.Math.Vector2(Q),q.getStyle("checkSize"))){if(h instanceof Oq.Group)return E.editing={},!0;var n=h.getWidth(),g=h.getHeight(),l=h.getAnchor();return E.editing={rect:{x:-n*l.x,y:-g*l.y,width:n,height:g},anchor:l,matrix:h.getMatrix()},!0}}}}},Ye.prototype.startEdit=function(i,t){i.startDragging(t),i.fi({kind:"beginEditAnchor",event:t})},Ye.prototype._46O=function(l){var n=this;n.editing&&(n.editing=null,n._interactor.fi({kind:"endEditAnchor",event:l})),n.tipInfo=null},Ye.prototype.handleEdit=function(J,l){var C=this,v=C.target;if(v){var H=C.editing;if(H){var K=J.lp(l),z=C._interactor;if(v instanceof Oq.Group)return v.setAnchor2(K),z._42(),void 0;var W=H.matrix,R=W.tfi(K),I=H.rect,B=(R.x-I.x)/I.width,M=(R.y-I.y)/I.height;if(!D.Default.isCtrlDown(l)){var e=z.getStyle("anchorRound"),b=z.getStyle("anchorSensitivity");B=Oq.roundTo(B,e,b),M=Oq.roundTo(M,e,b)}v.setAnchor(B,M,!0);var X=D.Default.getLogicalPoint(l,z._canvas);X.x+=Oq.Icons.TipShiftX,X.y+=Oq.Icons.TipShiftY;var Z=""+B.toFixed(2)+", "+M.toFixed(2);C.tipInfo={helperPos:X,text:Z,size:Z.length},z.fi({kind:"betweenEditAnchor",event:l})}}},Ye.prototype._42=function(S,w,k){var F=this;F.info={},F.screenInfo={};var h=F._interactor;h.editDetail||F.gatherInfo(w,k)&&F.isVisible()&&(Oq.Icons.DrawIcon(h,S,Oq.Icons.Anchor,F.screenInfo),F.tipInfo&&Oq.Icons.DrawIcon(h,S,Oq.Icons.TipHelper,F.tipInfo))};var yg=Oq.Curve=function(F){this.catalog="Curve",this._interactor=F};yg.prototype={},yg.prototype.constructor=yg,h.defineProperties(yg.prototype,{activing:{get:function(){return this._activing},set:function(A){var x=this;if(A)x._activing=new Oq.CurveActiving(this,A);else{var w=x._activing;w&&w.dispose(),x._activing=null}}}}),yg.PointType={Mirrored:0,Straight:1,Disconnected:2,Asymmetric:3},yg.prototype.setUp=function(){var R=this,U=R._interactor;U&&U.gv.mp(R._onGraphviewPropertyChanged,R)},yg.prototype._onGraphviewPropertyChanged=function(d){("zoom"===d.property||"translateX"===d.property||"translateY"===d.property)&&this._handleDataChanged()},yg.prototype.tearDown=function(){var J=this,T=J._interactor;T&&T.gv.ump(J._onGraphviewPropertyChanged,J)},yg.prototype.canEnterEditDetailMode=function(){var O=this,H=O._interactor,w=H._getValidSelection();if(1===w.length){var P=w[0],J=P instanceof D.Edge;if(P instanceof D.Shape||J){if(J){var j=P.s("edge.type");if(j&&"points"!==j)return}var x=H.gv;if(x.isPointEditable(P)&&x.isEditable(P))return O.target=P,!0}}},yg.prototype.preHandleScroll=function(){var T=this.editing;return T&&T.inEdit?!0:void 0},yg.prototype.getCurrentSelectintStatus=function(){var M=this;if(M.activing&&!M.activing.selections){if(M.activing.status!=R)return M.activing.status;var y=function(g){var n=M.activing.status;M.activing.status=g,M._interactor.fp("shapePointStatus",n,g)},h=Oq.Curve.PointType,s=M.activing.point,L=M.activing.pairs;if(!L||1!==L.length)return y(h.Mirrored);var F=L[0],l=F.c1&&F.c1.isNearEnough(s),V=F.c2&&F.c2.isNearEnough(s);if(!F.c1||!F.c2)return l||V?y(h.Straight):y(h.Disconnected);if(l&&V)return y(h.Straight);if(l||V)return y(h.Asymmetric);var O=F.c1.clone().sub(s),w=F.c2.clone().sub(s);return Math.abs(O.x*w.y-O.y*w.x)>1e-5||O.x*w.x>0?y(h.Disconnected):Math.abs(O.length()-w.length())>1e-5?y(h.Asymmetric):y(h.Mirrored)}},yg.prototype.handle_keydown=function(s){var A=this;if(A._interactor.editDetail){var n=Oq.Curve.PointType;"1"===s.key?A.setCurrentSelectionStatus(n.Straight):"2"===s.key?A.setCurrentSelectionStatus(n.Mirrored):"3"===s.key?A.setCurrentSelectionStatus(n.Disconnected):"4"===s.key&&A.setCurrentSelectionStatus(n.Asymmetric)}},yg.prototype.setCurrentSelectionStatus=function(P){var t=this,Z=t.activing;if(Z){var g=t.getCurrentSelectintStatus();if(null!==g&&g!==P){Z.status=P;var e=t.activing.point,J=t.activing.pairs;if(J&&1===J.length){var l=J[0],q=t.screenInfo.curve,Y=Oq.Curve.PointType,I=function(){t._writeToHt(),t._interactor.fp("shapePointStatus",g,P)};if(P===Y.Straight)return q.moveCtrlPoint(l,e,"c1"),q.moveCtrlPoint(l,e,"c2"),I(),void 0;if(g===Y.Straight){var u=q.findPairs(e,!0),Q=u[0],B=Q.r1||e,c=Q.r2||e,D=c.clone().sub(B).multiplyScalar(.25);return q.moveCtrlPoint(l,e.clone().sub(D),"c1"),q.moveCtrlPoint(l,e.clone().add(D),"c2"),I(),void 0}var $=l.c1,X=l.c2;if($&&X){if(P===Y.Mirrored)return q.moveCtrlPoint(l,e.clone().multiplyScalar(2).sub(X),"c1"),I(),void 0;if(P===Y.Asymmetric&&g===Y.Disconnected){var C=$.clone().sub(e).length(),D=e.clone().sub(X).setLength(C).add(e);return q.moveCtrlPoint(l,D,"c1"),I(),void 0}}Z._firePointChange(),t._interactor.fp("shapePointStatus",g,P)}}}},yg.prototype._handleDataChanged=function(Z){var S=this;if(S.screenInfo&&S.target){var W=S._interactor;S.gatherSingleTarget(W.gv,S.target,!0),S.check(W.gv,null,Z?W._getLogicalPoint(Z):new Oq.Math.Vector2(W._lastClientPoint)),W._42()
}},yg.prototype.gatherSingleTarget=function(y,k,j){var X,l,I=this;I.screenInfo&&I.screenInfo.curve&&(l=I.screenInfo.curve._curves);var z=I.editing;X=z?I.screenInfo:I.screenInfo={};var T,E,r=k instanceof D.Edge;r?(T=k.s("edge.segments"),E=k.s("edge.points")||new D.List):(T=k._58O,E=k._59O),X.S=T;var O,o=X.P=[],Q=Oq.getDataMatrix(k);if(k instanceof D.Polyline&&(O=k.getElevation()||0,X.E=[]),E.each(function(n){X.E&&X.E.push(n.e||O),n=Q.apply(n);var z=Oq.toScreenPosition(y,n);o.push(z.x,z.y)}),r){var K=Oq.toScreenPosition(y,k._lastSourcePoint),t=Oq.toScreenPosition(y,k._lastTargetPoint);o.splice(0,0,K.x,K.y),o.push(t.x,t.y)}if(!X.S||!X.S.size()){X.S=new D.List,X.S.add(1);for(var q=0;q<o.length/2-1;q++)X.S.add(2)}if((!z||j)&&I.convertToCubicBezier(l),I.activing&&(j||!I.editing||"realPoint"===I.editing.type)){var A=X.curve.findPairs(I.activing.point);I.activing.pairs=A}r&&"points"!==k.s("edge.type")&&I._writeToHt()},yg.prototype._convertToNewPoint=function(T,K,j){var Y,Z,p;for(Y=0,Z=K.length;Z>Y;Y++){if(p=K[Y],p._p1.isNearEnough(T))return p._p1;if(p._p4.isNearEnough(T))return p._p4}if(j)for(Y=0,Z=Math.min(j.length,Z);Z>Y;Y++){if(p=j[Y],p._p1===T)return K[Y]._p1;if(p._p4===T)return K[Y]._p4}},yg.prototype.convertToCubicBezier=function(U){var h,q,_=this,G=new Oq.Math.Curve,s=_.screenInfo;if(G.createFromHtShape(s.P,s.S,s.E),s.curve=G,_.activing){var P=G._curves;if(h=_.activing.point,q=_._convertToNewPoint(h,P,U),q&&(_.activing.point=q),_.activing.selections){var y=-1,f=_.activing.selections;f.forEach(function(Z){y++,q=_._convertToNewPoint(Z,P,U),q&&(f[y]=q)})}}},yg.prototype.check=function(L,Y,$){if(!Y||D.Default.isLeftButton(Y)){var H=this;if(H._interactor.setCursor("default"),H.editing=null,H.highlight=null,H.tipInfo=null,H.screenInfo){if(Le())return H._interactor._42(),!0;if(H._checkEditCtrlPoint($))return H._interactor._42(),!0;if(H._checkEditRealPoint($))return H._interactor._42(),!0;if(H._checkEditElevation($))return H._interactor._42(),!0;var q=H.screenInfo.curve,V=q.checkPoint($,H._interactor.getStyle("curveIntersectSize"));if(V){var p=H.highlight={};p.type="insertKnot",p.bezier=V.bezier,p.point=V.intersection}return H._interactor._42(),!0}}},yg.prototype._checkEditRealPoint=function(q){var l,j,K,b,R,C,y=this,i=y.screenInfo.curve._curves,p=y._interactor.getStyle("curvePointIntersectSize"),d=1/0;for(p*=p,K=0,b=i.length;b>K;K++)l=i[K],R=l._p1,C=q.distanceToSquared(R),d>C&&(d=C,j=R),R=l._p4,C=q.distanceToSquared(R),d>C&&(d=C,j=R);if(d>p)return!1;var h=y.highlight={};return h.type="changeRealPoint",h.point=j,y.editing={type:"realPoint",point:j,shiftGuide:{point:j.clone(),dir:"x",limit:0}},y._interactor.setCursor("crosshair"),!0},yg.prototype._checkEditElevation=function(g){var h=this;if(!h._interactor.getStyle("curveElevationVisible"))return!1;var n=h.activing;if(!n)return!1;var x=n.getCurrentEditingPoint();if(!x)return!1;var w=h._interactor,E=w.getStyle("curveElevationGuideShift"),Q=w.getStyle("curveElevationIntersectSize"),R=g.distanceToSquared({x:x.x+E[0],y:x.y+E[1]});if(!(R>Q*Q)){var A=h.highlight={};A.type="elevation";var _=new Oq.Math.Vector2(g.x,g.y,x.e);return h.editing={type:"elevation",startPoint:_},h._interactor.setCursor("crosshair"),!0}},yg.prototype._checkEditCtrlPoint=function(V){var e=this;if(e.activing&&!e.activing.selections){var W=e.getCurrentSelectintStatus();if(W!==Oq.Curve.PointType.Straight){var t=e.activing.pairs;if(t){var v=e._interactor.getStyle("curvePointIntersectSize");v*=v;var T,k,J,L,H,b,F,D,Y,Q=1/0;for(F=0,Y=t.length;Y>F;F++)for(L=t[F],D=0;2>D;D++)H=0===D?"c1":"c2",L[H]&&(b=V.distanceToSquared(L[H]),Q>b&&(Q=b,T=L,k=F,J=H));if(Q>v)return!1;e.activing.hlpair=T,e.activing.hltype=J;var q=e.highlight={};return q.type="changeCtrlPoint",q.point=T[J],e.editing={type:"ctrlPoint",pair:T,pairId:k,ctrlType:J,direction:T[J].clone().sub(e.activing.point).normalize()},e._interactor.setCursor("crosshair"),!0}}}},yg.prototype.startEdit=function(T,f){T.startDragging(f);var q=this;q.highlight&&"insertKnot"===q.highlight.type&&(q.insertKnot(),q.gatherSingleTarget(q._interactor.gv,q.target),q.activing=null,q._checkEditRealPoint(q._interactor._getLogicalPoint(f)));var V=q._activing;if(V){var s=q.editing?q.editing.type:null;"ctrlPoint"===s?V.editingCtrl={pairId:q.editing.pairId,type:V.hltype}:"realPoint"===s&&(V.editingCtrl=!1)}var I=q.highlight,c=D.Default.isCtrlDown(f);if(!I||Le()){var Q=q._interactor.gv;if(!Q.setFocus(f)||Q._scrolling)return;return Q.isPannable()&&xm(f)&&!c&&(q._pan={tx:Q.tx(),ty:Q.ty()},T.fi({kind:"beginPan",event:f})),void 0}if("changeRealPoint"===I.type){var h,y=q.activing?q.activing.point:null,l=q.activing?q.activing.selections:null;if(c&&q.activing)y===I.point?(l?(q.activing={point:l[0]},l.length>1&&(l.splice(0,1),q.activing.selections=l)):q.activing=null,q.editing=null):l&&(h=l.indexOf(I.point))>=0?(l.length>1?l.splice(h,1):delete q.activing.selections,q.editing=null):l?(l.push(y),q.activing={point:I.point,selections:l}):q.activing={point:I.point,selections:[y]};else if(l)y===I.point||((h=l.indexOf(I.point))>=0?(l.splice(h,1,y),q.activing={point:I.point,selections:l}):q.activing={point:I.point});else{var e;y===I.point&&(e=q.activing.status),q.activing={point:I.point},e&&(q.activing.status=e)}T.fi({kind:"beginEditPoint",event:f})}},yg.prototype.insertKnot=function(){var E=this,X=E.highlight,H=E.screenInfo.curve;H.insertKnot(X.bezier,X.point.t),E._writeToHt()},yg.prototype._writeToHt=function(){var W,n,w,M,h=this,f=h.screenInfo.curve,d=f.toHtShape(),O=d.points,F=[],$=d.segments,B=h._interactor.gv,Q=h.target,j=Q instanceof D.Edge,s=Oq.getDataMatrix(Q).invert();M=Q instanceof D.Polyline,M&&(w=Q.getElevation());for(var u=0,U=O.length;U>u;u++)W=O[u],n=Oq.toWorldPosition(B,W),n=s.apply(n),W.e!=R&&W.e!==w&&(n.e=W.e),F.push(n);if(Q._writing=!0,j){Q.s("edge.type","points"),Q.setStyle("edge.segments",$),Q.setStyle("edge.points",F.slice(1,F.length-1)),Q.setStyle("edge.source.offset.x",0),Q.setStyle("edge.source.offset.y",0),Q.setStyle("edge.target.offset.x",0),Q.setStyle("edge.target.offset.y",0);var y=h._nextChangeEdgeHost;delete h._nextChangeEdgeHost,y&&("source"===y.type?Q.setSource(y.host):Q.setTarget(y.host)),h._writeEdgeHostAnchor("source",F[0]),h._writeEdgeHostAnchor("target",F[F.length-1])}else F.length?(Q.setSegments($),Q.setPoints(F,!0)):Q.removeFromDataModel();delete Q._writing},yg.prototype._writeEdgeHostAnchor=function(z,y){var O=this,X=O.target,E=O._calcHostAnchor(X,z,y);X.s("edge."+z+".anchor.x",E.x),X.s("edge."+z+".anchor.y",E.y)},yg.prototype._calcHostAnchor=function(H,V,R,X){X||(X="source"===V?H.getSource():H.getTarget());var C=X.getRotation(),b=X.getAnchor(),a=this._interactor.gv;if(eb(X,a)&&(C=0),C){var y=X.getMatrix(),O=y.tfi(R),A=X.getSize();return{x:O.x/A.width+b.x,y:O.y/A.height+b.y}}var T=sb(a,X),G={x:(R.x-T.x)/T.width,y:(R.y-T.y)/T.height};return G},yg.prototype._handlePanning=function(h){var L=this,S=L._pan;if(S){S.started=!0;var x=L._interactor,o=x.gv,q=x._lastClientPoint,g=kq(h);o.setTranslate(S.tx+g.x-q.x,S.ty+g.y-q.y),L.gatherSingleTarget(x.gv,L.target),x._42(),x.fi({kind:"betweenPan",event:h})}},yg.prototype.handleEdit=function(K,h){var l=this,q=l.editing;if(l._pan)return l._handlePanning(h),void 0;if(q){q.inEdit=!0;var x,M,z,H=l._interactor._getLogicalPoint(h),g=D.Default.isCtrlDown(h),v=D.Default.isShiftDown(h),I=q.type,a=l.activing;if(l._guideInfo=null,"ctrlPoint"===I&&v){var W=l.editing.direction.clone();x=a.point;var c=W.dot(H.clone().sub(x));H=W.setLength(c).add(x)}else if("ctrlPoint"===I||"realPoint"===I){var W;if("realPoint"===I&&v){var T=l.editing.shiftGuide;M=T.point;var b=Math.abs(H.x-M.x),Z=Math.abs(H.y-M.y);b>Z&&b>T.limit&&"y"===T.dir&&(T.dir="x"),Z>b&&Z>T.limit&&"x"===T.dir&&(T.dir="y"),W=T.dir,"x"===W?(H.y=M.y,T.limit=Math.max(T.limit,b)):"y"===W&&(H.x=M.x,T.limit=Math.max(T.limit,Z))}var J=l._isEditEdgeSourceTarget();if(J){var B=l._editEdgeSourceTarget(J,H,g);B&&(z=B.tipText)}else if(!g){var p=l._guidingToEdit(H,W),V="realPoint"===I?l._interactor.gridGuide.findClosest(H,W,!0):null,U=1/0,t=1/0;V&&(V.x&&(U=V.x),V.y&&(t=V.y));var F=!1;p&&(p.xList&&(Math.abs(p.x)<=Math.abs(U)?(F=!0,U=p.x):delete p.xList),p.yList&&(Math.abs(p.y)<=Math.abs(t)?(F=!0,t=p.y):delete p.yList),F&&(l._guideInfo=p)),isFinite(U)&&(H.x+=U),isFinite(t)&&(H.y+=t),F&&(p.v=H)}}var n=l.screenInfo.curve;if("realPoint"===q.type){x=q.point,x.e!==R&&(H.e=x.e),n.moveRealPoint(x,H),q.point=H,l.highlight.point=H;var m=a.status,j=a.selections;if(l.activing={point:H,status:m},j){var S=H.clone().sub(x),P=0;j.forEach(function(x){var E=x.clone().add(S);n.moveRealPoint(x,E),j[P++]=E}),l.activing.selections=j}}else if("ctrlPoint"===q.type){var X=a.pairs,E=X[q.pairId];n.moveCtrlPoint(E,H,q.ctrlType);var k=a.status,s=Oq.Curve.PointType;if((k===s.Mirrored||k===s.Asymmetric)&&E.c1&&E.c2){var x=new Oq.Math.Vector2(a.point),f="c1"===q.ctrlType?"c2":"c1";if(k===Oq.Curve.PointType.Mirrored)n.moveCtrlPoint(E,x.clone().multiplyScalar(2).sub(H),f);else if(k===s.Asymmetric){var c=E[f].clone().sub(x).length(),y=x.clone().sub(E[q.ctrlType]).setLength(c).add(x);isNaN(y.x)||n.moveCtrlPoint(E,y,f)}}a._firePointChange()}else if("elevation"===q.type){M=q.startPoint;var o=M.e+(M.y-H.y)/K._zoom;l._setCurrentPointImpl("e",o),a._firePointChange(),z="E: "+Oq.toFixed(o)}var G=D.Default.getLogicalPoint(h,l._interactor._canvas);if(G.x+=Oq.Icons.TipShiftX,G.y+=Oq.Icons.TipShiftY,!z){var u=Oq.toWorldPosition(K,H);z=""+Oq.toFixed(u.x)+", "+Oq.toFixed(u.y)}l.tipInfo={helperPos:G,text:z,size:z.length},l._writeToHt(),l._interactor.fi({kind:"betweenEditPoint",event:h})}},yg.prototype._setCurrentPointImpl=function(w,U){var Y=this,o=Y._activing;if(!o)return!1;var k=Y.target;if(!k)return!1;var n=o.getCurrentEditingPoint();if(!n)return!1;var e=o.editingCtrl;if(!e)var u=n.clone();if("e"===w)n.e=U;else{var I;if("x"===w||"y"===w){var v=o._lastFirePoint;I="x"===w?{x:U,y:v?v.y:0}:{x:v?v.x:0,y:U}}else"object"==typeof w?(I=w,w.e!==R&&(n.e=w.e)):(I={x:arguments[0],y:arguments[1]},arguments[2]!==R&&(n.e=arguments[2]));var L=Oq.getDataMatrix(k);I=Oq.toScreenPosition(Y._interactor.gv,L.apply(I)),n.x=I.x,n.y=I.y}if(!e){var H=u.multiplyScalar(-1).add(n);n.e&&u.e&&(H.e=n.e-u.e),Y.screenInfo.curve.moveCtrlDueToRealPointMovement(n,H)}return!0},yg.prototype.setCurrentPoint=function(H,f){return this._setCurrentPointImpl(H,f)?(this._writeToHt(),!0):!1},yg.prototype._isEditEdgeSourceTarget=function(){var p=this,c=p.target;if(!(c instanceof D.Edge))return!1;var z=p.editing.point,o=p.screenInfo.curve._curves;return z===o[0]._p1?"source":z===o[o.length-1]._p4?"target":!1},yg.prototype._editEdgeSourceTarget=function(t,o,I){var Z,D=this,N=D.target;if(Z="source"===t?N.getSource():N.getTarget()){var k=D._interactor.gv,P=Oq.toWorldPosition(k,o),p=D._calcHostAnchor(N,t,P,Z);if(!I){var E=D._interactor.getStyle("anchorRound"),h=D._interactor.getStyle("anchorSensitivity");p.x=Oq.roundTo(p.x,E,h),p.y=Oq.roundTo(p.y,E,h)}if(D._interactor.getStyle("edgeHostDetectPerFrame")||p.x<0||p.x>1||p.y<0||p.y>1){var r=k.getDataAt(P,function(D){return k.isSelectable(D)?Bf(D)?!0:!1:!1});if(r){var $=D._calcHostAnchor(N,t,P,r);Z=r,D._nextChangeEdgeHost={type:t,host:r},p=$,I||(p.x=Oq.roundTo(p.x,E,h),p.y=Oq.roundTo(p.y,E,h))}}if(!I){var m=Tj(k,Z,0,0,0,p.x,p.y),n=Oq.toScreenPosition(k,m);o.x=n.x,o.y=n.y}return D._edgeHostGuideInfo=Oq.getTargetCornersOnScreen(k,Z),{host:Z,anchor:p,tipText:""+p.x.toFixed(2)+", "+p.y.toFixed(2)}}},yg.prototype._guidingToEdit=function(z,t){var Q,C,J=this;if(Q=J.screenInfo.curve){C=Q._curves;var l,k,L,$,U,u,b,v,G=1/0,E=1/0,Y=[];for(J.editing&&"realPoint"===J.editing.type&&(v=J.editing.point),U=0,u=2*C.length;u>U;U++)b=C[Math.floor(U/2)][U%2?"_p4":"_p1"],Y.indexOf(b)>=0||(Y.push(b),v&&v===b||(L=b.x-z.x,$=b.y-z.y,Math.abs(L)<Math.abs(G)?(G=L,l=[b]):L===G&&l.push(b),Math.abs($)<Math.abs(E)?(E=$,k=[b]):$===E&&k.push(b)));var B=J._interactor.getStyle("smartGuideSensitivity");if((Math.abs(G)>B||"y"===t)&&(l=null),(Math.abs(E)>B||"x"===t)&&(k=null),l||k){var p=!1,Z={};if(l&&(p=!0,Z.xList=l,Z.x=G),k&&(p=!0,Z.yList=k,Z.y=E),p)return Z}}},yg.prototype._46O=function(m){var p=this;p.editing&&(p.editing=null,p._interactor.fi({kind:"endEditPoint",event:m})),p._guideInfo=null,p._edgeHostGuideInfo=null,p._pan&&(p._pan=null,p._interactor.fi({kind:"endPan",event:m})),p.tipInfo=null},yg.prototype._canDeletePoint=function(n,h){var e=this.target;if(!(e instanceof D.Edge))return!0;var w=n._curves[0],y=n._curves[n._curves.length-1];return w._p1===h||y._p4===h?!1:!0},yg.prototype.handleDelete=function(){var E=this;if(E.activing&&E.screenInfo){var c=D.Default.isShiftDown(),V=E.screenInfo.curve;E._canDeletePoint(V,E.activing.point)&&V.deleteRealPoint(E.activing.point,c),E.activing.selections&&E.activing.selections.forEach(function(R){E._canDeletePoint(V,R)&&V.deleteRealPoint(R,c)}),E.activing=null,delete E.editing,delete E.tipInfo,delete E._pan,E._writeToHt(),E._interactor.fp("deleteShapePoint",!1,!0)}},yg.prototype.handleDoubleClick=function(b){var v=this,I=v._interactor._getLogicalPoint(b);if(v.screenInfo&&v._checkEditRealPoint(I)){var H=v.getCurrentSelectintStatus(),A=Oq.Curve.PointType;return H=H===A.Mirrored?A.Straight:A.Mirrored,v.setCurrentSelectionStatus(H),v._interactor._42(),!0}},yg.prototype._drawHighlight=function(w){var D=this,M=D.highlight;if(M){var r=M.bezier,H=D._interactor;r&&Oq.Icons.DrawIcon(H,w,Oq.Icons.ShapeHighlightCurve,[r._p1.x,r._p1.y,r._p2.x,r._p2.y,r._p3.x,r._p3.y,r._p4.x,r._p4.y]);var Q=M.point;Q&&"insertKnot"===M.type&&Oq.Icons.DrawIcon(H,w,Oq.Icons.ShapeHighlighPoint,Q)}},yg.prototype._drawGuide=function(H){var u=this,b=u._guideInfo;if(b){var P,s,B,j,a=b.v;for(P=0;2>P;P++)if(j=0===P?b.xList:b.yList)for(s=0,B=j.length;B>s;s++)Oq.Icons.DrawIcon(u._interactor,H,Oq.Icons.ShapeGuideLine,[a.x,a.y,j[s].x,j[s].y])}},yg.prototype._drawCurrentPoint=function(a){var g=this;if(g.activing){var t=g.activing,M=g.getCurrentSelectintStatus(),e=g._interactor;if(M!==Oq.Curve.PointType.Straight){var W=t.pairs;t.hlpair,t.hltype;var U=t.selections,C=t.editingCtrl;if(W&&!U){var w,j,o;for(j=0,o=W.length;o>j;j++)w=W[j],C&&j===C.pairId&&w[C.type]?Oq.Icons.DrawIcon(e,a,Oq.Icons.ShapeActivingCtrl,{point:w.point,c1:w.c1,c2:w.c2,hl:C.type}):Oq.Icons.DrawIcon(e,a,Oq.Icons.ShapeActivingCtrl,w)}}Oq.Icons.DrawIcon(e,a,Oq.Icons.ShapeHighlighRealPoint,g.activing.point),U&&U.forEach(function(K){Oq.Icons.DrawIcon(e,a,Oq.Icons.ShapeHighlighRealPoint,K)})}},yg.prototype.clear=function(){var L=this;L.editing=null,L._guideInfo=null,L.activing=null,L.highlight=null},yg.prototype._42=function(m){var N=this;N.info={},N.editing||(N.screenInfo=null);var y=N._interactor;if(!y.editDetail)return N.clear(),void 0;if(!N.target||!N._interactor.gv.isSelected(N.target)||!N._interactor.gv.isVisible(N.target))return y.editDetail=!1,N.clear(),void 0;if(N.gatherSingleTarget(y.gv,N.target),Oq.Icons.DrawIcon(y,m,Oq.Icons.ShapeBgCurve,N.screenInfo),N._drawHighlight(m),N._drawCurrentPoint(m),N._getRealPoint().forEach(function(n){Oq.Icons.DrawIcon(y,m,Oq.Icons.ShapePoint,n)}),N._drawGuide(m),N.tipInfo&&Oq.Icons.DrawIcon(y,m,Oq.Icons.TipHelper,N.tipInfo),N._edgeHostGuideInfo&&Oq.Icons.DrawIcon(y,m,Oq.Icons.NodeHoverGuide,N._edgeHostGuideInfo),N._interactor.getStyle("curveElevationVisible")&&N.target instanceof D.Polyline&&N.activing){var v=N.activing.getCurrentEditingPoint();v&&Oq.Icons.DrawIcon(y,m,Oq.Icons.EdgeElevationGuide,v)}},yg.prototype._getRealPoint=function(){var W=this.screenInfo,L=W.P,r=W.S,Z=-1,a=[];return r.each(function(V){var N=1;if(3===V)N=2;else if(4===V)N=3;else if(5===V)return;Z+=N,a.push({x:L[2*Z],y:L[2*Z+1]})}),a};var js=Oq.MoveHelper=function(q){var y=this;y.catalog="Move",y._interactor=q};js.prototype={},js.prototype.constructor=js,js.prototype.calcShift=function(R,I,K){var $,i,e=this,Q=e._interactor.gv,t=Q.lp(I);if("beginMove"===R&&e._gatherGridInfo(K._lastLogicalPoint||t),$=e._target){var p=$.downPosition;if(p){var M=e._interactor.getStyle("moveSensitivity")/Q._zoom;if(p.distanceTo(t)<M)return{x:0,y:0};delete $.downPosition}var y;i=D.Default.isShiftDown(I),i&&(t=e._dealShiftDown(t),y=$.shiftGuide.dir);var Y,G=$.rawPos={x:$.pos.x+t.x-$.lp.x,y:$.pos.y+t.y-$.lp.y};if(D.Default.isCtrlDown(I)){if(Y=e._calcShiftByAddon(),e._target.node instanceof Oq.Group){var A=e._target.node;A._position.x+=Y.x,A._position.y+=Y.y}return Y}for(var L,H=$.x+G.x,g=$.y+G.y,P={x:H,y:g},k={x:H+$.w/2,y:g+$.h/2},n={x:H+$.w,y:g+$.h},r=e._interactor.rectGuide,N=e._interactor.gridGuide,l=[r.findClosest(P,y),r.findClosest(k,y),r.findClosest(n,y),N.findClosest(P,y),N.findClosest(k,y),N.findClosest(n,y)],U=1/0,B=1/0,j=0,u=l.length;u>j;j++)L=l[j],L&&(H=L.x,g=L.y,isFinite(H)&&Math.abs(H)<Math.abs(U)&&(U=H),isFinite(g)&&Math.abs(g)<Math.abs(B)&&(B=g));if(isFinite(U)||(U=0),isFinite(B)||(B=0),Y=e._calcShiftByAddon(U,B),e._target.node instanceof Oq.Group){var A=e._target.node;A._position.x+=Y.x,A._position.y+=Y.y}var q=$.node;if(!eb(q,Q)){var F=G.x+U,b=G.y+B;e._interactor.rectGuide.gatherLines({node:q,x:$.x+F,y:$.y+b,w:$.w,h:$.h},y)}return Y}},js.prototype._calcShiftByAddon=function(B,u){var z=this._target,F=z.rawPos,x=z.node.getPosition();return B=B||0,u=u||0,{x:F.x-x.x+B,y:F.y-x.y+u}},js.prototype._dealShiftDown=function(P){var N=this,x=N._target.shiftGuide,u=N._target.lp,Q=Math.abs(P.x-u.x),T=Math.abs(P.y-u.y);Q>T&&Q>x.limit&&"y"===x.dir&&(x.dir="x"),T>Q&&T>x.limit&&"x"===x.dir&&(x.dir="y");var z=x.dir;return"x"===z?(P.y=u.y,x.limit=Math.max(x.limit,Q)):"y"===z&&(P.x=u.x,x.limit=Math.max(x.limit,T)),P},js.prototype._gatherGridInfo=function(E){var F,_=this,k=_._interactor,d=k._getValidSelection();if(1===d.length){if(F=d[0],!F.getRect)return _._target=null,void 0}else if(F=Oq.Group.findOrCreateGroup(d),!F)return _._target=null,void 0;var S=F.getPosition(),o=F.getRect();_._target={node:F,x:o.x-S.x,y:o.y-S.y,w:o.width,h:o.height,lp:{x:E.x,y:E.y},pos:{x:S.x,y:S.y},shiftGuide:{dir:"x",limit:0},downPosition:new Oq.Math.Vector2(E)},k.rectGuide.gatherRects()},js.prototype.clear=function(){var b=this;b._interactor.rectGuide.clear(),b._interactor._42()};var gh="directional",sj="point",zi="spot",$k="light.color",Tk=function(X,y){Op(y)&&gr.test(y)?nr(X,y):Dh(y)&&y.modelType?pf(X,y):Xp[X]=y},Pb=function(u){if(Dh(u))return u;var x=Xp[u];return u&&x===R&&gr.test(u)&&(Rl&&Rl[u]||nr(u,u)),x};Gp(U,{graph3dViewAttributes:p,graph3dViewFirstPersonMode:!1,graph3dViewMouseRoamable:!0,graph3dViewMoveStep:15,graph3dViewRotateStep:V/60,graph3dViewEditHelperDisabled:!1,graph3dViewPannable:!0,graph3dViewRotatable:!0,graph3dViewWalkable:!0,graph3dViewResettable:!0,graph3dViewZoomable:!0,graph3dViewRectSelectable:!0,graph3dViewRectSelectBackground:$j,graph3dViewGridVisible:!1,graph3dViewGridSize:50,graph3dViewGridGap:50,graph3dViewGridColor:[.4,.75,.85,1],graph3dViewOriginAxisVisible:!1,graph3dViewCenterAxisVisible:!1,graph3dViewAxisXColor:[1,0,0,1],graph3dViewAxisYColor:[0,1,0,1],graph3dViewAxisZColor:[0,0,1,1],graph3dViewEditSizeColor:[1,1,0,1],graph3dViewOrtho:!1,graph3dViewOrthoWidth:2e3,graph3dViewFovy:V/4,graph3dViewNear:10,graph3dViewFar:1e4,graph3dViewEye:[0,300,1e3],graph3dViewCenter:[0,0,0],graph3dViewUp:[0,1,-1e-7],graph3dViewHeadlightRange:0,graph3dViewHeadlightColor:[1,1,1,1],graph3dViewHeadlightIntensity:1,graph3dViewHeadlightDisabled:!1,graph3dViewFogDisabled:!0,graph3dViewFogColor:"white",graph3dViewFogNear:1,graph3dViewFogFar:2e3,graph3dViewDashDisabled:!0,graph3dViewBatchBlendDisabled:!0,graph3dViewBatchBrightnessDisabled:!0,graph3dViewBatchColorDisabled:!1,setShape3dModel:Tk,getShape3dModel:Pb,createMatrix:function(x,B){vi(x)||(x=[x]);for(var d=x.length-1;d>=0;d--){var v=x[d];B=dj(v.mat,v.s3,v.r3,v.rotationMode,v.t3,B)}return B},transformVec:function(W,P){return pk(W,P)},createBoxModel:function(){return{vs:Km,ns:um,uv:hs,is:Yh}},createRoundRectModel:function(S,a){return Nq.roundRect(S,a)},createStarModel:function(B,i){return Nq.star(B,i)},createRectModel:function(L,u){return Nq.rect(L,u)},createTriangleModel:function(a,b){return Nq.triangle(a,b)},createRightTriangleModel:function(j,p){return Nq.rightTriangle(j,p)},createParallelogramModel:function(I,F){return Nq.parallelogram(I,F)},createTrapezoidModel:function(Z,r){return Nq.trapezoid(Z,r)},createSmoothSphereModel:function(Y,O,j,v,f,g,l){return ek(new Yl(Y,O,j,v,f,g,l))},createSphereModel:function(P,I,J,z,G,r){return P?ug(P,I,J,z,G,r):U.createSmoothSphereModel()},createSmoothConeModel:function(W,t,O,F,i){return Vp(W,t,O,F,i)},createConeModel:function(Q,H,i,C,o,L){return Q?sm(Q,H,i,C,o,L):Vp(L)},createSmoothCylinderModel:function(S,h,b,y,m,p,w,Y){return ek(new ns(S,h,b,y,m,p,w,Y))},createCylinderModel:function(t,U,v,u,C,N,f){return t?Di(t,U,v,u,C,N,f):ch(N,f)},createSmoothTorusModel:function(D,c,S,K,C,P){return ek(new Ah(D,c,S,K,C,P))},createTorusModel:function(B,i,E,D,l,v,H){return B?dk(B,i,E,D,l,v,H):fd(v,H)},createExtrusionModel:function(C,x,p,F,f,d,O,M){return $d(C,x,p,F,f,d,O,M)},createSmoothRingModel:function(E,D,i,B,Q,u){for(var k=[],F=0;F<E.length-1;F+=2)k.push({x:E[F],y:E[F+1]});for(E=gk(k,D,i)[0],k=[],F=0;F<E.length;F++){var H=E[F];k.push(new Ho(H.x,0,H.y))}return ek(new qs(k,u,B,Q))},createTextGeometry:function(U,L){return ek(new Bn(U,L))},loadFontFace:function(n,w){U.xhrLoad(n,function(f){if(!f)return w();var A;try{A=JSON.parse(f)}catch(s){A=JSON.parse(f.substring(65,f.length-2))}we.loadFace(A),w&&w(A.familyName.toLowerCase())},w?null:{sync:!0})},getRotationFromMatrix4:function(n,h){var E=L,s=n[0],I=n[4],f=n[8],O=n[1],b=n[5],A=n[9],o=n[2],C=n[6],V=n[10];h=h||"xyz",h=h[2]+h[1]+h[0],h=h.toUpperCase();var m={};if("XYZ"===h)m._y=Math.asin(E(f,-1,1)),Math.abs(f)<.99999?(m._x=Math.atan2(-A,V),m._z=Math.atan2(-I,s)):(m._x=Math.atan2(C,b),m._z=0);else if("YXZ"===h)m._x=Math.asin(-E(A,-1,1)),Math.abs(A)<.99999?(m._y=Math.atan2(f,V),m._z=Math.atan2(O,b)):(m._y=Math.atan2(-o,s),m._z=0);else if("ZXY"===h)m._x=Math.asin(E(C,-1,1)),Math.abs(C)<.99999?(m._y=Math.atan2(-o,V),m._z=Math.atan2(-I,b)):(m._y=0,m._z=Math.atan2(O,s));else if("ZYX"===h)m._y=Math.asin(-E(o,-1,1)),Math.abs(o)<.99999?(m._x=Math.atan2(C,V),m._z=Math.atan2(O,s)):(m._x=0,m._z=Math.atan2(-I,b));else if("YZX"===h)m._z=Math.asin(E(O,-1,1)),Math.abs(O)<.99999?(m._x=Math.atan2(-A,b),m._y=Math.atan2(-o,s)):(m._x=0,m._y=Math.atan2(f,V));else{if("XZY"!==h)return null;m._z=Math.asin(-E(I,-1,1)),Math.abs(I)<.99999?(m._x=Math.atan2(C,b),m._y=Math.atan2(f,s)):(m._x=Math.atan2(-A,V),m._y=0)}return[m._x,m._y,m._z]},createRingModel:function(j,t,v,s,$,L,J,z,A,_){for(var F=[],y=0;y<j.length-1;y+=2)F.push({x:j[y],y:j[y+1]});L=L||U.shapeSide,J=J||0,z=z||L;var e,x,d,K,w,H,a,n,P,C,y,h,b,l,Y,O,o,f,i=[],q=[],E=A?[]:p,R=A?[]:p,G=_?[]:p,T=_?[]:p,I=s?[]:p,u=s?[]:p,M=$?[]:p,N=$?[]:p,j=gk(F,t,v),V=rd(j),Q=0,D=2*Math.PI/L;return j.forEach(function(U){if(d=U.length,d>1){if(K=U[0],s)for(H=K.x,n=K.y,y=J;z>y;y++)h=y+1,b=y*D,l=h*D,Y=X(b),O=S(b),o=X(l),f=S(l),I.push(Y*H,n,-O*H,o*H,n,-f*H,0,n,0),u.push(.5-.5*Y,.5-.5*O,.5-.5*o,.5-.5*f,.5,.5);for(C=0;d>C;C++){for(w=U[C],H=K.x,a=w.x,n=K.y,P=w.y,e=Q/V,Q+=ti(K,w),x=Q/V,y=J;z>y;y++)h=y+1,b=y*D,l=h*D,Y=X(b),O=S(b),o=X(l),f=S(l),i.push(Y*a,P,-O*a,o*a,P,-f*a,Y*H,n,-O*H,o*a,P,-f*a,o*H,n,-f*H,Y*H,n,-O*H),q.push(y/L,x,h/L,x,y/L,e,h/L,x,h/L,e,y/L,e),A&&y===J&&(E.push(0,n,0,0,P,0,Y*a,P,-O*a,Y*a,P,-O*a,Y*H,n,-O*H,0,n,0),R.push(0,.5-n,0,.5-P,2*a,.5-P,2*a,.5-P,2*H,.5-n,0,.5-n)),_&&h===z&&(G.push(0,n,0,o*a,P,-f*a,0,P,0,o*a,P,-f*a,0,n,0,o*H,n,-f*H),T.push(1,.5-n,1-2*a,.5-P,1,.5-P,1-2*a,.5-P,1,.5-n,1-2*H,.5-n));K=w}if($)for(H=K.x,n=K.y,y=J;z>y;y++)h=y+1,b=y*D,l=h*D,Y=X(b),O=S(b),o=X(l),f=S(l),M.push(o*H,n,-f*H,Y*H,n,-O*H,0,n,0),N.push(.5-.5*o,.5+.5*f,.5-.5*Y,.5+.5*O,.5,.5)}}),{vs:i,uv:q,bottom_vs:M,bottom_uv:N,top_vs:I,top_uv:u,from_vs:E,from_uv:R,to_vs:G,to_uv:T}}},!0),Gp(q,{"3d.move.mode":R,"3d.selectable":!0,"3d.visible":!0,"3d.movable":!0,"3d.editable":!0,"shape.border.gradient.color":R,"edge.gradient.color":R,"edge.source.t3":R,"edge.target.t3":R,"light.type":sj,"light.center":[0,0,0],"light.color":[1,1,1,1],"light.disabled":!1,"light.angle":V/4,"light.range":0,"light.exponent":1,"light.intensity":1,"wf.visible":!1,"wf.width":1,"wf.color":Un,"wf.short":!1,"wf.mat":R,"wf.geometry":!1,batch:R,"transparent.mask":!1,brightness:R,"select.brightness":.7,"repeat.uv.length":R,alphaTest:.4,"label.face":Ap,"label.t3":R,"label.r3":R,"label.texture.scale":2,"label.rotationMode":Bp,"label.light":!1,"label.blend":R,"label.reverse.flip":!1,"label.reverse.color":Wh,"label.reverse.cull":!1,"label.transparent":!1,"label.autorotate":!1,"label2.face":Ap,"label2.t3":R,"label2.r3":R,"label2.texture.scale":2,"label2.rotationMode":Bp,"label2.light":!1,"label2.blend":R,"label2.reverse.flip":!1,"label2.reverse.color":Wh,"label2.reverse.cull":!1,"label2.transparent":!1,"label2.autorotate":!1,"note.face":Ap,"note.t3":R,"note.r3":R,"note.texture.scale":2,"note.rotationMode":Bp,"note.light":!1,"note.blend":R,"note.reverse.flip":!1,"note.reverse.color":Wh,"note.reverse.cull":!1,"note.transparent":!1,"note.autorotate":!1,"note2.face":Ap,"note2.t3":R,"note2.r3":R,"note2.texture.scale":2,"note2.rotationMode":Bp,"note2.light":!1,"note2.blend":R,"note2.reverse.flip":!1,"note2.reverse.color":Wh,"note2.reverse.cull":!1,"note2.transparent":!1,"note2.autorotate":!1,shape3d:R,"shape3d.color":Er,"shape3d.top.color":R,"shape3d.bottom.color":R,"shape3d.from.color":R,"shape3d.to.color":R,"shape3d.image":R,"shape3d.top.image":R,"shape3d.bottom.image":R,"shape3d.from.image":R,"shape3d.to.image":R,"shape3d.light":!0,"shape3d.side":0,"shape3d.side.from":R,"shape3d.side.to":R,"shape3d.visible":!0,"shape3d.from.visible":!0,"shape3d.to.visible":!0,"shape3d.top.visible":!0,"shape3d.bottom.visible":!0,"shape3d.torus.radius":.17,"shape3d.resolution":0,"shape3d.blend":R,"shape3d.opacity":R,"shape3d.reverse.flip":!1,"shape3d.reverse.color":Wh,"shape3d.reverse.cull":!1,"shape3d.transparent":!1,"shape3d.uv.offset":R,"shape3d.uv.scale":R,"shape3d.top.uv.offset":R,"shape3d.top.uv.scale":R,"shape3d.bottom.uv.offset":R,"shape3d.bottom.uv.scale":R,"shape3d.from.uv.offset":R,"shape3d.from.uv.scale":R,"shape3d.to.uv.offset":R,"shape3d.to.uv.scale":R,"shape3d.top.cap":R,"shape3d.bottom.cap":R,"shape3d.start.angle":0,"shape3d.sweep.angle":x,"shape3d.discard.selectable":!0,"shape3d.top.discard.selectable":!0,"shape3d.bottom.discard.selectable":!0,"shape3d.from.discard.selectable":!0,"shape3d.to.discard.selectable":!0,"shape3d.scaleable":!0,"shape3d.autorotate":!1,"shape3d.fixSizeOnScreen":R,"shape3d.image.cache":!1,"shape3d.alwaysOnTop":!1,"all.light":!0,"all.visible":!0,"all.color":Er,"all.image":R,"all.blend":R,"all.opacity":R,"all.reverse.flip":!1,"all.reverse.color":Wh,"all.reverse.cull":!1,"all.transparent":!1,"all.uv":R,"all.uv.offset":R,"all.uv.scale":R,"all.discard.selectable":!0,mat:R,"left.mat":R,"right.mat":R,"top.mat":R,"bottom.mat":R,"front.mat":R,"back.mat":R},!0);var os,Kh=!1,Al=[0,0,0,0],Dp={left:[1/255,0,0,1],right:[2/255,0,0,1],top:[3/255,0,0,1],bottom:[4/255,0,0,1],front:[5/255,0,0,1],back:[6/255,0,0,1],m:{1:Aj,2:ig,3:ko,4:eg,5:Ap,6:Kq}},wp=function(Q,u,q,S){if(u.getFaceVisible(Q,q)){Wj(u,Rb(Q,u.getFaceMat(Q,q)||u.getMat(Q)));var Z=u._26I;u.getFaceReverseCull(Q,q)?Z.enable(Z.CULL_FACE):Z.disable(Z.CULL_FACE),gp(Z,u._prg.uFixPickReverseColor,Dp[q]),Fc(Z),Pe(Z,S,6),kr(Z),We(u)}},Dr=function(u){return u instanceof wk},Qj=function(O){return[O.x,O.e||0,O.y]},_m=function(p,u,y){for(var u=kd(u),a=u[0],r=u[1],j=u[2];y--;)p.push(a,r,j)},fp=function(U,x,d){for(var x=kd(x),Y=x[0],e=x[1],t=x[2],Z=x[3];d--;)U.push(Y,e,t,Z)},Gb=function(Y,N,y){if(N)for(var T,K,$,g=N[0],P=N[1],C=N[2],f=N[4],B=N[5],i=N[6],e=N[8],M=N[9],W=N[10],s=N[12],X=N[13],k=N[14],D=y.length,w=0,w=0;D>w;w+=3)T=y[w],K=y[w+1],$=y[w+2],Y.push(g*T+f*K+e*$+s,P*T+B*K+M*$+X,C*T+i*K+W*$+k);else xg(Y,y)},Ib=function(x,W){var m=W.s("light.intensity"),o=kd(W.s($k)),D=o[0],$=o[1],X=o[2];1!==m&&(D*=m,$*=m,X*=m),x.push(D,$,X,W.s("light.disabled")?1:0)},jl=function(T,w,r){gp(w,r.uHeadlightRange,T._headlightRange);var a=T._headlightIntensity,Z=kd(T._headlightColor);1!==a&&(Z=[Z[0]*a,Z[1]*a,Z[2]*a]),gp(w,r.uHeadlightColor,[Z[0],Z[1],Z[2],T._headlightDisabled?1:0]);var U=T._59O,z=T._spots,c=T._dirs;if(U.length){var b=[],t=[],K=[];U.forEach(function(q){Ib(b,q),xg(t,T._transformPointToViewSpace(q.p3())),K.push(q.s("light.range"))}),w.uniform4fv(r.uPointColor,b),w.uniform1fv(r.uPointRange,K),w.uniform3fv(r.uPointPosition,t)}if(z.length){var Y=[],E=[],N=[],V=[],k=[],y=[];z.forEach(function(t){Ib(Y,t),xg(E,T._transformPointToViewSpace(t.p3())),xg(k,T._transformDirectionToViewSpace(t.p3(),t.s("light.center"))),N.push(t.s("light.range")),V.push(X(t.s("light.angle")/2)),y.push(t.s("light.exponent"))}),w.uniform4fv(r.uSpotColor,Y),w.uniform1fv(r.uSpotRange,N),w.uniform1fv(r.uSpotAngle,V),w.uniform1fv(r.uSpotExponent,y),w.uniform3fv(r.uSpotPosition,E),w.uniform3fv(r.uSpotDirection,k)}if(c.length){var P=[],d=[];c.forEach(function(V){Ib(P,V),xg(d,T._transformDirectionToViewSpace(V.p3()))}),w.uniform4fv(r.uDirColor,P),w.uniform3fv(r.uDirDirection,d)}},Xn=function(v){return v>0&&0===(v-1&v)},em=function(x){return x=Q(0,j(V,x)),x=Q(Sd,j(V-Sd,x))},Gm=function(){return.05+b()/2},Zb=function(a,X,W,x){var l,u=a.getEye();return a.isOrtho()?(l=fg(a.getCenter(),u),l[0]+=x[0],l[1]+=x[1],l[2]+=x[2]):l=u,Qq(X,W,x,l)},Qq=function(E,s,T,l){var d=xb(E,s),J=fg(l,T,!0),R=xb(J,s);if(B(R)<Sd)return p;var w=(d-xb(T,s))/R;return[T[0]+J[0]*w,T[1]+J[1]*w,T[2]+J[2]*w]},En=function(d,x){return{x:2*d.x-x.x,y:2*d.y-x.y}},Ik=function(V,F,B,G){var K,w;if(!V)return K=z(F.y-B.y,B.x-F.x),{x:F.x+G*S(K),y:F.y+G*X(K)};if(!B)return K=z(V.y-F.y,F.x-V.x),{x:F.x+G*S(K),y:F.y+G*X(K)};var c=fg([V.x,V.y,0],[F.x,F.y,0],!0),A=fg([B.x,B.y,0],[F.x,F.y,0],!0),e=-(c[0]+A[0])/2,$=-(c[1]+A[1])/2,v=M(e*e+$*$);if(Sd>v)return K=z(V.y-F.y,F.x-V.x),{x:F.x+G*S(K),y:F.y+G*X(K)};var m=V.x-F.x,O=V.y-F.y,j=B.x-F.x,C=B.y-F.y,W=M(m*m+O*O),Z=M(j*j+C*C);K=Y(xb(c,A))/2,w=c[1]*A[0]-c[0]*A[1]>0?-1:1,e/=v,$/=v;var p=G/S(K),y=Q(W,Z)/X(K);v=Math.min(p,y);var d={x:F.x+w*v*e,y:F.y+w*v*$};return B.b&&p>Z/X(K)&&(d.adjust=!0),d},fi=function(W){var G=W[1],s=W[2],_=W[3],J=W[6],g=W[7],B=W[11];W[1]=W[4],W[2]=W[8],W[3]=W[12],W[4]=G,W[6]=W[9],W[7]=W[13],W[8]=s,W[9]=J,W[11]=W[14],W[12]=_,W[13]=g,W[14]=B},Hg=function(l){var Q=l[0],v=l[1],n=l[2],b=l[3],u=l[4],y=l[5],L=l[6],W=l[7],m=l[8],k=l[9],G=l[10],c=l[11],S=l[12],g=l[13],R=l[14],B=l[15],d=Q*y-v*u,i=Q*L-n*u,X=Q*W-b*u,F=v*L-n*y,x=v*W-b*y,j=n*W-b*L,z=m*g-k*S,M=m*R-G*S,H=m*B-c*S,D=k*R-G*g,t=k*B-c*g,w=G*B-c*R,T=d*w-i*t+X*D+F*H-x*M+j*z;return T?(T=1/T,l[0]=(y*w-L*t+W*D)*T,l[1]=(n*t-v*w-b*D)*T,l[2]=(g*j-R*x+B*F)*T,l[3]=(G*x-k*j-c*F)*T,l[4]=(L*H-u*w-W*M)*T,l[5]=(Q*w-n*H+b*M)*T,l[6]=(R*X-S*j-B*i)*T,l[7]=(m*j-G*X+c*i)*T,l[8]=(u*t-y*H+W*z)*T,l[9]=(v*H-Q*t-b*z)*T,l[10]=(S*x-g*X+B*d)*T,l[11]=(k*X-m*x-c*d)*T,l[12]=(y*M-u*D-L*z)*T,l[13]=(Q*D-v*M+n*z)*T,l[14]=(g*i-S*F-R*d)*T,l[15]=(m*F-k*i+G*d)*T,void 0):p},xc=function(R,E){if(E){var A=E[0],g=E[1],N=E[2];R[12]=R[0]*A+R[4]*g+R[8]*N+R[12],R[13]=R[1]*A+R[5]*g+R[9]*N+R[13],R[14]=R[2]*A+R[6]*g+R[10]*N+R[14],R[15]=R[3]*A+R[7]*g+R[11]*N+R[15]}},bf=function(o,y){if(y){var J=y[0],I=y[1],e=y[2];o[0]=o[0]*J,o[1]=o[1]*J,o[2]=o[2]*J,o[3]=o[3]*J,o[4]=o[4]*I,o[5]=o[5]*I,o[6]=o[6]*I,o[7]=o[7]*I,o[8]=o[8]*e,o[9]=o[9]*e,o[10]=o[10]*e,o[11]=o[11]*e}},jg=function(L,$,U){var p=$[0],z=$[1],i=$[2],x=$[3],u=$[4],r=$[5],o=$[6],d=$[7],F=$[8],h=$[9],R=$[10],T=$[11],J=$[12],G=$[13],D=$[14],B=$[15],j=U[0],a=U[1],c=U[2],H=U[3];return L[0]=j*p+a*u+c*F+H*J,L[1]=j*z+a*r+c*h+H*G,L[2]=j*i+a*o+c*R+H*D,L[3]=j*x+a*d+c*T+H*B,j=U[4],a=U[5],c=U[6],H=U[7],L[4]=j*p+a*u+c*F+H*J,L[5]=j*z+a*r+c*h+H*G,L[6]=j*i+a*o+c*R+H*D,L[7]=j*x+a*d+c*T+H*B,j=U[8],a=U[9],c=U[10],H=U[11],L[8]=j*p+a*u+c*F+H*J,L[9]=j*z+a*r+c*h+H*G,L[10]=j*i+a*o+c*R+H*D,L[11]=j*x+a*d+c*T+H*B,j=U[12],a=U[13],c=U[14],H=U[15],L[12]=j*p+a*u+c*F+H*J,L[13]=j*z+a*r+c*h+H*G,L[14]=j*i+a*o+c*R+H*D,L[15]=j*x+a*d+c*T+H*B,L},Ki=function(f,i,H,Y){var q,W,v,m,j,N,u,D,C,K,k=i[0],T=i[1],p=i[2],$=Y[0],U=Y[1],I=Y[2],X=H[0],Z=H[1],A=H[2];return B(k-X)<Sd&&B(T-Z)<Sd&&B(p-A)<Sd?vl(f):(u=k-X,D=T-Z,C=p-A,K=1/M(u*u+D*D+C*C),u*=K,D*=K,C*=K,q=U*C-I*D,W=I*u-$*C,v=$*D-U*u,K=M(q*q+W*W+v*v),K?(K=1/K,q*=K,W*=K,v*=K):(q=0,W=0,v=0),m=D*v-C*W,j=C*q-u*v,N=u*W-D*q,K=M(m*m+j*j+N*N),K?(K=1/K,m*=K,j*=K,N*=K):(m=0,j=0,N=0),f[0]=q,f[1]=m,f[2]=u,f[3]=0,f[4]=W,f[5]=j,f[6]=D,f[7]=0,f[8]=v,f[9]=N,f[10]=C,f[11]=0,f[12]=-(q*k+W*T+v*p),f[13]=-(m*k+j*T+N*p),f[14]=-(u*k+D*T+C*p),f[15]=1,f)
},sn=function(b,H,e,X,W){var k=1/t(H/2),B=1/(X-W);return b[0]=k/e,b[1]=0,b[2]=0,b[3]=0,b[4]=0,b[5]=k,b[6]=0,b[7]=0,b[8]=0,b[9]=0,b[10]=(W+X)*B,b[11]=-1,b[12]=0,b[13]=0,b[14]=2*W*X*B,b[15]=0,b},Ml=function(r,G,C,w,d,A,q){var N=1/(G-C),k=1/(w-d),c=1/(A-q);return r[0]=-2*N,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=-2*k,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=2*c,r[11]=0,r[12]=(G+C)*N,r[13]=(d+w)*k,r[14]=(q+A)*c,r[15]=1,r},im=function(j,X){var w=X[0],P=X[1],W=X[2],R=X[3],E=w*w+P*P+W*W+R*R,Y=E?1/E:0;return j[0]=-w*Y,j[1]=-P*Y,j[2]=-W*Y,j[3]=R*Y,j},er=function(N,r){var t=r[0]+r[5]+r[10],A=0;return t>0?(A=2*Math.sqrt(t+1),N[3]=.25*A,N[0]=(r[6]-r[9])/A,N[1]=(r[8]-r[2])/A,N[2]=(r[1]-r[4])/A):r[0]>r[5]&r[0]>r[10]?(A=2*Math.sqrt(1+r[0]-r[5]-r[10]),N[3]=(r[6]-r[9])/A,N[0]=.25*A,N[1]=(r[1]+r[4])/A,N[2]=(r[8]+r[2])/A):r[5]>r[10]?(A=2*Math.sqrt(1+r[5]-r[0]-r[10]),N[3]=(r[8]-r[2])/A,N[0]=(r[1]+r[4])/A,N[1]=.25*A,N[2]=(r[6]+r[9])/A):(A=2*Math.sqrt(1+r[10]-r[0]-r[5]),N[3]=(r[1]-r[4])/A,N[0]=(r[8]+r[2])/A,N[1]=(r[6]+r[9])/A,N[2]=.25*A),N},zd=function(Y,x,W){var a=x[0],_=x[1],n=x[2],r=x[3],V=a+a,y=_+_,i=n+n,C=a*V,O=a*y,X=a*i,N=_*y,G=_*i,F=n*i,S=r*V,e=r*y,m=r*i;return Y[0]=1-(N+F),Y[1]=O+m,Y[2]=X-e,Y[3]=0,Y[4]=O-m,Y[5]=1-(C+F),Y[6]=G+S,Y[7]=0,Y[8]=X+e,Y[9]=G-S,Y[10]=1-(C+N),Y[11]=0,Y[12]=W[0],Y[13]=W[1],Y[14]=W[2],Y[15]=1,Y},nc=U.getRotationFromMatrix4,Mb=function(){var Z=[0,0,0],s=[0,0,0],S=[0,0,0],v=function(u,j,f){u[0]=j[1]*f[2]-j[2]*f[1],u[1]=j[2]*f[0]-j[0]*f[2],u[2]=j[0]*f[1]-j[1]*f[0]},P=function(R){return R[0]*R[0]+R[1]*R[1]+R[2]*R[2]},Q=function(B){var n=Math.sqrt(P(B));B[0]/=n,B[1]/=n,B[2]/=n},n=function(X,v,D){X[0]=v[0]-D[0],X[1]=v[1]-D[1],X[2]=v[2]-D[2]};return function(T,W,L){var f=Cm();return n(S,T,W),0===P(S)&&(S[2]=1),Q(S),v(Z,L,S),0===P(Z)&&(1===Math.abs(L[2])?S[0]+=1e-4:S[2]+=1e-4,Q(S),v(Z,L,S)),Q(Z),v(s,S,Z),f[0]=Z[0],f[4]=s[0],f[8]=S[0],f[1]=Z[1],f[5]=s[1],f[9]=S[1],f[2]=Z[2],f[6]=s[2],f[10]=S[2],f}}(),Sr=function(A,P){return Ki(P?P:Cm(),A._eye,A._center,A._up)},cf=function(a){var Z=a.getAspect(),r=a._near,M=a._far,Q=Cm();if(a._ortho){var m=a._orthoWidth/2,C=m/Z;Ml(Q,-m,m,-C,C,r,M)}else sn(Q,a._fovy,Z,r,M);return Q},$m=function(f,v){if(!f)return p;var q=0,T=1,E=2,K=[],Y=0,N=f.length,z=N/3;if(v){for(;N>Y;Y++)K[Y]=0;for(Y=0;Y<v.length;Y+=3){var C=[],H=[],P=[];C[q]=f[3*v[Y+1]+q]-f[3*v[Y]+q],C[T]=f[3*v[Y+1]+T]-f[3*v[Y]+T],C[E]=f[3*v[Y+1]+E]-f[3*v[Y]+E],H[q]=f[3*v[Y+2]+q]-f[3*v[Y+1]+q],H[T]=f[3*v[Y+2]+T]-f[3*v[Y+1]+T],H[E]=f[3*v[Y+2]+E]-f[3*v[Y+1]+E],P[q]=C[T]*H[E]-C[E]*H[T],P[T]=C[E]*H[q]-C[q]*H[E],P[E]=C[q]*H[T]-C[T]*H[q];for(var V=0;3>V;V++)K[3*v[Y+V]+q]+=P[q],K[3*v[Y+V]+T]+=P[T],K[3*v[Y+V]+E]+=P[E]}}else for(Y=0;z>Y;Y+=3){var C=[],H=[],P=[];C[q]=f[3*(Y+1)+q]-f[3*Y+q],C[T]=f[3*(Y+1)+T]-f[3*Y+T],C[E]=f[3*(Y+1)+E]-f[3*Y+E],H[q]=f[3*(Y+2)+q]-f[3*(Y+1)+q],H[T]=f[3*(Y+2)+T]-f[3*(Y+1)+T],H[E]=f[3*(Y+2)+E]-f[3*(Y+1)+E],P[q]=C[T]*H[E]-C[E]*H[T],P[T]=C[E]*H[q]-C[q]*H[E],P[E]=C[q]*H[T]-C[T]*H[q];for(var V=0;3>V;V++)K[3*(Y+V)+q]=P[q],K[3*(Y+V)+T]=P[T],K[3*(Y+V)+E]=P[E]}for(Y=0;N>Y;Y+=3){var c=[];c[q]=K[Y+q],c[T]=K[Y+T],c[E]=K[Y+E];var D=M(c[q]*c[q]+c[T]*c[T]+c[E]*c[E]);0===D&&(D=Sd),c[q]=c[q]/D,c[T]=c[T]/D,c[E]=c[E]/D,K[Y+q]=c[q],K[Y+T]=c[T],K[Y+E]=c[E]}return new Oe(K)},Hr=function(S,n,q,j){if(q||(q=S.createTexture()),n){var O=S.TEXTURE_2D,z=S.REPEAT,h=S.CLAMP_TO_EDGE,v=S.TEXTURE_MIN_FILTER;j!==S.NEAREST&&(j=S.LINEAR),yk(S,q),S.texImage2D(O,0,S.RGBA,S.RGBA,S.UNSIGNED_BYTE,n),tr(S,S.TEXTURE_MAG_FILTER,j),Xn(n.width)&&Xn(n.height)&&!n.clampToEdge?(tr(S,S.TEXTURE_WRAP_S,z),tr(S,S.TEXTURE_WRAP_T,z),tr(S,v,S.LINEAR_MIPMAP_LINEAR),S.generateMipmap(O)):(tr(S,S.TEXTURE_WRAP_S,h),tr(S,S.TEXTURE_WRAP_T,h),tr(S,v,j)),yk(S,p)}return q},_g=function(t,n){var v=new Uint8Array(3);return n=n||t.createTexture(),yk(t,n),tr(t,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texImage2D(t.TEXTURE_2D,0,t.RGB,1,1,0,t.RGB,t.UNSIGNED_BYTE,v),n},Zc=function(u){u._26I&&u._prg&&(u._26I.deleteProgram(u._prg),u._prg=p)},pj=function(J,L,q,a){var A=J.createShader(q);return J.shaderSource(A,a),J.compileShader(A),J.attachShader(L,A),A},Qb=function(q){return q.createBuffer()},yk=function(L,c){L.bindTexture(L.TEXTURE_2D,c)},xp=function(k,m){k.bindFramebuffer(k.FRAMEBUFFER,m)},tr=function(i,g,p){i.texParameteri(i.TEXTURE_2D,g,p)},Gr=function(N,u){if(u){var u=kd(u);N.clearColor(u[0],u[1],u[2],u[3])}},Mp=function(Q,z){gp(Q,z.uFix,!0),Xd(Q,z.aNormal)},qh=function(z,Q){gp(z,Q.uFix,!1),Ub(z,Q.aNormal)},cg=function(d,c,O,w,P,r,k,B){d._picking||(O?(gp(d,c.uBlend,!0),gp(d,c.uBlendColor,O)):gp(d,c.uBlend,!1),gp(d,c.uLight,w==p?!0:w),Tq(P)&&1!==P&&gp(d,c.uPartOpacity,P),gp(d,c.uReverseFlip,r==p?!1:r),gp(d,c.uFixPickReverseColor,k||Wh)),B?d.enable(d.CULL_FACE):d.disable(d.CULL_FACE)},ul=function(k,O){k._picking||gp(k,O.uPartOpacity,1)},Fc=function(X,d,W,Q,Z,S,U,F,H){if(!W)return X.activeTexture(X.TEXTURE0),yk(X,X._emptyTexture),X.activeTexture(X.TEXTURE1),yk(X,X._emptyBlendTexture),void 0;gp(X,d.uTexture,!0),gp(X,d.uDiscardSelectable,sq(Q)?Q:!0),Ub(X,d.aUv),Gc(X,Z,S,d.aUv,2),H?(gp(X,d.uBlendTexture,!0),X.activeTexture(X.TEXTURE1),yk(X,H),X.uniform1i(d.uBlendSampler,1)):(gp(X,d.uBlendTexture,!1),X.activeTexture(X.TEXTURE1),yk(X,X._emptyBlendTexture)),X.activeTexture(X.TEXTURE0),yk(X,W),X.uniform1i(d.uSampler,0);var Y=[0,0,1,1];U&&(Y[0]=U[0],Y[1]=U[1]),F&&(Y[2]=F[0],Y[3]=F[1]),gp(X,d.uOffsetScale,Y)},kr=function(c,N,w){c.activeTexture(c.TEXTURE0),yk(c,p),c.activeTexture(c.TEXTURE1),yk(c,p),w&&(Xd(c,N.aUv),gp(c,N.uTexture,!1),gp(c,N.uBlendTexture,!1))},$l=function(c,k,Y,S,t,J){!Y||I||s||c.lineWidth(Y),S&&!c._picking&&gp(c,k.uFixPickReverseColor,S),t&&Gc(c,t,J,k.aPosition)},yj=function(u,w,d,S){os&&(S=u[os]),u.drawArrays(S==p?u.TRIANGLES:S,w,d);var e=u._renderInfo;e&&(e.calls++,e.vertices+=d,(S==p||S===u.TRIANGLES)&&(e.faces+=d/3),S===u.LINES&&(e.lines+=d/2))},Pe=function(a,K,o,g){os&&(g=a[os]),a.drawElements(g==p?a.TRIANGLES:g,o,a.UNSIGNED_SHORT,K==p?0:2*K);var F=a._renderInfo;F&&(F.calls++,F.vertices+=o,(g==p||g===a.TRIANGLES)&&(F.faces+=o/3),g===a.LINES&&(F.lines+=o/2))},ls=function(z,_,e,k,E){var T=z.ARRAY_BUFFER;z.bindBuffer(T,_),e&&z.bufferData(T,e,z.STATIC_DRAW),k!=p&&z.vertexAttribPointer(k,E?E:3,z.FLOAT,!1,0,0)},Gc=function(Z,t,W,G,X){return W?(Fk(Z,Z.ARRAY_BUFFER,t,W),G!=p&&Z.vertexAttribPointer(G,X?X:3,Z.FLOAT,!1,0,0),void 0):ls(Z,t,W,G,X)},Mg=function(o,U,e){var F=o.ELEMENT_ARRAY_BUFFER;o.bindBuffer(F,U),e&&o.bufferData(F,e,o.STATIC_DRAW)},Lh=function(s,p,x){Fk(s,s.ELEMENT_ARRAY_BUFFER,p,x)},Fk=function(y,C,G,T){var G,t=T.glBuf,U=y._id;t&&(G=t[U])&&G._buf?y.bindBuffer(C,G._buf):(G={_buf:Qb(y)},y._bufPool.push(G),y.bindBuffer(C,G._buf),y.bufferData(C,T,y.STATIC_DRAW),t||(t=T.glBuf={}),t[U]=G),G._fid=y._renderInfo.frame},gp=function(G,_,o){if(o!=p&&_!=p){o=kd(o);var v=o.length;3===v?G.uniform3fv(_,o):4===v?G.uniform4fv(_,o):16===v?G.uniformMatrix4fv(_,!1,o):sq(o)?G.uniform1i(_,o?1:0):2===v?G.uniform2fv(_,o):G.uniform1f(_,o)}},Ub=function(q,O){O!=p&&O>=0&&q.enableVertexAttribArray(O)},Xd=function(n,R){R!=p&&R>=0&&n.disableVertexAttribArray(R)},We=function(o,C){var _=o.getGL(),G=o._prg;o._7O=o._8O.pop(),C&&(gp(_,G.uMVMatrix,o._7O),o._6O=C,gp(_,G.uNMatrix,C))},qc=function(t,G){return G||(G=Cm()),Ef(G,t),Hg(G),fi(G),G},Wj=function(G,L){var q=G.getGL(),K=G._prg,V=G._7O;L&&(G._8O.push(Ch(V)),jg(V,V,L)),gp(q,K.uMVMatrix,V),gp(q,K.uNMatrix,qc(V,G._6O))},ge=function(C,i,E,t,y,Z){if(E){if(t){var w=E.value++,Q=2147483648|w,u=[(255&Q>>16)/255,(255&Q>>8)/255,(255&Q)/255,(255&Q>>24)/255];E[w]={data:y,part:Z}}else u=Al;return gp(C,i.uFixPickReverseColor,u),u}},ms=function(){var g={center:function(L,M,p,q,O){var K=-M[1]/2,F={x:-M[0]/2,y:K,width:M[0],height:M[1]},k=ad(L,F,p);return[k.x+q,-k.y-O,Gm()]},front:function(H,l,C,D,L){var r=-l[1]/2,m={x:-l[0]/2,y:r,width:l[0],height:l[1]},B=ad(H,m,C);return[B.x+D,-B.y-L,l[2]/2+Gm()]},back:function(S,w,u,$,f){var _=-w[0]/2,G=-w[1]/2,U={x:_,y:G,width:w[0],height:w[1]},B=ad(S,U,u);return[-B.x-$,-B.y-f,-w[2]/2-Gm()]},left:function(J,Z,q,R,x){var p=-Z[1]/2,V={x:-Z[2]/2,y:p,width:Z[2],height:Z[1]},m=ad(J,V,q);return[-Z[0]/2-Gm(),-m.y-x,m.x+R]},right:function(q,R,Q,f,h){var i=-R[2]/2,J=-R[1]/2,T={x:i,y:J,width:R[2],height:R[1]},M=ad(q,T,Q);return[R[0]/2+Gm(),-M.y-h,-M.x-f]},top:function(K,p,S,v,P){var b={x:-p[0]/2,y:-p[2]/2,width:p[0],height:p[2]},Q=ad(K,b,S);return[Q.x+v,p[1]/2+Gm(),Q.y+P]},bottom:function(q,g,S,r,s){var B=-g[2]/2,Y={x:-g[0]/2,y:B,width:g[0],height:g[2]},p=ad(q,Y,S);return[p.x+r,-g[1]/2-Gm(),-p.y-s]}};return function(U,H,P,b,S,l){return g[b](U,H,P,S||0,l||0)}}(),_q=function(M,K,s,a,J,N,F,l,C,S){if(J&&(K[0]+=J[0],K[1]+=J[1],K[2]+=J[2]),xc(M,s),l){var B=Cm();if(Oj(B,C,S),pk(K,B),xc(M,K),M.auto=l,M.pos=pk([0,0,0],M),N){var y=M.mat2=Cm();Oj(y,N,F)}}else Oj(M,C,S),xc(M,K),a===Aj?zl(M,-u):a===ig?zl(M,u):a===ko?Pc(M,-u):a===eg?Pc(M,u):a===Kq&&zl(M,V),Oj(M,N,F);return M},oh=function(L,J){var A=J.auto,W=J.mat2,f=L.gv;if(A){var K,u=Cm(),S=[0,0,0,0];K="string"==typeof A?[A.indexOf("x")<0?f._eye[0]:f._center[0],A.indexOf("y")<0?f._eye[1]:f._center[1],A.indexOf("z")<0?f._eye[2]:f._center[2]]:f._eye,er(S,Ki(Cm(),K,f._center,f._up)),zd(u,im(S,S),J.pos),W&&jg(u,u,W),Wj(f,u)}else Wj(f,J)},Ur=function(D,V,u,m,r){var b=D.s,g=D.gv,W=g.getGL(),a=g._prg,L=g._buffer,U=g._1O;Hr(W,jq,U),oh(D,u),cg(W,a,b(V+".blend"),b(V+".light"),b(V+".opacity"),b(V+".reverse.flip"),b(V+".reverse.color"),b(V+".reverse.cull")),Fc(W,a,U,r,L.uv,ue),Gc(W,L.vs,m,a.aPosition),Gc(W,L.ns,lo,a.aNormal),Lh(W,L.is,ic),Pe(W,0,ic.length),kr(W,a,U),ul(W,a),We(g)},Jn=function(Q,T,W){var z=Q.gv,A=Q.data,C=Q[T]={blend:z.getBodyColor(A)||z.getFaceBlend(A,T),light:z.getFaceLight(A,T),color:z.getFaceColor(A,T),opacity:z.getFaceOpacity(A,T),transparent:z.getFaceTransparent(A,T),reverseFlip:z.getFaceReverseFlip(A,T),reverseColor:z.getFaceReverseColor(A,T),reverseCull:z.getFaceReverseCull(A,T),texture:z.getFaceImage(A,T),blendTexture:z.getFaceBlendImage(A,T),discardSelectable:z.getFaceDiscardSelectable(A,T)};if("csg"!==T){C.uv=z.getFaceUv(A,T)||W&&W[T+"Uv"],C.uvScale=z.getFaceUvScale(A,T)||W&&W[T+"UvScale"],C.uvOffset=z.getFaceUvOffset(A,T)||W&&W[T+"UvOffset"];var N=z.getFaceMat(A,T);N&&(C.mat=Rb(A,N))}return C},yn=function(n,h,T,e,S){if(e){if(!S(e.transparent))return;var t=n.data,H=n.gv,F=H._buffer,B=H.getTexture(e.texture,t),$=H.getTexture(e.blendTexture,t);Fc(h,T,B,e.discardSelectable,F.uv,e.tuv,e.uvOffset,e.uvScale,$),cg(h,T,e.blend,e.light,e.opacity,e.reverseFlip,e.reverseColor,e.reverseCull),gp(h,T.uDiffuse,e.color),Gc(h,F.vs,e.vs,T.aPosition),Gc(h,F.ns,e.ns,T.aNormal),yj(h,0,e.vs.length/3),ul(h,T),kr(h,T,B)}},lj=function(c,O,n,r,j,y){var F,m,h,t,Z,I,V,J,U,u,$,K=[r-O,j-n],T=c?c.length:0;for(h=0;T>h;h++){for(t=2,F=c[h],Z=F[0],I=F[1];t+1<F.length;){if(V=F[t],J=F[t+1],m=Uj(O,n,r,j,Z,I,V,J,!0)){U=[V-Z,J-I],u=ti(U),U[0]/=u,U[1]/=u,u=xb(K,U),u=u>0?y:-y,$=[U[0]*u,U[1]*u];break}Z=V,I=J,t+=2}if($)break}if($)for(r=O+$[0],j=n+$[1],h=0;T>h;h++)for(t=2,F=c[h],Z=F[0],I=F[1];t+1<F.length;){if(V=F[t],J=F[t+1],m=Uj(O,n,r,j,Z,I,V,J,!0))return[0,0];Z=V,I=J,t+=2}return $?$:[r-O,j-n]},Wf=D.graph3d={},qp=function(Y,W,F){bd(l+".graph3d."+Y,W,F)},sd="~<yfusfw!+!yjsubNQv!>!opjujtpQ`mh!gjeof$!~<fdobutjEfojMb!>!fdobutjEfojMw|*itbEv)gj!ITBE!gfegj$!!gjeof$!~<ttfouihjsCidubCb!>!ttfouihjsCidubCw|*ttfouihjsCidubCv)gj!TTFOUIHJSCIDUBC!gfegj$!!gjeof$!~<eofmCidubCb!>!eofmCidubCw|*eofmCidubCv)gj!EOFMCIDUBC!gfegj$!!gjeof$!~<spmpDidubCb!>!spmpDidubCw|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!~<wVb!>!wVs|*fsvuyfUeofmCv)gj~<x{/fmbdTuftggPv!+!wVb!,!zy/fmbdTuftggPv!>!wVw|*fsvuyfUv)gj~<*yfusfw)4dfw!>!yfusfWw<**1/2!-mbnspOb)5dfw!+!yjsubNOv)4dfw!>!mbnspOw|*ldjQva!%%!yjGva)gj<*1/2!-opjujtpQb)5dfw!+!yjsubNWNv!>!yfusfw!5dfw|!*ejpw)ojbn!ejpw!gjeof$!<fdobutjEfojMw!ubpmg!hojzsbw<fdobutjEfojMb!ubpmg!fuvcjsuub<itbEv!mppc!nspgjov!ITBE!gfegj$!!gjeof$!<^UPQT`YBN]opjudfsjEupqTv!4dfw!nspgjov<^UPQT`YBN]opjujtpQupqTv!4dfw!nspgjov<^UPQT`YBN]spmpDupqTv!5dfw!nspgjov!1!?!UPQT`YBN!gj$!!gjeof$!<^UOJPQ`YBN]opjujtpQuojpQv!4dfw!nspgjov<^UOJPQ`YBN]spmpDuojpQv!5dfw!nspgjov!1!?!UOJPQ`YBN!gj$!!gjeof$!<^SJE`YBN]opjudfsjEsjEv!4dfw!nspgjov<^SJE`YBN]spmpDsjEv!5dfw!nspgjov!1!?!SJE`YBN!gj$!!gjeof$!<eofmCidubCw!4dfw!hojzsbw<eofmCidubCb!4dfw!fuvcjsuub<eofmCidubCv!mppc!nspgjov!EOFMCIDUBC!gfegj$!!gjeof$!<ttfouihjsCidubCw!ubpmg!hojzsbw<ttfouihjsCidubCb!ubpmg!fuvcjsuub<ttfouihjsCidubCv!mppc!nspgjov!TTFOUIHJSCIDUBC!gfegj$!!gjeof$!<spmpDidubCw!5dfw!hojzsbw<spmpDidubCb!5dfw!fuvcjsuub<spmpDidubCv!mppc!nspgjov!SPMPDIDUBC!gfegj$!<yfusfWw!4dfw!hojzsbw<mbnspOw!4dfw!hojzsbw<yjGv!mppc!nspgjov<ldjQv!mppc!nspgjov<yjsubNxfjWv!5ubn!nspgjov<yjsubNOv!5ubn!nspgjov<yjsubNQv!5ubn!nspgjov<yjsubNWNv!5ubn!nspgjov<opjujtpQb!4dfw!fuvcjsuub<mbnspOb!4dfw!fuvcjsuub<wVs!3dfw!hojzsbw<wVw!3dfw!hojzsbw<wVb!3dfw!fuvcjsuub<fmbdTuftggPv!5dfw!nspgjov<fsvuyfUeofmCv!mppc!nspgjov<fsvuyfUv!mppc!nspgjov!YJGFSQ^#CBRBEJxTT87hJFI,,bX1XrIwcn3UM{ZeZ,M6HEN6nLxe2Z72s2:3johr6foKrpqwxNKYkdbJ2CN[mBbf[wXU,T0oGuSEd190ohLZkEn8IuCe[OHoWeKz:Sf,VS7xdSLw23W1YJLU:jdv2{hiDbhDzNNEh9tp3xsuEp94Sl4c3wRzqwShMDRhCLRjCDEBOH5BBVRBCFRE4cJTHrTDH1BNgHJN",jh="~~<eJ!>!spmpDhbsG`mh~<spmpDsfmqnbTwv!>+!eJ<*wVs!-sfmqnbTeofmCv)E3fsvuyfu!>!spmpDsfmqnbTwv!5dfw|!*fsvuyfUeofmCv)!gj!!gjeof$!~<ttfouihjsCidubCw!>+!chs/eJ!!!|*ttfouihjsCidubCv)gj!TTFOUIHJSCIDUBC!gfegj$!~<ttfouihjsCv!>+!chs/eJ!!!|*1/2!>a!ttfouihjsCv)gj~~<zujdbqPusbQv!>+!b/eJ!!!|*1/2!>a!zujdbqPusbQv)gj~!gjeof$!<*spudbGhpg!-*x/eJ!-chs/spmpDhpGv)5dfw!-eJ)yjn!>!eJ<*iuqfe!-sbGhpGv!-sbfOhpGv)qfutiuppnt!>!spudbGhpg!ubpmg<x/esppDhbsG`mh0{/esppDhbsG`mh!>!iuqfe!ubpmg!HPG!gfegj$!!gjeof$!~~~~<chs/^j]spmpDupqTv!+!udfggFupqt!+!fhobSm!+!*1/1!-*mbnspOm.!-O)upe)ybn!>,!chs/eJ<*1/1!-*^j]uofopqyFupqTv!-udfggFupqt)xpq)ybn!>!udfggFupqt|*^j]fmhoBupqTv!?!udfggFupqt)gj<*mbnspOm!-^j]opjudfsjEupqTv)upe!>!udfggFupqt!ubpmg<*spudfWm)f{jmbnspo!>!mbnspOm!4dfw|*1/1!?!fhobSm)!gj~<*1/2!-*^j]fhobSupqTv!0!*spudfWm)iuhofm))ojn!.!1/2!>!fhobSm|*1/1!?!^j]fhobSupqTv)!gj<1/2!>!fhobSm!ubpmg<^j]opjujtpQupqTv!.!yfusfWw!>!spudfWm!4dfw|*1/1!>>!x/^j]spmpDupqTv)gj|!*,,j!<UPQT`YBN!=!j!<1>j!uoj)spg!1!?!UPQT`YBN!gj$!!gjeof$!~~~<chs/^j]spmpDuojpQv!+!fhobSm!+!*1/1!-**spudfWm)f{jmbnspo.!-O)upe)ybn!>,!chs/eJ|*1/1!?!fhobSm)!gj~<*1/2!-*^j]fhobSuojpQv!0!*spudfWm)iuhofm))ojn!.!1/2!>!fhobSm|*1/1!?!^j]fhobSuojpQv)!gj<1/2!>!fhobSm!ubpmg<^j]opjujtpQuojpQv!.!yfusfWw!>!spudfWm!4dfw|*1/1!>>!x/^j]spmpDuojpQv)gj|!*,,j!<UOJPQ`YBN!=!j!<1>j!uoj)spg!1!?!UOJPQ`YBN!gj$!!gjeof$!~~<chs/^j]spmpDsjEv!+!*1/1!-**^j]opjudfsjEsjEv)f{jmbnspo.!-O)upe)ybn!>,!chs/eJ|*1/1!>>!x/^j]spmpDsjEv)gj|!*,,j!<SJE`YBN!=!j!<1>j!uoj)spg!1!?!SJE`YBN!gj$!~<chs/spmpDuihjmebfIv!+!nsfUusfcnbm!>+!chs/eJ~<*1/2!-fhobSuihjmebfIv0*yfusfWw)iuhofm)ojn!.!1/2!!>+!nsfUusfcnbm|*1/1!?!fhobSuihjmebfIv)gj<*1/1!-6/1!,!6/1!+!*M.!-O)upe)ybn!>!nsfUusfcnbm!ubpmg|*1/1!>>!x/spmpDuihjmebfIv)gj|*uihjMv)gj~!gjeof$!~<spmpDeofmCv!>+!eJ|*eofmCv)gj!ftmf$!~<spmpDeofmCv!>+!eJ|*eofmCv)gj!ftmf~<eofmCidubCw!>+!chs/eJ|*eofmCidubCv)gj!EOFMCIDUBC!gfegj$!~<spmpd!>!eJ|ftmf~<spmpDwv!>!eJ|*fsvuyfUv)gj|!ftmf~<spmpDftsfwfSldjQyjGv!>!eJ|*qjmGftsfwfSva!%%!ldbCtj)gj~<fvsu!>!ldbCtj<O.!>!O|*1/1!=!*O!-F)upe)gj<ftmbg!>!ldbCtj!mppc<F.!>!M!4dfw<*yfusfWw.)f{jmbnspo!>!F!4dfw<*mbnspOw)f{jmbnspo!>!O!4dfw!gjeof$!<ftvggjEv!>!spmpd!ftmf$!~<ftvggjEv!>!spmpd|ftmf~<spmpDidubCw!>!spmpd|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!<spmpd!5dfw|!ftmf~!gjeof$!~~<ftvggjEv!>!eJ|ftmf~<esbdtje|*1/1!>>!x/ftvggjEv)gj|!*!fdobutjEitbEv!?!*!fdobutjEqbHitbEv!-fdobutjEfojMw!)epn!%%!itbEv)!gj!ITBE!gfegj$!!gjeof$!<spmpDftsfwfSldjQyjGv!>!eJ!ftmf$!~<spmpDftsfwfSldjQyjGv!>!eJ|ftmf~<spmpDidubCw!>!eJ|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!|*yjGv)gj<eJ!5dfw|ftmf~~!<esbdtje!|!*1/1!>>!b/spmpDhbsG`mh)!gj!gjeof$!<spmpDftsfwfSldjQyjGv!>!spmpDhbsG`mh!ftmf$!~<spmpDftsfwfSldjQyjGv!>!spmpDhbsG`mh|ftmf~<spmpDidubCw!>!spmpDhbsG`mh|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!|*ldjQv)gj~~~!<esbdtje!|!*utfUbiqmBv!>=!b/spmpDwv)!gj!!!!|!ftmf~~!<esbdtje!|!*1/1!>>!b/spmpDwv)!gj!!!!|!*uofsbqtobsUv)!gj<*wVw!-sfmqnbTv)E3fsvuyfu!>!spmpDwv|**fmcbudfmfTesbdtjEv!%%!ldjQv)a!%%!fsvuyfUv)gj<spmpDwv!5dfw|!*ejpw)ojbn!ejpw!gjeof$!<fdobutjEfojMw!ubpmg!hojzsbw<fdobutjEqbHitbEv!ubpmg!nspgjov<fdobutjEitbEv!ubpmg!nspgjov<itbEv!mppc!nspgjov!ITBE!gfegj$!!gjeof$!<sbGhpGv!ubpmg!nspgjov<sbfOhpGv!ubpmg!nspgjov<spmpDhpGv!5dfw!nspgjov!HPG!gfegj$!!gjeof$!<^UPQT`YBN]opjudfsjEupqTv!4dfw!nspgjov<^UPQT`YBN]opjujtpQupqTv!4dfw!nspgjov<^UPQT`YBN]fhobSupqTv!ubpmg!nspgjov<^UPQT`YBN]fmhoBupqTv!ubpmg!nspgjov<^UPQT`YBN]uofopqyFupqTv!ubpmg!nspgjov<^UPQT`YBN]spmpDupqTv!5dfw!nspgjov!1!?!UPQT`YBN!gj$!!gjeof$!<^UOJPQ`YBN]opjujtpQuojpQv!4dfw!nspgjov<^UOJPQ`YBN]fhobSuojpQv!ubpmg!nspgjov<^UOJPQ`YBN]spmpDuojpQv!5dfw!nspgjov!1!?!UOJPQ`YBN!gj$!!gjeof$!<^SJE`YBN]opjudfsjEsjEv!4dfw!nspgjov<^SJE`YBN]spmpDsjEv!5dfw!nspgjov!1!?!SJE`YBN!gj$!!gjeof$!<eofmCidubCw!4dfw!hojzsbw<eofmCidubCv!mppc!nspgjov!EOFMCIDUBC!gfegj$!!gjeof$!<ttfouihjsCidubCw!ubpmg!hojzsbw<ttfouihjsCidubCv!mppc!nspgjov!TTFOUIHJSCIDUBC!gfegj$!!gjeof$!<spmpDidubCw!5dfw!hojzsbw<spmpDidubCv!mppc!nspgjov!SPMPDIDUBC!gfegj$!<spmpDuihjmebfIv!5dfw!nspgjov<fhobSuihjmebfIv!ubpmg!nspgjov<yfusfWw!4dfw!hojzsbw<mbnspOw!4dfw!hojzsbw<ftvggjEv!5dfw!nspgjov<zujdbqPusbQv!ubpmg!nspgjov<ttfouihjsCv!ubpmg!nspgjov<uihjMv!mppc!nspgjov<spmpDeofmCv!5dfw!nspgjov<eofmCv!mppc!nspgjov<wVs!3dfw!hojzsbw<sfmqnbTeofmCv!E3sfmqnbt!nspgjov<sfmqnbTv!E3sfmqnbt!nspgjov<wVw!3dfw!hojzsbw<fsvuyfUeofmCv!mppc!nspgjov<fsvuyfUv!mppc!nspgjov<uofsbqtobsUv!mppc!nspgjov<utfUbiqmBv!ubpmg!nspgjov<spmpDftsfwfSldjQyjGv!5dfw!nspgjov<qjmGftsfwfSv!mppc!nspgjov<ldjQv!mppc!nspgjov<yjGv!mppc!nspgjov<fmcbudfmfTesbdtjEv!mppc!nspgjov!YJGFSQ!gjeof$!!gjeof$!!<ubpmg!qnvjefn!opjtjdfsq!!ftmf$!!<ubpmg!qihji!opjtjdfsq!!IHJI`OPJTJDFSQ`UOFNHBSG`MH!gfegj$!!TF`MH!gfegj$!";Gp(U,{setBatchInfo:function(f,m){pe[f]=m},getBatchInfo:function(L){return pe[L]}},!0);var df=[1,1,1],Jm=[1,0,0,0,0,1,0,1,1,1,1,0],Lb=[-.5,.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,.5,.5],rr=[.5,.5,-.5,.5,.5,.5,.5,-.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,.5,-.5],Yd=[.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,.5,.5,-.5],Od=[.5,-.5,.5,-.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,.5],He=[.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5],rc=[-.5,.5,-.5,.5,.5,-.5,.5,-.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5],Ep=function(e,x){Wk(e,x,"_batchModelMap","_batchIndexMap"),iq(e,x,"_wireframeModelMap","_wireframeIndexMap"),iq(e,x,"_polylineModelMap","_polylineIndexMap"),iq(e,x,"_wireframeModelMapSwap","_wireframeIndexMapSwap"),iq(e,x,"_polylineModelMapSwap","_polylineIndexMapSwap")},Wk=function(I,c,V,G){if(!c)return I[V]={},I[G]={},void 0;var t=c._id,Q=I[G],d=Q[t];if(d){var o=I[V],J=d.batch,Z=o[J],m=Z.ds,$=d.index;if(Z.invalidate=!0,delete Q[t],m.splice($,1),wf(m))return delete o[J],void 0;for(var A=d.begin,r=d.size,l=3*A,E=3*r,z=4*A,B=4*r,x=Z.vs,K=Z.ps,N=Z.uv,h=Z.cs,F=Z.bs,k=Z.rs,b=Z.ns,L=Z.ls;$<m.length;$++)d=Q[m[$]._id],d.index--,d.begin-=r;x.splice(l,E),K.splice(z,B),N&&N.splice(2*A,2*r),h&&h.splice(z,B),F&&F.splice(l,E),k&&k.splice(A,r),b&&b.splice(l,E),L&&L.splice(A,r)}},iq=Wk,Ee=function(J,G,F,T){if(!T)return p;var s=G[T];if(!s){var h=pe[T]||Vh,a=h.image?[]:p;s=G[T]={vs:[],ns:[],uv:a,cs:a?p:h.color?p:[],bs:h.blend?[]:p,ps:[],rs:h.brightness?[]:p,ds:[]}}return s.invalidate=!0,J[F._id]={index:s.ds.length,begin:s.vs.length/3,batch:T},s.ds.push(F),s},kk=function(z,G){return G!=p&&1!==G?[z[0]*G,z[1]*G,z[2]*G,z[3]]:z},Yb=function($,D,C){var e=$.getBrightness(D),_=kd(C.color||"white"),z=_[3]<1,r=Math.ceil(C.width)||1,J=(z?"T":"O")+r,t=$._wireframeIndexMap,K=$._wireframeModelMap,R=K[J];R||(R=K[J]={vs:[],cs:[],ps:[],ds:[],T:z,W:r});var H,d=$.getData3dUI(D),O=Te(d);if(C.geometry){if(!O)return;if(H=Xi(O),!H)return}else H=C.short?ce:Vr;R.invalidate=!0;var x=R.vs,N=R.cs,Q=R.ds,s=t[D._id]={index:Q.length,begin:x.length/3,batch:J};Q.push(D);var I=Rb(D,C.mat),S=d._calcAnchorMat(D);S&&jg(I,I,S),Gb(x,I,H);var W=s.size=x.length/3-s.begin;fp(N,kk(_,e),W)},xj=function(L,n,w,i,G,I,O,b,A){var x=L.getBrightness(n);x==p&&(x=1);var k=kk(kd(i),x),M=k[3]<1;I=Math.ceil(I)||1;var v=(M?"T":"O")+I;if(O){var y=O[0],X=(O[1]||y)+y;v+="-"+y+"-"+X,A&&(v+="-"+mg(A)+"-"+x,A=kk(kd(A),x))}var r=L._polylineIndexMap,q=L._polylineModelMap,R=q[v];R||(R=q[v]={vs:[],cs:[],ps:[],ds:[],ls:O?[]:p,T:M,W:I},O&&(R.D=y,R.G=X,R.A=A)),R.invalidate=!0;var U,H=R.vs,z=R.cs,l=R.ds,S=R.ls,_=r[n._id]={index:l.length,begin:H.length/3,batch:v};l.push(n),xg(H,w);var m,g=_.size=H.length/3-_.begin,Q=w.length,E=0,j=[];if(O||G)for(U=0;Q>U;U+=6)m=ti([w[U],w[U+1],w[U+2]],[w[U+3],w[U+4],w[U+5]]),j.push(m),E+=m;if(E&&G){var B,N=kk(kd(G),x),e=[N[0]-k[0],N[1]-k[1],N[2]-k[2],N[3]-k[3]],T=0;for(U=0;Q>U;U+=6)B=T/E,fp(z,[k[0]+e[0]*B,k[1]+e[1]*B,k[2]+e[2]*B,k[3]+e[3]*B],1),T+=j[U/6],B=T/E,fp(z,[k[0]+e[0]*B,k[1]+e[1]*B,k[2]+e[2]*B,k[3]+e[3]*B],1)}else fp(z,k,g);if(O)for(T=b||0,U=0;Q>U;U+=6)S.push(T),T+=j[U/6],S.push(T)},Pg=function(Q,N,o){if(N)for(var $=4*N.begin,Z=o[N.batch].ps,q=0;q<N.size;q++)Z[$++]=Q[0],Z[$++]=Q[1],Z[$++]=Q[2],Z[$++]=Q[3]},Xg=function(v,D){var Q=D+["32"],J=v[D],$=v[Q];J?$&&$.length===J.length?($.set(J),$.glBuf=null):v[Q]=new Oe(J):delete v[Q]},pp=function(Z,K,q,w,$,H,p,f,v){if(vi(q))q.forEach(function(B){pp(Z,K,B,w,$,H,p,f,v)});else if(Op(q))pp(Z,K,Te(w,q),w,$,H,p,f,v);else if(Dh(q)){var U,G=$n(q.mat,K,Z),D=$n(q.s3,K,Z),m=$n(q.t3,K,Z),C=$n(q.r3,K,Z);if((D||C||m||G)&&(U=dj(G,D,C,$n(q.rotationMode,K,Z),m),H.push(U)),q.shape3d)pp(Z,K,q.shape3d,w,$,H,p,f,q);else{var h=w.s;v=v||Vh;var j=H[0],V=H.length,e=h("shape3d.color",q.color,v.color);if($||($=h("shape3d.blend",q.blend,v.blend)),V>1){j=Ch(j);for(var N=1;V>N;N++)jg(j,j,H[N])}q.vs&&h(In,q.visible,v.visible)&&Ue(j,p,f,q.vs,q.uv,q.is,$,e),q.top_vs&&h(ro,q.topVisible,v.topVisible)&&Ue(j,p,f,q.top_vs,q.top_uv,q.top_is,$,h("shape3d.top.color",q.topColor,v.topColor)||e),q.bottom_vs&&h(rm,q.bottomVisible,v.bottomVisible)&&Ue(j,p,f,q.bottom_vs,q.bottom_uv,q.bottom_is,$,h("shape3d.bottom.color",q.bottomColor,v.bottomColor)||e),q.from_vs&&h(yr,q.fromVisible,v.fromVisible)&&Ue(j,p,f,q.from_vs,q.from_uv,q.from_is,$,h("shape3d.from.color",q.fromColor,v.fromColor)||e),q.to_vs&&h(Nh,q.toVisible,v.toVisible)&&Ue(j,p,f,q.to_vs,q.to_uv,q.to_is,$,h("shape3d.to.color",q.toColor,v.toColor)||e)}U&&H.pop()}},Ue=function(m,G,x,B,J,L,F,C){var j,s=G.cs,Q=G.uv,W=G.bs;if(L){j=L.length;for(var v=0;j>v;v++){var $=L[v];Gb(x,m,[B[3*$],B[3*$+1],B[3*$+2]]),Q&&xg(Q,[J[2*$],J[2*$+1]])}}else j=B.length/3,Gb(x,m,B),Q&&xg(Q,J);s&&fp(s,C,j),W&&(F?_m(W,F,j):xg(W,df,j))},Jq=function(D,Z,I,b){var P=[];b?pp(D.gv,D.data,b,D,D.getBodyColor(),[Z],I,P):(xe(D,Aj,Z,I,P),xe(D,ig,Z,I,P),xe(D,Ap,Z,I,P),xe(D,Kq,Z,I,P),xe(D,ko,Z,I,P),xe(D,eg,Z,I,P),xe(D,"csg",Z,I,P)),P.length&&(xg(I.vs,P),xg(I.ns,$m(P)))},xe=function(C,R,F,S,J){var Y=C[R];if(Y){var r=Y.tuv;if(r){var M,d,g,o,_=Y.uvScale,P=Y.uvOffset;if(_)for(M=r.length,d=_[0],g=_[1],o=0;M>o;o+=2)r[o]*=d,r[o+1]*=g;if(P)for(M=r.length,d=P[0],g=P[1],o=0;M>o;o+=2)r[o]+=d,r[o+1]+=g}Ue(F,S,J,Y.vs,r,p,Y.blend,Y.color)}},kf=function(R,c,D,X,f,M,g,I){var W,j=D.cs,u=D.uv,z=D.bs;if(R.getFaceVisible(c,M)){var y=R.getFaceMat(c,M);if(y&&(f=Rb(c,y)),Gb(g,f,I),j&&fp(j,R.getFaceColor(c,M),6),u){var r=R.getFaceUv(c,M)||X[M+"Uv"],B=R.getFaceUvScale(c,M)||X[M+"UvScale"],a=R.getFaceUvOffset(c,M)||X[M+"UvOffset"];r=r?[r[6],r[7],r[0],r[1],r[2],r[3],r[2],r[3],r[4],r[5],r[6],r[7]]:Jm;var K=r[0],$=r[1],E=r[2],h=r[3],w=r[4],k=r[5],o=r[6],N=r[7],v=r[8],A=r[9],i=r[10],Z=r[11];if(B){var F=B[0],p=B[1];K*=F,$*=p,E*=F,h*=p,w*=F,k*=p,o*=F,N*=p,v*=F,A*=p,i*=F,Z*=p}if(a){var Q=a[0],_=a[1];K+=Q,$+=_,E+=Q,h+=_,w+=Q,k+=_,o+=Q,N+=_,v+=Q,A+=_,i+=Q,Z+=_}u.push(K,$,E,h,w,k,o,N,v,A,i,Z)}z&&(W=R.getBodyColor(c)||R.getFaceBlend(c,M),W?_m(z,W,6):xg(z,df,6))}},Mf=function(U,d,A,b){var o=U.getGL(),l=U._prg,T=U._buffer;if(!es(d)){Wj(U),Mp(o,l);for(var j in d){var i=d[j];if(!(b&&!i.T||!b&&i.T)){i.invalidate?(i.invalidate=!1,Xg(i,"vs"),Xg(i,"cs"),Xg(i,"ls"),Xg(i,"ps")):A&&Xg(i,"ps");var N=i.vs32,n=A?i.ps32:i.cs32;$l(o,l,i.W,p,T.vs,N);var R=i.D,h=!U._dashDisabled&&R;gp(o,l.uAlphaTest,q.alphaTest),h&&(gp(o,l.uDash,!0),gp(o,l.uDashDistance,R),gp(o,l.uDashGapDistance,i.G),Ub(o,l.aLineDistance),Gc(o,T.lineDistance,i.ls32,l.aLineDistance,1),gp(o,l.uDiffuse,i.A||Vd));var m=!U._batchColorDisabled;m&&(gp(o,l.uBatchColor,!0),Ub(o,l.aBatchColor),Gc(o,T.batchColor,n,l.aBatchColor,4)),Fc(o),yj(o,0,N.length/3,o.LINES),kr(o),m&&(gp(o,l.uBatchColor,!1),Xd(o,l.aBatchColor)),h&&(gp(o,l.uDash,!1),Xd(o,l.aLineDistance))}}qh(o,l)}},vn=function(i,m,L){var b,Q,w,d,s,K,x,U,A,v,P,C=i.getGL(),M=i._prg,z=i._buffer,X=i._batchModelMap;if(!es(X)){Wj(i);for(b in X)if(Q=pe[b]||Vh,!(L&&!Q.transparent||!L&&Q.transparent)&&(w=X[b],m||!Q.transparentMask)){var B=L&&Q.autoSort!==!1&&(i._33Q||w.invalidate);if(w.invalidate?(w.invalidate=!1,Xg(w,"vs"),Xg(w,"ns"),Xg(w,"cs"),Xg(w,"rs"),Xg(w,"ps"),Xg(w,"bs"),Xg(w,"uv")):m&&Xg(w,"ps"),s=w.vs32,K=m?w.ps32:w.cs32,A=w.uv32,x=w.bs32,U=w.rs32,P=s.length/3,B&&(w.is=Ic(s,i.getEye())),P){d=Q.light,v=i.getTexture(Q.image),cg(C,M,p,Q.light,Q.opacity,Q.reverseFlip,Q.reverseColor,Q.reverseCull),K?i._batchColorDisabled||(gp(C,M.uBatchColor,!0),Ub(C,M.aBatchColor),Gc(C,z.batchColor,K,M.aBatchColor,4)):gp(C,M.uDiffuse,Q.color);var y=Q.alphaTest;gp(C,M.uAlphaTest,y===R?q.alphaTest:y);var t=x&&!i._batchBlendDisabled;t&&(gp(C,M.uBatchBlend,!0),Ub(C,M.aBatchBlend),Gc(C,z.batchBlend,x,M.aBatchBlend));var r=U&&!i._batchBrightnessDisabled;r&&(gp(C,M.uBatchBrightness,!0),Ub(C,M.aBatchBrightness),Gc(C,z.batchBrightness,U,M.aBatchBrightness,1)),A?Fc(C,M,v,Q.discardSelectable,z.uv,A,Q.uvOffset,Q.uvScale):Fc(C),Gc(C,z.vs,s,M.aPosition),Gc(C,z.ns,w.ns32,M.aNormal),w.is?(Mg(C,z.is,w.is),Pe(C,0,P)):yj(C,0,P),A?kr(C,M,v):kr(C),K&&!i._batchColorDisabled&&(gp(C,M.uBatchColor,!1),Xd(C,M.aBatchColor)),t&&(gp(C,M.uBatchBlend,!1),Xd(C,M.aBatchBlend)),r&&(gp(C,M.uBatchBrightness,!1),Xd(C,M.aBatchBrightness)),ul(C,M)}}}},Ic=function(F,t){for(var o=F.length/3,P=new Array(o),p=o/3,U=new Array(p),d=0;p>d;d++)U[d]=d;U.sort(function(A,I){var L=9*A,N=[(F[L]+F[L+3]+2*F[L+6])/4,(F[L+1]+F[L+4]+2*F[L+7])/4,(F[L+2]+F[L+5]+2*F[L+8])/4];L=9*I;var Z=[(F[L]+F[L+3]+2*F[L+6])/4,(F[L+1]+F[L+4]+2*F[L+7])/4,(F[L+2]+F[L+5]+2*F[L+8])/4],r=ti(t,N)-ti(t,Z);return r>0?-1:0>r?1:0});for(var d=0;p>d;d++){var s=3*d,T=3*U[d];P[s]=T,P[s+1]=T+1,P[s+2]=T+2}return new dm(P)},Sq={obj:function(w,H){var Y={mat:w.mat,s3:w.s3,r3:w.r3,rotationMode:w.rotationMode,t3:w.t3,cube:w.cube==p?!0:w.cube,center:w.center==p?!0:w.center,ignoreMtls:w.ignoreMtls,ignoreTransparent:w.ignoreTransparent,ignoreColor:w.ignoreColor,ignoreImage:w.ignoreImage,ignoreNormal:w.ignoreNormal,prefix:w.prefix,flipY:w.flipY,flipFace:w.flipFace,reverseFlipMtls:w.reverseFlipMtls,finishFunc:function(I,U){if(I){var U=[];for(var N in I){var O=I[N];U.rawS3=O.rawS3,U.push(O),w.eachModel&&w.eachModel(N,O)}U.json=w,H(U)}else H()}};U.loadObj(w.obj,w.mtl,Y)}};U.getModelTypeHandlers=function(){return Sq},U.setModelTypeHandler=function(L,R){Sq[L]=R},U.getModelTypeHandler=function(v){return Sq[v]},U.handleModelLoaded=function(){},U.handleUnfoundModel=function(){};var Rl=p,Dj=p,Zf=function(k){Rl&&!k._loadingModelView_&&(Dj||(Dj={}),Dj[k._loadingModelView_=Zq()]=k)},nr=function(x,Y){Rl||(Rl={});var k=Rl[x];if(k){if(k.url===Y)return;k.request.onload=Fp,k.request.onerror=Fp}var B=new XMLHttpRequest;if(Rl[x]={request:B,url:Y},B.overrideMimeType&&B.overrideMimeType("text/plain"),Y=U.beforeLoadURL(Y),Y.data){var I=U.parse(Y.data);pf(x,I,Y)}else B.open("GET",encodeURI(Y),!0),B.onload=function(Z){if(200===this.status||0===this.status){var K=U.parse(Z.target.response||Z.target.responseText);pf(x,K,Y)}else hh(x,U.handleUnfoundModel(x,Y)||p)},B.onerror=function(){hh(x,U.handleUnfoundModel(x,Y)||p)},B.send(null)},pf=function(A,d,J){var H=d.modelType;if(!H)return hh(A,d),U.handleModelLoaded(A,d),void 0;var X=U.getModelTypeHandler(H);if(X){var v=function(Z){Z?(hh(A,Z),U.handleModelLoaded(A,Z)):hh(A,U.handleUnfoundModel(A,J)||p)};X(d,v)}else hh(A,U.handleUnfoundModel(A,J)||p)},hh=function(y,Z){if(Xp[y]=Z,delete Rl[y],es(Rl)&&(Rl=p,Dj)){for(var n in Dj){var z=Dj[n];z._2O&&(z._2O={}),z.invalidateAll&&z.invalidateAll(R,"modelLoaded",y),z.redraw&&z.redraw(),z.iv(),delete z._loadingModelView_}Dj=p}if(Z&&Dj)for(var n in Dj){var z=Dj[n];z.invalidateAll&&z.invalidateAll(R,"modelLoading",y),z.redraw&&z.redraw(),z.iv()}},ue=new Oe([0,0,0,1,1,1,1,0]),lo=new Oe([0,0,1,0,0,1,0,0,1,0,0,1]),ic=new dm([0,1,2,2,3,0]),Km=new Oe([-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,.5,.5,.5,.5,.5,-.5,-.5,-.5,.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,.5]),Yh=new dm([0,1,2,0,2,3,4,5,6,4,6,7,8,9,10,8,10,11,12,13,14,12,14,15,16,17,18,16,18,19,20,21,22,20,22,23]),hs=new Oe([0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0]),um=$m(Km,Yh),Vr=(new Oe([-.5,.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,-.5,-.5,.5,.5,-.5,-.5,-.5,-.5,-.5,.5,-.5]),new dm([0,1,2,3,0,7,5,4,6,7,5,3,2,4,6,1]),[-.5,.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,.5,.5,-.5,.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,-.5,.5,.5,.5,.5,.5,-.5,.5,-.5,.5,.5,-.5,-.5,-.5,.5,.5,-.5,.5,-.5,-.5,-.5,.5,-.5,-.5,-.5]),ce=[-.5,.5,.5,-.4,.5,.5,-.5,.5,.5,-.5,.4,.5,-.5,.5,.5,-.5,.5,.4,.5,.5,.5,.4,.5,.5,.5,.5,.5,.5,.4,.5,.5,.5,.5,.5,.5,.4,-.5,-.5,.5,-.4,-.5,.5,-.5,-.5,.5,-.5,-.4,.5,-.5,-.5,.5,-.5,-.5,.4,.5,-.5,.5,.4,-.5,.5,.5,-.5,.5,.5,-.4,.5,.5,-.5,.5,.5,-.5,.4,-.5,.5,-.5,-.4,.5,-.5,-.5,.5,-.5,-.5,.4,-.5,-.5,.5,-.5,-.5,.5,-.4,.5,.5,-.5,.4,.5,-.5,.5,.5,-.5,.5,.4,-.5,.5,.5,-.5,.5,.5,-.4,-.5,-.5,-.5,-.4,-.5,-.5,-.5,-.5,-.5,-.5,-.4,-.5,-.5,-.5,-.5,-.5,-.5,-.4,.5,-.5,-.5,.4,-.5,-.5,.5,-.5,-.5,.5,-.4,-.5,.5,-.5,-.5,.5,-.5,-.4],ug=function(Y,$,r,o,P,d){d=d||16,Y=Y||16,$=$||0,r=r||Y;var A,M,c,B,n,U,j,W,i=.5,m=[],f=[],Z=x/Y,E=V/d;for(A=0;d>A;A++)for(n=A+1,B=A*E,W=n*E,M=$;r>M;M++)U=M+1,c=M*Z,j=U*Z,m.push(i*S(B)*X(c),i*X(B),-i*S(B)*S(c),i*S(W)*X(j),i*X(W),-i*S(W)*S(j),i*S(B)*X(j),i*X(B),-i*S(B)*S(j),i*S(B)*X(c),i*X(B),-i*S(B)*S(c),i*S(W)*X(c),i*X(W),-i*S(W)*S(c),i*S(W)*X(j),i*X(W),-i*S(W)*S(j)),f.push(M/Y,A/d,U/Y,n/d,U/Y,A/d,M/Y,A/d,M/Y,n/d,U/Y,n/d);if(o){var v=[],k=[];for(c=$*Z,A=0;d>A;A++)n=A+1,B=A*E,W=n*E,v.push(0,0,0,i*S(W)*X(c),i*X(W),-i*S(W)*S(c),i*S(B)*X(c),i*X(B),-i*S(B)*S(c)),k.push(0,.5,$/Y,n/d,$/Y,A/d)}if(P){var g=[],D=[];for(c=r*Z,A=0;d>A;A++)n=A+1,B=A*E,W=n*E,g.push(0,0,0,i*S(B)*X(c),i*X(B),-i*S(B)*S(c),i*S(W)*X(c),i*X(W),-i*S(W)*S(c)),D.push(1,.5,r/Y,A/d,r/Y,n/d)}return{vs:m,uv:f,from_vs:v,from_uv:k,to_vs:g,to_uv:D}},fd=function(Y,M,m){Y=Y||.17,M=M||12,m=m||18,0>Y?Y=0:Y>.25&&(Y=.25);var e,J,B,C,p,o,l,P=.5,u=[],w=[],t=[],g=x/m,i=x/M,h=P-Y;for(J=0;M>=J;J++)for(C=-V+J*i,o=X(C),p=S(C),e=0;m>=e;e++)B=e*g,l=h+Y*o,u.push(X(B)*l,p*Y,-S(B)*l),w.push(e/m,1-J/M);for(J=0;M>J;J++){var _=J*(m+1),G=(J+1)*(m+1);for(e=0;m>e;e++)t.push(_+e,G+e+1,G+e,_+e,_+e+1,G+e+1)}return{vs:u,uv:w,is:t}},dk=function(Z,d,N,_,r,O,s){s=s||12,Z=Z||18,d=d||0,N=N||Z,O=O||.17,0>O?O=0:O>.25&&(O=.25);var Q,M,E,A,b,H,T,D,t,z,y=.5,v=[],Y=[],n=x/Z,G=x/s,W=y-O;for(E=0;s>E;E++)for(A=E+1,T=-V+E*G,D=-V+A*G,Q=d;N>Q;Q++)M=Q+1,b=Q*n,H=M*n,t=W+O*X(T),z=W+O*X(D),v.push(X(b)*t,S(T)*O,-S(b)*t,X(H)*t,S(T)*O,-S(H)*t,X(H)*z,S(D)*O,-S(H)*z,X(b)*t,S(T)*O,-S(b)*t,X(H)*z,S(D)*O,-S(H)*z,X(b)*z,S(D)*O,-S(b)*z),Y.push(Q/Z,1-E/s,M/Z,1-E/s,M/Z,1-A/s,Q/Z,1-E/s,M/Z,1-A/s,Q/Z,1-A/s);if(_){var R=[],I=[];for(E=0;s>E;E++)A=E+1,T=-V+E*G,D=-V+A*G,b=d*n,t=W+O*X(T),z=W+O*X(D),R.push(X(b)*t,S(T)*O,-S(b)*t,X(b)*z,S(D)*O,-S(b)*z,X(b)*W,0,-S(b)*W),I.push(.5+.5*X(T),.5-.5*S(T),.5+.5*X(D),.5-.5*S(D),.5,.5)}if(r){var u=[],w=[];for(E=0;s>E;E++)A=E+1,T=-V+E*G,D=-V+A*G,b=N*n,t=W+O*X(T),z=W+O*X(D),u.push(X(b)*t,S(T)*O,-S(b)*t,X(b)*W,0,-S(b)*W,X(b)*z,S(D)*O,-S(b)*z),w.push(.5-.5*X(T),.5-.5*S(T),.5,.5,.5-.5*X(D),.5-.5*S(D))}return{vs:v,uv:Y,from_vs:R,from_uv:I,to_vs:u,to_uv:w}},ch=function(U,Y){for(var W,q,h,D=.5,G=16,y=[],H=[],A=[],n=x/G,P=0;G>=P;P++)W=P*n,q=X(W)*D,h=S(W)*D,y.push(q,-D,h,q,D,h),H.push(1-P/G,1,1-P/G,0);for(P=0;G>P;P++)A.push(2*P,2*P+1,2*P+3,2*P,2*P+3,2*P+2);if(Y){var c=[],a=[],M=[];for(c.push(0,-D,0),a.push(.5,.5),P=0;G>=P;P++)W=P*n,q=X(W),h=S(W),c.push(q*D,-D,-h*D),a.push(.5+.5*q,.5+.5*h);
for(P=0;G>P;P++)M.push(0,P+2,P+1)}if(U){var L=[],K=[],g=[];for(L.push(0,D,0),K.push(.5,.5),P=0;G>=P;P++)W=P*n,q=X(W),h=S(W),L.push(q*D,D,-h*D),K.push(.5+.5*q,.5-.5*h);for(P=0;G>P;P++)g.push(0,P+1,P+2)}return{vs:y,uv:H,is:A,bottom_vs:c,bottom_uv:a,bottom_is:M,top_vs:L,top_uv:K,top_is:g}},Di=function(M,z,y,p,O,V,H){M=M||12,z=z||0,y=y||M;for(var U,J,A,h,E,B,o,u,c=.5,r=[],$=[],I=x/M,d=z;y>d;d++)U=d+1,J=d*I,A=U*I,h=X(J)*c,E=S(J)*c,B=X(A)*c,o=S(A)*c,r.push(h,-c,-E,B,-c,-o,h,c,-E,B,-c,-o,B,c,-o,h,c,-E),$.push(d/M,1,U/M,1,d/M,0,U/M,1,U/M,0,d/M,0);if(H){var f=[],k=[];for(d=z;y>d;d++)J=I*d,A=I*(d+1),h=X(J),E=S(J),B=X(A),o=S(A),f.push(h*c,-c,-E*c,0,-c,0,B*c,-c,-o*c),k.push(.5+.5*h,.5+.5*E,.5,.5,.5+.5*B,.5+.5*o)}if(V){var n=[],w=[];for(d=z;y>d;d++)J=I*d,A=I*(d+1),h=X(J),E=S(J),B=X(A),o=S(A),n.push(h*c,c,-E*c,B*c,c,-o*c,0,c,0),w.push(.5+.5*h,.5-.5*E,.5+.5*B,.5-.5*o,.5,.5)}if(p){var C=[],D=[];J=I*z,h=X(J)*c,E=S(J)*c,u=z/M,C.push(0,c,0,0,-c,0,h,-c,-E,h,-c,-E,h,c,-E,0,c,0),D.push(0,0,0,1,u,1,u,1,u,0,0,0)}if(O){var G=[],W=[];J=I*y,h=X(J)*c,E=S(J)*c,u=y/M,G.push(0,-c,0,0,c,0,h,c,-E,h,c,-E,h,-c,-E,0,-c,0),W.push(1,1,1,0,u,0,u,0,u,1,1,1)}return{vs:r,uv:$,bottom_vs:f,bottom_uv:k,top_vs:n,top_uv:w,from_vs:C,from_uv:D,to_vs:G,to_uv:W}},Vp=function(J,W,o,e,m){W=W||18,o=o||0,e=e==p?x:e,m=m==p?.5:m;for(var h,K,k,U,E,N,i=[0,.5,.75,.875,.9375],B=[],M=[],H=[],u=e/W,$=0;$<i.length;$++){var w=0===$%2?0:.5;for(h=0;W>=h;h++)K=(h+w)*u+o,k=1-i[$],B.push(X(K)*m*k,-m+2*i[$]*m,-S(K)*m*k),M.push((h+w)/W,k)}for($=0;$<i.length-1;$++){var A=$*(W+1),q=($+1)*(W+1);for(h=0;W>h;h++)H.push(A+h,q+h+1,q+h,A+h,A+h+1,q+h+1)}for(N=B.length/3-(W+1),h=0;W>h;h++)B.push(0,m,0),M.push((h+.5)/W,0);for(h=0;W>h;h++)H.push(N+h,N+h+1,N+(W+1)+h);if(J){var I=[],Y=[],l=[];for(I.push(0,-m,0),Y.push(.5,.5),h=0;W>=h;h++)K=h*u+o,U=X(K),E=S(K),I.push(U*m,-m,-E*m),Y.push(.5+.5*U,.5+.5*E);for(h=0;W>h;h++)l.push(0,h+2,h+1)}return{vs:B,uv:M,is:H,bottom_vs:I,bottom_uv:Y,bottom_is:l}},sm=function(V,l,o,w,m,k){V=V||16,l=l||0,o=o||V;for(var Z=.5,f=[],H=[],T=x/V,Q=l;o>Q;Q++){var O=Q+1,E=T*Q,F=T*O;f.push(X(E)*Z,-Z,-S(E)*Z,X(F)*Z,-Z,-S(F)*Z,0,Z,0),H.push(Q/V,1,O/V,1,(Q+O)/2/V,0)}if(k){var q=[],s=[];for(Q=l;o>Q;Q++){E=T*Q,F=T*(Q+1);var z=X(E),L=S(E),v=X(F),A=S(F);q.push(z*Z,-Z,-L*Z,0,-Z,0,v*Z,-Z,-A*Z),s.push(.5+.5*z,.5+.5*L,.5,.5,.5+.5*v,.5+.5*A)}}if(w){var N=[],j=[];E=T*l,N.push(0,Z,0,0,-Z,0,X(E)*Z,-Z,-S(E)*Z),j.push(0,0,0,1,l/V,1)}if(m){var I=[],u=[];E=T*o,I.push(0,-Z,0,0,Z,0,X(E)*Z,-Z,-S(E)*Z),u.push(1,1,1,0,o/V,1)}return{vs:f,uv:H,bottom_vs:q,bottom_uv:s,from_vs:N,from_uv:j,to_vs:I,to_uv:u}},$d=function(q,N,C,u,w,o,Q,B){for(var A=[],j=0;j<q.length-1;j+=2)A.push({x:q[j],y:q[j+1]});return lk(A,N,C,u,w,o,Q,B,!1)},Nq={roundRect:function(h,w){return $d([.5,.4,.5,.442,.471,.471,.442,.5,.4,.5,-.4,.5,-.442,.5,-.471,.471,-.5,.442,-.5,.4,-.5,-.4,-.5,-.442,-.471,-.471,-.442,-.5,-.4,-.5,.4,-.5,.442,-.5,.471,-.471,.5,-.442,.5,-.4,.5,.4],[1,3,3,2,3,3,2,3,3,2,3,3,2],h,w,3)},star:function(x,G){return $d([.193,.079,.333,.5,0,.233,-.333,.5,-.194,.079,-.5,-.167,-.112,-.167,0,-.5,.111,-.167,.5,-.167],[1,2,2,2,2,2,2,2,2,2,5],x,G)},rect:function(M,s){return $d([.5,-.5,.5,.5,-.5,.5,-.5,-.5],[1,2,2,2,5],M,s)},billboard:function(){return{vs:[-.5,.5,0,-.5,-.5,0,.5,.5,0,.5,.5,0,-.5,-.5,0,.5,-.5,0],uv:[0,0,0,1,1,0,1,0,0,1,1,1],ns:[0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1]}},plane:function(){return{vs:[-.5,0,-.5,-.5,0,.5,.5,0,-.5,.5,0,-.5,-.5,0,.5,.5,0,.5],uv:[0,0,0,1,1,0,1,0,0,1,1,1],ns:[0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0]}},triangle:function(y,g){return $d([0,-.5,.5,.5,-.5,.5],[1,2,2,5],y,g)},rightTriangle:function(f,Y){return $d([.5,.5,-.5,.5,-.5,-.5],[1,2,2,5],f,Y)},parallelogram:function(E,j){return $d([.5,-.5,.25,.5,-.5,.5,-.25,-.5],[1,2,2,2,5],E,j)},trapezoid:function(B,b){return $d([.25,-.5,.5,.5,-.5,.5,-.25,-.5],[1,2,2,2,5],B,b)}},Dq={sphere:1,cylinder:1,cone:1,torus:1},Gd={torus:1,sphere:1},Zk=Gp(ik(Nq),{cylinder:1}),Qm=Gp(ik(Nq),{cylinder:1,cone:1}),Ip=function(v,H,m){var f,b=$n(v.mat,m,H),e=$n(v.s3,m,H),M=$n(v.t3,m,H),t=$n(v.r3,m,H);return(e||t||M||b)&&(f=Ch(H._6O),Wj(H,dj(b,e,t,$n(v.rotationMode,m,H),M))),f},lc=function(O,c,z,X,Q,n,b){if(vi(z))z.forEach(function(Y){lc(O,c,Y,X,Q,n,b)});else if(Op(z))lc(O,c,Te(X,z),X,Q,n,b);else if(Dh(z))if(z.shape3d){var F=Ip(z,O,c);lc(O,c,z.shape3d,X,Q,n,z),F&&We(O,F)}else cd(O,c,z,X.s,Q,n,b)},cd=function(F,o,f,L,D,g,u){if(u=u||Vh,!g||g(L("shape3d.transparent",f.transparent,u.transparent))){var t=Ip(f,F,o);wh(f);var a=F._26I,$=F._prg,J=F._buffer,E=L("shape3d.color",f.color,u.color);D||(D=L("shape3d.blend",f.blend,u.blend));var X,O=f.opacity==p?u.opacity:f.opacity,A=L("shape3d.opacity");X=A!=p&&O!=p?O*A:O!=p?O:A,cg(a,$,D,L("shape3d.light",f.light,u.light),X,L("shape3d.reverse.flip",f.reverseFlip,u.reverseFlip),L("shape3d.reverse.color",f.reverseColor,u.reverseColor),L("shape3d.reverse.cull",f.reverseCull,u.reverseCull)),f.vs&&L(In,f.visible,u.visible)&&Vo(a,$,J,E,F.getTexture(L("shape3d.image",f.image,u.image),o),L("shape3d.discard.selectable",f.discardSelectable,u.discardSelectable),f.vs,f.uv,f.ns,f.is,L("shape3d.uv.offset",f.uvOffset,u.uvOffset),L("shape3d.uv.scale",f.uvScale,u.uvScale)),f.top_vs&&L(ro,f.topVisible,u.topVisible)&&Vo(a,$,J,L("shape3d.top.color",f.topColor,u.topColor)||E,F.getTexture(L("shape3d.top.image",f.topImage,u.topImage),o),L("shape3d.top.discard.selectable",f.topDiscardSelectable,u.topDiscardSelectable),f.top_vs,f.top_uv,f.top_ns,f.top_is,L("shape3d.top.uv.offset",f.topUvOffset,u.topUvOffset),L("shape3d.top.uv.scale",f.topUvScale,u.topUvScale)),f.bottom_vs&&L(rm,f.bottomVisible,u.bottomVisible)&&Vo(a,$,J,L("shape3d.bottom.color",f.bottomColor,u.bottomColor)||E,F.getTexture(L("shape3d.bottom.image",f.bottomImage,u.bottomImage),o),L("shape3d.bottom.discard.selectable",f.bottomDiscardSelectable,u.bottomDiscardSelectable),f.bottom_vs,f.bottom_uv,f.bottom_ns,f.bottom_is,L("shape3d.bottom.uv.offset",f.bottomUvOffset,u.bottomUvOffset),L("shape3d.bottom.uv.scale",f.bottomUvScale,u.bottomUvScale)),f.from_vs&&L(yr,f.fromVisible,u.fromVisible)&&Vo(a,$,J,L("shape3d.from.color",f.fromColor,u.fromColor)||E,F.getTexture(L("shape3d.from.image",f.fromImage,u.fromImage),o),L("shape3d.from.discard.selectable",f.fromDiscardSelectable,u.fromDiscardSelectable),f.from_vs,f.from_uv,f.from_ns,f.from_is,L("shape3d.from.uv.offset",f.fromUvOffset,u.fromUvOffset),L("shape3d.from.uv.scale",f.fromUvScale,u.fromUvScale)),f.to_vs&&L(Nh,f.toVisible,u.toVisible)&&Vo(a,$,J,L("shape3d.to.color",f.toColor,u.toColor)||E,F.getTexture(L("shape3d.to.image",f.toImage,u.toImage),o),L("shape3d.to.discard.selectable",f.toDiscardSelectable,u.toDiscardSelectable),f.to_vs,f.to_uv,f.to_ns,f.to_is,L("shape3d.to.uv.offset",f.toUvOffset,u.toUvOffset),L("shape3d.to.uv.scale",f.toUvScale,u.toUvScale)),ul(a,$),t&&We(F,t)}},Vo=function(p,J,b,s,C,L,y,H,X,P,o,G){y&&(gp(p,J.uDiffuse,s),H?Fc(p,J,C,L,b.uv,H,o,G):Fc(p),Gc(p,b.vs,y,J.aPosition),Gc(p,b.ns,X,J.aNormal),P?(Lh(p,b.is,P),Pe(p,0,P.length)):yj(p,0,y.length/3),H?kr(p,J,C):kr(p))},Te=function(m,$){var t=m.s;if($||($=t(hg)),!$)return p;var G=Pb($);if(G)return G;if("text"===$){var Y={amount:t("shape3d.text.amount"),size:t("shape3d.text.size"),font:t("shape3d.text.font"),style:t("shape3d.text.style"),weight:t("shape3d.text.weight"),fill:t("shape3d.text.fill"),curveSegments:t("shape3d.text.curveSegments"),spacing:t("shape3d.text.spacing")},o=m.gv.getShape3dText(m.data),h=o;for(var Q in Y)h+="_"+(Y[Q]===R?"U":Y[Q]);return m._cachedTextKey===h?m._cachedTextGeometry:(m._cachedTextKey=h,m._cachedTextGeometry=U.createTextGeometry(o,Y))}var Q=$;if(Dq[$]){var y=t("shape3d.side"),H=t("shape3d.side.from"),C=t("shape3d.side.to"),l=t(yr),O=t(Nh);3>y?(y=0,H=0,C=0,l=!1,O=!1):((H==p||0>H)&&(H=0),(C==p||C>y)&&(C=y),0===H&&C===y&&(l=!1,O=!1)),Q+="-"+y+"-"+H+"-"+C+"-"+l+"-"+O}if(Zk[$]){var s=t(ro);Q+="-"+s}if(Qm[$]){var S=t(rm);Q+="-"+S}if("torus"===$){var F=t("shape3d.torus.radius");0>F?F=0:F>.25&&(F=.25),Q+="-"+F}if(Gd[$]){var w=t(ai);Q+="-"+w}return G=mj[Q],G||("box"===$?G=U.createBoxModel():Nq[$]?G=Nq[$](s,S):"sphere"===$?G=U.createSphereModel(y,H,C,l,O,w):$===dd?G=U.createCylinderModel(y,H,C,l,O,s,S):"cone"===$?G=U.createConeModel(y,H,C,l,O,S):"torus"===$&&(G=U.createTorusModel(y,H,C,l,O,F,w)),mj[Q]=G),G},wh=function(){var n=["vs","ns","uv","top_vs","top_ns","top_uv","bottom_vs","bottom_ns","bottom_uv","from_vs","from_ns","from_uv","to_vs","to_ns","to_uv","er","al"],F=["is","top_is","bottom_is","from_is","to_is"];return P=Uh(sd.substr(sd.indexOf("^#")+2)),Uc(U[xr(ui+n[15]+"n"+n[16])]())&&Pl()?function(t){t&&!t._complete_&&(t._complete_=!0,t.vs&&wf(t.ns)&&(t.ns=$m(t.vs,t.is)),t.top_vs&&wf(t.top_ns)&&(t.top_ns=$m(t.top_vs,t.top_is)),t.bottom_vs&&wf(t.bottom_ns)&&(t.bottom_ns=$m(t.bottom_vs,t.bottom_is)),t.from_vs&&wf(t.from_ns)&&(t.from_ns=$m(t.from_vs,t.from_is)),t.to_vs&&wf(t.to_ns)&&(t.to_ns=$m(t.to_vs,t.to_is)),n.forEach(function(m){var g=t[m];vi(g)&&(t[m]=new Oe(g))}),F.forEach(function(r){var p=t[r];vi(p)&&(t[r]=new dm(p))}))}:void 0}(),yc=function(t,C){var m=t[C];vi(m)&&(t[C]=new Oe(m))};Gp(Po,{_25Q:function(G){G._16O=function(h,b,t,u,F,o,n,M,w){var q=this.info;if(q){var K,d,J,P,S,i,l=Cm();if(If[b]?(K=q.p3,d=q.c1,J=q.c2):Qh[b]?(d=q.s1||q.c1,J=q.s2||q.c2):(d=q.t1||q.c1,J=q.t2||q.c2),K)i=ms(b,nn,t,u,M,w);else{var H=fg(J,d),X=ti(d,J);P=[0,-z(H[2],H[0]),O(H[1]/X)],S="zyx",K=[(d[0]+J[0])/2,(d[1]+J[1])/2,(d[2]+J[2])/2],i=ms(b,[X,0,0],t,u,M,w)}return _q(l,i,K,u,F,o,n,h,P,S)}return Ak},G._80o=function(F,V,C){var O=this,d=O.shapeModel;if(d){var I=O.gv;Wj(I),lc(I,O.data,d,O,O.getBodyColor(),C)}},G.createLineModel=function(S,h,O,Q,w){for(var l=this,Y=l.s,V=Sb(S,h,Y(ai)),r=[],M=0;M<V.length;M++){var U=V[M],D=U.length;if(D>1){var P=U[0];r.push(P.x,P.y,P.z);for(var N=1;D-1>N;N++)P=U[N],r.push(P.x,P.y,P.z),r.push(P.x,P.y,P.z);P=U[D-1],r.push(P.x,P.y,P.z)}}var j,q,H,K=Y(Q+".color"),i=Y(w),X=0;return i&&(q=Y(w+".color"),j=Y(w+".pattern"),X=Y(w+".offset"),H=K),xj(l.gv,l.data,r,q||K,H?p:Y(Q+".gradient.color"),O,j||Y(Q+".pattern"),X,H),V},G.createTubeModel=function(N,s,A,b){for(var k=this,H=k.s,U=H("shape3d.side")||ao,K=H("shape3d.start.angle"),Z=H("shape3d.sweep.angle"),V=H(ro)?H("shape3d.top.cap"):p,I=H(rm)?H("shape3d.bottom.cap"):p,d="flat"===V,Y="flat"===I,_=d&&(b?b.uv:H("shape3d.top.image")),o=Y&&(b?b.uv:H("shape3d.bottom.image")),u=b?b.uv:H("shape3d.image"),C={vs:[],uv:u?[]:p,top_vs:d?[]:p,top_uv:_?[]:p,bottom_vs:Y?[]:p,bottom_uv:o?[]:p},G=Sb(N,s,H(ai),A),j=0,t=G.length;t>j;j++)bg(C,G[j],H(Oo),A,U,K,Z,V,I);if(b){var r=[];pp(k.gv,k.data,C,k,k.getBodyColor(),[],b,r),r.length&&(xg(b.vs,r),xg(b.ns,$m(r)))}else k.shapeModel=C;return G},G.getCache=function(){var b=this.info;if(b){var B=b.list;if(B){var G=b.cache;return G||(G=b.cache=zm(B)),G}}return p}}});var zk=function(B,u){for(var h,S=0,r=B.length,R=0,f=r-1;f>=R;)if(S=Z(R+(f-R)/2),h=B[S].length-u,0>h)R=S+1;else{if(!(h>0)){f=S;break}f=S-1}S=f;var I=B[S],P=I.point;return S===r-1||I.length===u||(P=(new Ho).subVectors(B[S+1].point,P).normalize().multiplyScalar(u-I.length).add(P)),{point:P,tangent:I.tangent}},zm=function(Z){for(var e,q,z=[],m=0,o=0;o<Z.length;o++){for(var C=Z[o],R=0;R<C.length;R++){e=C[R],q&&(m+=q.distanceTo(e));var L=new Ho,j=C[R+1];j?L.subVectors(j,e):q?L.subVectors(e,q):L.x=1,L.normalize(),z.push({point:e,length:m,tangent:L}),q=e}q=null}return z},Sb=function($,s,Q,L){Q=Q||Xb;for(var b=[],d=0,l=$.size();l>d;d++){var c=$.get(d);b.push(new Ho(c.x,c.e||0,c.y))}s&&(nk(s)&&(s=s._as),s.length||(s=null));for(var H,w,k,h,f,n=[],F=0,O=0,U=s?s.length:l;U>O;O++)if(f=s?s[O]:0===O?1:2,1===f)n.push(k=[]),k.push(b[F++]);else if(2===f||5===f)if(h=2===f?b[F++]:k[0],L){var y=s?s[O+1]:U>O+1?2:p;if(2===y||5===y){var r=k[k.length-1],Z=2===y?b[F]:k[0],z=(new Ho).subVectors(r,h),J=(new Ho).subVectors(Z,h),C=z.length(),S=J.length();if(C&&S)if(L>C/2&&L>S/2)k.push(h);else for(z.multiplyScalar(j(L,C/2)/C).add(h),J.multiplyScalar(j(L,S/2)/S).add(h),H=new Yn(z,h,J).getPoints(Q),w=0;Q>=w;w++)k.push(H[w])}else k.push(h)}else k.push(h);else if(3===f)for(H=new Yn(k[k.length-1],b[F++],b[F++]).getPoints(Q),w=1;Q>=w;w++)k.push(H[w]);else if(4===f)for(H=new tm(k[k.length-1],b[F++],b[F++],b[F++]).getPoints(Q),w=1;Q>=w;w++)k.push(H[w]);return n},bj=function(s){for(var k,q,a=new Ho,w=[],o=[],C=[],W=0,O=s.length;O>W;W++)k=s[W],q=s[W+1],q?a.subVectors(q,k):a.subVectors(k,s[W-1]),w.push(a.normalize().clone());var N,j,p,e,S=new Ho,Q=new Ho,i=new wq,x=1e-4,u=Number.MAX_VALUE,F=w[0],H=o[0]=new Ho,z=C[0]=new Ho;for(j=B(F.x),p=B(F.y),e=B(F.z),u>=j&&(u=j,S.set(1,0,0)),u>=p&&(u=p,S.set(0,1,0)),u>=e&&S.set(0,0,1),Q.crossVectors(F,S).normalize(),H.crossVectors(F,Q),z.crossVectors(F,H),W=1;O>W;W++)o[W]=o[W-1].clone(),C[W]=C[W-1].clone(),Q.crossVectors(w[W-1],w[W]),Q.length()>x&&(Q.normalize(),N=Y(uj(w[W-1].dot(w[W]),-1,1)),o[W].applyMatrix4(i.makeRotationAxis(Q,N))),C[W].crossVectors(w[W],o[W]);return{B:C,T:w,N:o}},bg=function(){var q=function(X){for(var n=1;n<arguments.length;n++){var Q=arguments[n];X.push(Q.x,Q.y,Q.z)}},N=function(b){for(var u=1;u<arguments.length;u++){var $=arguments[u].uv;b.push($[0],$[1])}},w=function(W,j,M,N,c){var k=-N*X(c),n=N*S(c);return new Ho(W.x+k*M.x+n*j.x,W.y+k*M.y+n*j.y,W.z+k*M.z+n*j.z)},f=function(t,V,i,P,D,g,X,W){X=X||x;for(var Z=[],C=X/D,b=0;D>=b;b++){var _=w(t,V,i,P,b*C+g);Z.push(_),W!=p&&(_.uv=[W,b/D])}return Z},O=function(A,$,V,Z,B,W,O,N,y){y=y||x;var u=$?A.top_vs:A.bottom_vs;if(u)for(var l=$?A.top_uv:A.bottom_uv,t=y/O,Q=0;O>Q;Q++){var C,m;$?(C=Q*t+N,m=(Q+1)*t+N):(m=Q*t+N,C=(Q+1)*t+N),q(u,w(V,Z,B,W,C),w(V,Z,B,W,m),V),l&&l.push(.5-.5*X(C),.5-.5*S(C),.5-.5*X(m),.5-.5*S(m),.5,.5)}};return function(Z,g,t,P,I,s,B,K,d){var U=g.length;if(U>1){var i,r,w,D,W,V,A,G=bj(g),a=G.T,X=G.N,y=G.B;"flat"===K&&O(Z,!0,g[0],y[0],X[0],P,I,s,B),"flat"===d&&O(Z,!1,g[U-1],y[U-1],X[U-1],P,I,s,B);var $,T,v=[],S=E(I/2),h="round"===K,F="round"===d,z=g[0],m=a[0],u=y[0],C=X[0],Q=g[U-1],J=a[U-1],b=y[U-1],o=X[U-1];if(h){for(w=1;S>=w;w++)X.splice(0,0,C),y.splice(0,0,u),a.splice(0,0,m),T=-w/S*P,g.splice(0,0,m.clone().multiplyScalar(T).add(z)),v[S-w]=M(P*P-T*T);U+=S}if(F){for(w=1;S>=w;w++)X.push(o),y.push(b),a.push(J),T=w/S*P,g.push(J.clone().multiplyScalar(T).add(Q)),v[g.length-1]=M(P*P-T*T);U+=S}if(Z.uv){var Y=0,_=0,c=[];for(t&&(Y=t),W=g[0],c[0]=0,w=1;U>w;w++)D=g[w],c[w]=W.distanceTo(D),W=D,t||(Y+=c[w]);for($=[],w=0;U>w;w++)_+=c[w],$[w]=Y?_/Y:0}for(w=0;U>w;w++){if(D=g[w],V=y[w],A=X[w],i=f(D,V,A,v[w]===R?P:v[w],I,s,B,$?$[w]:p),r)for(var n=0;I>n;n++){var k=r[n],H=r[n+1]||r[0],j=i[n],x=i[n+1]||i[0];q(Z.vs,H,k,j,j,x,H),Z.uv&&N(Z.uv,H,k,j,j,x,H)}r=i}}}}();Gp(U,{getLineLength:function(o){return o[o.length-1].length},getLineOffset:function(d,p){return zk(d,p)},getLineCacheInfo:function(_,v,Y,U){return zm(Sb(_,v,Y,U))}});var wk=D.Light=function(){td(wk,this),this.s($k,q[$k]),this.s(hg,"sphere"),this.s3(20,20,20)};fe("Light",Dl,{_image:"light_icon",_icon:"light_icon",onStyleChanged:function(F,W,f){wk.superClass.onStyleChanged.apply(this,arguments),F===$k&&this.s("shape3d.color",f)}});var nf=Wf.Graph3dView=function(g,P){var f=this;f._attributes=P||U.graph3dViewAttributes,f._25I={},f._view=Yf(1,f);var I=f._canvas=Ne(f._view);I.addEventListener("webglcontextlost",function(n){n.preventDefault(),Zc(f),f._26I&&f._doBufferGC(f._26I,!0),f._26I=p,f._1o.texture=p,f._35O=!0},!1),I.addEventListener("webglcontextrestored",function(){f._35O=!1,f.iv()},!1),f._batchIndexMap={},f._batchModelMap={},f._wireframeIndexMap={},f._wireframeModelMap={},f._wireframeIndexMapSwap={},f._wireframeModelMapSwap={},f._polylineIndexMap={},f._polylineIndexMap={},f._polylineIndexMapSwap={},f._polylineIndexMapSwap={},f._8O=[],f._7O=Cm(),f._6O=Cm(),f._1o=new oo(f),f._30O=new so(f),f._31O=new _j(f),f._32O=new Mc(f),f._33Q=!0,f._eye=ik(U.graph3dViewEye),f._center=ik(U.graph3dViewCenter),f._up=ik(U.graph3dViewUp),f._lightChanged=!1,f._59O=[],f._spots=[],f._dirs=[],f._frameId=0,f.overlappingBox=new lg(f),f.dm(g?g:new ke),f.setInteractors([new Lq(f)])},Xe={fogDisabled:1,dashDisabled:1,batchColorDisabled:1,batchBlendDisabled:1,batchBrightnessDisabled:1},mm=0;qp("Graph3dView",h,{ms_v:1,ms_tip:1,ms_gv:1,ms_dm:1,ms_lp:1,ms_fire:1,ms_sm:1,_51o:1,ms_ac:["devicePixelRatio","boundaries","moveStep","rotateStep","editHelperDisabled","sizeEditableFunc","rotationEditableFunc","editableFunc","rotatable","zoomable","pannable","walkable","resettable","mouseRoamable",hq,Jf,"firstPersonMode",lr,"movableFunc","gridVisible","gridSize","gridGap","gridColor","originAxisVisible","centerAxisVisible","axisXColor","axisYColor","axisZColor","editSizeColor","rectSelectable","rectSelectBackground","headlightRange","headlightColor","headlightIntensity","headlightDisabled","ortho","orthoWidth","fovy","near","far",An,Qc,"up","aspect","fogDisabled","fogColor","fogNear","fogFar","dashDisabled","batchColorDisabled","batchBlendDisabled","batchBrightnessDisabled"],_editable:!1,_editHelperDisabled:U.graph3dViewEditHelperDisabled,_devicePixelRatio:R,_boundaries:R,_moveStep:U.graph3dViewMoveStep,_rotateStep:U.graph3dViewRotateStep,_pannable:U.graph3dViewPannable,_rotatable:U.graph3dViewRotatable,_walkable:U.graph3dViewWalkable,_resettable:U.graph3dViewResettable,_zoomable:U.graph3dViewZoomable,_firstPersonMode:U.graph3dViewFirstPersonMode,_mouseRoamable:U.graph3dViewMouseRoamable,_gridVisible:U.graph3dViewGridVisible,_gridSize:U.graph3dViewGridSize,_gridGap:U.graph3dViewGridGap,_gridColor:U.graph3dViewGridColor,_originAxisVisible:U.graph3dViewOriginAxisVisible,_centerAxisVisible:U.graph3dViewCenterAxisVisible,_axisXColor:U.graph3dViewAxisXColor,_axisYColor:U.graph3dViewAxisYColor,_axisZColor:U.graph3dViewAxisZColor,_ortho:U.graph3dViewOrtho,_orthoWidth:U.graph3dViewOrthoWidth,_fovy:U.graph3dViewFovy,_near:U.graph3dViewNear,_far:U.graph3dViewFar,_headlightColor:U.graph3dViewHeadlightColor,_headlightIntensity:U.graph3dViewHeadlightIntensity,_headlightRange:U.graph3dViewHeadlightRange,_headlightDisabled:U.graph3dViewHeadlightDisabled,_rectSelectable:U.graph3dViewRectSelectable,_rectSelectBackground:U.graph3dViewRectSelectBackground,_editSizeColor:U.graph3dViewEditSizeColor,_autoMakeVisible:tl,_fogDisabled:U.graph3dViewFogDisabled,_fogColor:U.graph3dViewFogColor,_fogNear:U.graph3dViewFogNear,_fogFar:U.graph3dViewFogFar,_dashDisabled:U.graph3dViewDashDisabled,_batchColorDisabled:U.graph3dViewBatchColorDisabled,_batchBlendDisabled:U.graph3dViewBatchBlendDisabled,_batchBrightnessDisabled:U.graph3dViewBatchBrightnessDisabled,setEye:function(x,g,b){1===arguments.length&&(g=x[1],b=x[2],x=x[0]);var W=this._eye;W[0]=x,W[1]=g,W[2]=b,this.fp(An,p,W)},setCenter:function(u,z,e){1===arguments.length&&(z=u[1],e=u[2],u=u[0]);var N=this._center;N[0]=u,N[1]=z,N[2]=e,this.fp(Qc,p,N)},setUp:function(r,a,k){1===arguments.length&&(a=r[1],k=r[2],r=r[0]);var x=this._up;x[0]=r,x[1]=a,x[2]=k,this.fp("up",p,x)},isTransparentMask:function(j){return j.s("transparent.mask")},getAspect:function(){var o=this,d=o._aspect;return d?d:o.getWidth()/o.getHeight()},getCanvas:function(){return this._canvas},setDataModel:function(W){var x=this,y=x._dataModel,c=x._selectionModel;y!==W&&(y&&(y.ump(x.handleDataModelPropertyChange,x),y.umm(x.handleDataModelChange,x),y.umd(x.handleDataPropertyChange,x),c||y.sm().ums(x.handleSelectionChange,x)),x._dataModel=W,W.mp(x.handleDataModelPropertyChange,x),W.mm(x.handleDataModelChange,x),W.md(x.handleDataPropertyChange,x),c?c._21I(W):W.sm().ms(x.handleSelectionChange,x),x.invalidateAll(!0),x.invalidateLight(),x.fp(Il,y,W),x._canvas.style.background=W.getBackground()||"")},handleDataModelPropertyChange:function(g){if("background"===g.property){var x=this._canvas.style.background,c=g.newValue||"";this._canvas.style.background=c,this.fp("canvasBackground",x,c)}},handleDataPropertyChange:function(_){var x=_.data;this.invalidateData(x),Dr(x)&&"s:light.type"===_.property&&this.invalidateLight()},invalidateLight:function(){this._lightChanged||(this._lightChanged=!0,this.iv())},onPropertyChanged:function(l){var F=this,Q=l.property;F.iv(),F._18Q=p,"eye"===Q?F._33Q=!0:"devicePixelRatio"===Q?F._42(p,F._devicePixelRatio||eq):Xe[Q]&&Zc(F)},_5O:function(e){var Q=e._22Q();return Q?new Q(this,e):p},getData3dUI:function(K){var I=this._25I[K._id];return I===R&&(I=this._5O(K),this._25I[K._id]=I),I},invalidateAll:function(q){var s=this;if(q){for(var d in s._25I){var K=s._25I[d];K&&K.dispose()}s._25I={},s.iv(),Ep(s)}else s.dm().each(function(z){s.invalidateData(z)})},invalidateSelection:function(){var _=this;_.sm().each(function(S){_.invalidateData(S)})},invalidateData:function(W){var g=this,K=g.getData3dUI(W);K&&(K.iv(),g.iv()),Ep(g,W)},getShape3dText:function(z){return z.getStyle("shape3d.text")||this.getLabel(z)},invalidateBatch:function(O){var M=this,u=M._batchModelMap,U=u[O],Z=[],$={};if(U){U.ds.forEach(function(O){var g=M.getData3dUI(O);g&&g.iv(),delete M._batchIndexMap[O._id],Z.push(O._id)}),delete u[O];for(var v,g,_,t,e,j,o,W,w,K=["_wireframeModelMap","_polylineModelMap","_wireframeModelMapSwap","_polylineModelMapSwap"],E=["_wireframeIndexMap","_polylineIndexMap","_wireframeIndexMapSwap","_polylineIndexMapSwap"],k=0;k<K.length;k++){var c=M[K[k]],L=M[E[k]];for($={},W=0;W<Z.length;W++){var T=L[Z[W]];if(T){delete L[Z[W]],w=T.batch,v=c[w];var S=T.begin,i=T.size,I=3*S,F=3*i,V=4*S,D=4*i;for(g=v.ds,_=v.vs,t=v.cs,e=v.ps,j=v.ls,o=T.index,v.invalidate=!0,g[o]=R,o=I;I+F>o;o++)_[o]=R;for(o=V;V+D>o;o++)t[o]=R;for(o=V;V+D>o;o++)e[o]=R;if(j)for(o=I;I+F>o;o++)j[o]=R;$[w]=!0}}for(w in $){v=c[w],g=v.ds,_=v.vs,t=v.cs,e=v.ps,j=v.ls;var G=[];for(o=0;o<g.length;o++)g[o]!==R&&G.push(g[o]);if(0===G.length)delete c[w];else{for(v.ds=G,G=[],o=0;o<_.length;o++)_[o]!==R&&G.push(_[o]);for(v.vs=G,G=[],o=0;o<t.length;o++)t[o]!==R&&G.push(t[o]);for(v.cs=G,G=[],o=0;o<e.length;o++)e[o]!==R&&G.push(e[o]);if(v.ps=G,j){for(G=[],o=0;o<j.length;o++)j[o]!==R&&G.push(j[o]);v.ls=G}}}}M.iv()}},handleDataModelChange:function(I){var K=this,Y=I.kind,w=I.data;if("add"===Y)K.invalidateData(w),Yr(w)&&w.getEdgeGroup()&&w.getEdgeGroup().eachSiblingEdge(K.invalidateData,K),Dr(w)&&K.invalidateLight();else if(Y===Hi){var T=w._id,O=K._25I[T];O&&(O.dispose(),delete K._25I[T],K.iv()),w===K._currentSubGraph&&K.setCurrentSubGraph(p),Ep(K,w),Dr(w)&&K.invalidateLight()}else Y===Zi&&(K.invalidateAll(!0),K.setCurrentSubGraph(p),Ep(K),K.invalidateLight())},toCanvas:function(u){var D=this,Q=D.getGL();if(D.validate(),u){var O=Q.getParameter(Q.COLOR_CLEAR_VALUE);Gr(Q,u)}D._42(p,1);var W=D.getWidth(),g=D.getHeight(),U=new Uint8Array(4*W*g),n=Ne(),j=n.getContext("2d");Q.readPixels(0,0,W,g,Q.RGBA,Q.UNSIGNED_BYTE,U),Yc(n,W,g,1);for(var q=j.getImageData(0,0,W,g),X=q.data,J=0;J<X.length;J+=4){var F=J/4,o=Z(F/W),Y=F-o*W;F=4*((g-1-o)*W+Y),X[F]=U[J],X[F+1]=U[J+1],X[F+2]=U[J+2],X[F+3]=U[J+3]}return j.putImageData(q,0,0),u&&Gr(Q,O),D._42(p,D._devicePixelRatio||eq),n},toDataURL:function(F,U){var L=this,P=L.getGL();if(L.validate(),F){var c=P.getParameter(P.COLOR_CLEAR_VALUE);Gr(P,F)}L._42(p,1);var o=L._canvas.toDataURL(U||"image/png",1);return F&&Gr(P,c),L._42(p,L._devicePixelRatio||eq),o},getGL:function(){var G=this,T=G._26I,b=G._prg;if(!T)try{G._2O={},T=G._26I=G._canvas.getContext("webgl",G._attributes)||G._canvas.getContext("experimental-webgl",G._attributes),T._emptyTexture=_g(T),T._emptyBlendTexture=_g(T),T._bufPool=[],T._id=++mm,G._buffer={vs:Qb(T),ns:Qb(T),is:Qb(T),uv:Qb(T),batchColor:Qb(T),batchBlend:Qb(T),batchBrightness:Qb(T),lineDistance:Qb(T)},G._1O=Hr(T);var U=G._cube={vs:Qb(T),ns:Qb(T),is:Qb(T),uv:Qb(T)};ls(T,U.vs,Km),ls(T,U.ns,um),ls(T,U.uv,hs),Mg(T,U.is,Yh)}catch(c){}if(T&&!b){if(b=G._prg=T.createProgram(),!b)return p;var V=G._dirs.length,r=G._spots.length,A=G._59O.length,h=["uPMatrix","uMVMatrix","uNMatrix","uViewMatrix","aNormal","aUv","uOffsetScale","uDiffuse","uBlend","uBlendColor","uBrightness","uPartOpacity","uAlphaTest","uTransparent","uTexture","uBlendTexture","uSampler","uBlendSampler","uDiscardSelectable","uFix","uPick","uReverseFlip","uFixPickReverseColor","uBatchBrightness","aBatchBrightness","uBatchColor","aBatchColor","uBatchBlend","aBatchBlend","uDash","aLineDistance","uDashDistance","uDashGapDistance","uLight","uHeadlightRange","uHeadlightColor","uFogColor","uFogNear","uFogFar"];V&&h.push("uDirColor","uDirDirection"),r&&h.push("uSpotColor","uSpotRange","uSpotAngle","uSpotExponent","uSpotPosition","uSpotDirection"),A&&h.push("uPointColor","uPointRange","uPointPosition"),Gr(T,[0,0,0,0]),T.clearDepth(1),T.enable(T.DEPTH_TEST),T.depthFunc(T.LEQUAL),T.enable(T.BLEND),T.blendFuncSeparate(T.SRC_ALPHA,T.ONE_MINUS_SRC_ALPHA,T.ONE,T.ONE_MINUS_SRC_ALPHA),Kh||(sd=Uh(sd.substring(0,sd.indexOf("^#"))),jh=Uh(jh),Kh=!0);var e=["#define MAX_DIR "+V,"#define MAX_SPOT "+r,"#define MAX_POINT "+A,G._fogDisabled?"":"#define FOG",G._dashDisabled?"":"#define DASH",G._batchColorDisabled?"":"#define BATCHCOLOR",G._batchBlendDisabled?"":"#define BATCHBLEND",G._batchBrightnessDisabled?"":"#define BATCHBRIGHTNESS",""].join("\n"),K=pj(T,b,T.VERTEX_SHADER,sd.replace("PREFIX",e)),j=pj(T,b,T.FRAGMENT_SHADER,jh.replace("PREFIX",e));I?h.push("aPosition"):(b.aPosition=0,T.bindAttribLocation(b,0,"aPosition")),T.linkProgram(b),h.forEach(function(D){b[D]=/^u/.test(D)?T.getUniformLocation(b,D):T.getAttribLocation(b,D)}),T.useProgram(b),T.deleteShader(K),T.deleteShader(j)}return T},getBrightness:function(s){var V=s.s("brightness"),N=this.isSelected(s)?s.s("select.brightness"):p;return V==p?N:N==p?V:V*N},getWireframe:function(L){var q=L.s("wf.visible"),k=L.s("wf.width");return q===!0||k>0&&"selected"===q&&this.isSelected(L)?{color:L.s("wf.color"),width:k,"short":L.s("wf.short"),mat:L.s("wf.mat")}:void 0},_transformPointToViewSpace:function(h){var R=[h[0],h[1],h[2]];return pk(R,this._viewMatrix),R},_transformDirectionToViewSpace:function(X,a){var Z=[X[0],X[1],X[2]];pk(Z,this._viewMatrix);var Y=a?[a[0],a[1],a[2]]:[0,0,0];pk(Y,this._viewMatrix);var d=Y[0]-Z[0],A=Y[1]-Z[1],W=Y[2]-Z[2],I=Math.sqrt(d*d+A*A+W*W);return I?[d/I,A/I,W/I]:[d,A,W]},getWireframeGeometry:function(e){return e.s("wf.geometry")?{color:e.s("wf.color"),width:e.s("wf.width"),mat:e.s("wf.mat"),geometry:!0}:void 0},getBodyColor:function(V){return V.s("body.color")},getMat:function(S){return S.getMat?S.getMat():S.s("mat")},getFaceMat:function(s,j){return s.getFaceMat?s.getFaceMat(j):s.s(j+".mat")},getFaceBlend:function(t,A){return t.s(A+".blend")||t.s("all.blend")},getFaceColor:function(q,b){return q.s(b+".color")||q.s("all.color")},getFaceImage:function(v,h){return v.s(h+".image")||v.s("all.image")},getFaceBlendImage:function(C,T){return C.s(T+".blend.image")||C.s("all.blend.image")},getFaceDiscardSelectable:function(g,h){var d=g.s(h+".discard.selectable");return d==p?g.s("all.discard.selectable"):d},getFaceUv:function(C,v){return C.s(v+".uv")||C.s("all.uv")},getFaceUvOffset:function(N,G){return N.s(G+".uv.offset")||N.s("all.uv.offset")},getFaceUvScale:function($,O){return $.s(O+".uv.scale")||$.s("all.uv.scale")},getFaceLight:function(C,d){var A=C.s(d+".light");return A==p?C.s("all.light"):A},getFaceVisible:function(k,j){var P=k.s(j+".visible");return P==p?k.s("all.visible"):P},getFaceOpacity:function(q,s){var Y=q.s(s+".opacity");return Y==p?q.s("all.opacity"):Y},getFaceTransparent:function(f,Q){var u=f.s(Q+".transparent");return u==p?f.s("all.transparent"):u},getFaceReverseColor:function(b,m){return b.s(m+".reverse.color")||b.s("all.reverse.color")},getFaceReverseFlip:function(v,E){var m=v.s(E+".reverse.flip");return m==p?v.s("all.reverse.flip"):m},getFaceReverseCull:function(u,C){var i=u.s(C+".reverse.cull");return i==p?u.s("all.reverse.cull"):i},getTextureMap:function(){return this._2O},deleteTexture:function(H){var e=this,J=e._2O[H];J&&(delete e._2O[H],e.getGL().deleteTexture(J))},invalidateShape3dCachedImage:function(h){var L=h._shape3dCachedImage;L&&(this.getGL().deleteTexture(L),delete h._shape3dCachedImage)},getTexture:function(T,m){if(!T)return p;var r=this,o=r.getGL(),U=r._2O[T];if(!U){var u=Tm(T);if(u)if(u.tagName){if(u.dynamic)return Hr(o,u,r._1O);U=r._2O[T]=Hr(o,u)}else{var s=m&&m.s("shape3d.image.cache");if(s&&m._shape3dCachedImage&&(U=m._shape3dCachedImage),!U){var B=m&&m.s("shape3d.fixSizeOnScreen"),F=B&&B[0]>0?B[0]:rl(u,m),G=B&&B[1]>0?B[1]:ws(u,m);if(F>=1&&G>=1){F*=devicePixelRatio,G*=devicePixelRatio;var J=Hp(F,G);yf(J,u,0,0,F,G,m,r),J.restore();var d=B?o.NEAREST:o.LINEAR;s&&bo(u,m)?(U=m._shape3dCachedImage=Hr(o,jq,null,d),jq=null):U=Hr(o,jq,r._1O,d)}}}}return U},redraw:function(){this.iv()},validateImpl:function(){var m=this;if(m._lightChanged){m._lightChanged=!1;var o=[],I=[],M=[];m.dm().each(function(X){if(Dr(X)){var L=X.s("light.type");L===sj?o.push(X):L===zi?I.push(X):L===gh&&M.push(X)}}),(o.length!==m._59O.length||I.length!==m._spots.length||M.length!==m._dirs.length)&&Zc(m),m._59O=o,m._spots=I,m._dirs=M}m._42(),m._1o.iv()},getRenderInfo:function(){var F=this.getGL();return F?F._renderInfo:void 0},showDebugTip:function(){var d=this,f=d._debugDiv;if(!f){f=d._debugDiv=i.createElement("div"),f.style.position="absolute",f.style.overflow="hidden",f.style.backgroundColor="white",f.style.color="black";var K=d.getView();d._79O?K.insertBefore(f,d._79O):K.appendChild(f),d._debugTipTimerId=setInterval(function(){var C=d.getRenderInfo();if(C){var g=d.getGL()._bufPool,Y=g.length-(g._ivCount||0),r="Draw Calls: "+C.calls+"<br/>"+"Vertices: "+C.vertices+"<br/>"+"Faces: "+C.faces+"<br/>"+"Lines: "+C.lines+"<br/>"+"Buffer Count: "+Y;f.innerHTML=r}},10)}},hideDebugTip:function(){var I=this,u=I._debugDiv;u&&(delete I._debugDiv,cancelAnimationFrame(I._debugTipTimerId),delete I._debugTipTimerId,I.getView().removeChild(u))},_42:function(O,Q){var l=this;if(!l._35O&&(!ie||Rq(ie))){var P,u;O&&(O instanceof Dl?u=O:P=O);var R=l._canvas,Z=l.getWidth(),A=l.getHeight(),J=l.getGL(),I=l._prg;if(J){if(Q?O||Yc(R,Z,A,Q):(Q=l._devicePixelRatio||eq,O||Z===R.clientWidth&&A===R.clientHeight||Yc(R,Z,A,Q)),J.viewport(0,0,Z*Q,A*Q),J._renderInfo={calls:0,vertices:0,faces:0,lines:0,frame:++l._frameId},l.overlappingBox.clear(),l._81O=p,J.clear(J.COLOR_BUFFER_BIT|J.DEPTH_BUFFER_BIT),gp(J,I.uBrightness,1),gp(J,I.uOpacity,1),gp(J,I.uPartOpacity,1),J._picking=!!O,gp(J,I.uPick,!!O),gp(J,I.uTexture,!1),gp(J,I.uBlendTexture,!1),gp(J,I.uAlphaTest,q.alphaTest),gp(J,I.uTransparent,!1),gp(J,I.uFix,!1),gp(J,I.uBatchColor,!1),gp(J,I.uBatchBlend,!1),gp(J,I.uBatchBrightness,!1),gp(J,I.uPMatrix,l._projectMatrix=cf(l)),gp(J,I.uViewMatrix,Sr(l,l._7O)),l._viewMatrix=Ch(l._7O),O||(jl(l,J,I),l._fogDisabled||(gp(J,I.uFogColor,l._fogColor),gp(J,I.uFogNear,l._fogNear),gp(J,I.uFogFar,l._fogFar))),Ub(J,I.aPosition),Ub(J,I.aNormal),Xd(J,I.aUv),Xd(J,I.aBatchColor),Xd(J,I.aBatchBlend),Xd(J,I.aBatchBrightness),Xd(J,I.aLineDistance),u){var y=J.getParameter(J.COLOR_CLEAR_VALUE);J.clearColor(0,0,0,0),J.disable(J.BLEND),Xd(J,I.aNormal),ls(J,l._cube.vs,p,I.aPosition),Mg(J,l._cube.is),wp(u,l,Aj,0),wp(u,l,Ap,6),wp(u,l,ig,12),wp(u,l,Kq,18),wp(u,l,ko,24),wp(u,l,eg,30),Ub(J,I.aNormal),Gr(J,y)}else if(P){P.value=2;var y=J.getParameter(J.COLOR_CLEAR_VALUE);J.clearColor(0,0,0,0),J.disable(J.BLEND),l._95I(J,I,P),vn(l,P),Mf(l,l._polylineModelMap,P),Mf(l,l._wireframeModelMap,P),gp(J,I.uTransparent,!0),l._95I(J,I,P,!0),vn(l,P,!0),Mf(l,l._polylineModelMap,P,!0),Mf(l,l._wireframeModelMap,P,!0),gp(J,I.uTransparent,!1),J.clear(J.DEPTH_BUFFER_BIT),l._swapLineMap(),l._95I(J,I,P,!1,!0),Mf(l,l._polylineModelMap,P),Mf(l,l._wireframeModelMap,P),l._swapLineMap(),J.disable(J.DEPTH_TEST),l._30O._42(J,I,P),J.enable(J.DEPTH_TEST),Gr(J,y)}else J.disable(J.BLEND),l.drawSky(J,I),l._31O._42(J,I),l._95I(J,I),vn(l),Mf(l,l._polylineModelMap),Mf(l,l._wireframeModelMap),J.enable(J.BLEND),gp(J,I.uTransparent,!0),J.depthMask(!1),l._95I(J,I,p,!0),vn(l,p,!0),Mf(l,l._polylineModelMap,p,!0),Mf(l,l._wireframeModelMap,p,!0),J.depthMask(!0),gp(J,I.uTransparent,!1),J.clear(J.DEPTH_BUFFER_BIT),l._swapLineMap(),l._95I(J,I,p,!1,!0),Mf(l,l._polylineModelMap),Mf(l,l._wireframeModelMap),l._swapLineMap(),J.disable(J.DEPTH_TEST),J.disable(J.BLEND),l._32O._42(J,I),l._30O._42(J,I),J.enable(J.DEPTH_TEST);ls(J,p),Mg(J,p),l._33Q=!1,l._doBufferGC(J)}}},setBufferGCInterval:function(c){this._bufferGCInterval=c},_doBufferGC:function(O,V){var h=O._bufPool,K=h.length;if(K){var m,M,u=O._renderInfo.frame,o=this._bufferGCInterval||10,i=0;
for(m=0;K>m;m++)M=h[m],M?(V||u-M._fid>o)&&(i++,O.deleteBuffer(M._buf),M._buf=null,h[m]=null):i++;if(i>K/2&&i>128){var R=[];for(m=0;K>m;m++)h[m]&&R.push(h[m]);O._bufPool=R}else h._ivCount=i}},_swapLineMap:function(){var x=this;w=x._polylineModelMap,x._polylineModelMap=x._polylineModelMapSwap,x._polylineModelMapSwap=w,w=x._wireframeModelMap,x._wireframeModelMap=x._wireframeModelMapSwap,x._wireframeModelMapSwap=w,w=x._polylineIndexMap,x._polylineIndexMap=x._polylineIndexMapSwap,x._polylineIndexMapSwap=w,w=x._wireframeIndexMap,x._wireframeIndexMap=x._wireframeIndexMapSwap,x._wireframeIndexMapSwap=w},_updateSkyBoxPosition:function(Z){if(this._skyBox&&Z&&"eye"===Z.property){var G=Z.newValue;this._skyBox.p3(G[0],G[1],G[2]),this.invalidateData(this._skyBox)}},setSkyBox:function(a){this._skyBox=a,this.ump(this._updateSkyBoxPosition,this),this.invalidateAll(),a&&(this.mp(this._updateSkyBoxPosition,this),this._updateSkyBoxPosition())},drawSky:function(T,V,j){var f=this,e=f._skyBox;if(e){var M=f._headlightIntensity,l=kd(f._headlightColor),V=f._prg;1!==M&&(l=[l[0]*M,l[1]*M,l[2]*M]),gp(T,V.uHeadlightColor,[l[0],l[1],l[2],1]);var G=f.getData3dUI(e);G&&G._42(T,V,j,function(){return!0}),T.clear(T.DEPTH_BUFFER_BIT),gp(T,V.uHeadlightColor,[l[0],l[1],l[2],f._headlightDisabled?1:0])}},_95I:function(A,x,n,K,Z){function w(z){if(!!z.s("shape3d.alwaysOnTop")==!!Z&&V.isVisible(z)&&(!W||d)){if(!n&&V.isTransparentMask(z))return;var N=V.getData3dUI(z);N&&N._42(A,x,n,c)}}var V=this,c=function(Q){return K?Q:!Q};V.sky&&A.clear(A.DEPTH_BUFFER_BIT),V.dm().each(w)},getLogicalPoint:function(P){return wd(P,this._canvas)},isRectOverlapping:function(P){var l=this.getData3dUI(P);return l._rectOverlapping},getHitFaceInfo:function(W){W.target&&(W=this.lp(W));var U=this.getDataInfoAt(W);if(U){var d=this._1o.face(U.data,Wo(W.x,W.y));if(d)return{data:U.data,face:d}}return p},unproject:function(Y,T){var p=this,E=p.getWidth(),e=p.getHeight(),y=Y.target?p.lp(Y):Y,S=y.x-E/2,b=y.y-e/2,O=2*(S/E),l=2*(-1*b/e);T=T||0;var w=Cm(),H=cf(p),M=Sr(p);jg(w,H,M),Hg(w);var W=en([O,l,T,1],w);return[W[0]/W[3],W[1]/W[3],W[2]/W[3]]},getDataAt:function(r){var b=this.getDataInfoAt(r);return b?b.data:p},getDataInfoAt:function(w,j){return w.target&&(w=this.lp(w)),this._1o.get(Wo(w.x,w.y,j),!0)},getDatasInRect:function(o){return this._1o.get(o)},setEditable:function(z){var h=this,H=h._editable;h._editable=z,this.fp(vp,H,z)},isEditable:function(l){var F=this;return F._editable?Bf(l)?l.s("3d.editable")?F._editableFunc?F._editableFunc(l):!0:!1:!1:!1},isSelectable:function(p){return p.s("3d.selectable")&&this.sm().isSelectable(p)},isMovable:function(f){var n=this;return Yr(f)&&f.getStyle(Bq)!==oi?!1:f.s("3d.movable")?n._movableFunc?n._movableFunc(f):!0:!1},isSizeEditable:function(t){return Bf(t)?this._sizeEditableFunc?this._sizeEditableFunc(t):!0:!1},isRotationEditable:function(E){return Bf(E)&&E.IRotatable!==!1?this._rotationEditableFunc?this._rotationEditableFunc(E):!0:!1},handleDelete:function(){this._editable&&this.removeSelection()},zoomIn:function(b){this.setZoom(Ro,b)},zoomOut:function(E){this.setZoom(1/Ro,E)},setZoom:function(d,D){if(1!==d){var $=this;if($._ortho)return $.setOrthoZoom(d,D),void 0;$._14o&&$._14o.stop(!0);var e=1/d,z=$._eye,I=$._center,o=I[0]+(z[0]-I[0])*e-z[0],l=I[1]+(z[1]-I[1])*e-z[1],C=I[2]+(z[2]-I[2])*e-z[2];if(!(ti(z,I)<$._moveStep&&1>e)){if(D=Cd(D)){var Y=ik(z);return D.action=function(Z){$.fi({kind:$._zooming?"betweenZoom":"beginZoom"}),$._zooming=1,z[0]=Y[0]+o*Z,z[1]=Y[1]+l*Z,z[2]=Y[2]+C*Z,$.fp(An,p,z)},D._37o=function(){delete $._14o,delete $._zooming,$.fi({kind:"endZoom"}),$.onZoomEnded()},$._14o=ne(D)}z[0]+=o,z[1]+=l,z[2]+=C,$.fp(An,p,z)}}},setOrthoZoom:function(g,A){if(1!==g){var P=this;P._14o&&P._14o.stop(!0);var i=P._orthoWidth,c=i/g-i;if(!(i<P._moveStep&&g>1))return(A=Cd(A))?(A.action=function(F){P.fi({kind:P._zooming?"betweenZoom":"beginZoom"}),P._zooming=1,P.setOrthoWidth(i+c*F)},A._37o=function(){delete P._14o,delete P._zooming,P.fi({kind:"endZoom"}),P.onZoomEnded()},P._14o=ne(A)):(P.setOrthoWidth(i/g),void 0)}},getPositionInfo:function(d){var E=this,j=E._eye,$=E._center,p=E.getAspect(),P=d?xb(fg($,j,!0),fg(d,j)):ti(j,$);if(E._ortho){var Z=E._orthoWidth;return{length:P,height:Z/p,width:Z}}var S=2*t(E._fovy/2)*P;return{length:P,height:S,width:S*p}},getCenterInfo:function(){var $=this;return $._81O||($._81O=$.getPositionInfo()),ik($._81O)},rotate:function(C,b,R,q){var x=this;if(C||b){q==p&&(q=x._firstPersonMode),x._88O&&x._88O.stop(!0);var D=x._center,y=x._eye,J=x.getCenterInfo().length,e=q?D:y,n=q?y:D,O=fg(e,n),w=z(O[0],O[2]),i=z(M(O[0]*O[0]+O[2]*O[2]),O[1]),P=q?Qc:An;return q&&(b=-b),(R=Cd(R))?(R.action=function(c){x.fi({kind:x._rotating?"betweenRotate":"beginRotate"}),x._rotating=1;var _=w+C*c,R=i+b*c;R=em(R),O[0]=J*S(R)*S(_),O[1]=J*X(R),O[2]=J*S(R)*X(_),e[0]=n[0]+O[0],e[1]=n[1]+O[1],e[2]=n[2]+O[2],x.fp(P,p,e)},R._37o=function(){delete x._88O,delete x._rotating,x.fi({kind:"endRotate"}),x.onRotateEnded()},x._88O=ne(R)):(w+=C,i+=b,i=em(i),O[0]=J*S(i)*S(w),O[1]=J*X(i),O[2]=J*S(i)*X(w),e[0]=n[0]+O[0],e[1]=n[1]+O[1],e[2]=n[2]+O[2],x.fp(P,p,e),void 0)}},pan:function(s,w,y,i){if(s||w){var L=this;i==p&&(i=L._firstPersonMode),L._89O&&L._89O.stop(!0);var T=Sr(L),j=[T[0]*s,T[4]*s,T[8]*s],S=[T[1]*w,T[5]*w,T[9]*w],X=j[0]+S[0],q=j[1]+S[1],B=j[2]+S[2],n=L._center,U=L._eye;if(i){var J=lj(L.getBoundaries(),U[0],U[2],U[0]+X,U[2]+B,M(X*X+B*B));X=J[0],B=J[1]}if(y=Cd(y)){var x=ik(U),C=ik(n);return y.action=function(l){L.fi({kind:L._panning?"betweenPan":"beginPan"}),L._panning=1,n[0]=C[0]+X*l,n[1]=C[1]+q*l,n[2]=C[2]+B*l,U[0]=x[0]+X*l,U[1]=x[1]+q*l,U[2]=x[2]+B*l,L.fp(An,p,U),L.fp(Qc,p,n)},y._37o=function(){delete L._89O,delete L._panning,L.fi({kind:"endPan"}),L.onPanEnded()},L._89O=ne(y)}n[0]+=X,n[1]+=q,n[2]+=B,U[0]+=X,U[1]+=q,U[2]+=B,L.fp(An,p,U),L.fp(Qc,p,n)}},walk:function(H,I,O){if(H){var R=this;O==p&&(O=R._firstPersonMode),R._90O&&R._90O.stop(!0);var M=R._center,l=R._eye,k=fg(M,l,!0);if(O){var L=lj(R.getBoundaries(),l[0],l[2],l[0]+k[0]*H,l[2]+k[2]*H,B(H));if(H=ti(L),!H)return;k=[L[0]/H,0,L[1]/H]}if(I=Cd(I)){var w=ik(l),d=ik(M);return I.action=function(_){R.fi({kind:R._walking?"betweenWalk":"beginWalk"}),R._walking=1;var F=H*_;l[0]=w[0]+k[0]*F,l[1]=w[1]+k[1]*F,l[2]=w[2]+k[2]*F,M[0]=d[0]+k[0]*F,M[1]=d[1]+k[1]*F,M[2]=d[2]+k[2]*F,R.fp(An,p,l),R.fp(Qc,p,M)},I._37o=function(){delete R._90O,delete R._walking,R.fi({kind:"endWalk"}),R.onWalkEnded()},R._90O=ne(I)}l[0]+=k[0]*H,l[1]+=k[1]*H,l[2]+=k[2]*H,M[0]+=k[0]*H,M[1]+=k[1]*H,M[2]+=k[2]*H,R.fp(An,p,l),R.fp(Qc,p,M)}},handleScroll:function(y,d){y.preventDefault();var p=this,s=p._moveStep;p.isFirstPersonMode()?p.isPannable()&&p.pan(0,d>0?s:-s):p.isZoomable()&&p.setZoom(0>d?1/di:di)},handlePinch:function(s,d){this.isZoomable()&&this.setZoom(d>s?1/Lm:Lm)},reset:function(){this.setCenter(U.graph3dViewCenter),this.setEye(U.graph3dViewEye),this.setUp(U.graph3dViewUp)},moveSelection:function(g,H,D){var J=this;J.dm().beginTransaction(),Fq(this.sm().toSelection(this.isMovable,this),g,H,D),J.dm().endTransaction()},getMoveMode:function(P,j){var u=j.s("3d.move.mode");if(u)return u;var K="88",V="89",l="90";return Ar(P)||qg[K]&&qg[V]&&qg[l]?"xyz":qg[K]&&qg[V]?"xy":qg[K]&&qg[l]?"xz":qg[V]&&qg[l]?"yz":qg[K]?"x":qg[V]?"y":qg[l]?"z":"xz"},handleTick:function(){var z=this,F=!1,J=z._moveStep,b=J,U=!1,d=!0,V=z._rotateStep*(d?-1:1);if(z.isWalkable()||(b=0),z.isPannable()||(J=0),z.isRotatable()||(V=0),z._32Q){var A=(Io()-z._32Q)/50;b*=A,J*=A,V*=A}z._31Q&&(bq(z._31Q),delete z._31Q,delete z._32Q),lm()&&(F=!0,z.pan(-J,0,U,d)),je()&&(F=!0,z.pan(J,0,U,d)),Xf()&&(F=!0,Ar()?z.pan(0,J,U,d):z.walk(b,U,d)),bs()&&(F=!0,Ar()?z.pan(0,-J,U,d):z.walk(-b,U,d)),hb()&&(F=!0,z.rotate(-V,0,U,d)),mq()&&(F=!0,z.rotate(V,0,U,d)),Xk()&&(F=!0,z.rotate(0,-V/2,U,d)),gd()&&(F=!0,z.rotate(0,V/2,U,d)),F&&(z._32Q=Io(),z._31Q=tf(z.handleTick,z))},handleKeyDown:function(z){var N=this;!ok(z)&&ci[z.keyCode]?N.handleTick():Fm(z)?N.selectAll():po(z)?N.handleDelete(z):Le(z)&&this.isResettable()&&N.reset()},checkDoubleClickOnNote:function(Z,X,u){var B=this;if(u===Ir){if(X.s("note.toggleable"))return X.s(Hj,!X.s(Hj)),B.fi({kind:"toggleNote",event:Z,data:X,part:u}),!0}else if(u===kb&&X.s("note2.toggleable"))return X.s(kg,!X.s(kg)),B.fi({kind:"toggleNote2",event:Z,data:X,part:u}),!0;return!1},checkDoubleClickOnRotation:function(s,k,r){return r===ac?(k.setRotationX(0),!0):r===sc?(k.setRotationY(0),!0):r===$c?(k.setRotationZ(0),!0):!1},onRotateEnded:function(){},onWalkEnded:function(){},toViewPosition:function(C){var G=this,i=G.getWidth()/2,k=G.getHeight()/2,j=G._18Q;return j&&j._wh===i/k||(j=cf(G),G._18Q=jg(j,j,Sr(G)),G._18Q._wh!==i/k),C=en([C[0],C[1],C[2],1],j),{x:i+i*C[0]/C[3],y:k-k*C[1]/C[3]}},getHitPosition:function(S,D,X){var c=this,T=c.getWidth(),$=c.getHeight(),h=S.target?c.lp(S):S,k=h.x-T/2,z=h.y-$/2,G=c.getCenterInfo(),v=Sr(c);D=D?D:[0,0,0],X=X?X:[0,1,0],k=k/T*G.width,z=-1*z/$*G.height;var H=[v[0]*k,v[4]*k,v[8]*k],A=[v[1]*z,v[5]*z,v[9]*z],y=[H[0]+A[0],H[1]+A[1],H[2]+A[2]],Q=c.getCenter(),j=Zb(c,D,X,[y[0]+Q[0],y[1]+Q[1],y[2]+Q[2]]);return j?j:[0,0,0]},getLineLength:function(w){this.validate();var p=this.getData3dUI(w);if(p&&p.getCache){var x=p.getCache();if(x)return x[x.length-1].length}return 0},getLineOffset:function(g,q){var f=this.getData3dUI(g);if(f&&f.getCache){var b=f.getCache();if(b)return zk(b,q)}return p},isLabelVisible:function(){return!0},isNoteVisible:function(){return!0}});var ae=Wf.Interactor=function(q){this.gv=q};qp("Interactor",h,{ms_listener:1,getView:function(){return this.gv.getView()},setUp:function(){this.addListeners()},tearDown:function(){this.removeListeners()}});var Lq=Wf.DefaultInteractor=function(S){td(Lq,this,[S])};qp("DefaultInteractor",ae,{handle_contextmenu:function(B){gj(B)},handle_mousewheel:function(p){this.gv.handleScroll(p,p.wheelDelta/40)},handle_DOMMouseScroll:function(a){2===a.axis&&this.gv.handleScroll(a,-a.detail)},handle_keydown:function(K){this.gv.handleKeyDown(K)},handle_mousedown:function(M){this.handle_touchstart(M)},handle_touchstart:function(l){gj(l);var N=this,C=N.gv,Q=xm(l),T=C.getDataInfoAt(l),m=T?T.data:p,U=T?T.part:p,A=C.sm(),M=Ae(l),G=cp(l);C.setFocus(l)&&(N._62O=p,N._57I=p,m?ok(l)?A.co(m)?A.rs(m):A.as(m):A.co(m)||A.ss(m):Q&&(ok(l)?C.isRectSelectable()&&(N._62O=mp):N._57I=kq(l)),N._31Q&&(bq(N._31Q),delete N._31Q,delete N._32Q),N._62O||(C.isFirstPersonMode()&&(Ar(l)||G>2?N._62O="pan":C.isMouseRoamable()||_?(N._62O="roaming",N.foward=M&&xm(l),N._32Q=Io(),N._31Q=tf(N.tick,N)):Q||(N._62O="roaming")),N._62O||(Q&&M&&Ec[U]?(N._62O=U,N.p3=m.p3()):Q&&M&&Bf(m)&&C.isSelected(m)&&C.isMovable(m)?(N._62O="move",N.p3=m.p3(),N.movedata=m):_&&(G>2?N._62O="pan":2===G&&(N.dist=Rp(l),N._62O="pinch")))),N.point=C.lp(l),Kc(N,l),dl(l)?C.handleDoubleClick(l,m,U):C.handleClick(l,m,U))},tick:function(){var g=this,A=g.gv,q=A._moveStep;g.point&&A.isWalkable()&&(g._32Q&&(q*=(Io()-g._32Q)/50),A.walk(g.foward?q:-q),g._32Q=Io(),g._31Q=tf(g.tick,g))},handle_mouseup:function(x){this.handle_touchend(x)},handle_touchend:function(H){var N=this._57I;N&&(ti(N,kq(H))<=1&&this.gv.sm().cs(),this._57I=p)},handleWindowMouseMove:function(o){this.handleWindowTouchMove(o)},handleWindowTouchMove:function(H){var E,j,v=this,Z=v.gv,N=v._62O,m=v.point,l=Z.dm(),n=Z.lp(H),d=n.x-m.x,h=n.y-m.y,g=-x*d/Z.getWidth(),a=-x*h/Z.getHeight();if("roaming"===N)v.rotate(H,g/2,a/2);else if(N===ac||N===sc||N===$c)Z._86O||l.beginTransaction(),Z.fi({kind:Z._86O?"betweenEditRotation":"beginEditRotation",event:H}),Z._86O=1,Z.sm().each(function(c){if(Bf(c)&&Z.isRotationEditable(c)){var J=B(g)>B(a)?g:a;N===ac?c.setRotationX(c.getRotationX()+J):N===sc?c.setRotationY(c.getRotationY()+J):N===$c&&c.setRotationZ(c.getRotationZ()+J)}});else if("move"===N||Ec[N]){N===eh||N===Ph||N===gc?(Z._87O||l.beginTransaction(),Z.fi({kind:Z._87O?"betweenEditSize":"beginEditSize",event:H}),Z._87O=1):(Z._moving||l.beginTransaction(),Z.fi({kind:Z._moving?"betweenMove":"beginMove",event:H}),Z._moving=1);var _,D=v.p3,O=Z.getPositionInfo(D),J=Sr(Z);_=N===Gk?"x":N===Nk?"y":N===ol?"z":N===eh?"sx":N===Ph?"sy":N===gc?"sz":Z.getMoveMode(H,v.movedata),d=d/Z.getWidth()*O.width,h=-1*h/Z.getHeight()*O.height;var R,q,w=[J[0]*d,J[4]*d,J[8]*d],t=[J[1]*h,J[5]*h,J[9]*h],S=w[0]+t[0],A=w[1]+t[1],U=w[2]+t[2],F=[D[0]+S,D[1]+A,D[2]+U],$=fg(Z.getEye(),F,!0);if("xyz"===_?(R=F,Z.moveSelection(S,A,U)):"xz"===_?(R=Zb(Z,D,[0,1,0],F),R&&Z.moveSelection(R[0]-D[0],0,R[2]-D[2])):"xy"===_?(R=Zb(Z,D,[0,0,1],F),R&&Z.moveSelection(R[0]-D[0],R[1]-D[1],0)):"yz"===_?(R=Zb(Z,D,[1,0,0],F),R&&Z.moveSelection(0,R[1]-D[1],R[2]-D[2])):"x"===_||"sx"===_?($[0]=0,R=Zb(Z,D,$,F),R&&(q=R[0]-D[0],"x"===_?Z.moveSelection(q,0,0):Z.sm().each(function(t){Bf(t)&&Z.isSizeEditable(t)&&(E=Q(Sd,t.getWidth()+q),j=E/t.getWidth(),t.setWidth(E),Ar(H)&&(t.setHeight(t.getHeight()*j),t.setTall(t.getTall()*j)))}))):"y"===_||"sy"===_?($[1]=0,R=Zb(Z,D,$,F),R&&(q=R[1]-D[1],"y"===_?Z.moveSelection(0,q,0):Z.sm().each(function(n){Bf(n)&&Z.isSizeEditable(n)&&(E=Q(Sd,n.getTall()+q),j=E/n.getTall(),n.setTall(E),Ar(H)&&(n.setHeight(n.getHeight()*j),n.setWidth(n.getWidth()*j)))}))):("z"===_||"sz"===_)&&($[2]=0,R=Zb(Z,D,$,F),R&&(q=R[2]-D[2],"z"===_?Z.moveSelection(0,0,q):Z.sm().each(function(n){Bf(n)&&Z.isSizeEditable(n)&&(E=Q(Sd,n.getHeight()+q),j=E/n.getHeight(),n.setHeight(E),Ar(H)&&(n.setTall(n.getTall()*j),n.setWidth(n.getWidth()*j)))}))),!R)return;v.p3=R}else if(N===mp){var C=v.div;C||(C=v.div=yb(),rj(v.getView(),C),C.op=m,C.style.background=Z.getRectSelectBackground()),Z.fi({kind:Z._rectSelecting?"betweenRectSelect":"beginRectSelect",event:H}),Z._rectSelecting=1,C.rect=Ui(C.op,n),Eb(C,C.rect)}else if("pinch"===N&&2===cp(H)){Z.fi({kind:Z._pinching?"betweenPinch":"beginPinch",event:H}),Z._pinching=1;var q=Rp(H);Z.handlePinch(q,v.dist),v.dist=q}else"pan"===N||Ar(H)?v.pan(H,d,h):Z.isFirstPersonMode()||(xm(H)?v.rotate(H,g,a):(v.pan(H,d,0),Z.isWalkable()&&(Z.fi({kind:Z._walking?"betweenWalk":"beginWalk",event:H}),Z._walking=1,Z.walk(h/Z.getHeight()*Z.getCenterInfo().height))));v.point=n},pan:function(R,q,B){var e=this.gv;if(e.isPannable()){var O=e.getCenterInfo(),v=q/e.getWidth()*O.width,h=-1*B/e.getHeight()*O.height;e.fi({kind:e._panning?"betweenPan":"beginPan",event:R}),e._panning=1,e.pan(-v,-h)}},rotate:function(M,U,P){var o=this.gv;o.isRotatable()&&(o.fi({kind:o._rotating?"betweenRotate":"beginRotate",event:M}),o._rotating=1,o.rotate(U,P))},handleWindowMouseUp:function(q){this.handleWindowTouchEnd(q)},handleWindowTouchEnd:function(g){var $=this,G=$.gv,c=G.dm(),J=$.div;if(J){var m=G.getDatasInRect(J.rect);if(!m.isEmpty()){var s=G.sm(),D=s.toSelection();m.each(function(W){s.co(W)?D.remove(W):D.add(W)}),s.ss(D)}_k(J)}G._moving&&(delete G._moving,G.fi({kind:"endMove",event:g}),G.onMoveEnded(),c.endTransaction()),G._panning&&(delete G._panning,G.fi({kind:"endPan",event:g}),G.onPanEnded()),G._rotating&&(delete G._rotating,G.fi({kind:"endRotate",event:g}),G.onRotateEnded()),G._86O&&(delete G._86O,G.fi({kind:"endEditRotation",event:g}),c.endTransaction()),G._87O&&(delete G._87O,G.fi({kind:"endEditSize",event:g}),c.endTransaction()),G._pinching&&(delete G._pinching,G.fi({kind:"endPinch",event:g}),G.onPinchEnded()),G._rectSelecting&&(delete G._rectSelecting,G.fi({kind:"endRectSelect",event:g}),G.onRectSelectEnded()),G._walking&&(delete G._walking,G.fi({kind:"endWalk",event:g}),G.onWalkEnded()),$.dist=$.point=$._62O=$.p3=$.movedata=$.div=$._57I=$._32Q=$._31Q=$.foward=p}});var oo=function(z){this.gv=z};bd(oo,h,{_iv:!0,iv:function(){this._iv=!0},face:function(y,X){var t=this,H=t.gv.getGL();if(!H||!Bf(y))return p;var J=X.x,V=X.width,E=X.height,D=t.height-X.y-E,$=Z(V/2),U=new Uint8Array(4*V*E),S=0;for(t.iv(),t.validate(y),xp(H,t.frame),H.readPixels(J,D,V,E,H.RGBA,H.UNSIGNED_BYTE,U),xp(H,p),t.iv();$>=S;S++)for(var z=$-S,I=$+S,g=z;I>=g;g++)for(var q=z;I>=q;q++)if(g===z||g===I||q===z||q===I){var i=Dp.m[U[4*(g*V+q)]];if(i)return i}},get:function(t,m){this.validate();var V=this,c=V.gv.getGL();if(!c)return p;var o,n,T=t.x,C=t.width,S=t.height,w=V.height-t.y-S,e=Z(C/2),k=new Uint8Array(4*C*S),F=0,H=k.length,f=m?p:new uh,l=m?p:{};if(xp(c,V.frame),c.readPixels(T,w,C,S,c.RGBA,c.UNSIGNED_BYTE,k),xp(c,p),m){for(;e>=F;F++)for(var O=e-F,K=e+F,s=O;K>=s;s++)for(var v=O;K>=v;v++)if((s===O||s===K||v===O||v===K)&&(o=V.info(k,4*(s*C+v))))return o}else for(;H>F;F+=4)o=V.info(k,F),o&&(n=o.data,l[n._id]||(f.add(n),l[n._id]=n));return f},info:function(Y,J){return this.colorMap[(Y[J]<<16)+(Y[J+1]<<8)+Y[J+2]+((127&Y[J+3])<<24)]},validate:function(A){var C=this,U=C.gv,i=U.getGL();if(i){var q=U.getWidth(),e=U.getHeight(),g=i.RGBA,w=i.TEXTURE_2D,R=i.RENDERBUFFER,M=i.FRAMEBUFFER;C.texture||(C.texture=Hr(i),C.render=i.createRenderbuffer(),C.frame=i.createFramebuffer()),(C.width!==q||C.height!==e)&&(yk(i,C.texture),i.texImage2D(w,0,g,q,e,0,g,i.UNSIGNED_BYTE,p),tr(i,i.TEXTURE_MIN_FILTER,i.LINEAR),i.bindRenderbuffer(R,C.render),i.renderbufferStorage(R,i.DEPTH_COMPONENT16,q,e),xp(i,C.frame),i.framebufferTexture2D(M,i.COLOR_ATTACHMENT0,w,C.texture,0),i.framebufferRenderbuffer(M,i.DEPTH_ATTACHMENT,R,C.render),yk(i,p),i.bindRenderbuffer(R,p),xp(i,p),C.width=q,C.height=e),C._iv&&(C._iv=!1,xp(i,C.frame),U._42(A||(C.colorMap={}),1),xp(i,p))}}});var _j=function(g){this.gv=g};bd(_j,h,{gap:0,size:0,_42:function(B,t){var w=this,n=w.gv,F=n._gridGap,C=n._gridSize;if(n._gridVisible){if(w.gap!==F||w.size!==C){for(var l=[],j=n._gridSize/2,U=F*j,y=0;2*j+1>y;y++){var N=6*y,X=6*(2*j+1)+N;l[N]=-U,l[N+1]=0,l[N+2]=-U+y*F,l[N+3]=U,l[N+4]=0,l[N+5]=-U+y*F,l[X]=-U+y*F,l[X+1]=0,l[X+2]=-U,l[X+3]=-U+y*F,l[X+4]=0,l[X+5]=U}w.vs=new Oe(l),w.gap=F,w.size=C}Wj(n),Mp(B,t),Fc(B),$l(B,t,1,n._gridColor,n._buffer.vs,w.vs),yj(B,0,w.vs.length/3,B.LINES),kr(B),qh(B,t)}else w.vs=w.gap=w.size=p}});var Mc=function(R){this.gv=R};bd(Mc,h,{_42:function(m,y){var a=this.gv,c=a._buffer.vs,P=a._axisXColor,R=a._axisYColor,J=a._axisZColor,H=a._originAxisVisible,L=a._centerAxisVisible;if(H||L){var K=I?m.TRIANGLES:m.TRIANGLE_FAN,s=m.LINES;if(Wj(a),Mp(m,y),Fc(m),H){var f=a.getCenterInfo(),w=j(f.width,f.height)/5,X=.8*w,U=.05*w;$l(m,y,1.5,P,c,new Oe([0,0,0,w,0,0,X,U,0,X,0,U,X,-U,0,X,0,-U,X,U,0,0,0,0,0,w,0,U,X,0,0,X,U,-U,X,0,0,X,-U,U,X,0,0,0,0,0,0,w,U,0,X,0,U,X,-U,0,X,0,-U,X,U,0,X])),yj(m,0,2,s),yj(m,1,6,K),$l(m,y,p,R),yj(m,7,2,s),yj(m,8,6,K),$l(m,y,p,J),yj(m,14,2,s),yj(m,15,6,K)}if(L){var n=a._center,g=n[0],x=n[1],C=n[2],f=a.getPositionInfo(n);w=j(f.width,f.height)/20,$l(m,y,1.5,P,c,new Oe([g,x,C,g+w,x,C,g,x,C,g,x+w,C,g,x,C,g,x,C+w])),yj(m,0,2,s),$l(m,y,p,R),yj(m,2,2,s),$l(m,y,p,J),yj(m,4,2,s)}kr(m),qh(m,y)}}});var so=function(U){this.gv=U},Gk="edit_tx",Nk="edit_ty",ol="edit_tz",ac="edit_rx",sc="edit_ry",$c="edit_rz",eh="edit_sx",Ph="edit_sy",gc="edit_sz",Ec={};Ec[Gk]=1,Ec[Nk]=1,Ec[ol]=1,Ec[ac]=1,Ec[sc]=1,Ec[$c]=1,Ec[eh]=1,Ec[Ph]=1,Ec[gc]=1,bd(so,h,{_42:function(t,V,E){var Z=this,M=Z.gv,m=M.sm().ld();if(M.isEditable(m)&&!M.isEditHelperDisabled()&&Bf(m)&&(!M.isFirstPersonMode()||!M.isMouseRoamable()&&!_)){Wj(M);var c,R,b=M.isMovable(m),Q=M.isRotationEditable(m),h=M.isSizeEditable(m),J=M._axisXColor,P=M._axisYColor,l=M._axisZColor,i=M._editSizeColor,v=M.getCenterInfo(),Y=j(v.width,v.height)/10,C=Y/(E?5:10),g=.7*Y,D=.4*g,U=m.p3(),F=U[0],L=U[1],$=U[2];c=[0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0],b&&Z._17O(t,V,m,E,Gk,J,c,[F,L-C,$,F+g,L-C,$,F+g,L,$,F+g,L,$,F,L,$,F,L-C,$,F,L-C,$+C,F+g,L-C,$+C,F+g,L-C,$,F+g,L-C,$,F,L-C,$,F,L-C,$+C]),R=F+g,h&&Z._17O(t,V,m,E,eh,i,c,[R,L-C,$,R+D,L-C,$,R+D,L,$,R+D,L,$,R,L,$,R,L-C,$,R,L-C,$+C,R+D,L-C,$+C,R+D,L-C,$,R+D,L-C,$,R,L-C,$,R,L-C,$+C]),R+=D,Q&&Z._17O(t,V,m,E,ac,J,c,[R,L-C,$,R+D,L-C,$,R+D,L,$,R+D,L,$,R,L,$,R,L-C,$,R,L-C,$+C,R+D,L-C,$+C,R+D,L-C,$,R+D,L-C,$,R,L-C,$,R,L-C,$+C]),c=[0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0],b&&Z._17O(t,V,m,E,Nk,P,c,[F,L,$,F,L+g,$,F-C,L+g,$,F-C,L+g,$,F-C,L,$,F,L,$,F,L,$,F,L,$-C,F,L+g,$-C,F,L+g,$-C,F,L+g,$,F,L,$]),R=L+g,h&&Z._17O(t,V,m,E,Ph,i,c,[F,R,$,F,R+D,$,F-C,R+D,$,F-C,R+D,$,F-C,R,$,F,R,$,F,R,$,F,R,$-C,F,R+D,$-C,F,R+D,$-C,F,R+D,$,F,R,$]),R+=D,Q&&Z._17O(t,V,m,E,sc,P,c,[F,R,$,F,R+D,$,F-C,R+D,$,F-C,R+D,$,F-C,R,$,F,R,$,F,R,$,F,R,$-C,F,R+D,$-C,F,R+D,$-C,F,R+D,$,F,R,$]),c=[1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0],b&&Z._17O(t,V,m,E,ol,l,c,[F,L,$,F,L,$+g,F,L-C,$+g,F,L-C,$+g,F,L-C,$,F,L,$,F,L-C,$,F-C,L-C,$,F-C,L-C,$+g,F-C,L-C,$+g,F,L-C,$+g,F,L-C,$]),R=$+g,h&&Z._17O(t,V,m,E,gc,i,c,[F,L,R,F,L,R+D,F,L-C,R+D,F,L-C,R+D,F,L-C,R,F,L,R,F,L-C,R,F-C,L-C,R,F-C,L-C,R+D,F-C,L-C,R+D,F,L-C,R+D,F,L-C,R]),R+=D,Q&&Z._17O(t,V,m,E,$c,l,c,[F,L,R,F,L,R+D,F,L-C,R+D,F,L-C,R+D,F,L-C,R,F,L,R,F,L-C,R,F-C,L-C,R,F-C,L-C,R+D,F-C,L-C,R+D,F,L-C,R+D,F,L-C,R])}},_17O:function(e,g,S,q,i,E,P,M){var x=this.gv._buffer;ge(e,g,q,!0,S,i),cg(e,g,p,!0,p,!0,p,!1),gp(e,g.uDiffuse,E),ls(e,x.vs,new Oe(M),g.aPosition),ls(e,x.ns,new Oe(P),g.aNormal),Fc(e),yj(e,0,12),kr(e),ul(e,g)}});var ah=function(y,u){this.gv=y,this.s=function(B,m,t){return m==p&&(m=t),m==p?u.getStyle(B):$n(m,u,y)},this.data=u};bd(ah,h,{I3d:!0,ms_icons:1,_iv:!0,iv:function(){this._iv=!0},_42:function(k,L,h,I){var m=this,y=m.data;if(!(y instanceof Zl)){var G,d,v,W,P,Z,D,A=m.gv,T=y._id,E=m.s("shape3d.alwaysOnTop")?null:m.s("batch"),l=A._batchIndexMap,e=A._batchModelMap,$=A.isSelectable(y),M=A.getBrightness(y),b=M!=p&&1!==M;if(m.needValidate(k)){if(v=Ee(l,e,y,E),m.validate(v,E?pe[E]||Vh:p),v&&(W=l[T],P=W.size=v.vs.length/3-W.begin,D=v.rs))for(M=b?M:1,Z=0;P>Z;Z++)D.push(M);if(Bf(y)){var N=A.getWireframeGeometry(y);if(N)Yb(A,y,N);else{var j=A.getWireframe(y);j&&Yb(A,y,j)}}m.labelInfo=m.label2Info=m.noteInfo=m.note2Info=m._38o=p,m._24O(Ql,"getLabel"),m._24O(Mn,"getLabel2"),m._26O(Ir,"getNote"),m._26O(kb,"getNote2"),m._15O(),m._iv=!1}b&&gp(k,L.uBrightness,M),gp(k,L.uAlphaTest,m.s("alphaTest")),d=ge(k,L,h,$,y,qr),d&&(Pg(d,l[T],e),Pg(d,A._polylineIndexMap[T],A._polylineModelMap),Pg(d,A._wireframeIndexMap[T],A._wireframeModelMap)),l[T]||m._80o(k,L,I),A.isLabelVisible(y)&&((G=m.labelInfo)&&(ge(k,L,h,$,y,Ql),m._28O(G,Ql,I)),(G=m.label2Info)&&(ge(k,L,h,$,y,Mn),m._28O(G,Mn,I))),A.isNoteVisible(y)&&((G=m.noteInfo)&&(ge(k,L,h,$,y,Ir),m._29O(G,Ir,I)),(G=m.note2Info)&&(ge(k,L,h,$,y,kb),m._29O(G,kb,I))),(G=m._38o)&&m._99O(k,L,G,h,$,I),b&&gp(k,L.uBrightness,1)}},needValidate:function(){return this._iv},validate:function(){},_16O:function(){return Ak},_80o:function(){},dispose:function(){},_calcAnchorMat:function(n){if(n.hasOwnProperty("_anchor")||n.hasOwnProperty("_anchorElevation")){var Z=n.getAnchor3d(),r={x:Z.x-.5,y:Z.y-.5,z:Z.z-.5},C=Cm();return xc(C,[-r.x,-r.y,-r.z]),C}},getBodyColor:function(f){var z=this.data,P=this.gv.getBodyColor(z);return P?P:f?z.getStyle(f):p},_24O:function(b,C){var y=this,E=y.data,R=y.gv,W=y.s,Z=R[C](E);if(Z!=p){var O=W(b+".scale"),e=W(b+".max"),Y=y[b+"Info"]={label:Z,textureScale:W(b+".texture.scale"),color:R[C+"Color"](E),font:W(b+".font"),align:W(b+".align"),background:R[C+"Background"](E)},r=Y.rect=bk(Y,Z);e>0&&e<r.width&&(Y.labelWidth=r.width,r.width=e),r.x=r.y=0,r.width*=O,r.height*=O,Y.mat=y._16O(W(b+".autorotate"),W(b+".position"),r,W(b+".face"),W(b+".t3"),W(b+".r3"),W(b+".rotationMode"));var G=r.width/2,D=r.height/2;Y.vs=new Oe([-G,D,0,-G,-D,0,G,-D,0,G,D,0]),r.width/=O,r.height/=O}},_26O:function($,l){var Y=this,o=Y.data,r=Y.gv,y=Y.s,i=r[l](o);if(i!=p){var O=y($+".scale"),m=this[$+"Info"]={note:i,textureScale:y($+".texture.scale"),expanded:y($+".expanded"),font:y($+".font"),color:y($+".color"),align:y($+".align"),borderWidth:y($+".border.width"),borderColor:y($+".border.color"),background:r[l+"Background"](o)};if(m.expanded){var P=y($+".max"),x=bk(m,i);x.width+=6,x.height+=2,P>0&&P<x.width&&(m.labelWidth=x.width,x.width=P);var F={x:-x.width/2,y:-8-x.height,width:x.width,height:x.height+8}}else F={x:-6,y:-18,width:12,height:18};m.mat=Y._16O(y($+".autorotate"),y($+".position"),p,y($+".face"),y($+".t3"),y($+".r3"),y($+".rotationMode")),m.rect=F,1!==O&&(F=ik(F),F.x*=O,F.height*=O,F.y=-F.height,F.width*=O);var W=F.x,M=F.y,b=F.width,d=F.height;m.vs=new Oe([W,-M,0,W,-M-d,0,W+b,-M-d,0,W+b,-M,0])}},_28O:function(l,s,U){if(U(this.s(s+".transparent"))){var p=l.rect,V=l.textureScale,E=p.width*V,t=p.height*V;if(E>=1&&t>=1){var x=Hp(E,t);1!==V&&(x.translate(x,p.x,p.y),x.scale(V,V),x.translate(x,-p.x,-p.y)),Yp(x,l),x.restore(),Ur(this,s,l.mat,l.vs,!0)}}},_29O:function(L,k,X){if(X(this.s(k+".transparent"))){var u=L.rect,v=L.textureScale,O=u.x,g=u.y,s=u.width*v,J=u.height*v;if(s>=1&&J>=1){u.x=u.y=0;var A=Hp(s,J);1!==v&&A.scale(v,v),Nf(A,L),A.restore(),u.x=O,u.y=g,Ur(this,k,L.mat,L.vs,!1)}}},_99O:function(U,y,P,Q,i,s){if(P){var X=this,g=X.gv,M=X.data,v=g._buffer,a=g._1O,k=P.icons;for(var B in k){var E=k[B],o=P.rects[B];if(o&&s($n(E.transparent,M,g))){ge(U,y,Q,i,M,B);var R=$n(E.shape3d,M,g),m=R?[R]:$n(E.names,M,g),G=m?m.length:0,H=$n(E.textureScale,M,g)||1,x=$n(E.light,M,g);x==p&&(x=R?!0:!1),cg(U,y,$n(E.blend,M,g),x,$n(E.opacity,M,g),$n(E.reverseFlip,M,g),$n(E.reverseColor,M,g),$n(E.reverseCull,M,g));for(var Y=0;G>Y;Y++){var w=m[Y],C=o[Y];if(oh(X,C.mat),R)lc(g,M,Te(X,R),X);else{var I=Tm(w);if(I){var q=C.width*H,_=C.height*H;if(q>=1&&_>=1){var f=Hp(q,_);Xl(f,I,$n(E.stretch,M,g),0,0,q,_,M,g),f.restore(),Hr(U,jq,a),Fc(U,y,a,$n(E.discardSelectable,M,g),v.uv,ue),ls(U,v.vs,C.vs,y.aPosition),Gc(U,v.ns,lo,y.aNormal),Lh(U,v.is,ic),Pe(U,0,ic.length),kr(U,y,a)}}}We(g)}ul(U,y)}}}}});var Hc=function(A,O){td(Hc,this,[A,O])};bd(Hc,ah,{_16O:function(V,n,s,u,U,Z,P,I,x){var X=this.data,E=X.getFinalScale3d(),r=ms(n,E,s,u,I,x);if(X.hasOwnProperty("_anchor")||X.hasOwnProperty("_anchorElevation")){var h=X.getAnchor3d();r[0]-=(h.x-.5)*E[0],r[1]-=(h.y-.5)*E[1],r[2]-=(h.z-.5)*E[2]}return _q(Cm(),r,X.p3(),u,U,Z,P,V,X.r3(),X.getRotationMode())},clear:function(){var $=this;$.faceMat=$.mat=$.shapeModel=$.left=$.right=$.front=$.back=$.top=$.bottom=$.csg=p},needValidate:function(L){if(this._iv)return this._validateFrameId=L._renderInfo.frame,!0;if(this.s("shape3d.autorotate")||this.s("shape3d.fixSizeOnScreen")||this.s("hide.overlapping.group")){var X=L._renderInfo.frame;if(this._validateFrameId!==X)return this._validateFrameId=X,!0}return!1},validate:function(O,u){var _=this,K=_.gv,l=_.data,d=Te(_);_._updateAutoRotation(),_._updateFixSize2d(),_._updateOverlapping(),(this.s("shape3d.autorotate")||this.s("shape3d.fixSizeOnScreen"))&&(iq(K,l,"_wireframeModelMap","_wireframeIndexMap"),iq(K,l,"_wireframeModelMapSwap","_wireframeIndexMapSwap"));var D=Rb(l,K.getMat(l),d?_.s("shape3d.scaleable"):!0),t=_._calcAnchorMat(l);if(t&&jg(D,D,t),_.clear(),O){var v=[];d?pp(K,l,d,_,_.getBodyColor(),[D],O,v):(kf(K,l,O,u,D,Aj,v,Lb),kf(K,l,O,u,D,ig,v,rr),kf(K,l,O,u,D,ko,v,Yd),kf(K,l,O,u,D,eg,v,Od),kf(K,l,O,u,D,Ap,v,He),kf(K,l,O,u,D,Kq,v,rc)),v.length&&(xg(O.vs,v),xg(O.ns,$m(v)))}else _.mat=D,(_.shapeModel=d)||(_._cubeUvs=null,_.vf(Aj,0),_.vf(ig,16),_.vf(Ap,8),_.vf(Kq,24),_.vf(ko,32),_.vf(eg,40))},_updateAutoRotation:function(){var u=this,P=u.s("shape3d.autorotate");if(P){var T,N=u.gv,V=u.data;T="string"==typeof P?[P.indexOf("x")<0?N._eye[0]:N._center[0],P.indexOf("y")<0?N._eye[1]:N._center[1],P.indexOf("z")<0?N._eye[2]:N._center[2]]:N._eye;var w=N._center,I=[T[0]-w[0],T[1]-w[1],T[2]-w[2]],c=V.p3(),b=Mb([c[0]+I[0],c[1]+I[1],c[2]+I[2]],c,N._up),i=V.r3(),A=nc(b,V.getRotationMode());Math.abs(i[0]-A[0])<1e-5&&Math.abs(i[1]-A[1])<1e-5&&Math.abs(i[2]-A[2])<1e-5||V.r3(A)}},_updateFixSize2d:function(){var f=this,I=f.data,M=f.s("shape3d.fixSizeOnScreen");if(!M)return I._dynamicScale3d&&delete I._dynamicScale3d,void 0;var j=f.gv;I.getFinalScale3d();var e=Rb(I,j.getMat(I)),r=pk([0,0,0],e),A=j.toViewPosition(r);if(!isNaN(A.x)&&!isNaN(A.y)){var u=pk([1,0,0],e),B=j.toViewPosition(u),w=pk([0,1,0],e),p=j.toViewPosition(w),h=B.x-A.x,T=p.y-A.y,G=I._dynamicScale3d||[1,1,1],W=Tm(I.s("shape3d.image")),E=M[0]>0?M[0]:W?rl(W,f):20,Y=M[1]>0?M[1]:W?ws(W,f):20,Z=Math.abs(h/E),O=Math.abs(T/Y);Math.abs(Z-1)<.001&&Math.abs(O-1)<.001||(I._dynamicScale3d=[G[0]/Z,G[1]/O,G[2]])}},_updateOverlapping:function(){var N=this,t=N.s("hide.overlapping.group");if(!t)return N._rectOverlapping&&(N._rectOverlapping=R),void 0;var H,Z,e,Y=N.gv,K=N.data,f=Rb(K,Y.getMat(K)),M=1/0,E=1/0,h=-1/0,G=-1/0,P=K.getAnchor3d(),L=P.x,n=P.y,D=P.z;for(H=0;8>H;H++){if(Z=pk([(H>>2)-L,(1&H>>1)-n,(1&H)-D],f),e=Y.toViewPosition(Z),isNaN(e.x)||isNaN(e.y))return;M=Math.min(M,e.x),h=Math.max(h,e.x),E=Math.min(E,e.y),G=Math.max(G,e.y)}var g={x:M,y:E,w:h-M,h:G-E};N._rectOverlapping=Y.overlappingBox.isOverlapping(t,g)},vf:function(h,A){var n=this;if(n.gv.getFaceVisible(n.data,h)){var l=Jn(n,h);l.mat&&(n.faceMat=!0);var s=l.uv;if(s){var u=n._cubeUvs;u||(u=n._cubeUvs=new Oe([0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0]));for(var M=0;8>M;M++)u[A+M]=s[M]}return l}},_80o:function(w,L,j){var Y=this;if(Y._rectOverlapping)return!0;var v=Y.gv,T=Y.data,Z=v._cube,G=Y.shapeModel;Wj(v,Y.mat),G?lc(v,T,G,Y,Y.getBodyColor(),j):(ls(w,Z.vs,p,L.aPosition),ls(w,Z.ns,p,L.aNormal),Mg(w,Z.is),Y._18O(w,L,Y.left,0,j),Y._18O(w,L,Y.front,6,j),Y._18O(w,L,Y.right,12,j),Y._18O(w,L,Y.back,18,j),Y._18O(w,L,Y.top,24,j),Y._18O(w,L,Y.bottom,30,j)),We(v),Y.faceMat&&(Y._18O(w,L,Y.left,0,j,!0),Y._18O(w,L,Y.front,6,j,!0),Y._18O(w,L,Y.right,12,j,!0),Y._18O(w,L,Y.back,18,j,!0),Y._18O(w,L,Y.top,24,j,!0),Y._18O(w,L,Y.bottom,30,j,!0))},_18O:function(d,E,L,o,m,Y){if(L){if(!m(L.transparent))return;if(Y&&!L.mat||!Y&&L.mat)return;Y&&Wj(this.gv,L.mat);var y=this,M=y.data,f=y.gv,S=f.getTexture(L.texture,M),x=L.uv,v=L.uvScale,X=L.uvOffset,a=L.discardSelectable;S?x?Fc(d,E,S,a,f._buffer.uv,y._cubeUvs,X,v):Fc(d,E,S,a,f._cube.uv,p,X,v):Fc(d),cg(d,E,L.blend,L.light,L.opacity,L.reverseFlip,L.reverseColor,L.reverseCull),gp(d,E.uDiffuse,L.color),Pe(d,o,6),ul(d,E),kr(d,E,S),Y&&We(f)}}});var Id=function(Z,N){td(Id,this,[Z,N])};bd(Id,ah,{_25Q:1,validate:function(L){var s=this,W=s.gv,i=s.data,c=s.s,d=c("edge.width"),J=i._40I,I=i._41I;if(s.shapeModel=s.info=p,J&&I){var O,x,w,_,v,S,n,R,m,k,M=i.isLooped(),C=c(Bq),N=U.getEdgeType(C);if(N){var T=N(i,kh(s,W,i,M,C),W,s._19Q);if(!T.points||T.points.isEmpty())return;S=s.info={},n=T.segments,v=T.points,R=v.size();for(var V=J.getElevation(),g=I.getElevation(),G=0;R>G;G++){var H=v.get(G);H.e==p&&(H.e=V+(g-V)*G/(R-1))}m=Qj(v.get(0)),k=Qj(v.get(R-1));var A=R%2;0===A?(S.c1=Qj(v.get(R/2-1)),S.c2=Qj(v.get(R/2))):S.p3=Qj(v.get((R-A)/2)),S.s1=m,S.s2=Qj(v.get(1)),S.t1=Qj(v.get(R-2)),S.t2=k}else{v=new uh,S=s.info={};var P=c("edge.offset"),K=c("edge.center"),F=c("edge.source.t3"),f=c("edge.target.t3"),q=J.p3(),Z=I.p3();if(F&&(q[0]+=F[0],q[1]+=F[1],q[2]+=F[2]),f&&(Z[0]+=f[0],Z[1]+=f[1],Z[2]+=f[2]),C===oi){n=c("edge.segments");var X=S.points=c(ds)||Jg;if(R=X.size()){m=Qj(X.get(0)),k=Qj(X.get(R-1)),!K&&P&&(w=fg(m,q,!0),P=j(P,ti(q,m)),q=[q[0]+w[0]*P,q[1]+w[1]*P,q[2]+w[2]*P],w=fg(Z,k,!0),P=j(P,ti(k,Z)),Z=[Z[0]-w[0]*P,Z[1]-w[1]*P,Z[2]-w[2]*P]);var A=R%2;0===A?(O=Qj(X.get(R/2-1)),x=Qj(X.get(R/2))):S.p3=Qj(X.get((R-A)/2)),S.s1=q,S.s2=m,S.t1=k,S.t2=Z}else!K&&P&&(w=fg(Z,q,!0),_=ti(q,Z),P=Mk(P,_),q=[q[0]+w[0]*P,q[1]+w[1]*P,q[2]+w[2]*P],Z=[Z[0]-w[0]*P,Z[1]-w[1]*P,Z[2]-w[2]*P]),O=q,x=Z;v.add({x:q[0],y:q[2],e:q[1]}),v.addAll(X),v.add({x:Z[0],y:Z[2],e:Z[1]})}else{var t=kh(s,W,i,M,C);if(s._19Q||(t=-t),M){var r=q[0],e=q[1],z=q[2],u=J.getTall()/2+t;O=[r-t,e+u,z],x=[r+t,e+u,z],v.add({x:r-t,y:z,e:e}),v.add({x:r-t,y:z,e:e+u}),v.add({x:r+t,y:z,e:e+u}),v.add({x:r+t,y:z,e:e})}else{w=fg(Z,q,!0),_=ti(q,Z);var Y={x:q[0],y:q[2]},o={x:Z[0],y:Z[2]},y=Ik(p,Y,o,t),Q=y.x-Y.x,D=y.y-Y.y;P=Mk(P,_),w[0]*=P,w[1]*=P,w[2]*=P,O=[q[0]+w[0]+Q,q[1]+w[1],q[2]+w[2]+D],x=[Z[0]-w[0]+Q,Z[1]-w[1],Z[2]-w[2]+D],K?(v.add({x:q[0],y:q[2],e:q[1]}),v.add({x:O[0],y:O[2],e:O[1]}),v.add({x:x[0],y:x[2],e:x[1]}),v.add({x:Z[0],y:Z[2],e:Z[1]})):(v.add({x:O[0],y:O[2],e:O[1]}),v.add({x:x[0],y:x[2],e:x[1]}))}}S.c1=O,S.c2=x}S.list=c(hg)===dd?s.createTubeModel(v,n,d/2,L):s.createLineModel(v,n,d,"edge","edge.dash")}}});var qb=function(J,D){td(qb,this,[J,D])};bd(qb,Hc,{_80o:function(s,h,G){var l=this,L=l.gv,Y=l.shapeModel;Wj(L,l.mat),Y?lc(L,l.data,Y,l,l.getBodyColor(),G):(yn(l,s,h,l.left,G),yn(l,s,h,l.front,G),yn(l,s,h,l.right,G),yn(l,s,h,l.back,G),yn(l,s,h,l.top,G),yn(l,s,h,l.bottom,G)),We(L)
},validate:function(i,r){var k,C,s=this,b=s.s,u=s.data,U=u.p3(),Q=u._thickness/2,t=u.isClosePath(),O=u.getPoints(),g=u.getSegments(),c=b(ai),S=i&&i.uv;if(s.clear(),0>Q)C=s.shapeModel=lk(O,g,b(ro),b(rm),c,b(Oo),u.getTall(),u.getShapeElevation(),t),b(In)?b("shape3d.image")||delete C.uv:(delete C.vs,delete C.ns,delete C.uv),b("shape3d.top.image")||delete C.top_uv,b("shape3d.bottom.image")||delete C.bottom_uv;else if(b(hg)===dd)k=gk(O,g,c,t),C=s.shapeModel={vs:[]},b("shape3d.image")&&(C.uv=[],C.sum=b(Oo)||rd(k)||1,C.len=0),b(ro)&&!t&&(C.top_vs=[],b("shape3d.top.image")&&(C.top_uv=[])),b(rm)&&!t&&(C.bottom_vs=[],b("shape3d.bottom.image")&&(C.bottom_uv=[])),s._12O(k,Q);else{var y,I,j,A,D,H,T,K,B,x;if(k=gk(O,g,c,t),D=s.vf(Ap,S,!1,r),Q&&(H=s.vf(Kq,S,!1,r),T=t?p:s.vf(Aj,S,!1,r),K=t?p:s.vf(ig,S,!1,r),B=s.vf(ko,S,!1,r),x=s.vf(eg,S,!1,r)),Q){for(var l=0,P=k.length;P>l;l++)k[l]=s._tryRemoveBezierPoints(k[l],Q);s._12O(k,Q)}else D&&k.forEach(function(C){if(A=C.length,A>0)for(y=C[0],j=1;A>j;j++)I=C[j],s.addV(D.vs,y,I),y=I});s._20Q(k),i||(D&&(D.ns=$m(D.vs),yc(D,"vs"),yc(D,Tg)),Q&&(H&&(H.ns=$m(H.vs),yc(H,"vs"),yc(H,Tg)),T&&(T.ns=$m(T.vs),yc(T,"vs"),yc(T,Tg)),K&&(K.ns=$m(K.vs),yc(K,"vs"),yc(K,Tg)),B&&(B.ns=$m(B.vs),yc(B,"vs"),yc(B,Tg)),x&&(x.ns=$m(x.vs),yc(x,"vs"),yc(x,Tg))))}var X=s.mat=Cm();xc(X,U),Oj(X,u.r3(),u.getRotationMode());var z=u.getScale3d(),J=u._dynamicScale3d;J&&(z[0]*=J[0],z[1]*=J[1],z[2]*=J[2]),bf(X,z),xc(X,pi(U)),i&&(Jq(s,X,i,C),s.clear())},_20Q:function(D){var E,R,c,o,q,O,f,y=this,N=y.front,M=y.back,b=y.top,n=y.bottom,e=N?N.tuv:p,F=M?M.tuv:p,j=b?b.tuv:p,K=n?n.tuv:p,L=0;(e||F||j||K)&&(E=y.s(Oo)||rd(D)||1,D.forEach(function(z){if(R=z.length,R>0)for(O=z[0],c=1;R>c;c++)f=z[c],o=L/E,L+=ti(O,f),q=L/E,y._14O(N,o,q),y._14O(M,1-q,1-o),y._14O(b,o,q),y._14O(n,o,q),O=f}))},_14O:function(z,k,B){if(z){var q=z.uv,s=z.tuv;if(s){if(q)var U=q[0]+(q[6]-q[0])*k,F=q[1]+(q[7]-q[1])*k,A=q[2]+(q[4]-q[2])*k,e=q[3]+(q[5]-q[3])*k,r=q[2]+(q[4]-q[2])*B,D=q[3]+(q[5]-q[3])*B,y=q[0]+(q[6]-q[0])*B,P=q[1]+(q[7]-q[1])*B;else U=k,F=0,A=k,e=1,r=B,D=1,y=B,P=0;s.push(A,e,r,D,y,P,y,P,U,F,A,e)}}},_13O:function(X){var H=X.uv,F=X.tuv;F&&(H?F.push(H[2],H[3],H[4],H[5],H[6],H[7],H[6],H[7],H[0],H[1],H[2],H[3]):F.push(0,1,1,1,1,0,1,0,0,0,0,1))},_tryRemoveBezierPoints:function(W,N){var D=W.length;if(4>D)return W;var X,c,w,e,i,m,n=!1,x=function(k){return W[k]},g=function(M){return W[D-1-M]};for(i=0;1>=i;i++)for(m=i?g:x,c=m(0),w=m(1),X=2;D-1>X;X++)if(e=m(X),!e.remove)if(e.b){var P=Ik(c,w,e,N);P.adjust?(e.remove=!0,n=!0):(c=w,w=e)}else c=w,w=e;if(!n)return W;var E=[];for(X=0;D>X;X++)W[X].remove||E.push(W[X]);return E},_12O:function(L,G){var e,i,V,Y,J,f=this;L.forEach(function($){if(J=$.length,J>0)for(e={p:$[0],n:!0},Y=1;J>Y;Y++)i=$[Y],V=J-1>Y?$[Y+1]:p,f.addPoint(e,i,V,G,$)})},addPoint:function(s,X,c,N,d){var V,I,K,S,y,b,P,r,U,C=this,Z=s.p,e=s.f,t=s.b,q=C.s("shape3d.side")||ao,g=C.s("shape3d.start.angle"),m=C.s("shape3d.sweep.angle"),l=C.shapeModel,O=C.data.isClosePath();if(s.n&&(s.n=!1,e=O&&d.length>2?Ik(d[d.length-2],Z,X,N):Ik(p,Z,X,N),t=En(Z,e),l?l.top_vs&&C._10O(t,e,q,g,m,l.top_vs,l.top_uv):(V=C.left)&&(C.addV(V.vs,t,e),C._13O(V))),I=c?Ik(Z,X,c,N):O&&d.length>2?Ik(Z,X,d[1],N):Ik(Z,X,p,N),K=En(X,I),l){var z,_,D=l.vs,v=l.uv,j=l.sum;for(v&&(z=l.len/j,l.len+=ti(Z,X),_=l.len/j),b=C._9O(t,e,q,g,m),P=C._9O(K,I,q,g,m),r=0;q>r;r++)U=r+1,xg(D,b[U]),xg(D,P[r]),xg(D,b[r]),xg(D,P[r]),xg(D,b[U]),xg(D,P[U]),v&&(S=r/q,y=U/q,v.push(z,y,_,S,z,S,_,S,z,y,_,y));!c&&l.bottom_vs&&C._10O(K,I,q,g,m,l.bottom_vs,l.bottom_uv,!0)}else!c&&(V=C.right)&&(C.addV(V.vs,I,K),C._13O(V)),(V=C.front)&&C.addV(V.vs,e,I),(V=C.back)&&C.addV(V.vs,K,t),(V=C.top)&&C.addH(V.vs,e,I,K,t,!0),(V=C.bottom)&&C.addH(V.vs,t,K,I,e);s.p=X,s.f=I,s.b=K},_10O:function(J,F,f,i,b,r,q,n){var R,Q,y=this,G=y.data,s=y._9O(J,F,f,i,b),w=(J.x+F.x)/2,T=(J.y+F.y)/2,z=G.getShapeElevation(),A=0;for(A=0;f>A;A++)n?(xg(r,s[A]),xg(r,s[A+1])):(xg(r,s[A+1]),xg(r,s[A])),xg(r,[w,z,T]),q&&(n?(R=x*(A+1)/f+i,Q=x*A/f+i):(R=x*A/f+i,Q=x*(A+1)/f+i),q.push(.5-.5*X(Q),.5-.5*S(Q),.5-.5*X(R),.5-.5*S(R),.5,.5))},_9O:function(m,V,q,o,c){var N,k,I=this,n=I.data,R=[],d=(m.x+V.x)/2,l=(m.y+V.y)/2,j=n.getTall()/2,A=n.getShapeElevation(),C=0;for(c=c||x;q>=C;C++)N=c*C/q+o,k=X(N),R.push([d+(m.x-d)*k,A+j*S(N),l+(m.y-l)*k]);return R},addV:function(p,N,O){var t=N.x,P=N.y,L=O.x,M=O.y,F=this.data,T=F.getShapeElevation(),G=F.getTall()/2;p.push(t,T-G,P,L,T-G,M,L,T+G,M,L,T+G,M,t,T+G,P,t,T-G,P)},addH:function(B,l,$,z,I,E){var M=this.data,P=M.getTall()/2,j=M.getShapeElevation()+(E?P:-P);B.push(l.x,j,l.y,$.x,j,$.y,z.x,j,z.y,z.x,j,z.y,I.x,j,I.y,l.x,j,l.y)},vf:function(b,q,A,o){var O,$=this,Y=$.gv.getFaceVisible($.data,b);return(A||Y)&&(O=Jn($,b,o),O.vs=[],O.tuv=Y&&(O.texture||q)?[]:p,O.visible=Y),O}});var op=function(W,m){td(op,this,[W,m])};bd(op,ah,{_25Q:1,validate:function(O){var s=this,_=s.data,I=s.s,j=_.getPoints(),q=j.size();if(s.shapeModel=s.info=p,q>1){var U=s.info={},W=_.getSegments(),V=_.getThickness(),r=Qj(j.get(0)),D=Qj(j.get(q-1)),z=q%2;0===z?(U.c1=Qj(j.get(q/2-1)),U.c2=Qj(j.get(q/2))):U.p3=Qj(j.get((q-z)/2)),U.s1=r,U.s2=Qj(j.get(1)),U.t1=Qj(j.get(q-2)),U.t2=D,U.list=I(hg)===dd?s.createTubeModel(j,W,V/2,O):s.createLineModel(j,W,V,"shape.border","shape.dash")}var x=_.p3(),N=s.mat=Cm();xc(N,x),Oj(N,_.r3(),_.getRotationMode());var n=_.getScale3d(),w=_._dynamicScale3d;w&&(n[0]*=w[0],n[1]*=w[1],n[2]*=w[2]),bf(N,n),xc(N,pi(x))},_80o:function(U,F,I){var z=this,p=z.shapeModel;if(p){var Y=z.gv;Wj(Y,z.mat),lc(Y,z.data,p,z,z.getBodyColor(),I),We(Y)}}}),Gp(U,{accordionViewExpandIcon:Ll(Dd),accordionViewCollapseIcon:Ll(Dd,!0),accordionViewLabelColor:nj,accordionViewLabelFont:cc,accordionViewTitleBackground:Pd,accordionViewSelectBackground:Un,accordionViewSelectWidth:3,accordionViewSeparatorColor:R,splitViewDividerSize:1,splitViewDividerBackground:Pd,splitViewDragOpacity:.5,splitViewToggleIcon:{width:16,height:16,comps:[{type:Rr,rect:[2,2,12,12],background:Dd}]},propertyViewLabelColor:Bd,propertyViewLabelSelectColor:nj,propertyViewLabelFont:cc,propertyViewExpandIcon:Ll(Gi),propertyViewCollapseIcon:Ll(Gi,!0),propertyViewBackground:zj,propertyViewRowLineVisible:!0,propertyViewColumnLineVisible:!0,propertyViewRowLineColor:bh,propertyViewColumnLineColor:bh,propertyViewSelectBackground:Un,listViewLabelColor:Bd,listViewLabelSelectColor:nj,listViewLabelFont:cc,listViewRowLineVisible:!1,listViewRowLineColor:bh,listViewSelectBackground:Un,treeViewLabelColor:Bd,treeViewLabelSelectColor:nj,treeViewLabelFont:cc,treeViewExpandIcon:Ll(Ao),treeViewCollapseIcon:Ll(Ao,!0),treeViewRowLineVisible:!1,treeViewRowLineColor:bh,treeViewSelectBackground:Un,treeViewDoubleClickToToggle:!0,tableViewLabelColor:Bd,tableViewLabelSelectColor:nj,tableViewLabelFont:cc,tableViewRowLineVisible:!0,tableViewColumnLineVisible:!0,tableViewRowLineColor:bh,tableViewColumnLineColor:bh,tableViewSelectBackground:Un,treeTableViewLabelColor:Bd,treeTableViewLabelSelectColor:nj,treeTableViewLabelFont:cc,treeTableViewExpandIcon:Ll(Ao),treeTableViewCollapseIcon:Ll(Ao,!0),treeTableViewRowLineVisible:!0,treeTableViewColumnLineVisible:!0,treeTableViewRowLineColor:bh,treeTableViewColumnLineColor:bh,treeTableViewSelectBackground:Un,tableHeaderLabelColor:Bd,tableHeaderLabelFont:cc,tableHeaderColumnLineVisible:!0,tableHeaderColumnLineColor:hi,tableHeaderBackground:zj,tableHeaderMoveBackground:ii,tableHeaderInsertColor:Un,tableHeaderSortDescIcon:dp(Gi,!0),tableHeaderSortAscIcon:dp(Gi),tabViewTabGap:1,tabViewLabelColor:nj,tabViewLabelFont:cc,tabViewTabBackground:Pd,tabViewSelectWidth:3,tabViewSelectBackground:Un,tabViewMoveBackground:ii,tabViewInsertColor:Un,toolbarLabelColor:Bd,toolbarLabelSelectColor:nj,toolbarLabelFont:cc,toolbarBackground:zj,toolbarSelectBackground:Un,toolbarItemGap:8,toolbarSeparatorColor:pc},!0);var Lc={translateX:1,sortColumn:1},fj={sortable:1,sortOrder:1,sortFunc:1},Ko={focusData:1},Vn={dataModel:1,sortColumn:1,sortFunc:1,visibleFunc:1,rootData:1,rootVisible:1},Jp={dataModel:1,sortFunc:1,visibleFunc:1,categorizable:1},Kp=function($,e){e.add($),$.hasChildren()&&$.eachChild(function(I){Kp(I,e)})},Uo=function(R,c,y,h,d,T,K,_,A,t,S){var B,$=y.getValueType(t),M=y.getAlign(t);if(y.getEnumValues(t)){var Y=y.toEnumLabel(c,t),N=_f||0,V=0,I=T,X=U.getTextSize(h,Y).width;return B=Tm(y.toEnumIcon(c,t)),B&&(V=T+_f/2,"center"===M?V+=(_-(N+X))/2:"right"===M&&(V=V+_-(N+X)),Pq(R,B,V,K+A/2,t,S),I=V+_f/2),Y!=p&&(B?Sn(R,Y,h,d,I,K,_-(I-T),A):Sn(R,Y,h,d,T,K,_,A,M)),void 0}return c=y.formatValue(c),c!=p?$===ym?(le(R,T,K,_,A,c),void 0):$===Um||!$&&sq(c)?(B=Tm(c?_h:bn),Pq(R,B,T+_/2,K+A/2,t,S),void 0):(Sn(R,c,h,d,T,K,_,A,M),void 0):void 0},vj=function(G,J){var z=J.view,Q=Gn(G),j=J.column||J.property;z.getDataModel().beginTransaction(),J.editor=G,G.info=J,z.setCurrentEditor(G),z.getView().insertBefore(Q,z._79O),Eb(G,J.editorRect),G.setFocus?G.setFocus():rb(G),G.commitValue=function(){G._17Q&&(G=G._17Q),z.setValue(J.data,j,G.getValue?G.getValue():G.value),G.close&&G.close(),_k(Q)},j.onEditorCreated&&j.onEditorCreated(J)},zs=function(M,G,C,W,g){var x=Vb(M,C),k=G.value,L=G.view,e=g.getValueType(G.data);return x.onblur=x.onchange=function(){L.endEditing()},"input"===M?(k=g.formatValue(k),k!=p&&(x.value=k),x.onkeydown=function(J){Oi(J)&&L.endEditing()},(e===ui||e===oe)&&x.addEventListener(Zn,U.numberListener,!1)):M===mp&&W.forEach(function(K){var A=i.createElement("option");A.innerHTML=g.toEnumLabel(K),A.value=K,g.isEnumEqual(k,K)&&(A.selected=!0),rj(x,A)}),vj(x,G),x},Tp=D.widget={},jr=function($,F,q){bd(l+".widget."+$,F,q)};Gp(Po,{ms_value:function(e){e.getValue=function(S){var K=this.getItemById(S),L=K.element;return Op(L)?L:L?L.getValue?L.getValue():L.value:K.selected},e.setValue=function(G,t){var W=this.getItemById(G),o=W.element;o&&!Op(o)?o.setValue?o.setValue(t):o.value=t:sq(t)?(W.selected=t,this.iv()):(W.element=t,this.iv())},e.v=function(p,C){var l=this;if(2===arguments.length)l.setValue(p,C);else{if(!Dh(p))return l.getValue(p);for(var h in p)l.setValue(h,p[h])}return l}},_46o:function(E){E._icon=p,E._accessType=p,E._valueType=p,E._editable=!1,E._batchEditable=!0,E._align=Aj,E._nullable=!0,E._emptiable=!1,E.setParent=ff,E.formatValue=function(d){var y=this,E=y._valueType;return y.getEnumValues()?y.toEnumLabel(d):E===Um?!!d:d!=p&&E===ui?o(d):d},E.setEnum=function(Z,f,K,n,g,Y,e){var k=this;Z&&!vi(Z)&&Z.values&&(n=Z.editable,K=Z.icons,f=Z.labels,g=Z.strict,Y=Z.maxHeight,e=Z.dropDownWidth,Z=Z.values),nk(Z)&&(Z=Z._as),nk(f)&&(f=f._as),nk(K)&&(K=K._as),k._enumValues=Z,k._enumLabels=f,k._enumIcons=K,k._enumEditable=n,k._enumStrict=g==p?!0:g,k._enumMaxHeight=Y,k._enumDropDownWidth=e,Z&&Z.length&&Tq(Z[0])&&(k._valueType=oe),k.fp("enum",!1,!0)},E.getEnumDropDownWidth=function(){return this._enumDropDownWidth},E.getEnumMaxHeight=function(){return this._enumMaxHeight},E.isEnumEditable=function(){return this._enumEditable},E.getEnumValues=function(){return this._enumValues},E.getEnumLabels=function(){return this._enumLabels},E.getEnumIcons=function(){return this._enumIcons},E.isEnumStrict=function(){return this._enumStrict},E.isEnumEqual=function(z,Q){return this._enumStrict?z===Q:z==Q},E.toEnumLabel=function(t,T){var P=this,s=P.getEnumValues(T),f=P.getEnumLabels(T);if(s&&f)for(var E=0;E<s.length;E++)if(P.isEnumEqual(t,s[E]))return f[E];return t},E.toEnumIcon=function(j,I){var n=this,$=n.getEnumValues(I),p=n.getEnumIcons(I);if($&&p)for(var c=0;c<$.length;c++)if(n.isEnumEqual(j,$[c]))return p[c];return R}},_45o:function(j){j._87o=function(L,v,e,d,w,N){if(L){var Q=this,K=Q._90I,a=yb(1);Q._columnLineVisible&&(w-=1),Q._rowLineVisible&&(N-=1),0>=w||0>=N||(Q._90I||(K=Q._90I={}),K[v]||(K[v]=new uh),Eb(a,Q.tx()+e,Q.ty()+d,w,N),rj(a,L),Q._view.insertBefore(a,Q._79O),L.onParentAdded&&L.onParentAdded(a),K[v].add(a))}},j._76o=function(){var x=this,Y=x._90I;if(Y){for(var e in Y)Y[e].each(function(O){_k(O)});delete x._90I}},j._77o=function(l){var L=this;if(L._90I){var I=L._90I[l];I&&(I.each(function(X){_k(X)}),delete L._90I[l])}}},_47o:function(t){t.getValue=function(e,R){return R.getValue?R.getValue(e,R,this):Kg(e,R.getAccessType(),R.getName())},t.setValue=function(u,O,t){if(O.isEmptiable(u)||""!==t||(t=R),O.isNullable(u)||t!=p){var m=this,g=O.getName(u),B=O.getAccessType(u),x=O.getValueType(u);x===ui&&Op(t)?t=f(t):x===oe&&Op(t)?t=parseFloat(t):x===Um&&Op(t)&&(t="true"===t),m._batchEditable&&O._batchEditable&&m.isSelected(u)?m.sm().each(function(V){O.setValue?O.setValue(V,O,t,m):re(V,B,g,t)}):O.setValue?O.setValue(u,O,t,m):re(u,B,g,t)}},t.setCurrentEditor=function(a){this.endEditing(),this._currentEditor=a,this.redraw()},t.isEditing=function(b,H){var u=this,j=u._currentEditor;if(!j)return!1;if(H){var h=j.info;return h?(h.column||h.property)===H&&h.data===b:!1}return!0},t.endEditing=function(){var u=this,f=u._currentEditor;f&&(delete u._currentEditor,f.commitValue&&f.commitValue(f.info),u.redraw(),u.getDataModel().endTransaction())},t.beginEditing=function(S){this.endEditing();var B=this,q=S.column||S.property;if(q.beginEditing)q.beginEditing(S);else{var r=S.data,t=S.value,o=B.getSelectBackground(r),l=q.getEnumValues(r),C=q.getSlider(r),y=q.getColorPicker(r);if(C){var Q=Wg(Tp.Slider,C);return Q.setValue(t),Q.getView().onblur=function(){B.endEditing()},Q.isInstant()&&(Q.onValueChanged=function(){B.setValue(r,q,Q.getValue())}),vj(Q,S),void 0}if(y||q.getValueType(r)===ym){var z=Wg(Tp.ColorPicker,y);return z.setValue(t),z.onClosed=function(){B.endEditing()},z.isInstant()&&(z.onValueChanged=function(T,N){B.setValue(r,q,N)}),vj(z,S),z.open(),void 0}if(l){if(Tp.ComboBox){var $=new Tp.ComboBox;$.setValue(t),$.setValues(l),$.setLabels(q.getEnumLabels(r)),$.setIcons(q.getEnumIcons(r)),$.setEditable(q.isEnumEditable(r)),$.setStrict(q.isEnumStrict(r)),$.setMaxHeight(q.getEnumMaxHeight(r)),$.setDropDownWidth(q.getEnumDropDownWidth(r)),$.onClosed=function(){B.endEditing()},vj($,S),$.open()}else zs(mp,S,o,l,q);return}var R=q.getValueType(r);if(R===Um||sq(t))return B.setValue(r,q,!t),void 0;if(q.getItemEditor(r)){var u=og(q.getItemEditor(r)),K=new u(r,q,B,S),Z=K.getView();return Z._17Q=K,K.setValue(t),Pf(Z),vj(Z,S),K.editBeginning&&K.editBeginning(),void 0}zs("input",S,o,p,q)}}},_44o:function(U){U.init=function(R){var N=this,D=N.th=new Jj(R),X=N._view=Yf(1,N);N.tv=N._tableView=R,rj(X,D.getView()),rj(X,R.getView()),D.mp(function(I){I.property===ye&&N.iv()}),N.iv()},U.getTableView=function(){return this.tv},U.getTableHeader=function(){return this.th},U.getDataModel=function(){return this.tv.dm()},U.getColumnModel=function(){return this.tv.getColumnModel()},U.setColumns=function(z){this.tv.setColumns(z)},U.addColumns=function(p){this.tv.addColumns(p)},U.endEditing=function(){this.tv.endEditing()},U.validateImpl=function(){var o=this,d=o.th,m=Hh(d),i={x:0,y:0,width:o.getWidth(),height:m};Eb(d,i),i.y=m,i.height=Q(0,o.getHeight()-m),Eb(o.tv,i)}},ms_vs:function(B){B._41o=function(){return this._29I.height<this._59I},B._43o=function(){var U=this;U._41o()&&(U._58I||(A(function(){U._94O()},uq),U.iv()),U._58I=new Date)},B._94O=function(){var l=this;if(l._58I){var t=new Date;t.getTime()-l._58I.getTime()>=uq?(delete l._58I,l.iv()):A(function(){l._94O()},uq)}},B._93I=function(){var k=this,Y=k._27I;if(k._58I||!k._autoHideScrollBar){Y||rj(k._79O,Y=k._27I=yb());var f=k._29I,n=f.height,M=k._59I,V=k.getScrollBarSize(),L=f.width-V-2,P=n*(-k.ty()/M),X=n*(n/M),i=Y.style;M>n?(zf>X&&(P=P+X/2-zf/2,0>P&&(P=0),P+zf>n&&(P=n-zf),X=zf),i.visibility=ks,i.background=k.getScrollBarColor(),i.borderRadius=V/2+Vj,Eb(Y,L,P,V,X)):i.visibility=yd}else Y&&(Y.style.visibility=yd)}},ms_hs:function(f){f._40o=function(){return this._29I.width<this._91I},f._42o=function(){var q=this;q._40o()&&(q._95O||(A(function(){q._94I()},uq),q.iv()),q._95O=new Date)},f._94I=function(){var p=this;if(p._95O){var C=new Date;C.getTime()-p._95O.getTime()>=uq?(delete p._95O,p.iv()):A(function(){p._94I()},uq)}},f._92I=function(){var A=this,e=A._28I;if(A._95O||!A._autoHideScrollBar){e||rj(A._79O,e=A._28I=yb());var t=A._29I,N=t.width,j=A._91I,Z=A.getScrollBarSize(),w=t.height-Z-2,V=N*(-A.tx()/j),$=N*(N/j),g=e.style;j>N?(zf>$&&(V=V+$/2-zf/2,0>V&&(V=0),V+zf>N&&(V=N-zf),$=zf),g.visibility=ks,g.background=A.getScrollBarColor(),g.borderRadius=Z/2+Vj,Eb(e,V,w,$,Z)):g.visibility=yd}else e&&(e.style.visibility=yd)}}}),kc(_h,on(16,16,[{type:li,rect:[1,1,14,14],background:Un},{type:yi,rect:[1,1,14,14],width:1,color:Ii},{type:jp,points:[13,3,7,12,4,8],borderWidth:2,borderColor:"#FFF"}])),kc(bn,on(16,16,{type:yi,rect:[1,1,14,14],width:1,color:Ii})),kc(as,on(16,16,[{type:On,rect:[2,2,12,12],borderWidth:1,borderColor:Ii,background:"#FFF"},{type:On,rect:[4,4,8,8],background:Un}])),kc(mh,on(16,16,{type:On,rect:[2,2,12,12],borderWidth:1,borderColor:Ii})),Po._15Q=function(e){e._29I=Am,e._59I=0,e._91I=0,e._5o=function(I){var H=this;H._30I=new uh,H._rows=new uh,H._rowMap={},H._31I=0,H._14I=0,H._view=Yf(1,H),H._canvas=Ne(H._view),rj(H._view,H._79O=yb()),H.dm(I?I:new ke)},e.getCheckIcon=function(S){var q=this.sm(),B=q.co(S);return q.sg()?Tm(B?as:mh):Tm(B?_h:bn)},e.checkData=function(N){var L=this.sm(),j=L.co(N);L.sg()&&j||(this._32o=1,j?L.rs(N):L.as(N),delete this._32o)},e.getDataAt=function(G){G.target&&(G=this.lp(G));var f=Z(G.y/this._rowHeight),Y=this._rows;return 0>f||f>=Y.size()?p:Y.get(f)},e.onDataDoubleClicked=function(){},e.onDataClicked=function(){},e.adjustTranslateX=function(){return 0},e.adjustTranslateY=function(f){var T=this.getHeight()-this._59I;return T>f&&(f=T),f>0?0:o(f)},e.onPropertyChanged=function(B){var T=this,m=B.property;Vn[m]?T.ivm():Ko[m]||T.redraw(),m===Gj?T._42o():m===Cn&&T._43o()},e.getLabel=function(K){return K.toLabel()},e.getLabelFont=function(){return this._labelFont},e.getLabelColor=function(A){var _=this;if(_.isCheckMode()){if(_._focusData===A)return _._labelSelectColor}else if(_.isSelected(A))return _._labelSelectColor;return _._labelColor},e.getStartRowIndex=function(){return this._31I},e.getEndRowIndex=function(){return this._14I},e.getRowDatas=function(){return this._rows},e.getRowIndex=function(C){return this._rowMap[C._id]},e.getRowSize=function(){return this._rows.size()},e.getViewRect=function(){return ik(this._29I)},e.isVisible=function(x){return this._visibleFunc?this._visibleFunc(x):!0},e.getCurrentSortFunc=function(){return this._sortFunc},e.setDataModel=function(K){var V=this,i=V._dataModel,A=V._selectionModel;i!==K&&(i&&(i.umm(V.handleDataModelChange,V),i.umd(V.handleDataPropertyChange,V),i.umh(V.handleHierarchyChange,V),A||i.sm().ums(V.handleSelectionChange,V)),V._dataModel=K,K.mm(V.handleDataModelChange,V),K.md(V.handleDataPropertyChange,V),K.mh(V.handleHierarchyChange,V),A?A._21I(K):K.sm().ms(V.handleSelectionChange,V),V.fp("dataModel",i,K))},e.validateModel=function(){var b=this;b._rows.clear(),b._rowMap={},b.buildChildren(b._dataModel._roots);var s=b._rows=b._rows.toList(b.isVisible,b),N=0,F=b.getCurrentSortFunc(),j=s.size();for(F&&s.sort(F);j>N;N++)b._rowMap[s.get(N)._id]=N},e.buildChildren=function(Z){var w=this;Z.each(function(G){w._rows.add(G),w.buildChildren(G._children)})},e.handleDataModelChange=function(){this.ivm()},e.handleDataPropertyChange=function(w){"parent"===w.property?this.ivm():this.invalidateData(w.data)},e.handleHierarchyChange=function(){this.ivm()},e.handleSelectionChange=function(I){I.datas.each(this.invalidateData,this),this.onSelectionChanged(I)},e.onSelectionChanged=function(L){var l=this,P=l.sm();!l.isAutoMakeVisible()||1!==P.size()||"set"!==L.kind&&"append"!==L.kind||l._32o||l.makeVisible(P.ld())},e.handleBackgroundClick=function(b){xm(b)&&!this.isCheckMode()&&this.sm().cs()},e.makeVisible=function(n){n&&(this._23I=n,this.iv())},e.scrollToIndex=function(v){var s=this,P=s._29I,b=P.height,B=s._rowHeight,x=B*v;v>=0&&v<s._rows.size()&&b>0&&(x+B>P.y+b?s.ty(-x+b-B):x<P.y&&s.ty(-x))},e.autoScroll=function(W,c){var H=this,J=H._rowHeight,r=J,I=J/4,G=H._29I,n=H.lp(W),P={x:H.tx(),y:H.ty()};return J>0&&G&&(n.x-G.x<r?H.translate(I,0):G.x+G.width-n.x<r&&H.translate(-I,0),n.y-G.y<r?H.translate(0,I):G.y+G.height-n.y<r&&H.translate(0,-I)),P.x=H.tx()-P.x,P.y=H.ty()-P.y,c&&(c.x+=P.x,c.y+=P.y),P},e.getTopRowOrderSelection=function(){var R=this.sm().getTopSelection(),V={},o=new uh;return R.each(function(w){V[w._id]=w}),this._rows.each(function(D){V[D._id]&&o.add(D)}),o},e.getRowOrderSelection=function(){var I=new uh;return this._rows.each(function(S){this.isSelected(S)&&I.add(S)},this),I},e.ivm=function(){this.invalidateModel()},e.invalidateModel=function(){var k=this;k._96I||(k._96I=1,k._32I=1,delete k._24I),k.iv()},e.redraw=function(){var s=this;s._32I||(s._32I=1,delete s._24I,s.iv())},e.invalidateData=function(C){var Z=this;N?Z.redraw():Z._32I||(Z._24I||(Z._24I={}),Z._24I[C._id]=C,Z.iv())},e.getFocusData=function(){return this._focusData},e.setFocusDataById=function(k){this.setFocusData(this.dm().getDataById(k))},e.setFocusData=function(u){var s=this,a=s._focusData;a!==u&&(s._focusData=u,s.fp("focusData",a,u),a&&s.invalidateData(a),u&&(s.invalidateData(u),s.isAutoMakeVisible()&&s.makeVisible(u)))},e.drawRowBackground=function(D,L,f,H,g,t,Z){var J=this,S=J.isCheckMode();(L===J._focusData&&S||f&&!S)&&le(D,H,g,t,Z,J.getSelectBackground(L))},e.drawData=function(e,L,P){var M=this,Q=M._rowHeight,_=Q*P,K=M._29I,r=K.x,B=K.width;e.save(),e.beginPath(),e.rect(r,_,B,Q),e.clip(),M._87o(M.drawRow(e,L,M.isSelected(L),r,_,B,Q),P,r,_,B,Q),e.restore(),M._rowLineVisible&&le(e,r,_+Q-1,B,1,M._rowLineColor)},e._12I=function(c){var p=this,v=p._31I,C=p._29I,E=C.x,N=C.y,m=C.width,D=C.height;for(c.beginPath(),c.rect(E,N,m,D),c.clip(),c.clearRect(E,N,m,D),p._76o(),p._93db(c);v<p._14I;v++)p.drawData(c,p._rows.get(v),v);p._92db(c)},e._13I=function(t){for(var l,j=this,I=j._rowHeight,P=j._29I,T=P.x,i=P.width,U=j._31I,Q=j._30I;U<j._14I;U++)l=j._rows.get(U),j._24I[l._id]&&Q.add({data:l,index:U});Q.isEmpty()||(t.beginPath(),Q.each(function(w){t.rect(T,w.index*I,i,I)}),t.clip(),Q.each(function(k){t.clearRect(T,k.index*I,i,I)}),Q.each(function(U){j._77o(U.index)}),j._93db(t),Q.each(function(n){j.drawData(t,n.data,n.index)}),j._92db(t),Q.clear())},e.validateImpl=function(){var N=this,$=N._canvas,s=N.getWidth(),l=N.getHeight(),Y=N._rowHeight,c=N._32I;(s!==$.clientWidth||l!==$.clientHeight)&&(Yc($,s,l),c=1);var x=W&&!d;N._96I&&!x&&N.validateModel();var m=N._29I,H={x:-N.tx(),y:-N.ty(),width:s,height:l},R=N._rows.size(),J=Xh($),g=N._23I;c||Kl(H,m)||(c=1),N._29I=H,N._59I=R*Y,N._31I=Z(H.y/Y),N._14I=E((H.y+H.height)/Y),N._31I<0&&(N._31I=0),N._14I>R&&(N._14I=R),N._99I&&c&&N._99I(),Co(J,N.tx(),N.ty(),1),c?N._12I(J):N._24I&&N._13I(J),N._93I(),N._92I(),J.restore(),N._32I=N._24I=N._96I=p,g&&(N.scrollToIndex(N.getRowIndex(g)),delete N._23I),N.tx(N.tx()),N.ty(N.ty())}},Po._48o=function($){$._rootVisible=!0,$._rootData=p,$._35o=function(){this._expandMap={},this._levelMap={}},$.validateModel=function(){var D=this,M=D._rootData;D._rows.clear(),D._levelMap={},D._rowMap={},D._currentLevel=0,M?D._rootVisible?D.isVisible(M)&&D.buildData(M):D.buildChildren(M):D.buildChildren(),delete D._currentLevel},$.buildData=function(P){var x=this,Y=P._id,o=x._rows;x._rowMap[Y]=o.size(),o.add(P),x._levelMap[Y]=x._currentLevel,x.isExpanded(P)&&(x._currentLevel++,x.buildChildren(P),x._currentLevel--)},$.buildChildren=function(Y){var d=this,g=Y?Y._children:d._dataModel._roots,p=d.getCurrentSortFunc();p&&d.isChildrenSortable(Y)?g.toList(d.isVisible,d).sort(p).each(d.buildData,d):g.each(function(s){d.isVisible(s)&&d.buildData(s)})},$.getLevel=function(m){return this._levelMap[m._id]},$.getToggleIcon=function(C){var c=this,e=c._loader,O=c._collapseIcon;return e&&!e.isLoaded(C)?O:C.hasChildren()?c.isExpanded(C)?c._expandIcon:O:p},$.isCheckMode=function(){return this._checkMode!=p},$.isChildrenSortable=function(){return!0},$.handleDataModelChange=function(N){var c=this;N.kind===Hi?delete c._expandMap[N.data._id]:N.kind===Zi&&(c._expandMap={}),c.ivm()},$.toggle=function(E){var O=this;O.isExpanded(E)?O.collapse(E):O.expand(E)},$.isExpanded=function(V){return 1===this._expandMap[V._id]},$.expand=function(M){var L=this,b=L._loader;L.isExpanded(M)||(b&&!b.isLoaded(M)&&b.load(M),L._expandMap[M._id]=1,L.ivm(),L.onExpanded(M))},$.onExpanded=function(){},$.collapse=function(U){var B=this;B.isExpanded(U)&&(delete B._expandMap[U._id],B.ivm(),B.onCollapsed(U))},$.onCollapsed=function(){},$.expandAll=function(Q){if(Q)this.expand(Q),Q.eachChild(function(_){this.expandAll(_)},this);else{var P=this;P._dataModel.each(function(m){m.hasChildren()&&(P._expandMap[m._id]=1)}),P.ivm()}},$.collapseAll=function(){this._expandMap={},this.ivm()},$.makeVisible=function($){if($){var q=this;if(!q._rootData||$.isDescendantOf(q._rootData)){for(var z=$._parent;z;)q.expand(z),z=z._parent;q._23I=$,q.iv()}}},$.checkData=function(R){var g,p=this,G=p._checkMode,t=p.sm(),k=t.co(R);if(!t.sg()||!k){if(p._32o=1,G===Wb)k?t.rs(R):t.as(R);else if(G===bi)g=new uh(R),g.addAll(R._children);else if("descendant"===G)g=new uh,Kp(R,g);else if("all"===G&&(g=new uh,Kp(R,g),!k))for(var A=R._parent;A;)g.add(A),A=A._parent;g&&(k?t.rs(g):t.as(g)),delete p._32o}},$._97I=function(N,d,A,m,Z,W,w){var C=this,h=C._indent,g=C._levelMap[d._id],o=C.getIconWidth(d),l=Tm(C.getToggleIcon(d));l?(m+=h*g,Pq(N,l,m+h/2,Z+w/2,d,C),m+=h):m+=h*(g+1),C._checkMode&&(Pq(N,C.getCheckIcon(d),m+h/2,Z+w/2,d,C),m+=h),C.drawIcon(N,d,m,Z,o,w),C.drawLabel(N,d,m+o,Z,w)}},Po._14Q=function(Z){Z.getIcon=function(d){return d.getIcon()},Z.getIconWidth=function(w){return this.getIcon(w)?this._indent:0},Z.drawIcon=function(d,z,X,c,R,V){if(R){var o=this,B=o.getBodyColor(z),Y=Tm(o.getIcon(z),B);Y&&(V-=o.isRowLineVisible()?1:0,Xl(d,Y,As,X,c,R,V,z,o,B),gg(d,o.getBorderColor(z),X,c,R,V))}},Z.drawLabel=function(z,W,A,Z,f){var U=this;Sn(z,U.getLabel(W),U.getLabelFont(W),U.getLabelColor(W),A,Z,0,f)}},Po._50o=function(O){O._98I=function(){var N=this,v=N._39o=new ke;N._60I=new uh,v.mm(N._17o,N),v.md(N._18o,N),v.mh(N._19o,N)},O.setColumns=function(h){this._39o.clear(),this.addColumns(h)},O.addColumns=function(j){var I=this._39o;j.forEach(function(J){if(!(J instanceof Tr)){var b=og(J.className);J=Wg(b?b:Tr,J)}I.add(J)})},O.onColumnClicked=function(){},O.onCheckColumnClicked=function(){},O._3Q=function(Y){for(var m,K=0,x=this._60I,v=x.size();v>K;K++)if(m=x.get(K),m.column===Y)return m;return p},O.getColumnAt=function(T){var O=this._4Q(T);return O?O.column:p},O._4Q=function(t){for(var A=this,I=t.target?A.lp(t).x:t.x,N=A._60I,q=0;q<N.size();q++){var L=N.get(q),b=L.startX;if(I>=b&&I<b+L.column.getWidth())return L}return p},O.getToolTip=function(_){var f=this,R=f.getDataAt(_),P=f.getColumnAt(_);return R&&P?P.getToolTip(R,f):p},O.adjustTranslateX=function(Y){var e=this.getWidth()-this._91I;return e>Y&&(Y=e),Y>0?0:o(Y)},O._99I=function(){var $=this,l=$._29I,U=$._60I;U.clear(),$._91I=0,$._39o._roots.each(function(x){if(x.isVisible()){var u=$._91I+x.getWidth();$._91I<=l.x+l.width&&u>=l.x&&U.add({column:x,startX:$._91I}),$._91I=u}})},O.drawData=function(I,F,M){var x=this,J=x._rowHeight,S=J*M,m=x.isSelected(F),v=x._29I,y=v.x,V=v.width;x.drawRowBackground(I,F,m,y,S,V,J),x._60I.each(function(U){var u=U.column,r=U.startX,c=u.getWidth();c>0&&!x.isEditing(F,u)&&(I.save(),I.beginPath(),I.rect(r,S,c,J),I.clip(),x._87o(x.drawCell(I,F,m,u,r,S,c,J),M,r,S,c,J),x._columnLineVisible&&le(I,r+c-1,S,1,J,x._columnLineColor),I.restore())}),x._rowLineVisible&&le(I,y,S+J-1,V,1,x._rowLineColor)},O.drawCell=function(c,A,a,s,i,Z,Q,B){var K=this;if(s.drawCell)return s.drawCell(c,A,a,s,i,Z,Q,B,K);var e=K.getValue(A,s);Uo(c,e,s,K.getLabelFont(A,s,e),K.getLabelColor(A,s,e),i,Z,Q,B,A,K)},O.getColumnModel=function(){return this._39o},O._17o=function(){this.redraw()},O._18o=function(G){var b=this;G.data===b._sortColumn&&fj[G.property]?b.ivm():(b._42o(),b.redraw())},O._19o=function(){this.redraw()},O.getCurrentSortFunc=function(){var I=this,w=I._sortColumn;if(w&&w.isSortable()){var P=w.getSortFunc(),T=Ug===w.getSortOrder()?1:-1;return P||(P=Md),function(S,l){return P.call(I,I.getValue(S,w),I.getValue(l,w),S,l)*T}}return I._sortFunc},O.isCellEditable=function(k,g){return!this.isCheckMode()&&this.isSelected(k)||this.isCheckMode()&&k===this._focusData?g.isEditable()&&this.isEditable():!1},O._37O=function(t,n){if(xm(n))for(var Y=this,H=Y.lp(n),S=Y._60I,Q=Y._rowHeight,U=Y._29I,f=U.x,d=U.y,s=U.width,J=U.height,v=0;v<S.size();v++){var M=S.get(v),z=M.startX,G=M.column,N=G.getWidth();if(G!==Y._31o&&G!==Y._4o&&Y.isCellEditable(t,G,n)&&H.x>=z&&H.x<z+N){var Z={x:z,y:Y.getRowIndex(t)*Q,width:N,height:Q},m={x:Z.x+Y.tx(),y:Z.y+Y.ty(),width:Z.width,height:Z.height},y=0,x=0;return Z.x<f?y=Z.x-f:Z.x+Z.width>f+s&&(y=Z.x+Z.width-f-s),y&&(Y.tx(Y.tx()-y),m.x-=y),Z.y<d?x=Z.y-d:Z.y+Q>d+J&&(x=Z.y+Q-d-J),x&&(Y.ty(Y.ty()-x),m.y-=x),Y.beginEditing({data:t,column:G,value:Y.getValue(t,G),event:n,rect:Z,editorRect:m,view:Y}),void 0}}}},Tp.BaseItemEditor=function(k,l,z,o){this._data=k,this._column=l,this._master=z,this._editInfo=o},jr("BaseItemEditor",h,{ms_ac:["data","column","master","editInfo"],editBeginning:function(){},getView:function(){},getValue:function(){},setValue:function(){}});var $h=D.Tab=function(){td($h,this)};fe("Tab",Mo,{ms_ac:["view","closable","disabled"],_icon:p,_closable:!1,_disabled:!1,setParent:ff});var Tr=D.Column=function(){td(Tr,this)};fe("Column",Mo,{_46o:1,ms_ac:["accessType","valueType",ks,vp,Eo,Mh,"align",ym,"sortOrder",Cc,"sortable","clickable","nullable","emptiable","slider","colorPicker","itemEditor"],_visible:!0,_width:80,_sortOrder:Ug,_sortFunc:p,_sortable:!0,_clickable:!0,setWidth:function(y){16>y&&(y=16);var c=this._width;this._width=y,this.fp(Mh,c,y)},getToolTip:function(B,Q){return this.formatValue(Q.getValue(B,this))}});var bc=D.Property=function(){td(bc,this)};fe("Property",Mo,{_46o:1,ms_ac:["accessType","valueType",vp,Eo,"categoryName",ym,"align","nullable","emptiable","slider","itemEditor","colorPicker"],_categoryName:p,getToolTip:function(b,V,U){var W=this;return V?W.formatValue(U.getValue(b,W)):U.getPropertyName(W)}}),Tp.AccordionView=function(){var M=this;M._20o={},M._21o=new uh,M._10o=p,M._9o=p,M._11o=p,M._view=Yf(0,M),M.iv()},jr("AccordionView",h,{ms_v:1,ms_fire:1,ms_ac:[_l,Nn,"titleHeight",Sl,$q,"titleBackground","selectWidth",ri,"orientation","separatorColor"],_expandIcon:U.accordionViewExpandIcon,_collapseIcon:U.accordionViewCollapseIcon,_titleHeight:Ze,_labelColor:U.accordionViewLabelColor,_labelFont:U.accordionViewLabelFont,_titleBackground:U.accordionViewTitleBackground,_selectBackground:U.accordionViewSelectBackground,_selectWidth:U.accordionViewSelectWidth,_orientation:"v",_separatorColor:U.accordionViewSeparatorColor,onPropertyChanged:function(){this.iv()},getView:function(){return this._view},getTitles:function(){return this._21o},getCurrentTitle:function(){return this._10o},add:function(Y,j,r,K){var n=this,A=yb();if(n._20o[Y])throw Y+" already exists";A.onmousedown=gj,A.style.cursor=Kn,A.addEventListener(_?yh:Fh,function(l){gj(l)},!1),A.addEventListener(_?Lj:Wc,function(c){gj(c),xm(c)&&(n._10o===Y?n.collapse():n.expand(Y))},!1),rj(n._view,A),n._20o[Y]={content:j,div:A,canvas:Ne(A),icon:K},n._21o.add(Y),r&&n.expand(Y),n.iv()},remove:function(t){var i=this,u=i._20o[t];u&&(_k(u.div),delete i._20o[t],i._21o.remove(t),i.iv())},clear:function(){var q=this;q._20o={},q._21o.clear(),q.iv()},isExpanded:function(c){return this._10o===c},expand:function(C){var A=this;A._20o[C]&&A._10o!==C&&(A._10o=C,A.onExpanded(C),A.iv())},onExpanded:function(){},collapse:function(){var K=this;K._10o&&(K.onCollapsed(K._10o),delete K._10o,K.iv())},onCollapsed:function(){},initCanvas:function(i,x,s){Yc(i,x,s);var H=Xh(i);return Co(H,0,0,1),H.clearRect(0,0,x,s),H},drawTitle:function(C,D,_,H,c){var g=this,S=Tm(c.icon),M=g.isExpanded(D),X=g._titleHeight,F=g._titleBackground,i=g._selectWidth,v=g._separatorColor,W=Tm(M?g._expandIcon:g._collapseIcon),q=i+4;le(C,0,0,_,H,F),M&&i&&le(C,0,0,i,H,g._selectBackground),(M||g._21o.get(g._21o.size()-1)!==D)&&le(C,0,H-1,_,1,v?v:Wr(F)),S&&(Pq(C,S,q+rl(S)/2,X/2),q+=rl(S)+2),Sn(C,D,g.getLabelFont(D),g.getLabelColor(D),q,0,0,X),W&&Pq(C,W,_-rl(W)/2-4,X/2)},validateImpl:function(){var s=this,i=s._view,r=0,v=0,g=s.getWidth(),E=s.getHeight(),W=s._titleHeight,H=s._21o.size()*W,h=s._11o,l=s._9o;
delete s._11o,delete s._9o,s._21o.each(function(w){var t,o,T=s._20o[w],I=T.content,p=s._10o===w;ld(s)?(Eb(T.div,r,0,W,E),t=s.initCanvas(T.canvas,W,E),Up(t,0,E),nd(t,-u),s.drawTitle(t,w,E,W,T),t.restore(),p?(o=Q(0,g-H),I&&(s._11o=I,s._9o=Gn(I),Eb(I,r+W,0,o,E)),r+=W+o):r+=W):(Eb(T.div,0,v,g,W),t=s.initCanvas(T.canvas,g,W),s.drawTitle(t,w,g,W,T),t.restore(),p?(o=Q(0,E-H),I&&(s._11o=I,s._9o=Gn(I),Eb(I,0,v+W,g,o)),v+=W+o):v+=W)});var L=s._9o;h&&h!==s._11o&&h.endEditing&&h.endEditing(),L&&L!==l&&rj(i,L),l&&l!==L&&_k(l)}}),Tp.SplitView=function(h,M,r,E){var z=this,C=z._dividerDiv=yb(),V=z._60O=Ne(),G=z._61O=Ne(),S=V.style,B=G.style;z._view=Yf(1,z),rj(z._view,C),S.msTouchAction=fl,S.pointerEvents=fl,S.cursor=Kn,B.msTouchAction=fl,B.pointerEvents=fl,B.cursor=Kn,h&&z.setLeftView(h),M&&z.setRightView(M),r&&z.setOrientation(r),E!=p&&z.setPosition(E),z.setStatus(of),new No(z)},jr("SplitView",h,{ms_v:1,ms_fire:1,ms_ac:["continuousLayout","dividerSize","dividerBackground","toggleIcon","togglable","dragOpacity","orientation","draggable","status"],_continuousLayout:!1,_position:.5,_togglable:!0,_orientation:"h",_draggable:!0,_dividerSize:U.splitViewDividerSize,_dividerBackground:U.splitViewDividerBackground,_dragOpacity:U.splitViewDragOpacity,_toggleIcon:U.splitViewToggleIcon,onPropertyChanged:function(){this.iv()},getDividerDiv:function(){return this._dividerDiv},getPosition:function(){return this._position},setPosition:function(e,r){var z=this,g=z._position;isNaN(e)||(r||(z._82O=0>e?-1:e>1?1:0),z._position=e,z.fp(tk,g,e))},getLeftView:function(){return this._leftView},setLeftView:function(j){var m=this,A=m._leftView,b=m._view;if(m._leftView!==j){if(A&&A!==m._rightView){var i=Gn(A);i.parentNode===b&&_k(i)}if(m._leftView=j,j){var V=Gn(j);V.parentNode!==b&&b.insertBefore(V,m._dividerDiv)}m.fp("leftView",A,j)}},getRightView:function(){return this._rightView},setRightView:function(B){var p=this,u=p._rightView,h=p._view;if(p._rightView!==B){if(u&&u!==p._leftView){var X=Gn(u);X.parentNode===h&&_k(X)}if(p._rightView=B,B){var E=Gn(B);E.parentNode!==h&&h.insertBefore(E,p._dividerDiv)}p.fp("rightView",u,B)}},validateImpl:function(){var G=this,a=G._draggable,D=G._position,y=G.getWidth(),T=G.getHeight(),Z=G._dividerSize,X=G._dividerBackground,i=_?18:8,h=G._dividerDiv,C=G._82O,t=G._60O,P=G._61O,v=G._toggleIcon,z=G._status,N=h.style,R=null,e=_?20:4,g=v.comps[0];Z>=i||0===Z?G._coverDiv&&(_k(G._coverDiv),delete G._coverDiv):G._coverDiv||(G._coverDiv=yb(),I&&(G._coverDiv.style.background=Lk),rj(h,G._coverDiv)),G._togglable?t.parentNode||(rj(h,t),rj(h,P)):(_k(t),_k(P));var E=G._coverDiv,m=G._leftView,J=G._rightView;if(ld(G)){if(Z>y&&(Z=y),z===of)if(1===C)var r=j(D,y),U=Q(0,y-Z-r);else-1===C?(U=j(-D,y),r=Q(0,y-Z-U)):(r=o((y-Z)*D),U=Q(0,y-Z-r));else"cl"===z?(r=0,U=Q(0,y-Z)):"cr"===z&&(U=0,r=Q(0,y-Z));m&&Eb(m,0,0,r,T),J&&Eb(J,r+Z,0,U,T),Eb(h,r,0,Z,T),G._22o=r,E&&(Eb(E,Z/2-i/2,0,i,T),E.style.cursor=a?Ie:""),h.style.cursor=a?Ie:"";var H=h.clientHeight/2,f=h.clientWidth;Yc(t,f,f),Eb(t,0,H-f-e,f,f),R=Xh(t),Co(R,0,0,1),g.rotation=-u,yf(R,v,0,0,f,f),R.restore(),Yc(P,f,f),Eb(P,0,H+e,f,f),R=Xh(P),Co(R,0,0,1),g.rotation=u,yf(R,v,0,0,f,f),R.restore()}else{if(Z>T&&(Z=T),z===of)if(1===C)var O=j(D,T),S=Q(0,T-Z-O);else-1===C?(S=j(-D,T),O=Q(0,T-Z-S)):(O=o((T-Z)*D),S=Q(0,T-Z-O));else"cl"===z?(O=0,S=Q(0,T-Z)):"cr"===z&&(S=0,O=Q(0,T-Z));m&&Eb(m,0,0,y,O),J&&Eb(J,0,O+Z,y,S),Eb(h,0,O,y,Z),G._22o=O,E&&(Eb(E,0,Z/2-i/2,y,i),E.style.cursor=a?dg:""),N.cursor=a?dg:"";var W=h.clientWidth/2,f=h.clientHeight;Yc(t,f,f),Eb(t,W-f-e,0,f,f),R=Xh(t),Co(R,0,0,1),g.rotation=0,yf(R,v,0,0,f,f),R.restore(),Yc(P,f,f),Eb(P,W+e,0,f,f),R=Xh(P),Co(R,0,0,1),g.rotation=V,yf(R,v,0,0,f,f),R.restore()}N.background=X}});var No=function(W){this.sv=W,this.addListeners()};bd(No,h,{ms_listener:1,getView:function(){return this.sv.getView()},handle_touchstart:function(u){var R=this,F=R.sv,z=F._dividerDiv,m=F._60O,D=F._61O,I=F._status,N=u.target;if(N===m)I===of?F.setStatus("cl"):"cr"===I&&F.setStatus(of);else if(N===D)I===of?F.setStatus("cr"):"cl"===I&&F.setStatus(of);else if(Ae(u)&&(N===z||N===F._coverDiv)&&(gj(u),F.isDraggable())){F.getLeftView(),F.getRightView();var f=R.maskDiv=yb();if(f.style.left=0,f.style.top=0,f.style.width=F.getWidth()+"px",f.style.height=F.getHeight()+"px",F.getView().appendChild(f),!F.isContinuousLayout()){var k=R.resizeDiv=yb();k.style.left=z.style.left,k.style.top=z.style.top,k.style.width=z.style.width,k.style.height=z.style.height,k.style.opacity=F.getDragOpacity(),k.style.background=F.getDividerBackground(),rj(R.getView(),k)}R._lastAbsPosition=F._22o,R._86o=ld(F)?kq(u).x:kq(u).y,Kc(R,u)}},handleWindowTouchMove:function(u){Ae(u)&&this.update(u,this.sv.isContinuousLayout())},handleWindowTouchEnd:function(S){var y=this;y.update(S,!0),y.sv.setStatus(of),y.maskDiv&&_k(y.maskDiv),y.resizeDiv&&_k(y.resizeDiv),y.maskDiv=y.resizeDiv=p},handle_mousedown:function(P){xm(P)&&this.handle_touchstart(P)},handleWindowMouseMove:function(C){this.handleWindowTouchMove(C)},handleWindowMouseUp:function(w){this.handleWindowTouchEnd(w)},update:function(E,u){var l=this,N=l.sv,f=ld(N)?N.getWidth():N.getHeight(),C=N._dividerSize,c=l._lastAbsPosition-l._86o;ld(N)?(c+=kq(E).x,c>f-C&&(c=f-C),0>c&&(c=0),l.resizeDiv&&(l.resizeDiv.style.left=c+Vj)):(c+=kq(E).y,c>f-C&&(c=f-C),0>c&&(c=0),l.resizeDiv&&(l.resizeDiv.style.top=c+Vj)),u&&f!==C&&(1===N._82O?N.setPosition(c,1):-1===N._82O?N.setPosition(c-f+C,1):N.setPosition(c/(f-C),1))}}),Tp.TabView=function(){var L=this,j=L._view=Yf(1,L),e=L._91O=yb(1),$=L._tabModel=new ke,c=$.sm(),Y=L.invalidate;L._7o=new uh,L._canvas=Ne(e),rj(j,e),rj(j,L._92O=yb(1)),c.setSelectionMode(Mr),c.ms(Y,L),$.mm(Y,L),$.md(Y,L),$.mh(Y,L),new Bo(L),L.iv()},jr("TabView",h,{ms_v:1,ms_fire:1,ms_tx:1,ms_ty:1,ms_lp:1,ms_ac:["movable","tabGap","tabHeight","tabPosition",Sl,$q,"tabBackground","selectWidth",ri,"moveBackground","insertColor"],_tabPosition:ko,_tabHeight:Ze,_tabGap:U.tabViewTabGap,_labelColor:U.tabViewLabelColor,_labelFont:U.tabViewLabelFont,_tabBackground:U.tabViewTabBackground,_selectWidth:U.tabViewSelectWidth,_selectBackground:U.tabViewSelectBackground,_moveBackground:U.tabViewMoveBackground,_insertColor:U.tabViewInsertColor,_movable:!0,getContentDiv:function(){return this._92O},getTitleDiv:function(){return this._91O},getTabModel:function(){return this._tabModel},add:function(C,W,s){var E=new $h,H=this._tabModel;return E.setName(C),E.setView(W),H.add(E),s&&H.sm().ss(E),E},getLabel:function(y){return y.toLabel()},onPropertyChanged:function(){this.iv()},_7Q:function(W){this._23o=W,this.iv()},get:function(k){var N=this,Y=N._tabModel;if(Tq(k))return Y._roots.get(k);if(Op(k)){var d;return Y.each(function(h){k===N.getLabel(h)&&(d=h)}),d}return k instanceof $h?k:p},select:function(M){this._tabModel.sm().ss(this.get(M))},remove:function(x){var X=this;if(x=X.get(x)){var F=X._tabModel,n=F._roots.indexOf(x);X._tabModel.remove(x),X._12Q(--n)}},getCurrentTab:function(){return this._8o},hideTabView:function(j,C){C.parentNode===this._92O&&(Bg(C)?(C.style.display=nl,C._tab_=j):_k(C),mk())},showTabView:function(Z,I){Bg(I)&&(I.style.display="block",I._tab_=Z),I.parentNode!==this._92O&&(rj(this._92O,I),mk())},_24o:function(){var t,a=this,w=a._8o,S=a._9o,P=a._tabModel.sm().ld();P&&(t=Gn(P.getView())),t!==S&&(S&&(w.getView()&&w.getView().endEditing&&w.getView().endEditing(),a.hideTabView(w,S)),t&&a.showTabView(P,t)),a._8o=P,a._9o=t,w!==P&&a.onTabChanged(w,P)},onTabClosing:function(){return!0},onTabChanged:function(){},onTabClosed:function(n,d){this._12Q(--d)},_12Q:function(Z){var m=this,k=m._tabModel,h=k.size();if(h&&!k.sm().ld()){Z==p&&(Z=0),Z>=h&&(Z=h-1),0>Z&&(Z=0);for(var e=Z;e>=0;e--){var l=m.get(e);if(!l.isDisabled())return m.select(l),l}for(e=Z+1;h>e;e++)if(l=m.get(e),!l.isDisabled())return m.select(l),l}},getTabWidth:function(R){var W=4,x=Tm(R.getIcon());x&&(W+=rl(x,R)+4);var u=this.getLabel(R);return u&&(W+=sk(this.getLabelFont(R),u).width+4),R.isClosable()&&(W+=10),W},drawTab:function(f,B,w,H,o,d,F){var A,M=this,v=M._tabPosition,P=w+4,K=M._selectWidth,i=Tm(B.getIcon()),_=B.isDisabled(),h=M.getLabelColor(B),D=M.getLabelFont(B),t=M.getLabel(B),k=M._selectBackground,T=v===Aj+"-vertical",U=v===ig+"-vertical";(T||U)&&(P=H+4),_&&(f.globalAlpha=cn),le(f,w,H,o,d,F),B===M._8o&&K&&(v===ko?le(f,w,H+d-K,o,K,k):v===Aj?le(f,w+o-K,H,K,d,k):v===ig?le(f,w,H,K,d,k):T?le(f,w+o-K,H,K,d,k):U?le(f,w,H,K,d,k):le(f,w,H,o,K,k));var R=o/2;if(T&&(Up(f,R,H+d/2),nd(f,V),Up(f,-R,-H-d/2)),i){var E=ws(i,B),g=rl(i,B);if(T||U){var c=w+o/2,Y=P+E/2;Up(f,c,Y),nd(f,u),Up(f,-c,-Y),Pq(f,i,w+o/2,P+E/2,B,M),Up(f,c,Y),nd(f,-u),Up(f,-c,-Y),P+=E+4}else Pq(f,i,P+g/2,H+d/2,B,M),P+=g+4}return T||U?(Up(f,o/2,P+o/2),nd(f,u),Up(f,-o/2,-P-o/2),Sn(f,t,D,h,w,P,d,o),Up(f,o/2,P+o/2),nd(f,-u),Up(f,-o/2,-P-o/2)):Sn(f,t,D,h,P,H,o,d),T&&(Up(f,R,H+d/2),nd(f,-V),Up(f,-R,-H-d/2)),B.isClosable()&&(A=U?{x:w+o-12,y:H+d-12,width:12,height:12}:{x:w+o-12,y:H+2,width:12,height:12},this.drawCloseIcon(B,f,h,A)),_&&(f.globalAlpha=1),A},drawCloseIcon:function(h,Q,T,w){var v=w.x,r=w.y;Q.strokeStyle=T,Q.lineWidth=1,Q.beginPath(),Q.moveTo(v+2,r+8),Q.lineTo(v+8,r+2),Q.moveTo(v+8,r+8),Q.lineTo(v+2,r+2),Q.stroke()},validateImpl:function(){var y=this;y._24o();var j,e=y._canvas,X=y._tabPosition,t=y._91O,I=y._92O,u=y._tabModel,Y=y.getWidth(),$=y.getHeight(),K=y._tabHeight,d=y._7o,o=y._tabGap,Z=X===ko,R=X===Aj,B=X===ig,U=X===Aj+"-vertical",_=X===ig+"-vertical",r=y._23o,V=0;if((R||B)&&u._roots.each(function(r){V=Q(y.getTabWidth(r),V)}),Z?(Eb(t,0,0,Y,K),j={x:0,y:K,width:Y,height:Q(0,$-K)}):R?(Eb(t,0,0,V,$),j={x:V,y:0,width:Q(0,Y-V),height:$}):B?(Eb(t,Y-V,0,V,$),j={x:0,y:0,width:Q(0,Y-V),height:$}):U?(Eb(t,0,0,K,$),j={x:K,y:0,width:Q(0,Y-K),height:$}):_?(Eb(t,Y-K,0,K,$),j={x:0,y:0,width:Q(0,Y-K),height:$}):(Eb(t,0,$-K,Y,K),j={x:0,y:0,width:Y,height:Q(0,$-K)}),Eb(I,j),U||_){y._9o&&(j.x=0,Eb(y._8o.getView(),j)),Yc(e,K,$);var C=Xh(e),x=0;if(Co(C,0,y.ty(),1),C.clearRect(0,0,K,$),d.clear(),u._roots.each(function(Y){var B,X=y.getTabWidth(Y);r&&r.tab===Y||(B=y.drawTab(C,Y,0,x,K,X,y._tabBackground)),d.add({_75o:B,tab:Y,startY:x,endY:x+X,height:X}),x+=X+o}),y._23Q=Q(0,x-o),r){var E=r.position;y.drawTab(C,r.tab,0,r.startY,K,r.height,y._moveBackground),le(C,0,E,K,1,y._insertColor)}C.restore(),y.ty(y.ty())}else if(R||B){y._9o&&(j.x=0,Eb(y._8o.getView(),j)),Yc(e,V,$);var C=Xh(e),x=0;if(Co(C,0,y.ty(),1),C.clearRect(0,0,V,$),d.clear(),u._roots.each(function($){var P;r&&r.tab===$||(P=y.drawTab(C,$,0,x,V,K,y._tabBackground)),d.add({_75o:P,tab:$,startY:x,endY:x+K,height:K}),x+=K+o}),y._23Q=Q(0,x-o),r){var E=r.position;y.drawTab(C,r.tab,0,r.startY,V,r.height,y._moveBackground),le(C,0,E,V,1,y._insertColor)}C.restore(),y.ty(y.ty())}else{y._9o&&(j.y=0,Eb(y._8o.getView(),j)),Yc(e,Y,K);var C=Xh(e),H=0;if(Co(C,y.tx(),0,1),C.clearRect(0,0,Y,K),d.clear(),u._roots.each(function(V){var p,W=y.getTabWidth(V);r&&r.tab===V||(p=y.drawTab(C,V,H,0,W,K,y._tabBackground)),d.add({_75o:p,tab:V,startX:H,endX:H+W,width:W}),H+=W+o}),y._64I=Q(0,H-o),r){var E=r.position;y.drawTab(C,r.tab,r.startX,0,r.width,K,y._moveBackground),ve(C,y._insertColor,E,0,K)}C.restore(),y.tx(y.tx())}for(var N=[],n=I.children,g=0;g<n.length;g++){var f=n[g],a=f._tab_;a&&!u.contains(a)&&N.push(f)}N.forEach(function(l){I.removeChild(l)})}});var Bo=function(p){this.tv=p,this.addListeners()};bd(Bo,h,{ms_listener:1,getView:function(){return this.tv._91O},handle_mousewheel:function(N){this.handleScroll(N,10*(N.wheelDelta/40))},handle_DOMMouseScroll:function(Z){this.handleScroll(Z,10*-Z.detail)},handleScroll:function(W,O){gj(W);var P=this.tv,B=P._tabPosition;!P._40o()||B!==ko&&B!==eg||P.tx(this.tv.tx()+O),!P._41o()||B!==Aj&&B!==ig&&B!==Aj+"-vertical"&&B!==ig+"-vertical"||P.ty(this.tv.ty()+O)},_8Q:function(u){var L,I,$=this.tv,P=$._tabPosition,E=$._7o;if(P===ko||P===eg){var o=$.lp(u).x;for(L=0;L<E.size();L++)if(I=E.get(L),I.startX<=o&&o<=I.endX)return I}else if(P===Aj||P===ig||P===Aj+"-vertical"||P===ig+"-vertical"){var V=$.lp(u).y;for(L=0;L<E.size();L++)if(I=E.get(L),I.startY<=V&&V<=I.endY)return I}return p},isClickable:function(r){var H=this.tv,Q=H._tabPosition,T=this._73o=this._8Q(r);return!H._40o()||Q!==ko&&Q!==eg?!H._41o()||Q!==Aj&&Q!==ig&&Q!==Aj+"-vertical"&&Q!==ig+"-vertical"?T&&(!T.tab.isDisabled()||H.isMovable()):!0:!0},handle_mousemove:function(X){var o=this;cj?o._74o=o._8Q(X):o.getView().style.cursor=o.isClickable(X)?Kn:""},handle_mousedown:function(w){this.handle_mousemove(w),this.handle_touchstart(w)},handle_touchstart:function(H){var Y=this,F=Y.tv,t=F._tabPosition;gj(H),xm(H)&&Y.isClickable(H)&&(t===ko||t===eg?(Y.x=kq(H).x,Y.lp=F.lp(H),Y.tx=F.tx()):(Y.y=kq(H).y,Y.lp=F.lp(H),Y.ty=F.ty()),Kc(Y,H))},handleWindowMouseMove:function(s){this.handleWindowTouchMove(s)},handleWindowTouchMove:function(C){var m,q=this,L=q.tv,f=L._tabPosition,S=q._73o;if(f===ko||f===eg){if(m=kq(C).x-q.x,!q._25o&&!q.moving&&B(m)>2&&(L._40o()&&!ok(C)?q._25o=1:S&&L.isMovable()&&(q.moving=1)),q._25o)L.tx(q.tx+m);else if(q.moving){var t=q.lp.x+m,e=L._tabGap/2;L._7o.each(function(n){var K=n.endX,d=t-n.startX<K-t;t>=n.startX&&K>=t&&L._7Q({tab:S.tab,startX:S.startX+m,width:S.width,front:d,insertTab:n.tab,position:d?Q(0,n.startX-e):j(L._64I,K+e)})})}}else if(m=kq(C).y-q.y,!q._25o&&!q.moving&&B(m)>2&&(L._41o()&&!ok(C)?q._25o=1:S&&L.isMovable()&&(q.moving=1)),q._25o)L.ty(q.ty+m);else if(q.moving){var z=q.lp.y+m,e=L._tabGap/2;L._7o.each(function(u){var I=u.endY,Z=z-u.startY<I-z;z>=u.startY&&I>=z&&L._7Q({tab:S.tab,startY:S.startY+m,height:S.height,front:Z,insertTab:u.tab,position:Z?Q(0,u.startY-e):j(L._23Q,I+e)})})}},handleWindowMouseUp:function(x){this.handleWindowTouchEnd(x)},handleWindowTouchEnd:function(){var G=this,k=G.tv,i=k._tabPosition,I=k.getTabModel(),h=I._roots,U=G._73o;if(G.moving){var K=k._23o;if(K&&K.insertTab!==K.tab){var A=K.tab,l=h.remove(A),W=h.indexOf(K.insertTab);W>=0&&(K.front||W++,W<=h.size()&&(h.add(A,W),I._38I(A,l,W)))}k._7Q(p),delete G.moving}else if(!G._25o&&U){A=U.tab;var b=G._74o;if(!b||b.tab===A)if(!A.isDisabled()&&$f(U._75o,G.lp)){var Q=function(){var n=h.indexOf(A);I.remove(A),k.onTabClosed(A,n)};k.onTabClosing(A,Q)&&Q()}else A.isDisabled()||k._8o===A||I.sm().ss(A)}G._25o=G._73o=G._74o=i===ko||i===eg?G.x=G.lp=G.tx=p:G.y=G.lp=G.ty=p}}),Tp.PropertyView=function(T){var c=this;c._view=Yf(1,c),c._canvas=Ne(c._view),rj(c._view,c._79O=yb()),c._rows=new uh,c._28o=new uh,c._26o={},c._26Q={};var k=c._propertyModel=new ke,b=c.ivm;k.mm(b,c),k.md(b,c),k.mh(b,c),c.dm(T?T:new ke),new Xo(c)},jr("PropertyView",h,{ms_ac:[Sl,Tc,$q,vp,Eo,"categorizable",qe,Cc,lr,_l,Nn,Dg,Se,Zd,"selectRowIndex",ri,"background",Fj,Vl,Df,Zj,Bs],ms_v:1,ms_dm:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,_45o:1,_47o:1,ms_tip:1,_29I:Am,_59I:0,_9I:0,_selectRowIndex:-1,_editable:!0,_batchEditable:!0,_categorizable:!0,_indent:_f,_background:U.propertyViewBackground,_expandIcon:U.propertyViewExpandIcon,_collapseIcon:U.propertyViewCollapseIcon,_scrollBarColor:Hb,_scrollBarSize:Db,_autoHideScrollBar:Eg,_selectBackground:U.propertyViewSelectBackground,_rowHeight:El,_rowLineVisible:U.propertyViewRowLineVisible,_rowLineColor:U.propertyViewRowLineColor,_10I:.5,_columnLineVisible:U.propertyViewColumnLineVisible,_columnLineColor:U.propertyViewColumnLineColor,_labelColor:U.propertyViewLabelColor,_labelSelectColor:U.propertyViewLabelSelectColor,_labelFont:U.propertyViewLabelFont,getRows:function(){return this._rows},getColumnPosition:function(){return this._10I},setColumnPosition:function(k){0>k&&(k=0),k>1&&(k=1);var X=this,j=X._10I;X._10I=k,X.fp("columnPosition",j,k)},getPropertyName:function($){return $.toLabel()},getLabelFont:function(){return this._labelFont},getLabelColor:function(O,D,s){return s===this._selectRowIndex?this._labelSelectColor:this._labelColor},getPropertyFont:function(){return this._labelFont},getPropertyColor:function(R,H){return H===this._selectRowIndex?this._labelSelectColor:R.getColor()||this._labelColor},getCategoryFont:function(){return this._labelFont},getCategoryColor:function(){return this._labelColor},adjustTranslateX:function(){return 0},adjustTranslateY:function(w){var E=this.getHeight()-this._59I;return E>w&&(w=E),w>0?0:o(w)},isExpanded:function(f){if(!f)return!0;var j=this._26o[f];return j?j.isExpanded:!(this._26Q[f]===!1)},toggle:function(g){var X=this;X.isExpanded(g)?X.collapse(g):X.expand(g)},expandAll:function(){this.validate();for(var b in this._26o)this.expand(b)},expand:function(B){if(B&&B!==nl){var Z=this,A=Z._26o[B];A&&!A.isExpanded&&(A.isExpanded=!0,Z.onExpanded(B),Z.ivm())}},onExpanded:function(){},collapseAll:function(){this.validate();for(var J in this._26o)this.collapse(J)},collapse:function(q){if(q&&q!==nl){var Z=this,Q=Z._26o[q];Q&&Q.isExpanded&&(Q.isExpanded=!1,Z.onCollapsed(q),Z.ivm())}},onCollapsed:function(){},getCategoryName:function(G){if(!this.isCategorizable())return nl;var q=G.getCategoryName();return q?q:nl},getPropertyModel:function(){return this._propertyModel},handleSelectionChange:function(){this.ivm()},setDataModel:function(i){var I=this,U=I._dataModel;U!==i&&(U&&(U.umd(I.handlePropertyChange,I),I._selectionModel||U.sm().ums(I.handleSelectionChange,I)),I._dataModel=i,i.md(I.handlePropertyChange,I),I._selectionModel?I._selectionModel._21I(i):i.sm().ms(I.handleSelectionChange,I),I.fp(Il,U,i))},isVisible:function(P){return this._visibleFunc?this._visibleFunc(P):!0},onPropertyChanged:function(F){var V=this,m=F.property;Jp[m]?V.ivm():V.iv(),m===Cn&&V._43o()},getCurrentData:function(){return this._27o},updateCurrentData:function(){this._27o=this.sm().ld()},getRawProperties:function(){return this._27o?this._propertyModel._roots:Jg},handlePropertyChange:function(U){this._27o===U.data&&this.iv()},ivm:function(){this.invalidateModel()},invalidateModel:function(){var L=this;L._96I||(L.setSelectRowIndex(-1),L._96I=1,L.iv())},redraw:function(){this.iv()},validateModel:function(){var F=this,J=F._rows,e=F._28o,f={},p=new uh,Z=F._27o;F.updateCurrentData(),Z!==F._27o&&F.endEditing(),J.clear(),e.clear(),F.getRawProperties().each(function(g){if(F.isVisible(g)){p.add(g);var G=F.getCategoryName(g);f[G]||(e.add(G,G===nl?0:R),f[G]={isExpanded:F.isExpanded(G),properties:new uh})}}),F._sortFunc&&p.sort(F._sortFunc);for(var j in F._26o)F._26Q[j]=F.isExpanded(j);F._26o=f,e.each(function(N){N!==nl&&J.add(N);var U=f[N];U.isExpanded&&p.each(function(v){F.getCategoryName(v)===N&&(U.properties.add(v),J.add({property:v,data:F._27o}))},F)})},validateImpl:function(){var o=this;o._76o(),o._96I&&(o.validateModel(),delete o._96I);var h=o._canvas,i=o.getWidth(),$=o.getHeight(),O=-o.ty(),e=o._rowHeight,l=o._indent,k=i-l,n=o._rows,z=n.size(),W=o._9I=l+k*o._10I,w=o._59I=z*e;Yc(h,i,$),o._29I={x:0,y:O,width:i,height:$},o._31I=Z(O/e),o._14I=E((O+$)/e),o._31I<0&&(o._31I=0),o._14I>z&&(o._14I=z);var H,P=Xh(h),r=o._background;Co(P,0,-O,1),P.beginPath(),P.rect(0,O,i,$),P.clip(),P.clearRect(0,O,i,$),o._93db(P),r&&le(P,0,0,l,w,r);for(var B=o._31I;B<o._14I;B++){var g=n.get(B),O=e*B;if(Op(g))r&&le(P,l,O,k,e,r),H=Tm(o.isExpanded(g)?o._expandIcon:o._collapseIcon),H&&Xl(P,H,As,0,O,l,e),P.save(),P.beginPath(),P.rect(l,O,k,e),P.clip(),o.drawCategoryName(P,g,B,l,O,k,e),P.restore();else{var m=g.property,C=g.data,H=Tm(m.getIcon()),D=o._selectRowIndex===B?o.getSelectBackground():p;if(H&&Xl(P,H,As,0,O,l,e),D&&le(P,l,O,k,e,D),P.save(),P.beginPath(),P.rect(l,O,W-l,e),P.clip(),o.drawPropertyName(P,m,B,l,O,W-l,e),P.restore(),!o.isEditing(C,m)){var M=W+1,J=i-W-1;P.save(),P.beginPath(),P.rect(M,O,J,e),P.clip(),o._87o(o.drawPropertyValue(P,m,o.getValue(C,m),B,M,O,J,e,C),B,M,O,J,e),P.restore()}}o._rowLineVisible&&le(P,l,O+e-1,k,1,o._rowLineColor)}o._columnLineVisible&&(le(P,W,0,1,w,o._columnLineColor),le(P,i-1,0,1,w)),o._92db(P),o._93I(),P.restore(),o.ty(o.ty())},drawCategoryName:function(p,X,m,c,J,s,O){Sn(p,X,this.getCategoryFont(X),this.getCategoryColor(X),c,J,s,O)},drawPropertyName:function(f,c,w,n,J,j,$){return c.drawPropertyName?(c.drawPropertyName(f,c,w,n,J,j,$,this),void 0):(Sn(f,this.getPropertyName(c),this.getPropertyFont(c,w),this.getPropertyColor(c,w),n,J,j,$),void 0)},drawPropertyValue:function(U,e,f,n,m,h,F,K,M){return e.drawPropertyValue?e.drawPropertyValue(U,e,f,n,m,h,F,K,M,this):(Uo(U,f,e,this.getLabelFont(e,f,n),this.getLabelColor(e,f,n),m,h,F,K,M,this),void 0)},isPropertyEditable:function(t){return t.isEditable()&&this.isEditable()},setProperties:function(p){this._propertyModel.clear(),this.addProperties(p)},addProperties:function(K){if(K){var s=this._propertyModel;K.forEach(function(p){if(!(p instanceof bc)){var C=og(p.className);p=Wg(C?C:bc,p)}s.add(p)})}},getRowIndexAt:function(c){var B=this,H=Z(B.lp(c).y/B._rowHeight);return H>=0&&H<B._rows.size()?H:-1},getPropertyAt:function(D){var O=this,c=O.getRowIndexAt(D);return c>=0?O._rows.get(c).property:p},getToolTip:function(N){var j=this,B=j.getPropertyAt(N),e=j._27o;return B&&e?B.getToolTip(e,j._9I<j.lp(N).x,j):p}});var Xo=function(K){this.pv=K,this.addListeners()};bd(Xo,h,{ms_listener:1,getView:function(){return this.pv._view},setCursor:function(g){this.getView().style.cursor=g},clear:function(){var G=this;G._62O=G.cp=G.ty=G.p=p,G.setCursor(Wb)},handle_mousedown:function(f){this.handle_touchstart(f)},handle_touchstart:function(J){var U=this,L=U.pv;gj(J),L.setFocus(J)&&(xm(J)?(U.cp=kq(J),U.ty=L.ty(),U.p=L.getColumnPosition(),U.handle_touchmove(J)):L.setSelectRowIndex(L.getRowIndexAt(J)))},handleWindowMouseUp:function(){this.clear()},handleWindowTouchEnd:function(){this.clear()},handle_mouseup:function(G){this.handle_touchend(G)},handle_touchend:function(B){var v=this;if(v.cp&&!v._62O){var Y=v.pv,n=Y.lp(B),g=n.x,P=n.y,l=Y._indent,m=Y.getRowIndexAt(B),U=Y._9I;if(m>=0){var s=Y._rowHeight,Q=s*m,C=Y._rows.get(m),V=C.property;if(Op(C))Tm(Y.isExpanded(C)?Y._expandIcon:Y._collapseIcon)&&g>=0&&l>=g&&P>=Q&&Q+s>=P?Y.toggle(C):dl(B)&&Y.toggle(C);else if(g>U&&Y.isPropertyEditable(V,B)){var W={x:U+1,y:Q,width:Y.getWidth()-U-1,height:s},E={x:W.x+Y.tx(),y:W.y+Y.ty(),width:W.width,height:W.height},S=0,R=Y._29I;W.y<R.y?S=W.y-R.y:W.y+s>R.y+R.height&&(S=W.y+s-R.y-R.height),S&&(Y.ty(Y.ty()-S),E.y-=S),Y.beginEditing({data:C.data,property:V,value:Y.getValue(C.data,V),event:B,rect:W,editorRect:E,view:Y})}}Y.setSelectRowIndex(m)}v.clear()},handleWindowMouseMove:function(i){this.handleWindowTouchMove(i)},handleWindowTouchMove:function(G){var P=this,X=P.pv,I=P.ty,Y=P.cp,Z=kq(G),S=P._62O;if("p"===S)X.setTranslateY(I+Z.y-Y.y);else if("c"===S){var N=X.getWidth()-X._indent;if(N>16){var z=P.p-(Y.x-Z.x)/N,W=16/N;W>z&&(z=W),z>1-W&&(z=1-W),X.setColumnPosition(z)}}else"s"===S&&X.setTranslateY(I+(Y.y-Z.y)*X._59I/X._29I.height)},handle_mousemove:function(I){this.handle_touchmove(I)},handle_touchmove:function(y){if(!cj&&xm(y)){var k=this,u=k.pv,n=B(u.lp(y).x-u._9I)<=(_?8:3);k.cp?k._62O||(n?(k._62O="c",Kc(k)):B(kq(y).y-k.cp.y)>=2&&(k._62O=k.isV(y)?"s":"p",Kc(k))):(n?k.setCursor(Ie):k.setCursor(Wb),k.isV(y)&&u._43o())}},isV:function(d){var k=this.pv,c=k._29I;return k._41o()&&c.x+c.width-k.lp(d).x<zr},handle_mousewheel:function(Q){this.handleScroll(Q,Q.wheelDelta/40)},handle_DOMMouseScroll:function(s){2===s.axis&&this.handleScroll(s,-s.detail)},handleScroll:function(z,W){var D=this.pv;gj(z),D.endEditing(),D.translate(0,W*D.getRowHeight())},handle_keydown:function(p){var v=this.pv,J=v._rows.size(),B=v._selectRowIndex+(Xk(p)?-1:1);(Xk(p)||gd(p))&&(0>B&&(B=0),B>=J&&(B=J-1),v.setSelectRowIndex(B))}}),Tp.ListView=function(U){this._5o(U),new vm(this)},jr("ListView",h,{ms_ac:[Sl,Tc,$q,Fj,qe,Vl,Df,Cc,lr,Dg,Se,Zd,Jf,ri],ms_v:1,ms_bnb:1,ms_tip:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,_14Q:1,ms_dm:1,_45o:1,_checkMode:!1,_indent:_f,_rowHeight:El,_rowLineVisible:U.listViewRowLineVisible,_rowLineColor:U.listViewRowLineColor,_scrollBarColor:Hb,_scrollBarSize:Db,_autoMakeVisible:tl,_autoHideScrollBar:Eg,_selectBackground:U.listViewSelectBackground,_labelColor:U.listViewLabelColor,_labelSelectColor:U.listViewLabelSelectColor,_labelFont:U.listViewLabelFont,isCheckMode:function(){return this._checkMode},setCheckMode:function(L){var s=this,p=s._checkMode;s._checkMode=L,s.fp(Pk,p,L)},drawRow:function(f,h,b,V,Z,U,d){var e=this,X=0,G=e._indent,E=e.getIconWidth(h);e.drawRowBackground(f,h,b,V,Z,U,d),e._checkMode&&(Pq(f,Tm(e.getCheckIcon(h)),X+G/2,Z+d/2,h,e),X+=G),e.drawIcon(f,h,X,Z,E,d),e.drawLabel(f,h,X+E,Z,d)}});var vm=function(N){this.list=N,this._lastSelectDataTime=Io(),this.addListeners()};bd(vm,h,{ms_listener:1,getView:function(){return this.list._view},clear:function(Z){var N=this,G=N.list;Z&&"d"===N._62O&&!N.dragCancel&&G.handleDragAndDrop(Z,"end"),G.draggingData&&(G.draggingData=null,G.redraw()),N.dragCancel=N._62O=N._isV=N._isH=N.cp=N.tx=N.ty=p},handle_mousedown:function(H){this.handle_touchstart(H)},handle_touchstart:function(e){var J=this,r=J.list;if(gj(e),r.setFocus(e)){var v=r.getDataAt(e);J.cp=kq(e),J.tx=r.tx(),J.ty=r.ty(),xm(e)?v&&r.handleDragAndDrop&&!J.isV(e)&&!J.isH(e)&&(r.draggingData=v,r.redraw(),r.handleDragAndDrop(e,"prepare")):(v&&J._33o(e,v),J.clear(e))}},handleWindowMouseUp:function(b){this.clear(b)},handleWindowTouchEnd:function(W){this.clear(W)},handle_mouseup:function(B){this.handle_touchend(B)},handle_touchend:function(I){var R=this,w=R.list;if(!R._isV&&!R._isH&&R.cp&&!R._62O){var C=w.getDataAt(I);C?(w.isCheckMode()?R._34o(I,C):R._33o(I,C),dl(I)?w.onDataDoubleClicked(C,I):w.onDataClicked(C,I)):w.handleBackgroundClick(I)}R.clear(I)},handleWindowMouseMove:function(B){this.handleWindowTouchMove(B)},handleWindowTouchMove:function(s){var e=this,T=e.list,j=e._62O,p=e.tx,$=e.ty,u=e.cp,h=kq(s),L=T._29I;"p"===j?T.setTranslate(p+h.x-u.x,$+h.y-u.y):"v"===j?T.ty($+(u.y-h.y)*T._59I/L.height):"h"===j?T.tx(p+(u.x-h.x)*T._91I/L.width):"d"===j&&(e.dragCancel||T.handleDragAndDrop(s,"between"))},handle_mousemove:function(S){this.handle_touchmove(S)},handle_touchmove:function(t){if(!cj&&xm(t)){var o=this,X=o.list;if(o._isV=o.isV(t),o._isH=o.isH(t),o.cp){if(!o._62O){if(ti(kq(t),o.cp)<2)return;o._isV?o._62O="v":o._isH?o._62O="h":X.draggingData&&!this.dragCancel?(o._62O="d",X.handleDragAndDrop(t,"begin")):o._62O="p",o._62O&&"d"!==o._62O&&X.draggingData&&(X.draggingData=null,X.redraw()),Kc(o)}}else o._isV&&X._43o(),o._isH&&X._42o()}},isV:function($){var l=this.list,c=l._29I;return l._41o()&&c.x+c.width-l.lp($).x<zr},isH:function(y){var r=this.list,M=r._29I;return r._40o()&&M.y+M.height-r.lp(y).y<zr},handle_mousewheel:function(s){this.handleScroll(s,s.wheelDelta/40,s.wheelDelta!==s.wheelDeltaX)},handle_DOMMouseScroll:function(c){this.handleScroll(c,-c.detail,1)},handleScroll:function(p,y,B){var h=this.list;gj(p),h.endEditing&&h.endEditing(),B&&h._41o()?h.translate(0,y*h.getRowHeight()):h._40o()&&h.translate(10*y,0)},handle_keydown:function(u){if(!U.isInput(u.target)){var c,g=this.list,T=g.sm(),Z=g._rows,k=Z.size();if(Fm(u))g.selectAll();else if(po(u))g.handleDelete&&g.handleDelete(u);else if(xq(u))"d"!==this._62O||this.dragCancel||(g.handleDragAndDrop(u,"cancel"),this.dragCancel=!0);else if(Le(u))g.isCheckMode()&&(c=g.getFocusData(),c&&g.checkData(c));else if(Xk(u)||gd(u)){var t=g.isCheckMode();if(c=t?g.getFocusData():T.ld()){var f=g.getRowIndex(c);f>=0&&(Xk(u)?0!==f&&(c=Z.get(f-1),t?g.setFocusData(c):T.ss(c)):f!==k-1&&(c=Z.get(f+1),t?g.setFocusData(c):T.ss(c)))}else k>0&&(c=Z.get(0),t?g.setFocusData(c):T.ss(c))}}},_34o:function(f,v){var I=this.list,k=I.lp(f).x;return k>=0&&k<=I._indent?(I.checkData(v),void 0):(I.setFocusData(v),void 0)},_33o:function(i,H){var P=this.list,L=P.sm(),r=L.ld();if(ok(i))P.isSelected(H)?L.rs(H):L.as(H);else if(Ar(i))if(r)for(var s=P.getRowIndex(r),m=P.getRowIndex(H);s!==m;)s+=m>s?1:-1,L.as(P._rows.get(s));else L.ss(H);else if(xm(i)){var G=Io();if(L.contains(H)){var U=G-this._lastSelectDataTime;P.handleDataDoubleSelect&&U>500&&1500>U&&P.handleDataDoubleSelect(i,H)}L.ss(H),this._lastSelectDataTime=G}else L.contains(H)||L.ss(H)}}),Tp.TreeView=function(u){var c=this;c._35o(),c._5o(u),new ts(c)},jr("TreeView",h,{ms_ac:[Sl,Tc,$q,"rootVisible",Pk,"rootData",Cc,lr,Dg,Se,Zd,qe,Fj,Vl,Df,_l,Nn,Jf,ri,"loader","doubleClickToToggle"],ms_v:1,ms_bnb:1,ms_tip:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,ms_dm:1,_48o:1,_14Q:1,_45o:1,_checkMode:p,_indent:_f,_rowHeight:El,_rowLineVisible:U.treeViewRowLineVisible,_rowLineColor:U.treeViewRowLineColor,_scrollBarColor:Hb,_scrollBarSize:Db,_autoHideScrollBar:Eg,_expandIcon:U.treeViewExpandIcon,_collapseIcon:U.treeViewCollapseIcon,_autoMakeVisible:tl,_selectBackground:U.treeViewSelectBackground,_labelColor:U.treeViewLabelColor,_labelSelectColor:U.treeViewLabelSelectColor,_labelFont:U.treeViewLabelFont,_doubleClickToToggle:U.treeViewDoubleClickToToggle,drawRow:function(s,C,J,S,a,v,I){var i=this;i.drawRowBackground(s,C,J,S,a,v,I),i._97I(s,C,J,0,a,v,I)},isOnToggleIcon:function(K){var r=this.getDataAt(K);if(r){var A=this.getIndent(),O=this.lp(K).x;if(Tm(this.getToggleIcon(r))){var E=A*this.getLevel(r);if(O>=E&&E+A>=O)return!0}}return!1}});var ts=function(w){td(ts,this,[w])};bd(ts,vm,{toggle:function(c,y,R,d){var s=this.list,N=s.lp(c).x;if(Tm(s.getToggleIcon(y))){var Q=R*d;if(N>=Q&&Q+R>=N)return s.toggle(y),!0}return s.isDoubleClickToToggle()&&dl(c)?(s.toggle(y),!0):!1},_34o:function(k,x){var $=this.list,d=$.lp(k).x,A=$._levelMap[x._id],P=$._indent,T=P*(A+1);return d>=T&&T+P>=d?($.checkData(x),void 0):(this.toggle(k,x,P,A)||$.setFocusData(x),void 0)},_33o:function(d,Z){var t=this,T=t.list;t.toggle(d,Z,T._indent,T.getLevel(Z))||ts.superClass._33o.call(t,d,Z)},handle_keydown:function(B){if(hb(B)||mq(B)){var k=this.list,o=k._rows,P=k.isCheckMode(),H=k.sm(),F=P?k.getFocusData():H.ld();F?F.hasChildren()&&(hb(B)?k.collapse(F):k.expand(F)):o.size()>0&&(F=o.get(0),P?k.setFocusData(F):H.ss(F))}else ts.superClass.handle_keydown.call(this,B)}});var jf=Tp.TableView=function(S){this._98I(),this._5o(S),new Xj(this)};jr("TableView",h,{ms_ac:[Sl,Tc,$q,"sortMode",vp,Eo,Fj,Vl,Df,Zj,Bs,"sortColumn",Cc,lr,Dg,Se,Zd,Jf,ri],ms_v:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,ms_dm:1,ms_tip:1,_50o:1,_45o:1,_47o:1,_sortMode:Aq,_editable:!0,_batchEditable:!1,_rowHeight:El,_rowLineVisible:U.tableViewRowLineVisible,_rowLineColor:U.tableViewRowLineColor,_columnLineVisible:U.tableViewColumnLineVisible,_columnLineColor:U.tableViewColumnLineColor,_scrollBarColor:Hb,_scrollBarSize:Db,_autoHideScrollBar:Eg,_autoMakeVisible:tl,_selectBackground:U.tableViewSelectBackground,_labelColor:U.tableViewLabelColor,_labelSelectColor:U.tableViewLabelSelectColor,_labelFont:U.tableViewLabelFont,getCheckColumn:function(){var W=this;if(!W._31o){var b=W._31o=new Tr;b.setEditable(!0),b.setWidth(40),b.getValue=W.getCheckColumValue,b.drawCell=W.drawCheckColumnCell}return W._31o},isCheckMode:function(){return this._39o.contains(this._31o)},setCheckMode:function(w){var M=this,v=M._39o,J=M.getCheckColumn();w!==M.isCheckMode()&&(w?v.add(J,0):v.remove(J),M.fp(Pk,!w,w))},getCheckColumValue:function(W,N,p){return p.isSelected(W)},drawCheckColumnCell:function(Y,q,Z,O,m,H,b,a,o){Pq(Y,o.getCheckIcon(q),m+b/2,H+a/2,q,o)}});var Xj=function(Q){td(Xj,this,[Q])};bd(Xj,vm,{_34o:function(k,T){var R=this.list,L=R._31o;if(R.isCellEditable(T,L,k)){var m=R._3Q(L),H=R.lp(k).x;if(m&&H>=m.startX&&H<m.startX+L.getWidth())return R.checkData(T),void 0}R._37O(T,k),R.setFocusData(T)},_33o:function(f,M){this.list._37O(M,f),Xj.superClass._33o.apply(this,arguments)}});var Gl=Tp.TreeTableView=function(H){var T=this,J=T._4o=new Tr;T._35o(),T._98I(),T._5o(H),J.setDisplayName("Name"),J.setEditable(!0),J.setWidth(180),J.drawCell=Xr,J.getValue=fn,T._39o.add(J),new Fe(T)},Xr=function(Q,F,$,s,c,N,o,H,p){p._97I(Q,F,$,c,N,o,H)},fn=function(X,h,R){return R.getLabel(X)};jr("TreeTableView",h,{ms_ac:[Sl,Tc,$q,"sortMode",vp,Eo,qe,Pk,"rootData","rootVisible",Cc,lr,"sortColumn",_l,Nn,Dg,Se,Zd,Jf,Df,Fj,Vl,Zj,Bs,ri,"loader"],ms_v:1,ms_bnb:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,ms_dm:1,ms_tip:1,_50o:1,_48o:1,_14Q:1,_45o:1,_47o:1,_sortMode:Aq,_checkMode:p,_editable:!0,_batchEditable:!1,_indent:_f,_rowHeight:El,_rowLineVisible:U.treeTableViewRowLineVisible,_rowLineColor:U.treeTableViewRowLineColor,_columnLineVisible:U.treeTableViewColumnLineVisible,_columnLineColor:U.treeTableViewColumnLineColor,_expandIcon:U.treeTableViewExpandIcon,_collapseIcon:U.treeTableViewCollapseIcon,_scrollBarColor:Hb,_scrollBarSize:Db,_autoHideScrollBar:Eg,_autoMakeVisible:tl,_selectBackground:U.treeTableViewSelectBackground,_labelColor:U.treeTableViewLabelColor,_labelSelectColor:U.treeTableViewLabelSelectColor,_labelFont:U.treeTableViewLabelFont,getTreeColumn:function(){return this._4o
}});var Fe=function(G){td(Fe,this,[G])};bd(Fe,vm,{_34o:function(J,s){var p=this.list,y=p._4o,C=p._3Q(y),I=p.lp(J).x;if(C){var V=p._indent,j=C.startX+V*p.getLevel(s);if(Tm(p.getToggleIcon(s))&&I>=j&&j+V>=I)return p.toggle(s),void 0;if(p.isCellEditable(s,y)&&(j+=V,I>=j&&j+V>=I))return p.checkData(s),void 0}p._37O(s,J),p.setFocusData(s)},_33o:function(R,n){var p=this.list,i=p.lp(R).x;if(Tm(p.getToggleIcon(n))){var g=p._3Q(p._4o);if(g){var F=p._indent,U=g.startX+F*p.getLevel(n);if(i>=U&&U+F>=i)return p.toggle(n),void 0}}p._37O(n,R),Fe.superClass._33o.apply(this,arguments)}});var Jj=Tp.TableHeader=function(k){var r=this,e=r._view=Yf(1,r),h=r._39o=k.getColumnModel(),W=r.iv;r.tv=r._tableView=k,r._60I=new uh,r._canvas=Ne(e),e.style.background=U.tableHeaderBackground||"",e.style.height=Hm+Vj,h.mm(W,r),h.md(W,r),h.mh(W,r),k.mp(function(_){Lc[_.property]&&r.iv()},r),new wc(r),r.iv()};jr("TableHeader",h,{ms_v:1,ms_lp:1,ms_fire:1,ms_ac:["checkIcon","sortDescIcon","sortAscIcon",Sl,$q,qe,"moveBackground","insertColor",Zj,Bs,"resizable","movable"],_checkIcon:bn,_movable:!0,_resizable:!0,_labelColor:U.tableHeaderLabelColor,_labelFont:U.tableHeaderLabelFont,_columnLineColor:U.tableHeaderColumnLineColor,_columnLineVisible:U.tableHeaderColumnLineVisible,_sortDescIcon:U.tableHeaderSortDescIcon,_sortAscIcon:U.tableHeaderSortAscIcon,_moveBackground:U.tableHeaderMoveBackground,_insertColor:U.tableHeaderInsertColor,_indent:_f,getCheckIcon:function(){return this._checkIcon},getTableView:function(){return this.tv},getLabel:function(O){return O.toLabel()},getLabelFont:function(){return this._labelFont},getLabelColor:function(g){return g.getColor()||this._labelColor},getLabelAlign:function(k){return k._align},onPropertyChanged:function(){this.iv()},_5Q:function(q){this._61I=q,this.iv()},getLogicalPoint:function(j){return wd(j,this._canvas,this.tv.tx())},validateImpl:function(){var M=this,d=M._canvas,p=M.getWidth(),o=M.getHeight(),H=M.tv,h=M._60I,z=M._61I,A=-H.tx(),N=0;(p!==d.clientWidth||o!==d.clientHeight)&&Yc(d,p,o),h.clear(),M._39o._roots.each(function(Z){if(Z.isVisible()){var z=N+Z.getWidth();A+p>=N&&z>=A&&h.add({column:Z,startX:N}),N=z}});var E=Xh(d);if(Co(E,-A,0,1),E.beginPath(),E.rect(A,0,p,o),E.clip(),E.clearRect(A,0,p,o),h.each(function(R){var f=R.column,u=R.startX,q=f.getWidth();q>0&&(E.save(),E.beginPath(),E.rect(u,0,q,o),E.clip(),z&&z.column===f||M.drawColumn(E,f,u,0,q,o),M._columnLineVisible&&le(E,u+q-1,0,1,o,M._columnLineColor),E.restore())}),z){var g=z.column,N=z.startX,l=z.position,e=g.getWidth();E.save(),E.beginPath(),E.rect(N,0,e,o),E.clip(),E.fillStyle=M._moveBackground,E.fill(),M.drawColumn(E,g,N,0,e,o),E.restore(),ve(E,M._insertColor,l,0,o)}E.restore()},_6Q:function(r){var p=this.tv;return p._31o===r&&p.sm().getSelectionMode()===jn},drawColumn:function(L,j,w,f,l,$){var b=this,M=b.tv,g=Tm(j.getIcon()),X=b.getLabelAlign(j);if(b._6Q(j)){var P=Tm(b._checkIcon);Pq(L,P,w+l/2,f+$/2,j,b)}else{var G=b.getLabel(j),q=b.getLabelFont(j),H=b.getLabelColor(j),U=sk(q,G).width,y=g?b._indent:0;X===Aj?(g&&Xl(L,g,As,w,f,y,$),Sn(L,G,q,H,w+y,f,l,$,Aj)):X===ig?(g&&Xl(L,g,As,w+l-U-y,f,y,$),Sn(L,G,q,H,w,f,l,$,ig)):(g&&Xl(L,g,As,w+(l-U-y)/2,f,y,$),Sn(L,G,q,H,w+(l-U+y)/2,f,0,$,Aj))}if(j.isSortable()&&M.getSortColumn()===j&&(g=Tm(j.getSortOrder()===Ug?b._sortAscIcon:b._sortDescIcon))){var T=rl(g,j)/2+2;Pq(L,g,X===ig?w+T:w+l-T,f+$/2,j,M)}}});var wc=function(k){var F=this;F.th=k,F.tv=k._tableView,F.addListeners()};bd(wc,h,{ms_listener:1,getView:function(){return this.th.getView()},setCursor:function(D){this.getView().style.cursor=D},handle_mousemove:function(y){if(!cj){var t=this;delete t._29o,t.setCursor(Wb);for(var H=t.th,J=H._60I,g=H.lp(y).x,D=J.size()-1;D>=0;D--){var O=J.get(D),i=O.column,I=O.startX+i.getWidth();if(H.isResizable()&&B(I-g)<=(_?10:3))return t._29o=O,t.setCursor(Ie),void 0;g>O.startX&&I>g&&(t._29o=O),(i.isClickable()||i.isSortable()||H.isMovable()||t.tv.getCheckColumn&&i===t.tv.getCheckColumn())&&g>O.startX&&I>g&&t.setCursor(Kn)}}},handle_mousedown:function(F){this.handle_touchstart(F)},handle_touchstart:function(b){var t=this;gj(b),t.tv.endEditing(),t.handle_mousemove(b),t._29o&&(t.x=kq(b).x,t.lx=t.th.lp(b).x,t.w=t._29o.column.getWidth(),Kc(t,b))},handleWindowMouseMove:function(b){this.handleWindowTouchMove(b)},handleWindowTouchMove:function(_){var N=this,C=N.th,A=N.getView().style.cursor,V=N._29o,s=kq(_).x-N.x;if(N.resizing||N.moving||(A===Ie?N.resizing=1:C.isMovable()&&A===Kn&&B(s)>2&&(N.moving=1)),N.resizing)V.column.setWidth(N.w+s);else if(N.moving){var q=N.lx+s;C._60I.each(function(n){var U=n.startX,A=U+n.column.getWidth();if(q>=U&&A>=q){var f={column:V.column,startX:V.startX+s,front:A-q>q-U,insertColumn:n.column};f.position=f.front?U:A,C._5Q(f)}})}},_16Q:function(F,g){var p=this,W=p.tv,f=p.th,E=f._checkIcon;if(f._6Q(F)){var R=Tm(E),o=p.lx,Z=F.getWidth(),G=rl(R,F);if(o>=g+Z/2-G&&g+Z/2+G>=o){f.setCheckIcon(E===_h?bn:_h);var J=W.sm(),K=W._rows;return E===_h?J.rs(K):J.ss(K),W.onCheckColumnClicked(F),!0}}return!1},handleWindowMouseUp:function(i){this.handleWindowTouchEnd(i)},handleWindowTouchEnd:function(y){var Y=this,v=Y.tv,N=Y.th,r=Y._29o;if(Y.moving){var i=N._61I;if(i&&i.insertColumn!==i.column){var L=i.column,O=v.getColumnModel()._roots,q=O.remove(L),m=O.indexOf(i.insertColumn);m>=0&&(i.front||m++,m<=O.size()&&(O.add(L,m),v.getColumnModel()._38I(L,q,m)))}N._5Q(p),delete Y.moving}else if(!Y.resizing&&r){L=r.column;var M=N.lp(y).x,g=r.startX,A=!0;if(N.onColumnClicked){var x=N.onColumnClicked(L,y,g);x===!1&&(A=!1)}if(A&&M>=g&&M<=g+L.getWidth()&&!Y._16Q(L,g)){if(L.isSortable()){var D=v.getSortMode(),u=L.getSortOrder();D===Aq?v.getSortColumn()===L?(u===qi&&v.setSortColumn(p),L.setSortOrder(u===Ug?qi:Ug)):v.setSortColumn(L):"bistate"===D&&(v.getSortColumn()===L?L.setSortOrder(u===Ug?qi:Ug):v.setSortColumn(L))}v.onColumnClicked(L,y,g)}}Y._29o=Y.resizing=Y.x=Y.lx=Y.w=p}}),Tp.TablePane=function(R){this.init(new jf(R))},jr("TablePane",h,{ms_v:1,_44o:1}),Tp.TreeTablePane=function(w){this.init(new Gl(w))},jr("TreeTablePane",h,{ms_v:1,_44o:1}),Tp.Toolbar=function(S){var N=this,i=N._view=Yf(1,N),e=i.style;e.background=U.toolbarBackground||"",e.height=Ze+Vj,N._canvas=Ne(i),N._30o=new uh,N._90I=new uh,N.setItems(S||[]),i.handleGroupSelectedChanged=function(z){if(z.isSelected()){var Y=z.getGroupId();null!=Y&&N._items.forEach(function(k){var W=k.element;W&&W!==z&&W.setSelected&&W.getGroupId&&W.getGroupId()===Y&&W.setSelected(!1)})}},new vf(N)},jr("Toolbar",h,{ms_v:1,ms_fire:1,ms_tx:1,ms_lp:1,ms_tip:1,ms_value:1,ms_ac:[dh,Sl,$q,Tc,ri,"itemGap","separatorColor","currentItem","stickToRight"],_labelColor:U.toolbarLabelColor,_labelSelectColor:U.toolbarLabelSelectColor,_labelFont:U.toolbarLabelFont,_selectBackground:U.toolbarSelectBackground,_itemGap:U.toolbarItemGap,_separatorColor:U.toolbarSeparatorColor,_stickToRight:!1,getSumWidth:function(){return this._64I},getToolTip:function(V){var N=this.getItemInfoAt(V);return N?N.item.toolTip:p},getLabelColor:function(Z){return Z&&Z.selected&&Z.type!==_h&&Z.type!==qo?this._labelSelectColor:this._labelColor},onPropertyChanged:function(z){this.iv(),z.property===dh&&this._items.forEach(function(C){jm(C)})},redraw:function(){this.iv()},addItem:function(l,F){var z=this._items;F==p?z.push(l):z.splice(F,0,l),this.fp(dh,p,z)},removeItem:function(o){if(o)for(var K=this._items,l=0;l<K.length;l++)o===K[l]&&(K.splice(l,1),this.fp(dh,p,K))},removeItemById:function(O){if(O!=p)for(var F=this._items,a=0;a<F.length;a++)if(O===F[a].id){var J=F.splice(a,1)[0];return this.fp(dh,p,F),J}},getItemById:function(s){if(s!=p)for(var M=this._items,T=0;T<M.length;T++){var $=M[T];if(s===$.id)return $}},setItemVisible:function(c,S){var n=this.getItemById(c);n&&(n.visible=S)},getItemInfos:function(){return this._30o},getItemInfoAt:function(U){var i=this,t=0,J=i._30o,H=i.lp(U),Y=H.x,c=H.y;if(c>=0&&c<=i.getHeight())for(;t<J.size();t++){var l=J.get(t);if(l.startX<=Y&&Y<=l.endX)return l}return p},drawItem:function(o,k,y,D,f){if(k.visible===!1)return 0;if(vk(k.visible)&&!k.visible())return 0;var V=this,c=k.disabled;c&&(o.globalAlpha=cn);var U=V.drawItemImpl(o,k,y,D,f),x=V._itemGap;return c&&(o.globalAlpha=1),this._currentItem!==k||"separator"===k||k.separator===!0||k.unfocusable||gg(o,V._separatorColor,y-x/2,0,U+x,D),U},drawItemImpl:function(W,H,X,m,T){var s=this,O=s._view,u=s._itemGap,i=m/2,E=H.type,I=H.element,h=H.label;Op(I)&&(h=I,I=p);var N,A=s.getLabelFont(H),P=s.getLabelColor(H),t=H.selected,f=Tm(H.icon),B=rl(f,H),Z=0,C=B+(h?sk(A,h).width:0);if("separator"===H||H.separator===!0)return ve(W,s._separatorColor,X,m/4,i),1;if(I){f&&Pq(W,f,X+B/2,i,H,s),Sn(W,h,A,P,X+B,0,0,m);var w=Gn(I);T||s._90I.add(w),w.parentNode!==O&&rj(O,w),I.iv&&I.iv(),I.validate&&I.validate();var b=w.getBoundingClientRect(),o=b.width,y=w.style;return Pf(w),y.left=s.tx()+X+C+Vj,y.top=(m-b.height)/2+Vj,C+o}return E===qo?N=Tm(t?as:mh):E===_h&&(N=Tm(t?_h:bn)),N?(Z=rl(N,H),Pq(W,N,X+Z/2,i,H,s),X+=Z,C+=Z):t&&le(W,X-u/2,0,C+u,m,s.getSelectBackground(H)),f&&Pq(W,f,X+B/2,i,H,s),Sn(W,h,A,P,X+B,0,0,m),C},validateImpl:function(){var l=this,L=l._canvas,R=l.getWidth(),m=l.getHeight(),r=l._30o,f=l._items;Yc(L,R,m);var v=Xh(L),b=l._itemGap,P=b/2;Co(v,l.tx(),0,1),v.clearRect(0,0,R,m);var $=l._90I;l._90I=new uh,r.clear(),f.forEach(function(C){var q=l.drawItem(v,C,P,m);r.add({item:C,startX:P,endX:P+q,width:q}),q&&(P+=q+b)}),$.each(function(t){l._90I.contains(t)||_k(t)});var U=l._64I;l._64I=Q(0,P),v.restore(),l._stickToRight?(l._65O=0,v=Xh(L),P=R-l._64I+b,Co(v,0,0,1),v.clearRect(0,0,R,m),r.clear(),f.forEach(function(f){var K=l.drawItem(v,f,P,m,!0);r.add({item:f,startX:P,endX:P+K,width:K}),K&&(P+=K+b)}),v.restore()):l.tx(l.tx()),U!==l._64I&&l.onSumWidthChanged(U,l._64I)},onSumWidthChanged:function(){},handleClick:function(h,k){var l=this,B=h.type,c=h.action,C=h.groupId,g=h.selected;h.disabled||(C!=p?g||(h.selected=!0,this._items.forEach(function(s){s.groupId===C&&h!==s&&(s.selected=!1)}),c&&h.action(h,l,k)):B===_h||"toggle"===B?(h.selected=!g,c&&h.action(h,l,k)):c&&h.action(h,l,k)),mk(),l.iv()}});var vf=function(t){this.tb=t,this.addListeners()};bd(vf,h,{ms_listener:1,getView:function(){return this.tb._view},handle_mousewheel:function(G){this.handleScroll(G,10*(G.wheelDelta/40))},handle_DOMMouseScroll:function(J){this.handleScroll(J,10*-J.detail)},handleScroll:function(h,m){gj(h);var k=this.tb;k.isScrollable()&&!k._stickToRight&&(k.tx(k.tx()+m),al())},handle_mousemove:function(V){var i=this;cj||i.setItem(V)},handle_mouseout:function(x){var c=this;x.target===c.getView()?c.tb.setCurrentItem(p):c.handle_mousemove(x)},handle_mousedown:function(T){this.handle_mousemove(T),this.handle_touchstart(T)},handle_touchstart:function(d){var g=this,B=g.tb,G=d.target;xm(d)&&(G===g.getView()||G===B._canvas)&&(gj(d),B.setFocus(d)&&(this.setItem(d,!0),(B.isScrollable()||g.info&&!g.info.item.disabled)&&(g.x=kq(d).x,g.tx=B.tx(),Kc(g,d))))},handleWindowMouseMove:function($){this.handleWindowTouchMove($)},handleWindowTouchMove:function(k){var P=this,m=P.tb;if(!m._stickToRight){var C=kq(k).x-P.x;!P._25o&&B(C)>2&&m.isScrollable()&&(P._25o=1),P._25o&&m.tx(P.tx+C)}},handleWindowMouseUp:function(D){this.handleWindowTouchEnd(D)},handleWindowTouchEnd:function(M){var z=this,Z=z.tb,C=z.info,A=z.tb.getItemInfoAt(M);if(!z._25o&&C){var d=C.item;A&&A.item===d&&Z.handleClick(d,M)}z._25o=z.x=z.tx=p,z.setItem()},setItem:function(s,A){var V=this,c=V.tb,_=V.info=s?c.getItemInfoAt(s):p,z=_?_.item:p;c.setCurrentItem(z),A&&z&&vk(z.onDown)&&z.onDown(s)}}),Tp.BorderPane=function(){this._view=Yf(1,this),this.iv()},jr("BorderPane",h,{ms_v:1,ms_ac:["topHeight","bottomHeight","leftWidth","rightWidth"],ms_fire:1,getLeftView:function(){return this._leftView},setLeftView:function(j,b){this._12o("leftView",j),b!=p&&this.setLeftWidth(b)},getRightView:function(){return this._rightView},setRightView:function(a,g){this._12o("rightView",a),g!=p&&this.setRightWidth(g)},getTopView:function(){return this._topView},setTopView:function(Z,K){this._12o("topView",Z),K!=p&&this.setTopHeight(K)},getBottomView:function(){return this._bottomView},setBottomView:function(U,v){this._12o("bottomView",U),v!=p&&this.setBottomHeight(v)},getCenterView:function(){return this._centerView},setCenterView:function(P){this._12o("centerView",P)},_12o:function(v,Y){var L=this,w="_"+v,T=L._view,c=L[w];c!==Y&&(c&&(c.getView?_k(c.getView()):_k(c)),L[w]=Y,Y&&(Y.getView?rj(T,Y.getView(),1):rj(T,Y,1)),L.fp(v,c,Y))},onPropertyChanged:function(){this.iv()},validateImpl:function(){var U=this,N=U._topView,f=U._bottomView,R=U._leftView,i=U._rightView,x=U._centerView,K=U.getWidth(),I=U.getHeight(),u=0,B=0,q=K,T=I,$=0,w=0,G=0,O=0;N&&($=U._topHeight==p?Hh(N):U._topHeight,B=$),f&&(w=U._bottomHeight==p?Hh(f):U._bottomHeight,T=I-w),R&&(G=U._leftWidth==p?Rd(R):U._leftWidth,u=G),i&&(O=U._rightWidth==p?Rd(i):U._rightWidth,q=K-O);var W=Q(0,q-u),s=Q(0,T-B);N&&Eb(N,0,0,K,$),f&&Eb(f,0,T,K,w),R&&Eb(R,0,B,G,s),i&&Eb(i,q,B,O,s),x&&Eb(x,u,B,W,s)}})}}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:(0,eval)("this"),Object);